{"version":3,"kind":"Notebook","sha256":"5298534f77dd784b5b6b598831916be41670d15c63708fc82096fcdf9aa354fb","slug":"sections.computer-programming.fortran.neural-fortran.section-examples-sine-wave","location":"/Sections/Computer_Programming/Fortran/Neural_Fortran/Section_Examples_Sine_Wave.ipynb","dependencies":[],"frontmatter":{"title":"Neural Fortran Examples: Sine Wave","content_includes_title":true,"kernelspec":{"name":"py311_env","display_name":"Python 3.11","language":"python"},"authors":[{"nameParsed":{"literal":"Mark Khusid","given":"Mark","family":"Khusid"},"name":"Mark Khusid","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/markkhusid/MKDynamics_Website_V2","numbering":{"title":{"offset":4}},"source_url":"https://github.com/markkhusid/MKDynamics_Website_V2/blob/master/Sections/Computer_Programming/Fortran/Neural_Fortran/Section_Examples_Sine_Wave.ipynb","edit_url":"https://github.com/markkhusid/MKDynamics_Website_V2/edit/master/Sections/Computer_Programming/Fortran/Neural_Fortran/Section_Examples_Sine_Wave.ipynb","exports":[{"format":"ipynb","filename":"Section_Examples_Sine_Wave.ipynb","url":"/build/Section_Examples_Sin-f4039dc3a1690171fbf88842eecf20d9.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"","value":"---\njupytext:\n  formats: md:myst\n  text_representation:\n    extension: .md\n    format_name: myst\nkernelspec:\n  display_name: Python 3\n  language: python\n  name: python3\n---","key":"ZQH5PBWgwe"}],"key":"bjEHaDDJwP"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Neural Fortran Examples: Sine Wave","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YvveEStsse"}],"identifier":"neural-fortran-examples-sine-wave","label":"Neural Fortran Examples: Sine Wave","html_id":"neural-fortran-examples-sine-wave","implicit":true,"key":"eiKtqQrc8S"}],"key":"xEbvl3uHYB"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IifxQO9x9o"}],"identifier":"introduction","label":"Introduction","html_id":"introduction","implicit":true,"key":"dZTqvltiIy"}],"key":"xb7Wf5VA5U"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this example, we will train a neural network to approximate the sine function. We will use a simple feedforward neural network with two hidden layers. The network will be trained using the backpropagation algorithm.  The data will be written to a CSV file using the CSV Fortran library ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nKdyi7Rbz3"},{"type":"link","url":"https://github.com/jacobwilliams/csv-fortran","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"https://​github​.com​/jacobwilliams​/csv​-fortran","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WZ9slhZxsI"}],"urlSource":"https://github.com/jacobwilliams/csv-fortran","error":true,"key":"CNtgIZReW7"},{"type":"text","value":". The neural network will be implemented in Fortran using the Neural Fortran library ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CrEKRrBGR6"},{"type":"link","url":"https://github.com/modern-fortran/neural-fortran","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"https://​github​.com​/modern​-fortran​/neural​-fortran","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XaA7F20kJz"}],"urlSource":"https://github.com/modern-fortran/neural-fortran","error":true,"key":"HDNpo1FtS0"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"U4PlrrCPjH"}],"key":"iwqHOyEeaa"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Once the data is collected and saved to a CSV file, Pandas and Matplotlib will be used to plot the learned sine wave and mean squared error versus the learning iteration number.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PQKM267aVU"}],"key":"JYKBn00p1v"}],"key":"BzIaVhHhDO"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Neural Network Theory by ChatGPT o1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NvPmJgmcvX"}],"identifier":"neural-network-theory-by-chatgpt-o1","label":"Neural Network Theory by ChatGPT o1","html_id":"neural-network-theory-by-chatgpt-o1","implicit":true,"key":"ysnOrrlzLW"}],"key":"Gg7HY9Sbrk"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Below is a concise yet mathematically grounded overview of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tF5aVajPKx"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"dense neural networks","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jJnOGu3cD8"}],"key":"yG0Y7JEWd0"},{"type":"text","value":", sometimes referred to as ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BoAeOxtQF8"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"feedforward","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iC0GrAZMsG"}],"key":"JlUrnqqK9j"},{"type":"text","value":" or ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vKGIqkp0iC"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"fully connected","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PJx2duZdGf"}],"key":"s0Zy5JI8IG"},{"type":"text","value":" networks. We will cover their core structure, forward-pass equations, and typical training approach.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"g748z3zZ89"}],"key":"vHN9YT4iLA"},{"type":"thematicBreak","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dY66zsCEie"},{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Dense Neural Network Structure","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yGDHPeoA9I"}],"identifier":"dense-neural-network-structure","label":"Dense Neural Network Structure","html_id":"dense-neural-network-structure","implicit":true,"key":"mVtVsek54a"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"A ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"f8WLHkslj7"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"dense (fully connected) neural network","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"oM57f4W4UY"}],"key":"kMD9MNM4K5"},{"type":"text","value":" consists of layers of neurons, where each neuron in one layer connects to ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"j9ygdXx2Gd"},{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"every","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"LEyWBm4nTe"}],"key":"kr9PQZic0L"},{"type":"text","value":" neuron in the next layer via a trainable weight. Suppose we have a network with ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"tgPzVFjwfm"},{"type":"inlineMath","value":"L","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span>","key":"NP72gtkiRX"},{"type":"text","value":" layers, indexed by ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"weBKrWr3QO"},{"type":"inlineMath","value":" \\ell = 1, 2, \\ldots, L","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">ℓ</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>L</mi></mrow><annotation encoding=\"application/x-tex\"> \\ell = 1, 2, \\ldots, L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\">ℓ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span>","key":"pPJj8Wvf7w"},{"type":"text","value":". Each layer ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"wnuG43nqNZ"},{"type":"inlineMath","value":"\\ell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">ℓ</mi></mrow><annotation encoding=\"application/x-tex\">\\ell</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\">ℓ</span></span></span></span>","key":"kfTsfGIjZz"},{"type":"text","value":" has ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"r06GqIG0bB"},{"type":"inlineMath","value":"n_\\ell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>n</mi><mi mathvariant=\"normal\">ℓ</mi></msub></mrow><annotation encoding=\"application/x-tex\">n_\\ell</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3361em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">ℓ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"kezgm2wfdF"},{"type":"text","value":" neurons. For simplicity, let ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"XWnl7ybNws"},{"type":"inlineMath","value":"\\mathbf{x} \\in \\mathbb{R}^{n_0}","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">x</mi><mo>∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><msub><mi>n</mi><mn>0</mn></msub></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{x} \\in \\mathbb{R}^{n_0}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mord mathbf\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>","key":"FYNInxIw7h"},{"type":"text","value":" be the input, where ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Cuzh3DRpEr"},{"type":"inlineMath","value":"n_0","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>n</mi><mn>0</mn></msub></mrow><annotation encoding=\"application/x-tex\">n_0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"coZcGKbrjd"},{"type":"text","value":" is the input dimension, and let ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"dXvky1Y3D2"},{"type":"inlineMath","value":"\\mathbf{y} \\in \\mathbb{R}^{n_L}","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">y</mi><mo>∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><msub><mi>n</mi><mi>L</mi></msub></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{y} \\in \\mathbb{R}^{n_L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3567em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mathnormal mtight\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1433em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>","key":"o4ZC14OKJp"},{"type":"text","value":" be the network’s output.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"XSawIE3GJ4"}],"key":"OYJfMGp9Ay"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"A typical layer ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"tsOMvy0eCj"},{"type":"inlineMath","value":"\\ell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">ℓ</mi></mrow><annotation encoding=\"application/x-tex\">\\ell</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\">ℓ</span></span></span></span>","key":"kQH5pHOMMA"},{"type":"text","value":" of the network (for ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"oUu59rYzHl"},{"type":"inlineMath","value":"1 \\le \\ell \\le L","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1</mn><mo>≤</mo><mi mathvariant=\"normal\">ℓ</mi><mo>≤</mo><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">1 \\le \\ell \\le L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7804em;vertical-align:-0.136em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8304em;vertical-align:-0.136em;\"></span><span class=\"mord\">ℓ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span>","key":"PylvRdd6T1"},{"type":"text","value":") is described by a linear transformation followed by an elementwise non-linear activation. Specifically,","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"t6Eyt5r5PH"}],"key":"PfCAVF3qif"},{"type":"math","value":"\\mathbf{z}^{(\\ell)} \n  \\;=\\; W^{(\\ell)}\\, \\mathbf{h}^{(\\ell-1)} \\;+\\; \\mathbf{b}^{(\\ell)},","position":{"start":{"line":11,"column":1},"end":{"line":14,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi mathvariant=\"bold\">z</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msup><mtext>  </mtext><mo>=</mo><mtext>  </mtext><msup><mi>W</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msup><mtext> </mtext><msup><mi mathvariant=\"bold\">h</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mtext>  </mtext><mo>+</mo><mtext>  </mtext><msup><mi mathvariant=\"bold\">b</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">\\mathbf{z}^{(\\ell)} \n  \\;=\\; W^{(\\ell)}\\, \\mathbf{h}^{(\\ell-1)} \\;+\\; \\mathbf{b}^{(\\ell)},</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.938em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">z</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0213em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1324em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"1","key":"qIfzJi8UkE"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"where:","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"ZxQkYoCRCo"}],"key":"xlv49v8maW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":17,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"W^{(\\ell)} \\in \\mathbb{R}^{n_\\ell \\times n_{\\ell-1}}","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>W</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><mrow><msub><mi>n</mi><mi mathvariant=\"normal\">ℓ</mi></msub><mo>×</mo><msub><mi>n</mi><mrow><mi mathvariant=\"normal\">ℓ</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow></msup></mrow><annotation encoding=\"application/x-tex\">W^{(\\ell)} \\in \\mathbb{R}^{n_\\ell \\times n_{\\ell-1}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9271em;vertical-align:-0.0391em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7713em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7713em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">ℓ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1512em;\"><span></span></span></span></span></span></span><span class=\"mbin mtight\">×</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">ℓ</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2107em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>","key":"VrQWKYKBUe"},{"type":"text","value":" is the weight matrix for layer ","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"FkiX5HPTRZ"},{"type":"inlineMath","value":"\\ell","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">ℓ</mi></mrow><annotation encoding=\"application/x-tex\">\\ell</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\">ℓ</span></span></span></span>","key":"ogPXunsroW"},{"type":"text","value":".","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"IPJ5ToQ9yp"}],"key":"vI5BXfE0CM"}],"key":"J4ykGlIgqj"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\mathbf{b}^{(\\ell)} \\in \\mathbb{R}^{n_\\ell}","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">b</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><msub><mi>n</mi><mi mathvariant=\"normal\">ℓ</mi></msub></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{b}^{(\\ell)} \\in \\mathbb{R}^{n_\\ell}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9271em;vertical-align:-0.0391em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">ℓ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1512em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>","key":"Tw6hhkCDbl"},{"type":"text","value":" is the bias vector.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"klXAE2pFTN"}],"key":"i9F7UJ5M28"}],"key":"fpi6mNm2RH"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"\\mathbf{h}^{(\\ell-1)} \\in \\mathbb{R}^{n_{\\ell-1}}","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">h</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo>∈</mo><msup><mi mathvariant=\"double-struck\">R</mi><msub><mi>n</mi><mrow><mi mathvariant=\"normal\">ℓ</mi><mo>−</mo><mn>1</mn></mrow></msub></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{h}^{(\\ell-1)} \\in \\mathbb{R}^{n_{\\ell-1}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9271em;vertical-align:-0.0391em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6889em;\"></span><span class=\"mord\"><span class=\"mord mathbb\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">ℓ</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2107em;\"><span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>","key":"lUJI5dHrAl"},{"type":"text","value":" is the output (also called the activation) of the previous layer (","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"taiTJxMCs8"},{"type":"inlineMath","value":"\\ell-1","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">ℓ</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\ell-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord\">ℓ</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"dzBtzsMSXB"},{"type":"text","value":").","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"CyFvquadcE"}],"key":"Kh3tyDYFDV"}],"key":"xrJPtEsRiV"}],"key":"IWHMxwfvvL"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Next, we apply a (usually nonlinear) activation function ","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"aq9kxh8t7j"},{"type":"inlineMath","value":"\\sigma(\\cdot)","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi><mo stretchy=\"false\">(</mo><mo>⋅</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\sigma(\\cdot)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord\">⋅</span><span class=\"mclose\">)</span></span></span></span>","key":"VzzTEi554x"},{"type":"text","value":" elementwise:","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"HIfty6v89O"}],"key":"jlVkgX8SSk"},{"type":"math","value":"\\mathbf{h}^{(\\ell)} \n  \\;=\\; \\sigma\\bigl(\\mathbf{z}^{(\\ell)}\\bigr)\n  \\;=\\; \n  \\begin{bmatrix}\n    \\sigma(z_1^{(\\ell)}) \\\\[6pt]\n    \\sigma(z_2^{(\\ell)}) \\\\[6pt]\n    \\vdots \\\\[6pt]\n    \\sigma(z_{n_\\ell}^{(\\ell)}) \\\\[6pt]\n  \\end{bmatrix}.","position":{"start":{"line":23,"column":1},"end":{"line":33,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi mathvariant=\"bold\">h</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msup><mtext>  </mtext><mo>=</mo><mtext>  </mtext><mi>σ</mi><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">(</mo><msup><mi mathvariant=\"bold\">z</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">)</mo><mtext>  </mtext><mo>=</mo><mtext>  </mtext><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>σ</mi><mo stretchy=\"false\">(</mo><msubsup><mi>z</mi><mn>1</mn><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>σ</mi><mo stretchy=\"false\">(</mo><msubsup><mi>z</mi><mn>2</mn><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi><mi mathvariant=\"normal\">⋮</mi><mpadded height=\"0em\" voffset=\"0em\"><mspace mathbackground=\"black\" width=\"0em\" height=\"1.5em\"></mspace></mpadded></mi></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>σ</mi><mo stretchy=\"false\">(</mo><msubsup><mi>z</mi><msub><mi>n</mi><mi mathvariant=\"normal\">ℓ</mi></msub><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msubsup><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{h}^{(\\ell)} \n  \\;=\\; \\sigma\\bigl(\\mathbf{z}^{(\\ell)}\\bigr)\n  \\;=\\; \n  \\begin{bmatrix}\n    \\sigma(z_1^{(\\ell)}) \\\\[6pt]\n    \\sigma(z_2^{(\\ell)}) \\\\[6pt]\n    \\vdots \\\\[6pt]\n    \\sigma(z_{n_\\ell}^{(\\ell)}) \\\\[6pt]\n  \\end{bmatrix}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.938em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.288em;vertical-align:-0.35em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathbf\">z</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing size1\">)</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:8.4744em;vertical-align:-3.9872em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.4501em;\"><span style=\"top:-3.511em;\"><span class=\"pstrut\" style=\"height:6.8161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎣</span></span></span><span style=\"top:-4.658em;\"><span class=\"pstrut\" style=\"height:6.8161em;\"></span><span style=\"height:4.8161em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='4.8161em' style='width:0.6667em' viewBox='0 0 666.67 4816' preserveAspectRatio='xMinYMin'><path d='M319 0 H403 V4816 H319z M319 0 H403 V4816 H319z'/></svg></span></span><span style=\"top:-10.1111em;\"><span class=\"pstrut\" style=\"height:6.8161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎡</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.9501em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.4872em;\"><span style=\"top:-7.1299em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0448em;\"><span style=\"top:-2.4337em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span><span style=\"top:-3.2198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2663em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-5.1251em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0448em;\"><span style=\"top:-2.4337em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span><span style=\"top:-3.2198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2663em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.6651em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\">⋮</span><span class=\"mord rule\" style=\"border-right-width:0em;border-top-width:1.5em;bottom:0em;\"></span></span></span></span><span style=\"top:-0.6603em;\"><span class=\"pstrut\" style=\"height:3.6875em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.0448em;\"><span style=\"top:-2.5834em;margin-left:-0.044em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3448em;\"><span style=\"top:-2.3488em;margin-left:0em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">ℓ</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1512em;\"><span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.2198em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2225em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.9872em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.4501em;\"><span style=\"top:-3.511em;\"><span class=\"pstrut\" style=\"height:6.8161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎦</span></span></span><span style=\"top:-4.658em;\"><span class=\"pstrut\" style=\"height:6.8161em;\"></span><span style=\"height:4.8161em;width:0.6667em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.6667em' height='4.8161em' style='width:0.6667em' viewBox='0 0 666.67 4816' preserveAspectRatio='xMinYMin'><path d='M263 0 H347 V4816 H263z M263 0 H347 V4816 H263z'/></svg></span></span><span style=\"top:-10.1111em;\"><span class=\"pstrut\" style=\"height:6.8161em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎤</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.9501em;\"><span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"2","key":"AEtUDYqgsF"},{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"For instance, ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"vKE3wg7zrw"},{"type":"inlineMath","value":"\\sigma","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>σ</mi></mrow><annotation encoding=\"application/x-tex\">\\sigma</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span></span></span></span>","key":"MLUoavRBSn"},{"type":"text","value":" might be the ReLU function ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"dunCwpzCql"},{"type":"inlineMath","value":"\\max(0, z)","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>max</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>z</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\max(0, z)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">max</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.04398em;\">z</span><span class=\"mclose\">)</span></span></span></span>","key":"R8oRtqHMSp"},{"type":"text","value":", the sigmoid function ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"EAXHxjgqdA"},{"type":"inlineMath","value":"\\tfrac{1}{1 + e^{-z}}","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>z</mi></mrow></msup></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\tfrac{1}{1 + e^{-z}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.2484em;vertical-align:-0.4033em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7027em;\"><span style=\"top:-2.786em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.04398em;\">z</span></span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4033em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"R8OdSJ9q8N"},{"type":"text","value":", or ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"HF8UPG2Tlo"},{"type":"inlineMath","value":"\\tanh","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>tanh</mi><mo>⁡</mo></mrow><annotation encoding=\"application/x-tex\">\\tanh</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mop\">tanh</span></span></span></span>","key":"AFCrzH1F8v"},{"type":"text","value":". The final output layer might also have a special activation (e.g., softmax for classification).","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"c2AHu93DoJ"}],"key":"YHxsjxcoQc"},{"type":"thematicBreak","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"pCRe8BFqUZ"},{"type":"heading","depth":2,"position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"Forward Pass Equations","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"ug2OiVM4u3"}],"identifier":"forward-pass-equations","label":"Forward Pass Equations","html_id":"forward-pass-equations","implicit":true,"key":"mUINCVDIlv"},{"type":"paragraph","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"Using the above notation, we initialize the network’s input as","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"XLrneO88qD"}],"key":"mOULHWEuPV"},{"type":"math","value":"\\mathbf{h}^{(0)} \\;=\\; \\mathbf{x}.","position":{"start":{"line":43,"column":1},"end":{"line":45,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi mathvariant=\"bold\">h</mi><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow></msup><mtext>  </mtext><mo>=</mo><mtext>  </mtext><mi mathvariant=\"bold\">x</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{h}^{(0)} \\;=\\; \\mathbf{x}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.938em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">0</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4444em;\"></span><span class=\"mord mathbf\">x</span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"3","key":"Esi8IMNvq2"},{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"Then for each layer ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"H3IPcuJLjR"},{"type":"inlineMath","value":"\\ell = 1, 2, \\ldots, L","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">ℓ</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mo>…</mo><mo separator=\"true\">,</mo><mi>L</mi></mrow><annotation encoding=\"application/x-tex\">\\ell = 1, 2, \\ldots, L</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord\">ℓ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8778em;vertical-align:-0.1944em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\">…</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">L</span></span></span></span>","key":"daoJzMLRK5"},{"type":"text","value":", we compute","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"x5kf1bbm1l"}],"key":"sIw1v5gHSz"},{"type":"math","value":"\\mathbf{z}^{(\\ell)} = W^{(\\ell)}\\, \\mathbf{h}^{(\\ell-1)} + \\mathbf{b}^{(\\ell)}, \n  \\quad\n  \\mathbf{h}^{(\\ell)} = \\sigma\\bigl(\\mathbf{z}^{(\\ell)}\\bigr).","position":{"start":{"line":49,"column":1},"end":{"line":53,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi mathvariant=\"bold\">z</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><msup><mi>W</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msup><mtext> </mtext><msup><mi mathvariant=\"bold\">h</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></msup><mo>+</mo><msup><mi mathvariant=\"bold\">b</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo separator=\"true\">,</mo><mspace width=\"1em\"/><msup><mi mathvariant=\"bold\">h</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo>=</mo><mi>σ</mi><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">(</mo><msup><mi mathvariant=\"bold\">z</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo fence=\"true\" stretchy=\"true\" minsize=\"1.2em\" maxsize=\"1.2em\">)</mo><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{z}^{(\\ell)} = W^{(\\ell)}\\, \\mathbf{h}^{(\\ell-1)} + \\mathbf{b}^{(\\ell)}, \n  \\quad\n  \\mathbf{h}^{(\\ell)} = \\sigma\\bigl(\\mathbf{z}^{(\\ell)}\\bigr).</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.938em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">z</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0213em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mbin mtight\">−</span><span class=\"mord mtight\">1</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1324em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.288em;vertical-align:-0.35em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">σ</span><span class=\"mopen\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathbf\">z</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing size1\">)</span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"4","key":"qhRk9UGHmK"},{"type":"paragraph","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"At the final layer, ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"INyHRt74cp"},{"type":"inlineMath","value":"\\mathbf{h}^{(L)}","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi mathvariant=\"bold\">h</mi><mrow><mo stretchy=\"false\">(</mo><mi>L</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\mathbf{h}^{(L)}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.888em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">h</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">L</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span></span>","key":"CdpqhODzAh"},{"type":"text","value":" becomes the network’s output ","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"SY0B6ptrNj"},{"type":"inlineMath","value":"\\mathbf{y}","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"bold\">y</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6389em;vertical-align:-0.1944em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span></span></span></span>","key":"EqB2oRyfQV"},{"type":"text","value":". Hence, a forward pass through a dense network is just iterating these matrix-vector multiplications and elementwise activations.","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"NkADyhNqxf"}],"key":"mDW9T4xstF"},{"type":"thematicBreak","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"lLX0cqeAVI"},{"type":"heading","depth":2,"position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"Training With Gradient Descent","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"DoF23RNEdp"}],"identifier":"training-with-gradient-descent","label":"Training With Gradient Descent","html_id":"training-with-gradient-descent","implicit":true,"key":"wk2z5K1fC0"},{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"To train the network, we typically have a dataset of inputs ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"nPJ7rC1qYn"},{"type":"inlineMath","value":"\\{\\mathbf{x}_i\\}","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><msub><mi mathvariant=\"bold\">x</mi><mi>i</mi></msub><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\{\\mathbf{x}_i\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\"><span class=\"mord mathbf\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">}</span></span></span></span>","key":"hk1NB0OTKW"},{"type":"text","value":" and corresponding targets ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"Kt9pJrWBO3"},{"type":"inlineMath","value":"\\{\\mathbf{t}_i\\}","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><msub><mi mathvariant=\"bold\">t</mi><mi>i</mi></msub><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\{\\mathbf{t}_i\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\"><span class=\"mord mathbf\">t</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">}</span></span></span></span>","key":"KYYekO103g"},{"type":"text","value":". We define a ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"JdVRxJAgNb"},{"type":"strong","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"loss function","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"CcdxEats2B"}],"key":"rwXB66jt1m"},{"type":"text","value":" ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"qkDtplhu6V"},{"type":"inlineMath","value":"\\mathcal{L}","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathcal{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathcal\">L</span></span></span></span>","key":"XgBA8DFiW1"},{"type":"text","value":", such as mean squared error (for regression) or cross-entropy (for classification). For a single training example ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"ZnJnIUIXy2"},{"type":"inlineMath","value":"(\\mathbf{x}, \\mathbf{t})","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">x</mi><mo separator=\"true\">,</mo><mi mathvariant=\"bold\">t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(\\mathbf{x}, \\mathbf{t})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathbf\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">t</span><span class=\"mclose\">)</span></span></span></span>","key":"onKj5mwDcT"},{"type":"text","value":", we might write","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"kx66XHKG1T"}],"key":"SzHOQcEg8G"},{"type":"math","value":"\\mathcal{L}(\\mathbf{t}, \\mathbf{y}) \n  \\;=\\; \\frac{1}{2} \\|\\mathbf{y} - \\mathbf{t}\\|^2\n  \\quad\\text{(for an example squared error case).}","position":{"start":{"line":63,"column":1},"end":{"line":67,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"script\">L</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold\">t</mi><mo separator=\"true\">,</mo><mi mathvariant=\"bold\">y</mi><mo stretchy=\"false\">)</mo><mtext>  </mtext><mo>=</mo><mtext>  </mtext><mfrac><mn>1</mn><mn>2</mn></mfrac><mi mathvariant=\"normal\">∥</mi><mi mathvariant=\"bold\">y</mi><mo>−</mo><mi mathvariant=\"bold\">t</mi><msup><mi mathvariant=\"normal\">∥</mi><mn>2</mn></msup><mspace width=\"1em\"/><mtext>(for an example squared error case).</mtext></mrow><annotation encoding=\"application/x-tex\">\\mathcal{L}(\\mathbf{t}, \\mathbf{y}) \n  \\;=\\; \\frac{1}{2} \\|\\mathbf{y} - \\mathbf{t}\\|^2\n  \\quad\\text{(for an example squared error case).}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathcal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathbf\">t</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\">∥</span><span class=\"mord mathbf\" style=\"margin-right:0.01597em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord mathbf\">t</span><span class=\"mord\"><span class=\"mord\">∥</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mord text\"><span class=\"mord\">(for an example squared error case).</span></span></span></span></span></span>","enumerator":"5","key":"kbcQJcT8oo"},{"type":"paragraph","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"d9wgm8xdqw"},{"type":"strong","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"backpropagation","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"Th29EdKKgL"}],"key":"AH2rG31JOQ"},{"type":"text","value":" algorithm computes partial derivatives of ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"K3nCtgmjew"},{"type":"inlineMath","value":"\\mathcal{L}","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"script\">L</mi></mrow><annotation encoding=\"application/x-tex\">\\mathcal{L}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathcal\">L</span></span></span></span>","key":"ZAZTbxG8He"},{"type":"text","value":" with respect to each network parameter ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"hxpgS137IS"},{"type":"inlineMath","value":"\\{W^{(\\ell)}, \\mathbf{b}^{(\\ell)}\\}","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">{</mo><msup><mi>W</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo separator=\"true\">,</mo><msup><mi mathvariant=\"bold\">b</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">\\{W^{(\\ell)}, \\mathbf{b}^{(\\ell)}\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.138em;vertical-align:-0.25em;\"></span><span class=\"mopen\">{</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mclose\">}</span></span></span></span>","key":"kjrIXhzKrD"},{"type":"text","value":". Gradient-based optimizers (e.g., stochastic gradient descent) then update the parameters in the direction that reduces the loss:","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"lZK2qRPdA1"}],"key":"sDfY9ICpfo"},{"type":"math","value":"W^{(\\ell)} \\;\\leftarrow\\; W^{(\\ell)} \\;-\\; \\eta \\,\\frac{\\partial \\mathcal{L}}{\\partial W^{(\\ell)}}\n  \\quad,\\quad\n  \\mathbf{b}^{(\\ell)} \\;\\leftarrow\\; \\mathbf{b}^{(\\ell)} \\;-\\; \\eta \\,\\frac{\\partial \\mathcal{L}}{\\partial \\mathbf{b}^{(\\ell)}},","position":{"start":{"line":71,"column":1},"end":{"line":75,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>W</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msup><mtext>  </mtext><mo>←</mo><mtext>  </mtext><msup><mi>W</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msup><mtext>  </mtext><mo>−</mo><mtext>  </mtext><mi>η</mi><mtext> </mtext><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi mathvariant=\"script\">L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msup><mi>W</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow></mfrac><mspace width=\"1em\"/><mo separator=\"true\">,</mo><mspace width=\"1em\"/><msup><mi mathvariant=\"bold\">b</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msup><mtext>  </mtext><mo>←</mo><mtext>  </mtext><msup><mi mathvariant=\"bold\">b</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msup><mtext>  </mtext><mo>−</mo><mtext>  </mtext><mi>η</mi><mtext> </mtext><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi mathvariant=\"script\">L</mi></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msup><mi mathvariant=\"bold\">b</mi><mrow><mo stretchy=\"false\">(</mo><mi mathvariant=\"normal\">ℓ</mi><mo stretchy=\"false\">)</mo></mrow></msup></mrow></mfrac><mo separator=\"true\">,</mo></mrow><annotation encoding=\"application/x-tex\">W^{(\\ell)} \\;\\leftarrow\\; W^{(\\ell)} \\;-\\; \\eta \\,\\frac{\\partial \\mathcal{L}}{\\partial W^{(\\ell)}}\n  \\quad,\\quad\n  \\mathbf{b}^{(\\ell)} \\;\\leftarrow\\; \\mathbf{b}^{(\\ell)} \\;-\\; \\eta \\,\\frac{\\partial \\mathcal{L}}{\\partial \\mathbf{b}^{(\\ell)}},</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.938em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">←</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0213em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0754em;vertical-align:-0.704em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">η</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.296em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.814em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathcal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.704em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">←</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0213em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathbf\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.938em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0754em;vertical-align:-0.704em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">η</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.296em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathbf\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.814em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mtight\">ℓ</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathcal\">L</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.704em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span></span></span></span></span>","enumerator":"6","key":"xzjkA3MMEE"},{"type":"paragraph","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"where ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"mcBXZUEEkp"},{"type":"inlineMath","value":"\\eta","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>η</mi></mrow><annotation encoding=\"application/x-tex\">\\eta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">η</span></span></span></span>","key":"tYxRtzHo2b"},{"type":"text","value":" is the learning rate. Repeated over many iterations (epochs), the network learns weights that (hopefully) minimize the loss on the training set and generalize to unseen data.","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"qU1RPm70Wj"}],"key":"hqB4qA5Jd1"},{"type":"thematicBreak","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"hB3MPK4dLS"},{"type":"paragraph","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"text","value":"This dense architecture is the foundational design for many neural networks. While modern advances (like convolutional or transformer layers) may structure connections differently, the core linear+activation principle remains central to deep learning.","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"XgVqtMipCh"}],"key":"HfodHe3Wit"}],"key":"ZrUku43wUk"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Code Analysis by ChatGTP o1","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"En0ir7MSru"}],"identifier":"code-analysis-by-chatgtp-o1","label":"Code Analysis by ChatGTP o1","html_id":"code-analysis-by-chatgtp-o1","implicit":true,"key":"OJr5e57gAj"}],"key":"hX8RS9L2tW"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Below is a detailed walkthrough of how the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nBQKCALjC6"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":"program sine","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m9OsCNDWVi"}],"key":"SqRSZf3QEn"},{"type":"text","value":" works, focusing on what each block of code accomplishes and how it fits into the overall workflow of training a sine-wave–inspired neural network. We will cover:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cqESUbwTAp"}],"key":"wev8W2FRnP"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":3,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Imports and Declarations","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hYGKQAjYXP"}],"key":"hoQrtexvZn"}],"key":"FV0fMGz2Py"}],"key":"JBsdfSsZMI"},{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"CSV Logging Initialization","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"kNfzRXp1gD"}],"key":"wFeBqFA3yK"}],"key":"YcO4Csx4Jh"}],"key":"TqyS6dMuQ2"},{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Creating Test Data","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"FX4Eonjlko"}],"key":"N5J1MhFcor"}],"key":"jXBitySPgb"}],"key":"ARvwjksOrA"},{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Defining the Neural Network","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"LaNHwXvUeC"}],"key":"C31UthDDG7"}],"key":"ORLR4WzHsu"}],"key":"x6gRvS1yoq"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Training Loop","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"yQP0pdzOEh"}],"key":"M2vkJVeOrA"},{"type":"text","value":" (Forward & Backward passes, updating weights)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"zA682T6ZL1"}],"key":"jOtUYPsaK7"}],"key":"tBiuli3SUn"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Computing Mean Squared Error","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"UDAwUngFr3"}],"key":"cxauQ0nYSc"}],"key":"sT2iD8swaM"}],"key":"JQhxznMTf8"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Logging Data to CSV","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ceIeUrhQNe"}],"key":"ZA45K4hIXt"}],"key":"oUfDTK1SHI"}],"key":"iMDsolYVRA"}],"key":"MW3AHRWSrh"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Throughout, note that the network code comes from a library ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"rmIBXY3Uj3"},{"type":"inlineCode","value":"nf","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"XZHhuedAQd"},{"type":"text","value":" (with ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ql1rPSNI1X"},{"type":"inlineCode","value":"dense","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"zXdo0gGTop"},{"type":"text","value":", ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"nWjfm733WL"},{"type":"inlineCode","value":"input","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"hR9nHM0L1d"},{"type":"text","value":", ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"KOg5jAOxfe"},{"type":"inlineCode","value":"network","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"N4PvhB6B0l"},{"type":"text","value":", ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"QIdbw4kvYe"},{"type":"inlineCode","value":"sgd","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"PLkZ7rS2uE"},{"type":"text","value":"), and CSV output is handled by ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"nCnNnergZJ"},{"type":"inlineCode","value":"csv_module","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ONEvjxgz5B"},{"type":"text","value":". The code also uses single-precision real numbers (","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"alJVoesX0C"},{"type":"inlineCode","value":"real32","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"x5nUxH5f92"},{"type":"text","value":") for training variables and a double-precision ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Wd7VYT4G90"},{"type":"inlineCode","value":"pi","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"MtgRB9egY5"},{"type":"text","value":" in some places.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Xgv0nZrbLw"}],"key":"G3ID6ZQxTM"},{"type":"thematicBreak","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"gwhduy3GUp"},{"type":"heading","depth":2,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"1. ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"K5SwsRMfPc"},{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Imports and Declarations","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"B8J1CAdbbL"}],"key":"tBywSSwGZ5"}],"identifier":"id-1-imports-and-declarations","label":"1. Imports and Declarations","html_id":"id-1-imports-and-declarations","implicit":true,"key":"OlLiOSao6h"},{"type":"code","lang":"fortran","value":"program sine\n  use csv_module\n  use nf, only: dense, input, network, sgd\n  use iso_fortran_env, only: real32\n\n  implicit none\n\n  real, parameter :: pi = 4 * atan(1.)","position":{"start":{"line":17,"column":1},"end":{"line":26,"column":1}},"key":"iGOI6VTnqI"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":28,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"inlineCode","value":"csv_module","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"c5kFzmJsZy"}],"key":"caR1BIp94f"},{"type":"text","value":": A module that provides CSV reading/writing functionality.","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"USnpgS32eL"}],"key":"fTCoDZUkIQ"}],"key":"Ya5aFUYSJu"},{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"inlineCode","value":"nf","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"s4DOfJpDOc"}],"key":"DljjL53p5s"},{"type":"text","value":": A custom or third-party neural network framework that exposes:","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"VbUuuWTgP5"}],"key":"aMGB7POdKA"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":30,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"dense","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"rQtMFJjvVA"},{"type":"text","value":": A fully connected (dense) layer constructor.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"AkmYC4H5Qc"}],"key":"oTjcZHL0xN"}],"key":"cBjtiDBSH6"},{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"input","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"lk5Z47VwHc"},{"type":"text","value":": An input layer constructor.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"XKZ1slaZMV"}],"key":"OdsfBlB6h9"}],"key":"XPtX5n9Vjp"},{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"network","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"cGvr0oed8N"},{"type":"text","value":": A type or class that composes layers and provides ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"QZRmPL2WRj"},{"type":"inlineCode","value":"forward","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"iUyPharCQW"},{"type":"text","value":", ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"aQqoUM9Imp"},{"type":"inlineCode","value":"backward","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"zIYbtYZpju"},{"type":"text","value":", ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"VwDcMOjgaE"},{"type":"inlineCode","value":"update","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"X45bVXS0a6"},{"type":"text","value":", ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"nl21p8Pe9l"},{"type":"inlineCode","value":"predict","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"GvVM0KHgY6"},{"type":"text","value":".","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"zkHeAZejGD"}],"key":"oWgCIfMWUi"}],"key":"aC1nJWMElX"},{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"sgd","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"q6PphuZ6FE"},{"type":"text","value":": A function or type for the Stochastic Gradient Descent optimizer.","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"JXxc53Rdef"}],"key":"OeCg7dOcAv"}],"key":"CRj6rTLHD3"}],"key":"emKqdJoy39"}],"key":"ESSuUUBC3P"},{"type":"listItem","spread":true,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"inlineCode","value":"iso_fortran_env, only: real32","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"NFjcmTXK7w"}],"key":"QfqVtqXI0o"},{"type":"text","value":": Imports the ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"FHWpIjt13a"},{"type":"inlineCode","value":"real32","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"iFT0yJ5SN3"},{"type":"text","value":" kind for single-precision floats (32-bit).","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"p8AkRc9svA"}],"key":"VvaPAAySvB"}],"key":"fDnqVhmHZ0"},{"type":"listItem","spread":true,"position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"inlineCode","value":"implicit none","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"kXeaceDnbG"}],"key":"sPb6MZoqmz"},{"type":"text","value":": Requires explicit declarations for all variables.","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"WeCFf54RpO"}],"key":"PW70JG3vFQ"}],"key":"QPzM6JJpJX"},{"type":"listItem","spread":true,"position":{"start":{"line":36,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"inlineCode","value":"pi","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"fdTr1F9o9R"}],"key":"w4nBqcQrPD"},{"type":"text","value":": Defined via ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"t451DL5VG3"},{"type":"inlineCode","value":"4 * atan(1.)","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"qEsamFSjda"},{"type":"text","value":", which yields ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"FA6aEEYOw7"},{"type":"inlineMath","value":"\\pi \\approx 3.14159265...","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>π</mi><mo>≈</mo><mn>3.14159265...</mn></mrow><annotation encoding=\"application/x-tex\">\\pi \\approx 3.14159265...</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">3.14159265...</span></span></span></span>","key":"o9ig9fjOPz"},{"type":"text","value":".","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"cG1evs3TyL"}],"key":"wbEEOYE4bf"}],"key":"AVTGmXk1Hk"}],"key":"NMUqDWLymp"},{"type":"thematicBreak","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"U5LxaVSZs4"},{"type":"heading","depth":2,"position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"2. ","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"twn0M4t9g3"},{"type":"strong","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"CSV Logging Initialization","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"W67iUGdxju"}],"key":"XzO7B1rpdh"}],"identifier":"id-2-csv-logging-initialization","label":"2. CSV Logging Initialization","html_id":"id-2-csv-logging-initialization","implicit":true,"key":"p9CMCovJ8q"},{"type":"code","lang":"fortran","value":"  type(csv_file) :: sine_NN_data_file\n  type(network) :: net\n\n  logical :: status_ok","position":{"start":{"line":42,"column":1},"end":{"line":47,"column":1}},"key":"niM1Nk93Ey"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":49,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"inlineCode","value":"sine_NN_data_file","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"IrnNH8u1iG"}],"key":"bHCgmuftxO"},{"type":"text","value":": A ","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"ozsTo46Q4x"},{"type":"inlineCode","value":"csv_file","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"mY7pDCOe21"},{"type":"text","value":" object that will handle CSV writing.","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"QaNgoW8Yr9"}],"key":"alWxZgJIUM"}],"key":"nFMBnhG8Ye"},{"type":"listItem","spread":true,"position":{"start":{"line":50,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"inlineCode","value":"net","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"eFtuACPuz0"}],"key":"VFwyqrR7HS"},{"type":"text","value":": A neural network object.","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"ixu1xz8V6f"}],"key":"VWZj6EfMd0"}],"key":"UzpUOd8SGg"}],"key":"mwOD5KuMKe"},{"type":"code","lang":"fortran","value":"  integer, parameter :: num_iterations = 100000\n  integer, parameter :: test_size = 50\n  real(kind=real32), parameter :: learning_rate = 0.1","position":{"start":{"line":52,"column":1},"end":{"line":56,"column":1}},"key":"JqzqYcCTq2"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":58,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"inlineCode","value":"num_iterations","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"iOA28G42G9"}],"key":"Xevq9ND0dt"},{"type":"text","value":": The number of training iterations (epochs).","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"Ydcj5HqNvz"}],"key":"hNIfdzwnpb"}],"key":"Cq24Cn1rKM"},{"type":"listItem","spread":true,"position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"inlineCode","value":"test_size","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"Fq0iyVCbZo"}],"key":"ATeT93EQkf"},{"type":"text","value":": The number of data points for both testing and each training mini-batch (30).","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"ulpT3RSbas"}],"key":"kAMJCTkTuF"}],"key":"wJFemmLi1L"},{"type":"listItem","spread":true,"position":{"start":{"line":60,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"inlineCode","value":"learning_rate","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"oEiNe09rvs"}],"key":"Ick17FgCkM"},{"type":"text","value":": The initial learning rate (0.1) for the ","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"Y5wJos0iQH"},{"type":"inlineCode","value":"sgd","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"J5HNteRYwa"},{"type":"text","value":" optimizer.","position":{"start":{"line":60,"column":1},"end":{"line":60,"column":1}},"key":"zhEnUIaduA"}],"key":"utN4MmrAeC"}],"key":"gxqOvzYCDj"}],"key":"f1mfPmb5OJ"},{"type":"thematicBreak","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"lFsEho9Mtc"},{"type":"heading","depth":2,"position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"3. ","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"rFf2AFbLdZ"},{"type":"strong","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"Neural Network Dimensions and Data Arrays","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"ciIxOugjHA"}],"key":"DzcravbyP3"}],"identifier":"id-3-neural-network-dimensions-and-data-arrays","label":"3. Neural Network Dimensions and Data Arrays","html_id":"id-3-neural-network-dimensions-and-data-arrays","implicit":true,"key":"rVtsO5m10h"},{"type":"code","lang":"fortran","value":"  integer, parameter :: num_inputs = 1\n  integer, parameter :: num_outputs = 1\n  integer, parameter :: num_neurons_first_layer = 10\n  integer, parameter :: num_neurons_second_layer = 10","position":{"start":{"line":66,"column":1},"end":{"line":71,"column":1}},"key":"MYp3DEkaJW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":73,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"inlineCode","value":"num_inputs","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"FAwUdcM6h7"}],"key":"HjNPs8Wn2m"},{"type":"text","value":": The network expects 1D input.","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"uEIzeuWsPm"}],"key":"BX7IO1wji7"}],"key":"xzzS0RyvV9"},{"type":"listItem","spread":true,"position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"inlineCode","value":"num_outputs","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"VMVQScslt7"}],"key":"QgPINduP4a"},{"type":"text","value":": The network outputs 1 value.","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"OrR92Qbj2I"}],"key":"aNmqXrXuYh"}],"key":"hOLbSjruWi"},{"type":"listItem","spread":true,"position":{"start":{"line":75,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"inlineCode","value":"num_neurons_first_layer","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"QgxcsKSXyZ"},{"type":"text","value":", ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"tt30Zj6g9D"},{"type":"inlineCode","value":"num_neurons_second_layer","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"DwcUkAMta4"}],"key":"RZf4NTVVAf"},{"type":"text","value":": Two hidden layers with 10 neurons each.","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"DSfoaPAT8Q"}],"key":"EQ2GxiLTxu"}],"key":"fEzdWFK5Kq"}],"key":"e9lMsg6bBp"},{"type":"code","lang":"fortran","value":"  real(kind=real32), dimension(test_size) :: x_test, y_test, x_train, y_train, y_pred\n  real, dimension(1) :: x_train_arr_temp\n  real, dimension(1) :: y_train_arr_temp\n  real, dimension(1) :: x_test_arr_temp\n  real, dimension(1) :: y_pred_arr_temp","position":{"start":{"line":77,"column":1},"end":{"line":83,"column":1}},"key":"z3fHVq9w3h"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":85,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"inlineCode","value":"x_test, y_test","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"HHy042yxU1"}],"key":"pLIWKd2363"},{"type":"text","value":": Arrays of size ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"a9t5JLiRrJ"},{"type":"inlineCode","value":"test_size","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"yyi0rYuY0T"},{"type":"text","value":" to store the input and target for the sine wave ","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"H7kBQathsG"},{"type":"emphasis","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"test set","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"Sj1eEPx6mH"}],"key":"Q0sQO5nSOg"},{"type":"text","value":".","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"KFIPGyQqVQ"}],"key":"ptnRZDY2gr"}],"key":"gacujpkmJU"},{"type":"listItem","spread":true,"position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"inlineCode","value":"x_train, y_train","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"pyair1CkOS"}],"key":"tR51WBv0Km"},{"type":"text","value":": Arrays of size ","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"IEStyiE827"},{"type":"inlineCode","value":"test_size","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"ObAnBDopsy"},{"type":"text","value":" for the random training mini-batch each iteration.","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"HTIL2U2u8L"}],"key":"KFPNmtHHfF"}],"key":"LuBXAQOjZO"},{"type":"listItem","spread":true,"position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"inlineCode","value":"y_pred","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"auYqGiXnrO"}],"key":"Cl2DsHEt1r"},{"type":"text","value":": Predictions made on the test data, also size ","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"VFZgPNHlAL"},{"type":"inlineCode","value":"test_size","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"kSpu19qMt6"},{"type":"text","value":".","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"dlm3u41N0F"}],"key":"mtxHllyGvx"}],"key":"ndCF9iHSch"},{"type":"listItem","spread":true,"position":{"start":{"line":88,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"inlineCode","value":"x_train_arr_temp, y_train_arr_temp, x_test_arr_temp, y_pred_arr_temp","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"qAynamJEMA"}],"key":"hZQiiqXJQr"},{"type":"text","value":": All ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"uJOYRBPgWq"},{"type":"inlineCode","value":"dimension(1)","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"MTwbDX7KLX"},{"type":"text","value":".","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"DhvecWZ4HY"}],"key":"TxDj4aKgyv"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":89,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"These hold ","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"MySUPMKLWe"},{"type":"strong","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"single-sample","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"HUnexUJgpx"}],"key":"f70g0QwEmE"},{"type":"text","value":" data for the neural network calls. The library expects arrays, even for single-value input.","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"Rw4DTehK4U"}],"key":"UUZ7hZBSG3"}],"key":"SnUZCfUefq"},{"type":"listItem","spread":true,"position":{"start":{"line":90,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"For instance, ","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"nxX22PqjOo"},{"type":"inlineCode","value":"x_train(j)","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"rsEYkv0Cqc"},{"type":"text","value":" is stored in ","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"Bn2q1CkCT3"},{"type":"inlineCode","value":"x_train_arr_temp(1)","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"rtHfuHL7dk"},{"type":"text","value":" before calling ","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"Q4pUabS42V"},{"type":"inlineCode","value":"forward","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"gM4f8KuDiP"},{"type":"text","value":".","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"NqWm2rqFAk"}],"key":"gO0N9mq7Rz"}],"key":"APoIlRq8bz"}],"key":"aLZArbLGSY"}],"key":"UNlwUspuoA"}],"key":"Dxfm6ej6tx"},{"type":"code","lang":"fortran","value":"  real(kind=real32), dimension(num_iterations) :: mean_squared_error\n  integer :: i, j\n\n  real(kind=real32) :: x_train_temp","position":{"start":{"line":92,"column":1},"end":{"line":97,"column":1}},"key":"o6lBky6m0G"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":99,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"inlineCode","value":"mean_squared_error","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"tWJnuWI0zm"}],"key":"s7Jd9rQHdQ"},{"type":"text","value":": An array storing MSE for each of the ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"JV10qqI5VS"},{"type":"inlineCode","value":"num_iterations","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"GNuUvHbxsf"},{"type":"text","value":".","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"TkvmYyAH6H"}],"key":"FkSjXGybrd"}],"key":"yTGO0Fg8YJ"},{"type":"listItem","spread":true,"position":{"start":{"line":100,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"children":[{"type":"inlineCode","value":"x_train_temp","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"key":"I2vS9f5v9k"}],"key":"Wr74rXazwi"},{"type":"text","value":": A random value used to generate the training data.","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"key":"j0PqcmRrIH"}],"key":"qJlmsFiGmG"}],"key":"hnnbGdEQg8"}],"key":"CeHfgSTrUf"},{"type":"thematicBreak","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"S0IUn5M3K3"},{"type":"heading","depth":3,"position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"3.1 ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"pBntuzzMEV"},{"type":"strong","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"CSV File Initialization","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"MS23B0ZzlN"}],"key":"wYCcMvvgLl"}],"identifier":"id-3-1-csv-file-initialization","label":"3.1 CSV File Initialization","html_id":"id-3-1-csv-file-initialization","implicit":true,"key":"BADUtAu2Ll"},{"type":"code","lang":"fortran","value":"  call sine_NN_data_file%initialize(verbose=.true.)\n  ...\n  call sine_NN_data_file%open('sine_NN_data.csv', n_cols=7, status_ok=status_ok)\n  if (.not. status_ok) then\n    ...\n  end if\n  ...\n  call sine_NN_data_file%add(['Iteration', 'x_test___', 'y_test___', &\n                              'x_train__', 'y_train__', 'y_pred___', 'MSE______'])\n  call sine_NN_data_file%next_row()","position":{"start":{"line":106,"column":1},"end":{"line":117,"column":1}},"key":"Lo8rk6OpQ9"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":119,"column":1},"end":{"line":122,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"inlineCode","value":"initialize","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"SFNOIZa0vV"}],"key":"oFVZwHqZdL"},{"type":"text","value":": Prepares the CSV object.","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"jZFVoWcNNF"}],"key":"KVPMeHjgS0"}],"key":"gHa7zAkmll"},{"type":"listItem","spread":true,"position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"inlineCode","value":"open","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"CcztRbFRfe"}],"key":"LluyStK7Ty"},{"type":"text","value":": Opens a file named ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"dealysWo3q"},{"type":"inlineCode","value":"sine_NN_data.csv","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"mbnU0pxQfm"},{"type":"text","value":". The code also specifies ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"Wkqp6Ai2jB"},{"type":"inlineCode","value":"n_cols=7","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"iU0WpAqWEM"},{"type":"text","value":", meaning each row will eventually have up to 7 columns.","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"jcSrnDFNkd"}],"key":"t0S6AUsLxQ"}],"key":"qIj5h22SnO"},{"type":"listItem","spread":true,"position":{"start":{"line":121,"column":1},"end":{"line":122,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"text","value":"Header","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"J37JIv9RnY"}],"key":"FE5UNkmwVh"},{"type":"text","value":": ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"PYhS8kLcDK"},{"type":"inlineCode","value":"add([...])","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"eG5pTAtyBK"},{"type":"text","value":" writes a header row with column labels, then ","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"OLBYsOhmLD"},{"type":"inlineCode","value":"next_row()","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"ERoYft4xAB"},{"type":"text","value":" finalizes that line.","position":{"start":{"line":121,"column":1},"end":{"line":121,"column":1}},"key":"naVbEIut5D"}],"key":"E0Jr7CNRYn"}],"key":"R1VTtoa14G"}],"key":"G5Qc5QQ5nS"},{"type":"thematicBreak","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"T1GDqQLOsd"},{"type":"heading","depth":2,"position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"4. ","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"H3IEl29DNn"},{"type":"strong","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"children":[{"type":"text","value":"Creating Test Data","position":{"start":{"line":125,"column":1},"end":{"line":125,"column":1}},"key":"bvXnBIXLYn"}],"key":"TS5Z8FhfVd"}],"identifier":"id-4-creating-test-data","label":"4. Creating Test Data","html_id":"id-4-creating-test-data","implicit":true,"key":"IKBN7RypoJ"},{"type":"code","lang":"fortran","value":"  x_test = [((j - 1) * 2.0d0 * pi / test_size, j = 1, test_size)]\n  y_test = (sin(x_test) + 1.0d0) / 2.0d0","position":{"start":{"line":127,"column":1},"end":{"line":130,"column":1}},"key":"nZ52iPUle6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":132,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":132,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"For each ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"GitDKuHxX8"},{"type":"inlineCode","value":"j","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"PCL4jwyhLS"},{"type":"text","value":" in ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"N9s41G8XwE"},{"type":"inlineCode","value":"[1..test_size]","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"SjUx7ufClf"},{"type":"text","value":", compute ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"kTmLytmsE6"},{"type":"inlineMath","value":"\\displaystyle x\\_test(j) = \\frac{(j - 1)\\times 2\\pi}{\\text{test\\_size}}","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi>x</mi><mi mathvariant=\"normal\">_</mi><mi>t</mi><mi>e</mi><mi>s</mi><mi>t</mi><mo stretchy=\"false\">(</mo><mi>j</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mo stretchy=\"false\">(</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>×</mo><mn>2</mn><mi>π</mi></mrow><mtext>test_size</mtext></mfrac></mstyle></mrow><annotation encoding=\"application/x-tex\">\\displaystyle x\\_test(j) = \\frac{(j - 1)\\times 2\\pi}{\\text{test\\_size}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.06em;vertical-align:-0.31em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">es</span><span class=\"mord mathnormal\">t</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.423em;vertical-align:-0.996em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">test_size</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05724em;\">j</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.996em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span>","key":"jNimfT7Oyj"},{"type":"text","value":".","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"UKND9hlc4L"}],"key":"KmqXUbY26b"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"This distributes 30 points evenly between ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"sBU1yI2jhm"},{"type":"inlineCode","value":"0","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"mK45H5aW3g"},{"type":"text","value":" and ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"sGfvf4zeag"},{"type":"inlineCode","value":"2π","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"WuDqfdyFCT"},{"type":"text","value":".","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"I6QBSZ60c7"}],"key":"rJsTPalW3E"}],"key":"DN0ag40U76"}],"key":"IxP9yn1GfR"}],"key":"zutRPKNggp"},{"type":"listItem","spread":true,"position":{"start":{"line":134,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The target is ","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"ELgtTF7xLs"},{"type":"inlineCode","value":"y_test(j) = (sin(x_test(j)) + 1) / 2","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"Y1J4rIe9Eh"},{"type":"text","value":", mapping the sine wave from ","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"IZPfcwm58M"},{"type":"inlineCode","value":"[-1, +1]","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"sae7wXitaK"},{"type":"text","value":" to ","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"glpN26SwAV"},{"type":"inlineCode","value":"[0, 1]","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"JZL6GdzQW6"},{"type":"text","value":".","position":{"start":{"line":134,"column":1},"end":{"line":134,"column":1}},"key":"M3ApmZK0D4"}],"key":"vHFzpD0qlB"}],"key":"eHT9vxtHNy"}],"key":"qJBMxz1Yy9"},{"type":"thematicBreak","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"NMl2aFlM8U"},{"type":"heading","depth":2,"position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"text","value":"5. ","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"yKHluPbQeB"},{"type":"strong","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"text","value":"Constructing the Neural Network","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"c9arbtwfle"}],"key":"G89jDB0aX5"}],"identifier":"id-5-constructing-the-neural-network","label":"5. Constructing the Neural Network","html_id":"id-5-constructing-the-neural-network","implicit":true,"key":"K52xasjnDB"},{"type":"code","lang":"fortran","value":"  net = network([ &\n    input(num_inputs), &\n    dense(num_neurons_first_layer), &\n    dense(num_neurons_second_layer), &\n    dense(num_outputs) &\n  ])","position":{"start":{"line":140,"column":1},"end":{"line":147,"column":1}},"key":"W907VjW54E"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":149,"column":1},"end":{"line":154,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":149,"column":1},"end":{"line":154,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"children":[{"type":"inlineCode","value":"network([...])","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"aZvvyYhjvh"}],"key":"u7a03dOplI"},{"type":"text","value":": Creates a layered neural network object with the following sequence:","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"d89JL81y9X"}],"key":"tQmnAKUNWX"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":150,"column":1},"end":{"line":154,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"children":[{"type":"inlineCode","value":"input(num_inputs)","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"HGJ6VeSanb"}],"key":"umSASwx4RQ"},{"type":"text","value":": 1D input layer.","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"OX6zMh0Dco"}],"key":"Xb9sq1bNwK"}],"key":"pvfWM8ESUf"},{"type":"listItem","spread":true,"position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"inlineCode","value":"dense(num_neurons_first_layer)","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"kM2B19LA30"}],"key":"tof6HjTaPh"},{"type":"text","value":": A fully connected layer with 10 neurons.","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"wKQC3pe4RC"}],"key":"uu8Oui09WM"}],"key":"p3wujNZ86O"},{"type":"listItem","spread":true,"position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"children":[{"type":"inlineCode","value":"dense(num_neurons_second_layer)","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"odzoXn9w0b"}],"key":"JCuEH8tG8G"},{"type":"text","value":": Another hidden layer with 10 neurons.","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"Z5aKEa8t1d"}],"key":"a0IP5LPRKF"}],"key":"pIjMqmdrLl"},{"type":"listItem","spread":true,"position":{"start":{"line":153,"column":1},"end":{"line":154,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"inlineCode","value":"dense(num_outputs)","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"EZCtdvRHPY"}],"key":"extVlXdorJ"},{"type":"text","value":": Final layer that outputs a single value.","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"rjLwuKRjno"}],"key":"v8oPaDTpGB"}],"key":"VVlaKcKDiQ"}],"key":"nZ7DFcaaIP"}],"key":"CPqL80DC4L"}],"key":"iIBfg6DqRI"},{"type":"code","lang":"fortran","value":"  call net % print_info()","position":{"start":{"line":155,"column":1},"end":{"line":157,"column":1}},"key":"tk0omG5bfF"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":159,"column":1},"end":{"line":160,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":159,"column":1},"end":{"line":160,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Prints summary info about the network (number of parameters, layer shapes, etc.).","position":{"start":{"line":159,"column":1},"end":{"line":159,"column":1}},"key":"lxlRbTaC28"}],"key":"Q0sy3GLpZm"}],"key":"k5c9XX9s03"}],"key":"PRrsMOsF1i"},{"type":"thematicBreak","position":{"start":{"line":161,"column":1},"end":{"line":161,"column":1}},"key":"UurZK4lpMv"},{"type":"heading","depth":2,"position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"children":[{"type":"text","value":"6. ","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"iHorsYuhAm"},{"type":"strong","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"children":[{"type":"text","value":"Training Loop","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"exHOoFhYQg"}],"key":"Qow3seSzZo"}],"identifier":"id-6-training-loop","label":"6. Training Loop","html_id":"id-6-training-loop","implicit":true,"key":"Oh5OVXJO5T"},{"type":"code","lang":"fortran","value":"  do i = 1, num_iterations","position":{"start":{"line":165,"column":1},"end":{"line":167,"column":1}},"key":"h86ggGwPEH"},{"type":"paragraph","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"children":[{"type":"text","value":"A loop over the total epochs (","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"WmRVkWhggp"},{"type":"inlineCode","value":"num_iterations","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"ISenmcwI6I"},{"type":"text","value":" = 100,000). Each iteration does:","position":{"start":{"line":169,"column":1},"end":{"line":169,"column":1}},"key":"Joq19Rx57x"}],"key":"Z0p3CSX3m1"},{"type":"heading","depth":3,"position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"children":[{"type":"text","value":"6.1 ","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"key":"ZJ8dInSq4B"},{"type":"strong","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"children":[{"type":"text","value":"Mini-Batch Data Generation","position":{"start":{"line":171,"column":1},"end":{"line":171,"column":1}},"key":"OFNA4D47Il"}],"key":"YyaD77dSat"}],"identifier":"id-6-1-mini-batch-data-generation","label":"6.1 Mini-Batch Data Generation","html_id":"id-6-1-mini-batch-data-generation","implicit":true,"key":"SK7v6ojjjr"},{"type":"code","lang":"fortran","value":"    do j = 1, test_size\n      call random_number(x_train_temp)\n      x_train(j) = x_train_temp * 2.0d0 * pi\n      y_train(j) = (sin(x_train(j)) + 1.0d0) / 2.0d0","position":{"start":{"line":173,"column":1},"end":{"line":178,"column":1}},"key":"aD76LoEJSU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":180,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":180,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"For each of the ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"pG5NC7D9LH"},{"type":"inlineCode","value":"test_size","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"wy4Udrym8a"},{"type":"text","value":" samples in the batch:","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"q3BZNoeEaP"}],"key":"Md3wu7DF91"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":181,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Generate a random number ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"qxnRgGLsZe"},{"type":"inlineCode","value":"x_train_temp","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"H45T0A3TZ4"},{"type":"text","value":" in [0, 1).","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"TBBZSQBNDC"}],"key":"JdR7gOwGiL"}],"key":"bEc1TbZwOi"},{"type":"listItem","spread":true,"position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Scale it to ","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"IVcnPooKMZ"},{"type":"inlineCode","value":"[0, 2π]","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"AEFhSY7KGS"},{"type":"text","value":".","position":{"start":{"line":182,"column":1},"end":{"line":182,"column":1}},"key":"KwPVFOpGyr"}],"key":"WL9B039cBv"}],"key":"P9DnC0VlWB"},{"type":"listItem","spread":true,"position":{"start":{"line":183,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compute ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"Pwks8HOVlh"},{"type":"inlineCode","value":"y_train(j)","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"AewbS00PbN"},{"type":"text","value":" as ","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"OScRyfV1Zp"},{"type":"inlineCode","value":"(sin(x_train(j)) + 1.0)/2.0","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"xqVP1NRybn"},{"type":"text","value":", so the sine wave is in [0, 1].","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"RBZdLMfkE2"}],"key":"tRSZKrEz7D"}],"key":"Wbv7T2hp7b"}],"key":"weFH5KyZCe"}],"key":"eBUEmD8rrk"}],"key":"FkQpHcXYlB"},{"type":"heading","depth":3,"position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"text","value":"6.2 ","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"TMCI5ndzPu"},{"type":"strong","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"text","value":"Per-Sample Forward/Backward","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"xMIYXYZb9N"}],"key":"kJobQDRjPY"}],"identifier":"id-6-2-per-sample-forward-backward","label":"6.2 Per-Sample Forward/Backward","html_id":"id-6-2-per-sample-forward-backward","implicit":true,"key":"je1RJ401as"},{"type":"code","lang":"fortran","value":"      x_train_arr_temp = x_train(j)\n      y_train_arr_temp = y_train(j)\n\n      call net % forward(x_train_arr_temp)\n      call net % backward(y_train_arr_temp)\n      call net % update(optimizer=sgd(learning_rate=learning_rate))","position":{"start":{"line":187,"column":1},"end":{"line":194,"column":1}},"key":"hHbvUu7GWF"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":196,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"inlineCode","value":"x_train_arr_temp","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"e8gwiwqZa4"}],"key":"i6y92Px1MU"},{"type":"text","value":" and ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"aL5YXIfrBl"},{"type":"strong","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"children":[{"type":"inlineCode","value":"y_train_arr_temp","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"U0WMLiXUGS"}],"key":"SVesIPim2e"},{"type":"text","value":" are 1-element arrays. Some neural net frameworks require arrays even for single-value inputs.","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"QVtYoUUWBO"}],"key":"x7YwITZSOE"}],"key":"bS7LCEAeJn"},{"type":"listItem","spread":true,"position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"inlineCode","value":"forward(...)","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"key":"P5Ax0KkSQK"}],"key":"MujR3WXYRU"},{"type":"text","value":" passes the single sample through the network, producing internal activations.","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"key":"FovqfkP2rx"}],"key":"T7nxaZcswS"}],"key":"ESlUNMLuts"},{"type":"listItem","spread":true,"position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"inlineCode","value":"backward(...)","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"YJ0q03QRRu"}],"key":"FFaQRY1UA0"},{"type":"text","value":" uses the single-sample label ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"VEWPlBhRRP"},{"type":"inlineCode","value":"y_train_arr_temp","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"VrAzbsNHlm"},{"type":"text","value":" to compute gradients (loss derivative w.r.t. weights).","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"VwKClAaN0N"}],"key":"qWy5wn890t"}],"key":"qK4JQaDK1t"},{"type":"listItem","spread":true,"position":{"start":{"line":199,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"children":[{"type":"inlineCode","value":"update(...)","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"XvfA9pkDmP"}],"key":"ghM959dju7"},{"type":"text","value":" applies ","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"ao8yQ7kNrb"},{"type":"strong","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"children":[{"type":"text","value":"Stochastic Gradient Descent","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"v0cpI4A1s7"}],"key":"P4AUkOA0GP"},{"type":"text","value":" with ","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"u5WKof3hzO"},{"type":"inlineCode","value":"learning_rate=0.1","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"B4DYyxsFF9"},{"type":"text","value":" to update network weights.","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"CiNdcZZ3rY"}],"key":"HYjGQ3k8vS"}],"key":"unh19NVM7r"}],"key":"YwkWIzugni"},{"type":"paragraph","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"children":[{"type":"strong","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"children":[{"type":"text","value":"Important","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"pAKpAK7n6U"}],"key":"mz6mdbsLU2"},{"type":"text","value":": This code does a per-sample update inside the loop over ","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"seK0fOEvyN"},{"type":"inlineCode","value":"j","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"kzkSmxSllJ"},{"type":"text","value":". This is effectively “online” or “sample-by-sample” training, repeated ","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"JbRdXGbmTf"},{"type":"inlineCode","value":"test_size","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"EyVpjV33qb"},{"type":"text","value":" times per iteration.","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"E0wEVupuda"}],"key":"ooDYXMHbIL"},{"type":"heading","depth":3,"position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"children":[{"type":"text","value":"6.3 ","position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"key":"cCLnDkedWi"},{"type":"strong","position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"children":[{"type":"text","value":"Prediction on the Test Sample","position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"key":"Kt3PAkKsZ2"}],"key":"BDbM8lGSoF"}],"identifier":"id-6-3-prediction-on-the-test-sample","label":"6.3 Prediction on the Test Sample","html_id":"id-6-3-prediction-on-the-test-sample","implicit":true,"key":"rn76UkvthY"},{"type":"code","lang":"fortran","value":"      x_test_arr_temp = x_test(j)\n      y_pred_arr_temp = net % predict(x_test_arr_temp)\n      y_pred(j) = y_pred_arr_temp(1)\n    end do","position":{"start":{"line":205,"column":1},"end":{"line":210,"column":1}},"key":"FqBrLgghfn"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":212,"column":1},"end":{"line":214,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Takes the test input ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"bRFw76HCMA"},{"type":"inlineCode","value":"x_test(j)","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"MvgLzvR2MC"},{"type":"text","value":", passes it through the network to get ","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"Y2qSuABI7c"},{"type":"inlineCode","value":"y_pred_arr_temp","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"R3VxvrAClc"},{"type":"text","value":" (again a 1-element array).","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"Y5scCuUkRW"}],"key":"gOsuazQONX"}],"key":"EO1xphwjfY"},{"type":"listItem","spread":true,"position":{"start":{"line":213,"column":1},"end":{"line":214,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Store ","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"pm99zEbgan"},{"type":"inlineCode","value":"y_pred(j) = y_pred_arr_temp(1)","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"fAIa6vMQXI"},{"type":"text","value":".","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"vFZQ7TDJXy"}],"key":"MbgN159xRd"}],"key":"F99uBezay8"}],"key":"x2ZZyDCTdH"},{"type":"paragraph","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"children":[{"type":"text","value":"After this inner loop, we have:","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"bK8HccnzwT"}],"key":"alMqtt5C3y"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":216,"column":1},"end":{"line":218,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A mini-batch of ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"W6fhNJ3Ymk"},{"type":"inlineCode","value":"test_size","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"DsPeogvht7"},{"type":"text","value":" random training samples used for weight updates.","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"ZgG8nMpI55"}],"key":"nx1RanS2oH"}],"key":"BiDdk7qNnd"},{"type":"listItem","spread":true,"position":{"start":{"line":217,"column":1},"end":{"line":218,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"children":[{"type":"inlineCode","value":"y_pred","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"AXjwIlOvLt"}],"key":"XW5JeJKyIS"},{"type":"text","value":" for each of the 30 test points in ","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"mIPMbiDqYa"},{"type":"inlineCode","value":"x_test","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"ofz550rh5R"},{"type":"text","value":".","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"t276Z65dFp"}],"key":"Z715KnkFJa"}],"key":"Wl3nOTD64n"}],"key":"OwCmVjxQ58"},{"type":"thematicBreak","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"sP8olh14bd"},{"type":"heading","depth":3,"position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"children":[{"type":"text","value":"6.4 ","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"key":"HSO62xFXt8"},{"type":"strong","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"children":[{"type":"text","value":"Compute Mean Squared Error","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"key":"yPR2A9UL1Z"}],"key":"fqhTi3eehp"}],"identifier":"id-6-4-compute-mean-squared-error","label":"6.4 Compute Mean Squared Error","html_id":"id-6-4-compute-mean-squared-error","implicit":true,"key":"iLcfUjgLhF"},{"type":"code","lang":"fortran","value":"    mean_squared_error(i) = sum((y_pred - y_test)**2) / test_size","position":{"start":{"line":223,"column":1},"end":{"line":225,"column":1}},"key":"Z8axuuvs3n"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":227,"column":1},"end":{"line":229,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compare the network’s predictions ","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"ASEZnFmnA1"},{"type":"inlineCode","value":"y_pred","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"nwYOn0usQF"},{"type":"text","value":" with the true test values ","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"XCoRX7rn6X"},{"type":"inlineCode","value":"y_test","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"ooPsgPjO63"},{"type":"text","value":".","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"GRZxpXmBJq"}],"key":"S71KHpHNYB"}],"key":"fbuqAhFHj8"},{"type":"listItem","spread":true,"position":{"start":{"line":228,"column":1},"end":{"line":229,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The MSE for iteration ","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"M2VI5rXHEa"},{"type":"inlineCode","value":"i","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"mQWB0kJOm0"},{"type":"text","value":" is the average of squared differences.","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"XBUzX0mmuS"}],"key":"R8vPAzdv15"}],"key":"JJZqonJalo"}],"key":"i3338RevLc"},{"type":"thematicBreak","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"vLEd1QWaoo"},{"type":"heading","depth":3,"position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"children":[{"type":"text","value":"6.5 ","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"key":"JGEEKK3uzW"},{"type":"strong","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"children":[{"type":"text","value":"Logging Each Sample to CSV","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"key":"BJcoDxeaGl"}],"key":"AlNThACDYb"}],"identifier":"id-6-5-logging-each-sample-to-csv","label":"6.5 Logging Each Sample to CSV","html_id":"id-6-5-logging-each-sample-to-csv","implicit":true,"key":"Z49LkbCjnj"},{"type":"code","lang":"fortran","value":"    do j = 1, test_size\n      call sine_NN_data_file%add([i], int_fmt='(i6)')\n      call sine_NN_data_file%add([ &\n        x_test(j), & \n        y_test(j), &\n        x_train(j), &\n        y_train(j), &\n        y_pred(j), &\n        mean_squared_error(i)], &\n        real_fmt='(f9.6)')\n      call sine_NN_data_file%next_row()\n    end do","position":{"start":{"line":234,"column":1},"end":{"line":247,"column":1}},"key":"A4BIVxa3Yy"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":249,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":249,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"We output ","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"ImqP7GRboB"},{"type":"strong","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"children":[{"type":"text","value":"50 rows","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"KHgx4uobl0"}],"key":"UcUURx59HS"},{"type":"text","value":" per iteration. Each row records:","position":{"start":{"line":249,"column":1},"end":{"line":249,"column":1}},"key":"muTBv2PWCG"}],"key":"accfkpSmcu"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":250,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"children":[{"type":"text","value":"Iteration","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"key":"UEy74gthCU"}],"key":"uXgGa0kDg0"},{"type":"text","value":" number ","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"key":"XLYhlCywm9"},{"type":"inlineCode","value":"i","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"key":"ZP4gk6jwPT"},{"type":"text","value":".","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"key":"NaHeAJRY1M"}],"key":"VLmz9JRjiJ"}],"key":"zSV3qhqBL9"},{"type":"listItem","spread":true,"position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"children":[{"type":"inlineCode","value":"x_test(j)","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"bzUJh8WGfW"}],"key":"c8DX1NXIG9"},{"type":"text","value":": The j-th test input.","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"m41QTlUe94"}],"key":"R88AANjHDs"}],"key":"norVLx4hsM"},{"type":"listItem","spread":true,"position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"children":[{"type":"inlineCode","value":"y_test(j)","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"BO07XrnEcA"}],"key":"wqFPIJgEJ5"},{"type":"text","value":": The sine wave’s true value at ","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"q4XrkunJav"},{"type":"inlineCode","value":"x_test(j)","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"XImFFlMzJC"},{"type":"text","value":".","position":{"start":{"line":252,"column":1},"end":{"line":252,"column":1}},"key":"C8KQzG6a0g"}],"key":"Zu8RDCtnSS"}],"key":"yVJzs5SOUh"},{"type":"listItem","spread":true,"position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"inlineCode","value":"x_train(j)","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"lIost86zZK"}],"key":"BPl3ZPihTf"},{"type":"text","value":": The j-th random training sample.","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"LSum8R7Czk"}],"key":"FBp0Lh6OUh"}],"key":"vLhuHaDJQG"},{"type":"listItem","spread":true,"position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"children":[{"type":"inlineCode","value":"y_train(j)","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"key":"ismy3K0yWU"}],"key":"hg7UpqKjf3"},{"type":"text","value":": The training label for that sample.","position":{"start":{"line":254,"column":1},"end":{"line":254,"column":1}},"key":"ARPWHvpQrW"}],"key":"terUZANioL"}],"key":"hUhZxtQIgP"},{"type":"listItem","spread":true,"position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"children":[{"type":"inlineCode","value":"y_pred(j)","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"GONA2a2Dzb"}],"key":"wTyvurlzS9"},{"type":"text","value":": The network’s prediction for ","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"ztxGL0oUQ9"},{"type":"inlineCode","value":"x_test(j)","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"Dmph4vV3IQ"},{"type":"text","value":".","position":{"start":{"line":255,"column":1},"end":{"line":255,"column":1}},"key":"K3JCwv1Vjs"}],"key":"vmCuPyfNqy"}],"key":"tHtvi6h9Ed"},{"type":"listItem","spread":true,"position":{"start":{"line":256,"column":1},"end":{"line":257,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"children":[{"type":"inlineCode","value":"mean_squared_error(i)","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"key":"MpKdnYKPR0"}],"key":"lMHs9daliw"},{"type":"text","value":": The iteration’s MSE.","position":{"start":{"line":256,"column":1},"end":{"line":256,"column":1}},"key":"vWT0ooMw5t"}],"key":"QraH3DqrUW"}],"key":"vTvMiRL83C"}],"key":"t5OCyrzYDr"}],"key":"MRk35xmWF3"}],"key":"ZYRlVe5e40"},{"type":"paragraph","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"children":[{"type":"text","value":"Hence, each iteration appends 50 lines to the CSV file, for a total of: ","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"L2AGAwzpxt"},{"type":"inlineMath","value":"50 \\times \\text{num_iterations}","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"error":true,"message":"Expected 'EOF', got '_' at position 20: …times \\text{num_̲iterations}","key":"Z8ktGYjjli"},{"type":"text","value":" lines.","position":{"start":{"line":258,"column":1},"end":{"line":258,"column":1}},"key":"A2034YpJrh"}],"key":"nGBAPZQOjL"},{"type":"thematicBreak","position":{"start":{"line":260,"column":1},"end":{"line":260,"column":1}},"key":"RipBE0RByX"},{"type":"heading","depth":3,"position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"children":[{"type":"text","value":"6.6 ","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"RZGB8MSeQq"},{"type":"strong","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"children":[{"type":"text","value":"Occasional Print of MSE","position":{"start":{"line":262,"column":1},"end":{"line":262,"column":1}},"key":"INEbot303M"}],"key":"VdppsMWZ1F"}],"identifier":"id-6-6-occasional-print-of-mse","label":"6.6 Occasional Print of MSE","html_id":"id-6-6-occasional-print-of-mse","implicit":true,"key":"vYO6Uuw1SQ"},{"type":"code","lang":"fortran","value":"    if (mod(i, (num_iterations/10)) == 0) then\n      print '(\"Iteration: \", I6, \" | MSE: \", F9.6)', i, mean_squared_error(i)\n    end if","position":{"start":{"line":264,"column":1},"end":{"line":268,"column":1}},"key":"J3hCCQsCCF"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":270,"column":1},"end":{"line":271,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":270,"column":1},"end":{"line":271,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Every 1/10th of ","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"gfHy1p5y26"},{"type":"inlineCode","value":"num_iterations","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"VZpqooFM8v"},{"type":"text","value":" (in this case, every 10000 iterations if ","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"z528e4c9v4"},{"type":"inlineCode","value":"num_iterations=100000","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"henInXEGiz"},{"type":"text","value":"), print the iteration number and current MSE to the console.","position":{"start":{"line":270,"column":1},"end":{"line":270,"column":1}},"key":"DU397Rc8TP"}],"key":"z3OHYbFW8J"}],"key":"omOFJX70WP"}],"key":"mvQIyeTx8q"},{"type":"thematicBreak","position":{"start":{"line":272,"column":1},"end":{"line":272,"column":1}},"key":"POv8smId4q"},{"type":"heading","depth":2,"position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"children":[{"type":"text","value":"7. ","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"KQEVggOmNX"},{"type":"strong","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"children":[{"type":"text","value":"Closing Steps","position":{"start":{"line":274,"column":1},"end":{"line":274,"column":1}},"key":"GFRcJd1sLa"}],"key":"XqV5ztRma9"}],"identifier":"id-7-closing-steps","label":"7. Closing Steps","html_id":"id-7-closing-steps","implicit":true,"key":"xupyx6t5uJ"},{"type":"code","lang":"fortran","value":"  print *, '[*] Training complete!'\n  print *, '[*] Saving data to the CSV file...'\n  ...\n  call sine_NN_data_file%close(status_ok=status_ok)\n  if (.not. status_ok) then\n    print *, '[!] Error closing the CSV file...'\n    stop\n  end if\nend program sine","position":{"start":{"line":276,"column":1},"end":{"line":286,"column":1}},"key":"sIO2LKZJu1"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":288,"column":1},"end":{"line":289,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":288,"column":1},"end":{"line":289,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Signals the end of training and closes the CSV file, ensuring everything is written to disk properly.","position":{"start":{"line":288,"column":1},"end":{"line":288,"column":1}},"key":"syvbLpbtQQ"}],"key":"yWjHEquuIy"}],"key":"eHzRiazGUT"}],"key":"QExjsfahKW"},{"type":"thematicBreak","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"fi1AFkBg0e"},{"type":"heading","depth":2,"position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"children":[{"type":"text","value":"8. ","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"KllV1axPyx"},{"type":"strong","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"children":[{"type":"text","value":"Summary of the Workflow","position":{"start":{"line":292,"column":1},"end":{"line":292,"column":1}},"key":"JYxPlnK1bk"}],"key":"HA8DeRH0Ko"}],"identifier":"id-8-summary-of-the-workflow","label":"8. Summary of the Workflow","html_id":"id-8-summary-of-the-workflow","implicit":true,"key":"HToVmaYIuy"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":294,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"children":[{"type":"text","value":"Initialize","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"mXAaByke4f"}],"key":"yoYGyxvheh"},{"type":"text","value":": Creates a CSV object, sets up the neural network, and preps hyperparameters.","position":{"start":{"line":294,"column":1},"end":{"line":294,"column":1}},"key":"Cgn1TcSYvB"}],"key":"AYQCoEej5p"}],"key":"v7MlC5b0W4"},{"type":"listItem","spread":true,"position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"children":[{"type":"text","value":"Generate","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"suiOW2550q"}],"key":"meoZdTtwl8"},{"type":"text","value":" a small, fixed test set (","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"Y8GLlOfo64"},{"type":"inlineCode","value":"x_test, y_test","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"EfxzTp7hhn"},{"type":"text","value":") spanning 0 to ","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"puS2pndx7O"},{"type":"inlineMath","value":"2\\pi","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">2\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>","key":"PaWbjXxVqA"},{"type":"text","value":".","position":{"start":{"line":295,"column":1},"end":{"line":295,"column":1}},"key":"hB0epq7AtO"}],"key":"tRZK8b9grX"}],"key":"qOcMBQW765"},{"type":"listItem","spread":true,"position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"children":[{"type":"text","value":"Create","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"ztTqqaiOJZ"}],"key":"SJanh6yJnh"},{"type":"text","value":" the network with 1 input neuron, two hidden layers of 10 each, and 1 output.","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"hfhCbDonqv"}],"key":"mlCMTD25lV"}],"key":"KjnovbfpDJ"},{"type":"listItem","spread":true,"position":{"start":{"line":297,"column":1},"end":{"line":304,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"children":[{"type":"text","value":"Training","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"RowTtVjxkf"}],"key":"Utv4Ouieh7"},{"type":"text","value":" (outer loop over ","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"bd50KR7jmE"},{"type":"inlineCode","value":"i","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"mWGjSQCi7S"},{"type":"text","value":"):","position":{"start":{"line":297,"column":1},"end":{"line":297,"column":1}},"key":"XTdlSpQQ5T"}],"key":"wTiGfJBJFQ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":298,"column":1},"end":{"line":304,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Build a random mini-batch of ","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"GHguMoZDzS"},{"type":"inlineCode","value":"test_size","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"RPhManlFaK"},{"type":"text","value":" samples (","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"DsYdmaJlNn"},{"type":"inlineCode","value":"x_train, y_train","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"tMhov19qGm"},{"type":"text","value":").","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"YMKZYU7Igd"}],"key":"Mw4uNnTC0F"}],"key":"P2xS3oFuOb"},{"type":"listItem","spread":true,"position":{"start":{"line":299,"column":1},"end":{"line":301,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"For each sample:","position":{"start":{"line":299,"column":1},"end":{"line":299,"column":1}},"key":"JVAxk9Q2lA"}],"key":"QdRfcS62pq"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":300,"column":1},"end":{"line":301,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Convert the single value to a 1-element array, do ","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"wx0kwE7hHx"},{"type":"inlineCode","value":"forward/backward/update","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"gjOourt3OZ"},{"type":"text","value":".","position":{"start":{"line":300,"column":1},"end":{"line":300,"column":1}},"key":"XqrJHt9wgc"}],"key":"Rc9s63YQjH"}],"key":"slWIQGs4dG"},{"type":"listItem","spread":true,"position":{"start":{"line":301,"column":1},"end":{"line":301,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Predict on the corresponding test sample ","position":{"start":{"line":301,"column":1},"end":{"line":301,"column":1}},"key":"pm53wvoH9T"},{"type":"inlineCode","value":"x_test(j)","position":{"start":{"line":301,"column":1},"end":{"line":301,"column":1}},"key":"xcmsErgrZx"},{"type":"text","value":".","position":{"start":{"line":301,"column":1},"end":{"line":301,"column":1}},"key":"JTq4OD3KVJ"}],"key":"ye0Euygv76"}],"key":"AOPYYKMQYk"}],"key":"CoA7h6IfOM"}],"key":"n1kXXL9pyr"},{"type":"listItem","spread":true,"position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Compute MSE over all 50 test points.","position":{"start":{"line":302,"column":1},"end":{"line":302,"column":1}},"key":"EvG2TzPQt8"}],"key":"XQBTavPky5"}],"key":"OKZN4NiOj0"},{"type":"listItem","spread":true,"position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Write iteration data (50 rows) into a CSV file.","position":{"start":{"line":303,"column":1},"end":{"line":303,"column":1}},"key":"Ujp1xIuSCw"}],"key":"bn9Ox37fr7"}],"key":"sovo49AH4d"},{"type":"listItem","spread":true,"position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Occasionally print progress.","position":{"start":{"line":304,"column":1},"end":{"line":304,"column":1}},"key":"ay5tXrGTwp"}],"key":"zqZ5qHapE4"}],"key":"EEupI90cQg"}],"key":"CmHtQnmPi1"}],"key":"LJYJ4MnoxZ"},{"type":"listItem","spread":true,"position":{"start":{"line":305,"column":1},"end":{"line":306,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"children":[{"type":"text","value":"Finish","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"neYuxJ0Pfs"}],"key":"zPl8uh1ROF"},{"type":"text","value":": Print completion message, close the CSV file.","position":{"start":{"line":305,"column":1},"end":{"line":305,"column":1}},"key":"caUP5b30tL"}],"key":"DFNDLtdWDX"}],"key":"BbBAvcVX33"}],"key":"noeSHoe30E"},{"type":"paragraph","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"children":[{"type":"strong","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"children":[{"type":"text","value":"Key Observations","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"u8IEphGZlB"}],"key":"a2Ee5HAbsC"},{"type":"text","value":":","position":{"start":{"line":307,"column":1},"end":{"line":307,"column":1}},"key":"YUkH59z8ys"}],"key":"moskgKrB19"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":308,"column":1},"end":{"line":311,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The code mixes “training data” that’s random each iteration with a fixed “test set” (","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"keo2O4kxqu"},{"type":"inlineCode","value":"x_test","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"efKYNxkxXm"},{"type":"text","value":"). This is somewhat unusual—often you keep a consistent training set or you randomize from a larger pool. But it works here as a demonstration of incremental training for the sine function.","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"XpCjCgmfeS"}],"key":"Lp9EETsw0v"}],"key":"YBgxGwMgSM"},{"type":"listItem","spread":true,"position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The network is updated on a per-sample basis, repeated 50 times per iteration. That’s effectively a “mini-batch” of size 1 repeated 50 times.","position":{"start":{"line":309,"column":1},"end":{"line":309,"column":1}},"key":"YS76o7DYvS"}],"key":"Wq6t9MpQcM"}],"key":"Qq163Rk8qu"},{"type":"listItem","spread":true,"position":{"start":{"line":310,"column":1},"end":{"line":311,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The final CSV ends up quite large: ","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"aeCnaqYjZn"},{"type":"inlineCode","value":"num_iterations × test_size","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"JLw1F0hlKB"},{"type":"text","value":" lines, with 7 columns each.","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"JXbntzGHqa"}],"key":"ZtjGwA5Uvy"}],"key":"G4vnaJv8Nx"}],"key":"OZCExe2Szq"},{"type":"paragraph","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"children":[{"type":"text","value":"This design shows how to integrate data generation, single-sample training steps, and CSV logging within a single Fortran program using a custom ","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"Xd1ZIrMudc"},{"type":"inlineCode","value":"network","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"jhLUdJrmiT"},{"type":"text","value":" library.","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"psfIMW9KCX"}],"key":"rUlkBVz3J1"}],"key":"QAnqboVatr"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Program Code","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q0sBl3KcUT"}],"identifier":"program-code","label":"Program Code","html_id":"program-code","implicit":true,"key":"dz4TEejBA7"}],"key":"UnnmdmQzNN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"section_examples_sine_wave.f90","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F2CqU9G0eY"}],"identifier":"section-examples-sine-wave-f90","label":"section_examples_sine_wave.f90","html_id":"section-examples-sine-wave-f90","implicit":true,"key":"QWbOTi3WTd"}],"key":"UfppAKdCFD"},{"type":"block","kind":"notebook-content","children":[{"type":"include","file":"Fortran_Code/Section_Examples_Sine_Wave/app/section_examples_sine_wave.f90","literal":true,"children":[{"type":"code","value":"program sine\n  use csv_module\n  use nf, only: dense, input, network, sgd\n  use iso_fortran_env, only: real32\n\n  implicit none\n\n  real, parameter :: pi = 4 * atan(1.)\n  \n  ! CSV file objects for the training, testing, and prediction data\n  type(csv_file) :: sine_NN_data_file\n  type(network) :: net\n\n  ! Status of the CSV file operations\n  logical :: status_ok\n \n  ! Neural Network Training parameters\n  integer, parameter :: num_iterations = 100000\n  integer, parameter :: test_size = 50\n  real(kind=real32), parameter :: learning_rate = 0.1\n  \n  ! Neural Network (Fully Connected) Parameters\n  integer, parameter :: num_inputs = 1\n  integer, parameter :: num_outputs = 1\n  integer, parameter :: num_neurons_first_layer = 10\n  integer, parameter :: num_neurons_second_layer = 10\n\n  ! Training, Testing, and Prediction Data\n  real(kind=real32), dimension(test_size) :: x_test, y_test, x_train, y_train, y_pred\n  real, dimension(1) :: x_train_arr_temp\n  real, dimension(1) :: y_train_arr_temp\n  real, dimension(1) :: x_test_arr_temp\n  real, dimension(1) :: y_pred_arr_temp\n  \n  ! Mean Squared Error\n  real(kind=real32), dimension(num_iterations) :: mean_squared_error\n\n  ! Loop variables\n  integer :: i, j\n\n  ! Temporary variables\n  real(kind=real32) :: x_train_temp\n\n  ! Initialize the CSV file\n  call sine_NN_data_file%initialize(verbose=.true.)\n  \n  ! Open the CSV file\n  print *, '[*] Opening the CSV file...'\n  call sine_NN_data_file%open('sine_NN_data.csv', n_cols=7, status_ok=status_ok)\n  if (.not. status_ok) then\n    print *, '[!] Error opening the CSV file...'\n    stop\n  end if\n\n  ! Add header to the CSV file\n  print *, '[*] Adding header to the CSV file...'\n  call sine_NN_data_file%add(['Iteration', 'x_test___', 'y_test___', 'x_train__', 'y_train__', 'y_pred___', 'MSE______'])\n  call sine_NN_data_file%next_row()\n  \n  print '(\"[*] Creating Sine Wave Testing Data\")'\n\n  ! Create the Sine Wave Testing Data\n  x_test = [((j - 1) * 2.0d0 * pi / test_size, j = 1, test_size)]\n  y_test = (sin(x_test) + 1.0d0) / 2.0d0\n\n  ! Create the Neural Network\n  print *, '[*] Creating the Neural Network...'\n  print '(60(\"=\"))'\n  net = network([ &\n    input(num_inputs), &\n    dense(num_neurons_first_layer), &\n    dense(num_neurons_second_layer), &\n    dense(num_outputs) &\n  ])\n\n  ! Print the Neural Network information\n  call net % print_info()\n  print *\n\n  ! Train the Neural Network\n  print *, '[*] Training the Neural Network...'\n  print '(60(\"=\"))'\n\n  ! Loop over the number of iterations (epochs)\n  do i = 1, num_iterations\n\n    ! Train the Neural Network on the mini - batch of training data\n    do j = 1, test_size\n      ! Generate a random mini - batch of training data\n      call random_number(x_train_temp)\n      x_train(j) = x_train_temp * 2.0d0 * pi\n      y_train(j) = (sin(x_train(j)) + 1.0d0) / 2.0d0\n\n      ! Forward / backward pass and update the weights\n      x_train_arr_temp = x_train(j)\n      y_train_arr_temp = y_train(j)\n      call net % forward(x_train_arr_temp)\n      call net % backward(y_train_arr_temp)\n      call net % update(optimizer=sgd(learning_rate=learning_rate))\n\n      ! Evaluate the Neural Network on the testing data\n      x_test_arr_temp = x_test(j)\n      y_pred_arr_temp = net % predict(x_test_arr_temp)\n      y_pred(j) = y_pred_arr_temp(1)\n    end do\n    \n    ! Calculate the mean squared error\n    mean_squared_error(i) = sum((y_pred - y_test)**2) / test_size\n\n    do j = 1, test_size\n      ! Save the iteration number, testing, training, prediction and mean squared error data to the CSV file\n      ! For each interation there will be test_size rows of data of testing, training, prediction and mean squared error\n      call sine_NN_data_file%add([i], int_fmt='(i6)')\n      call sine_NN_data_file%add([ &\n        x_test(j), & \n        y_test(j), &\n        x_train(j), &\n        y_train(j), &\n        y_pred(j), &\n        mean_squared_error(i)], &\n        real_fmt='(f9.6)')\n      call sine_NN_data_file%next_row()\n    end do\n\n    ! Print the MSE every (num_iterations/10) iterations\n    if (mod(i, (num_iterations/10)) == 0) then\n      print '(\"Iteration: \", I6, \" | MSE: \", F9.6)', &\n        i, mean_squared_error(i)\n    end if\n  \n  end do\n\n  print *, '[*] Training complete!'\n  print *, '[*] Saving data to the CSV file...'\n\n  ! Close the CSV file\n  print *, '[*] Closing the CSV file...'\n  call sine_NN_data_file%close(status_ok=status_ok)\n  if (.not. status_ok) then\n    print *, '[!] Error closing the CSV file...'\n    stop\n  end if\n  \nend program sine\n\n","lang":"fortran","filename":"section_examples_sine_wave.f90","key":"MfvBoHwWjo"}],"key":"KhAJ4EtT8w"}],"key":"vzCpQ23i3O"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The above program is compiled and run using Fortran Package Manager (fpm).  The following FPM configuration file (fpm.toml) was used:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EYHN10HMz7"}],"key":"QVHGuRHyax"}],"key":"mX9lMpnDXn"},{"type":"block","kind":"notebook-content","children":[{"type":"include","file":"Fortran_Code/Section_Examples_Sine_Wave/fpm.toml","literal":true,"children":[{"type":"code","value":"name = \"Section_Examples_Sine_Wave\"\n\n[build]\nauto-executables = true\nauto-tests = true\nauto-examples = true\n\n[install]\nlibrary = false\n\n[dependencies]\ncsv-fortran = { git=\"https://github.com/jacobwilliams/csv-fortran.git\" }\nneural-fortran = { git=\"https://github.com/modern-fortran/neural-fortran.git\" }\n\n[[executable]]\nname=\"Section_Examples_Sine_Wave\"\nsource-dir=\"app\"\nmain=\"section_examples_sine_wave.f90\"\n\n","lang":"toml","filename":"fpm.toml","key":"Q0OAHCwdQW"}],"key":"SZ6VQeBBlx"}],"key":"Wfs2gk3vpm"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Build the Program using FPM (Fortran Package Manager)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PNGaU1ZGtc"}],"identifier":"build-the-program-using-fpm-fortran-package-manager","label":"Build the Program using FPM (Fortran Package Manager)","html_id":"build-the-program-using-fpm-fortran-package-manager","implicit":true,"key":"jATWhFibHE"}],"key":"hiR8g9eBlJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nroot_dir = \"\"\nroot_dir = os.getcwd()","key":"f9P7jk5x8Q"},{"type":"outputs","id":"RQkoDy_Sdm1S1nuE0CiFm","children":[],"key":"qmpjf6nRPa"}],"key":"RYSfFvgmTM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"code_dir = root_dir + \"/\" + \"Fortran_Code/Section_Examples_Sine_Wave\"","key":"WoXhzMvHJu"},{"type":"outputs","id":"C8EJJTkkx_ZZqu5Who9pZ","children":[],"key":"Rg9IyMJ9xe"}],"key":"qnCwKneyxP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"os.chdir(code_dir)","key":"V759DZCYjq"},{"type":"outputs","id":"4gcZVG-GxqYN_5EIChKYI","children":[],"key":"SjRRx76dew"}],"key":"fLy6VPkM1e"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"build_status = os.system(\"fpm build 2>/dev/null\")","key":"TM17rwpYO0"},{"type":"outputs","id":"b2OtHiZjNdTaWCJ1DbZfD","children":[],"key":"bwQOfxrGU8"}],"key":"qFKeaSWWml"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Run the Program using FPM (Fortran Package Manager)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LJI2g6VCtQ"}],"identifier":"run-the-program-using-fpm-fortran-package-manager","label":"Run the Program using FPM (Fortran Package Manager)","html_id":"run-the-program-using-fpm-fortran-package-manager","implicit":true,"key":"Uaos3aYJOB"}],"key":"raELPEaNYh"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The program is run and the output is saved into a file named sine_NN_data.dat","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pv96Fp3eFp"}],"key":"D7WCroFdwH"}],"key":"aJFyKcrcTv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"exec_status = \\\n    os.system(\"fpm run 2>/dev/null\")","key":"DH1d1BpMd5"},{"type":"outputs","id":"2AXjp1tCFBY9PtWDx0_y7","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":" [*] Opening the CSV file...\n [*] Adding header to the CSV file...\n[*] Creating Sine Wave Testing Data\n [*] Creating the Neural Network...\n============================================================\nLayer: input\n------------------------------------------------------------\nOutput shape: 1\nParameters: 0\n\nLayer: dense\n------------------------------------------------------------\nInput shape: 1\nOutput shape: 10\nParameters: 20\nActivation: sigmoid\n\nLayer: dense\n------------------------------------------------------------\nInput shape: 10\nOutput shape: 10\nParameters: 110\nActivation: sigmoid\n\nLayer: dense\n------------------------------------------------------------\nInput shape: 10\nOutput shape: 1\nParameters: 11\nActivation: sigmoid\n\n\n [*] Training the Neural Network...\n============================================================\nIteration:  10000 | MSE:  0.007093\nIteration:  20000 | MSE:  0.000202\nIteration:  30000 | MSE:  0.000148\nIteration:  40000 | MSE:  0.000123\nIteration:  50000 | MSE:  0.000105\nIteration:  60000 | MSE:  0.000094\nIteration:  70000 | MSE:  0.000087\nIteration:  80000 | MSE:  0.000081\nIteration:  90000 | MSE:  0.000073\nIteration: 100000 | MSE:  0.000065\n [*] Training complete!\n [*] Saving data to the CSV file...\n [*] Closing the CSV file...\n"},"children":[],"key":"lMeVOEG0CJ"}],"key":"meDBMN2HNA"}],"key":"dhfzFsLfeG"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the Neural Network Predictions and Mean Squared Error","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m0RUMu0kDf"}],"identifier":"plot-the-neural-network-predictions-and-mean-squared-error","label":"Plot the Neural Network Predictions and Mean Squared Error","html_id":"plot-the-neural-network-predictions-and-mean-squared-error","implicit":true,"key":"lHHPJ9yjkq"}],"key":"t6JfADQnYz"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Read the Data from the CSV File","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ue5GeqKld8"}],"identifier":"read-the-data-from-the-csv-file","label":"Read the Data from the CSV File","html_id":"read-the-data-from-the-csv-file","implicit":true,"key":"KSmvHq0CZM"}],"key":"wj4G0w9Deb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\nimport matplotlib.pyplot as plt","key":"MwfIrYYwXY"},{"type":"outputs","id":"Y0fqtT07hO6wCYE_T7ReR","children":[],"key":"kS2GCKowTp"}],"key":"pC0tXF97Jg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"csv_file = \"sine_NN_data.csv\"\ndf = pd.read_csv(csv_file, header=0, names=[\n        \"Iteration\", \"x_test\", \"y_test\", \"x_train\", \"y_train\", \"y_pred\", \"MSE\"\n    ])\ndf.info()","key":"Ec4xrZDdRB"},{"type":"outputs","id":"K3wTbqvP3or80aV1_3OWx","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 5000000 entries, 0 to 4999999\nData columns (total 7 columns):\n #   Column     Dtype  \n---  ------     -----  \n 0   Iteration  int64  \n 1   x_test     float64\n 2   y_test     float64\n 3   x_train    float64\n 4   y_train    float64\n 5   y_pred     float64\n 6   MSE        float64\ndtypes: float64(6), int64(1)\nmemory usage: 267.0 MB\n"},"children":[],"key":"GPXK3AfqmK"}],"key":"e9w0vlRUA5"}],"key":"P30tynvNnd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Group and Average the Mean Squared Error by Iteration","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AOMIWV3owr"}],"identifier":"group-and-average-the-mean-squared-error-by-iteration","label":"Group and Average the Mean Squared Error by Iteration","html_id":"group-and-average-the-mean-squared-error-by-iteration","implicit":true,"key":"LsLoe1mBna"}],"key":"DXtHL0fBF5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"grouped = df.groupby(\"Iteration\")\nmse_by_iter = grouped[\"MSE\"].mean()\noverall_mse = mse_by_iter.mean()\nprint(f\"Overall Mean Squared Error: {overall_mse}\")","key":"Ux68NVlVEA"},{"type":"outputs","id":"2AIVV6xJvPDdiX4pVVi1A","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Overall Mean Squared Error: 0.0014115740300000004\n"},"children":[],"key":"YDfWCkvFfw"}],"key":"CBGpuuSjoh"}],"key":"aO0jK6SKqu"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the Neural Network Predictions vs True Sine Wave","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ty0AMGzBP5"}],"identifier":"plot-the-neural-network-predictions-vs-true-sine-wave","label":"Plot the Neural Network Predictions vs True Sine Wave","html_id":"plot-the-neural-network-predictions-vs-true-sine-wave","implicit":true,"key":"vGEgQzfJ6L"}],"key":"imgn3Ab8ga"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"iteration_step = 5000 # Plot every iteration_step iteration\niteration_list = mse_by_iter.index.to_list()\niterations_to_plot = [1] + list(range(iteration_step, iteration_list[-1]+1, iteration_step))","key":"hg9HxavRIg"},{"type":"outputs","id":"U82KnpibiRl-T_AwknIqK","children":[],"key":"IrczH51LfH"}],"key":"i2lbcvsg87"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure(figsize=(10, 6))\nfor iteration in iterations_to_plot:\n    group_df = grouped.get_group(iteration)\n\n    plt.plot(group_df[\"x_test\"], group_df[\"y_test\"], 'k--', alpha=0.5,\n                 label=\"True Sine Wave\")\n    plt.plot(group_df[\"x_test\"], group_df[\"y_pred\"], label=f\"Iteration {iteration}\")\n\nplt.xlabel(\"x_test\")\nplt.ylabel(\"sine value\")\nplt.title(f\"Predicted vs. True Sine Wave (plotting every {iteration_step}-th iteration)\")\n# Avoid repeated legend entries for the 'True Sine' if multiple lines are drawn\nhandles, labels = plt.gca().get_legend_handles_labels()\n# Filter out duplicates by building an ordered dictionary\nfrom collections import OrderedDict\nby_label = OrderedDict(zip(labels, handles))\nplt.legend(by_label.values(), by_label.keys(), loc=\"lower left\", ncol=2)\n\nplt.grid(True)\nplt.tight_layout()\nplt.show()","key":"Ds5OJBLFHK"},{"type":"outputs","id":"gmgjG2mEeeVsZqx6n1BXL","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"4e3dc9f42dbc67029e84725e5f51f7dc","path":"/build/4e3dc9f42dbc67029e84725e5f51f7dc.png"},"text/plain":{"content":"<Figure size 1000x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"no3NqojcXp"}],"key":"zeFUOincjN"}],"key":"MfJyBPPPOm"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the Mean Squared Error vs Iteration","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ugY72xHAQR"}],"identifier":"plot-the-mean-squared-error-vs-iteration","label":"Plot the Mean Squared Error vs Iteration","html_id":"plot-the-mean-squared-error-vs-iteration","implicit":true,"key":"xY6VFGD2LP"}],"key":"KFYzQuNrLM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.figure(figsize=(8, 6))\nplt.plot(mse_by_iter.index[::1000], mse_by_iter.values[::1000], marker='o')\nplt.title(\"Mean Squared Error vs. Iteration\")\nplt.xlabel(\"Iteration\")\nplt.ylabel(\"MSE\")\nplt.grid(True)\nplt.tight_layout()\nplt.yscale(\"log\")\nplt.show()","key":"cL3tO6IIy4"},{"type":"outputs","id":"KoIE54nydOXJ2sPizKfa1","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c95dca7eb02ee4b8dbbfd157ea0f2ff5","path":"/build/c95dca7eb02ee4b8dbbfd157ea0f2ff5.png"},"text/plain":{"content":"<Figure size 800x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"fzczgZDW4t"}],"key":"yvGspPNZdI"}],"key":"uCHiZ8NaUI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Conclusion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z8sq0dpunA"}],"identifier":"conclusion","label":"Conclusion","html_id":"conclusion","implicit":true,"key":"kyXBWaSO3f"}],"key":"gZmAznaD8W"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We have successfully trained a neural network to approximate the sine function. The neural network was implemented in Fortran using the Neural Fortran library. The data was written to a CSV file using the CSV Fortran library. The neural network predictions and mean squared error were plotted using Python.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"owyaaY6FRr"}],"key":"fKtF7KfL6o"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"As can be seen from the plot, the neural network was able to approximate the sine function quite well. The mean squared error decreased over time as the neural network was trained. This example demonstrates how neural networks can be used to approximate complex functions such as the sine function.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Zqn9b9jn3q"}],"key":"gmwys2JRZN"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"As the iteration number reached 100,000, the neural network predictions closely matched the true sine wave function. The mean squared error decreased over time as the neural network was trained. This example demonstrates how neural networks can be used to approximate complex functions such as the sine function.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Uzh0mbdSyA"}],"key":"soQSdtBUlb"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"A great improvement on this code would be to implement the training loop using OpenMP.  This would allow the training loop to be parallelized and run on multiple cores.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"whQFDPupIP"}],"key":"lwuebrQ4Wv"}],"key":"tEdvgrJP0W"}],"key":"kCthaH0vN2"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Neural Fortran","url":"/sections/computer-programming/fortran/neural-fortran/neural-fortran-head","group":"Computer Programming"},"next":{"title":"Discretized Fourier Transform of Arbitrary Signal Using FFTW3 in Fortran","url":"/sections/computer-programming/fortran/dfft/dfft","group":"Computer Programming"}}},"domain":"http://localhost:3004"}