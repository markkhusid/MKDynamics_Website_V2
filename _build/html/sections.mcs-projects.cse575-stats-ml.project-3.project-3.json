{"version":3,"kind":"Notebook","sha256":"715e6873e0599e65ac30ca7258f6da3577b86289b28b059b186321502a9471aa","slug":"sections.mcs-projects.cse575-stats-ml.project-3.project-3","location":"/Sections/MCS_Projects/CSE575_Stats_ML/Project_3/Project_3.ipynb","dependencies":[],"frontmatter":{"title":"CSE572 Statistical Machine Learning - Project 3 - Classification Using Neural Networks and Deep Learning Project","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Mark Khusid","given":"Mark","family":"Khusid"},"name":"Mark Khusid","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/markkhusid/MKDynamics_Website_V2","numbering":{"title":{"offset":3}},"source_url":"https://github.com/markkhusid/MKDynamics_Website_V2/blob/master/Sections/MCS_Projects/CSE575_Stats_ML/Project_3/Project_3.ipynb","edit_url":"https://github.com/markkhusid/MKDynamics_Website_V2/edit/master/Sections/MCS_Projects/CSE575_Stats_ML/Project_3/Project_3.ipynb","exports":[{"format":"ipynb","filename":"Project_3.ipynb","url":"/build/Project_3-39d2f30e77412c63b8aaad6ae42e9d86.ipynb"}]},"widgets":{"application/vnd.jupyter.widget-state+json":{"state":{},"version_major":2,"version_minor":0}},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Import Libraries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JmOjtV7NqL"}],"identifier":"import-libraries","label":"Import Libraries","html_id":"import-libraries","implicit":true,"key":"bs5nyy43vB"}],"key":"FIZRRD33gv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import warnings\nwarnings.filterwarnings(\"ignore\")\nimport keras\nfrom tensorflow.keras.utils import to_categorical\nfrom keras.datasets import mnist\nfrom keras.models import Sequential\nfrom keras.layers import Dense, Dropout, Flatten\nfrom keras.layers import Conv2D, MaxPooling2D\nfrom keras import backend as K\nimport tensorflow as tf\n\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import confusion_matrix, ConfusionMatrixDisplay\n\nimport os\nimport multiprocessing\n\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n","key":"RVAZJwQl7F"},{"type":"outputs","id":"kgkul-7o6IS6Eq3J19Tr7","children":[],"key":"mwqWNKqZiR"}],"key":"E8Ntax0El1"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Problem Solution","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vebjzb6qV8"}],"identifier":"problem-solution","label":"Problem Solution","html_id":"problem-solution","implicit":true,"key":"ecQqoX8qwa"}],"key":"JcEKbuh4iu"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Show Compute Environment","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CGVKtNi1pR"}],"identifier":"show-compute-environment","label":"Show Compute Environment","html_id":"show-compute-environment","implicit":true,"key":"XyY3hxxrYP"}],"key":"rmR6sg1Te1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Number of logical CPUs\nnum_cores = multiprocessing.cpu_count()\nprint(f\"Number of CPU cores available: {num_cores}\")\n\n# Number of GPUs\nprint(\"Num GPUs Available:\", len(tf.config.list_physical_devices('GPU')))","key":"Gz4tO3VQeV"},{"type":"outputs","id":"_SyMtameR7Mw8pUB-F6TC","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Number of CPU cores available: 16\nNum GPUs Available: 1\n"},"children":[],"key":"ltc36T2Gap"}],"key":"Gdi5heKVy2"}],"key":"ZqIXLdTFrM"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Batch Size","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZcDJMSP2oT"}],"identifier":"define-batch-size","label":"Define Batch Size","html_id":"define-batch-size","implicit":true,"key":"SM8EMaSQSy"}],"key":"z8jLKKq4Lm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"batch_size = 64","key":"Bsfktjhd7U"},{"type":"outputs","id":"lj7efNOVAsbmg1HdEom22","children":[],"key":"bwu9LSEZYm"}],"key":"krPiv4mSvQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Number of Classes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"usRq70rYcj"}],"identifier":"define-number-of-classes","label":"Define Number of Classes","html_id":"define-number-of-classes","implicit":true,"key":"XCpGjE00qg"}],"key":"qo4nMsX4n3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"num_classes = 10","key":"cjoURah75R"},{"type":"outputs","id":"lFgnZP0t4DRunZc8QhdpE","children":[],"key":"scIJ6hTCdW"}],"key":"ST1aLPRlBB"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Number of Training Epochs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AR5M9Aibg4"}],"identifier":"define-number-of-training-epochs","label":"Define Number of Training Epochs","html_id":"define-number-of-training-epochs","implicit":true,"key":"OdnkiogvT6"}],"key":"jcxFnTb5a0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"epochs = 12","key":"UACmwMIYaZ"},{"type":"outputs","id":"2LgNsIhzY3iIQZre6PKd0","children":[],"key":"BGHt8EuI8M"}],"key":"jhxtH9HbbR"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Image Dimensions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EQ3KbnQafE"}],"identifier":"define-image-dimensions","label":"Define Image Dimensions","html_id":"define-image-dimensions","implicit":true,"key":"rPFrwfc3Fl"}],"key":"l4HFjz9HDu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# input image dimensions\nimg_rows, img_cols = 28, 28","key":"JDMVTE3V0c"},{"type":"outputs","id":"SHqULEFYzF4u14TcswDax","children":[],"key":"uwBdnjwzJm"}],"key":"K141y5ldNV"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Kernel Size (Updated from (3,3) Baseline to (5,5) Task 2)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zYcxQTBnka"}],"identifier":"define-kernel-size-updated-from-3-3-baseline-to-5-5-task-2","label":"Define Kernel Size (Updated from (3,3) Baseline to (5,5) Task 2)","html_id":"define-kernel-size-updated-from-3-3-baseline-to-5-5-task-2","implicit":true,"key":"lo5DR56Nn7"}],"key":"jUrJknLw3u"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"kernel_size = (5,5)","key":"I4yW0VHwZI"},{"type":"outputs","id":"cN_phP-Muc6KxalpMAp_h","children":[],"key":"plQD5QqzoU"}],"key":"OUk1CviPB2"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Pooling Size","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T52v3Gi5I5"}],"identifier":"define-pooling-size","label":"Define Pooling Size","html_id":"define-pooling-size","implicit":true,"key":"faKR8xO6wL"}],"key":"x4H5XvgLZ5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pool_size = (2,2)","key":"KCosfGtw9i"},{"type":"outputs","id":"77aptO_LXXpvrSl33vVHt","children":[],"key":"cPTbWAqd0n"}],"key":"RFBy7jPF7S"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load Data and Train / Test Split","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f4K9Lk3b1m"}],"identifier":"load-data-and-train-test-split","label":"Load Data and Train / Test Split","html_id":"load-data-and-train-test-split","implicit":true,"key":"Dj0Csya8Po"}],"key":"JogtLeMIKT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# the data, split between train and test sets\n(x_train, y_train), (x_test, y_test)=tf.keras.datasets.mnist.load_data('mnist.npz')","key":"l87925qEPd"},{"type":"outputs","id":"l0Ug5OvDoxXkJ5dXily1h","children":[],"key":"TH42wDaAeF"}],"key":"c3bPyHgI25"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_train.shape","key":"t7TXzOZfXb"},{"type":"outputs","id":"UgEldfxEQ5KbJJdf5Sm7D","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"(60000, 28, 28)","content_type":"text/plain"}}},"children":[],"key":"Pp3Bpi0U9I"}],"key":"sXNPQYsgyp"}],"key":"neB3NTmJ6R"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_train.shape","key":"QcXeHLPQci"},{"type":"outputs","id":"OygCjj9gFIsxIvasvD_H-","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"(60000,)","content_type":"text/plain"}}},"children":[],"key":"sjIALtFAcA"}],"key":"sl6IhBgHxi"}],"key":"BCUtYWbVVY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_test.shape","key":"jM9glIV1TD"},{"type":"outputs","id":"K2qLgldziMxcOeDrq6P7w","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"(10000, 28, 28)","content_type":"text/plain"}}},"children":[],"key":"IwkWO14Sgx"}],"key":"NUQmp4AZkW"}],"key":"nyLTnyee9M"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_test.shape","key":"MtfusHLPJR"},{"type":"outputs","id":"RC0T1uGoBqlBTwSld4m_n","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/plain":{"content":"(10000,)","content_type":"text/plain"}}},"children":[],"key":"rirXTwb8Fu"}],"key":"k8B4lZdEId"}],"key":"xM1INYykB1"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"EDA on Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RxfHcVown6"}],"identifier":"eda-on-data","label":"EDA on Data","html_id":"eda-on-data","implicit":true,"key":"VmastOqPTT"}],"key":"JqRfnj4HLK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize First Train Image","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"krCdI81yu6"}],"identifier":"visualize-first-train-image","label":"Visualize First Train Image","html_id":"visualize-first-train-image","implicit":true,"key":"D2zX0X0GyQ"}],"key":"E48Wqaz0ye"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ticks = np.arange(0, 28+2, 2)\n#ticks","key":"rZ6tIj0W5b"},{"type":"outputs","id":"o_6AvUWh_v0Gxtn5SYjvf","children":[],"key":"iLRZJpPfnO"}],"key":"f2xvEKamAK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.imshow(x_train[0], cmap='grey')\nplt.xlim(0, 28)\nplt.xticks(ticks=ticks)\nplt.yticks(ticks=ticks)\nplt.show()","key":"o8pTZM4CCX"},{"type":"outputs","id":"MYHa1JGsc7ZJ5_iPMn4PH","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6307c9063d2a896beafa2689ed8da5df","path":"/build/6307c9063d2a896beafa2689ed8da5df.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"tCmQIoNhFo"}],"key":"rTrp2yBdLI"}],"key":"ufaf3p2JN3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize the First 10 X Train Images","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XYltz1TY7y"}],"identifier":"visualize-the-first-10-x-train-images","label":"Visualize the First 10 X Train Images","html_id":"visualize-the-first-10-x-train-images","implicit":true,"key":"Jhdh3In7Yf"}],"key":"px3QTRQEn2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Display the first 10 images\nnum_images_to_display = 10\nplt.figure(figsize=(10, 5))  # Adjust the figure size\n\nfor i in range(num_images_to_display):\n    plt.subplot(2, 5, i + 1)  # Create a 2x5 grid for 10 images\n    plt.imshow(x_train[i], cmap='gray')  # Display each image\n    plt.title(f'Train Image {i + 1}')\n    plt.axis('off')  # Hide axes for better visualization\n\nplt.tight_layout()\nplt.show()","key":"m2LYv0ljDK"},{"type":"outputs","id":"K_6shd-yP7Hb8UJ6Ud9-D","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7ce587a1409319f6f079817b9548c2b6","path":"/build/7ce587a1409319f6f079817b9548c2b6.png"},"text/plain":{"content":"<Figure size 1000x500 with 10 Axes>","content_type":"text/plain"}}},"children":[],"key":"kxGVPkSPOO"}],"key":"lZrJPQ6wxR"}],"key":"dCx9IMw3Eb"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Print the First 10 Y Train Class Labels","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"om4MASRZpA"}],"identifier":"print-the-first-10-y-train-class-labels","label":"Print the First 10 Y Train Class Labels","html_id":"print-the-first-10-y-train-class-labels","implicit":true,"key":"rnE91oWsCr"}],"key":"sAPv01gGsx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_train[0:10]","key":"HGlYOJNwVQ"},{"type":"outputs","id":"k60lCYajGkwT8zfEkXb3N","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/plain":{"content":"array([5, 0, 4, 1, 9, 2, 1, 3, 1, 4], dtype=uint8)","content_type":"text/plain"}}},"children":[],"key":"O4zcgfr7iD"}],"key":"evSVALDn7r"}],"key":"sVtBN3QEAx"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize the First X 10 Test Images","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wMWXZ29lF6"}],"identifier":"visualize-the-first-x-10-test-images","label":"Visualize the First X 10 Test Images","html_id":"visualize-the-first-x-10-test-images","implicit":true,"key":"mI3lfPWg3N"}],"key":"sipZavEk6R"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Display the first 10 images\nnum_images_to_display = 10\nplt.figure(figsize=(10, 5))  # Adjust the figure size\n\nfor i in range(num_images_to_display):\n    plt.subplot(2, 5, i + 1)  # Create a 2x5 grid for 10 images\n    plt.imshow(x_test[i], cmap='gray')  # Display each image\n    plt.title(f'Test Image {i + 1}')\n    plt.axis('off')  # Hide axes for better visualization\n\nplt.tight_layout()\nplt.show()","key":"ImSoHmwSiA"},{"type":"outputs","id":"x_io8vSm9O6kqI7i3IdHD","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0e370b8936aebd53b2df30837226df74","path":"/build/0e370b8936aebd53b2df30837226df74.png"},"text/plain":{"content":"<Figure size 1000x500 with 10 Axes>","content_type":"text/plain"}}},"children":[],"key":"kz2sWWgjOf"}],"key":"HHNlU9PYsp"}],"key":"v2EXfaZY4r"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Print the First 10 Y Test Class Labels","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cRkoRatfgX"}],"identifier":"print-the-first-10-y-test-class-labels","label":"Print the First 10 Y Test Class Labels","html_id":"print-the-first-10-y-test-class-labels","implicit":true,"key":"YyGCeZZAZn"}],"key":"vPqOzPff0y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_test[0:10]","key":"vbG093oMFu"},{"type":"outputs","id":"SfkclHQAn5mRQ8ZQ2JN1f","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"array([7, 2, 1, 0, 4, 1, 4, 9, 5, 9], dtype=uint8)","content_type":"text/plain"}}},"children":[],"key":"kF95usoSOe"}],"key":"FOeCEn2x3x"}],"key":"wL5W23KBT7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Reformat Data if Necessary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"idGF6Kp4gW"}],"identifier":"reformat-data-if-necessary","label":"Reformat Data if Necessary","html_id":"reformat-data-if-necessary","implicit":true,"key":"T62j43X3Go"}],"key":"TjzyCn7MoP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"if K.image_data_format() == 'channels_first':\n    x_train = x_train.reshape(x_train.shape[0], 1, img_rows, img_cols)\n    x_test = x_test.reshape(x_test.shape[0], 1, img_rows, img_cols)\n    input_shape = (1, img_rows, img_cols)\nelse:\n    x_train = x_train.reshape(x_train.shape[0], img_rows, img_cols, 1)\n    x_test = x_test.reshape(x_test.shape[0], img_rows, img_cols, 1)\n    input_shape = (img_rows, img_cols, 1)","key":"d1zzX5R6zU"},{"type":"outputs","id":"jqfow9_T6lPMcqp0qtMiz","children":[],"key":"kAqIEaQefc"}],"key":"lMhCIAOyk0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_train.shape","key":"xKFh9dyhFe"},{"type":"outputs","id":"u58qAmp2QMh09FmiAZAK9","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/plain":{"content":"(60000, 28, 28, 1)","content_type":"text/plain"}}},"children":[],"key":"N66nxgaRyq"}],"key":"Fu7dkDdXys"}],"key":"S7JkvTCtLo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_test.shape","key":"MFy82IsHTZ"},{"type":"outputs","id":"p9yYrRsqYKlp-DyTguntA","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"(10000, 28, 28, 1)","content_type":"text/plain"}}},"children":[],"key":"ozMM1Pg161"}],"key":"H4qjThPZHt"}],"key":"Ge9lL3b6eg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cast and Normalize Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oZ3sLA6PWt"}],"identifier":"cast-and-normalize-data","label":"Cast and Normalize Data","html_id":"cast-and-normalize-data","implicit":true,"key":"OXemoSrhIh"}],"key":"HiD3J5btjn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_train = x_train.astype('float32')\nx_test = x_test.astype('float32')\nx_train /= 255\nx_test /= 255","key":"VVkW9zPn3K"},{"type":"outputs","id":"PccQ5_P51hy2Ra0B0EzTy","children":[],"key":"QD178mieLN"}],"key":"za1SmlcR8f"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Print Out Description of Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LKRJfjJMTj"}],"identifier":"print-out-description-of-data","label":"Print Out Description of Data","html_id":"print-out-description-of-data","implicit":true,"key":"zBwS40XAkU"}],"key":"Fi8OnCGBiB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print('x_train shape:', x_train.shape)\nprint(x_train.shape[0], 'train samples')\nprint(x_test.shape[0], 'test samples')","key":"GvfcYuoEzX"},{"type":"outputs","id":"Ldj7e0_4o7EuI9Ru1S6oa","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"x_train shape: (60000, 28, 28, 1)\n60000 train samples\n10000 test samples\n"},"children":[],"key":"xfkcVJzqPU"}],"key":"WZsGNy2lBo"}],"key":"WJzyJ4B2pC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Convert Class Vectors into Binary Class Matrices","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jKXOP7HRj1"}],"identifier":"convert-class-vectors-into-binary-class-matrices","label":"Convert Class Vectors into Binary Class Matrices","html_id":"convert-class-vectors-into-binary-class-matrices","implicit":true,"key":"cqWTf1BzId"}],"key":"jCeFKyCgpo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# convert class vectors to binary class matrices\ny_train = to_categorical(y_train, num_classes)\ny_test = to_categorical(y_test, num_classes)","key":"on9i5n0E1o"},{"type":"outputs","id":"UUqBakZXHuAj8tUKnIirJ","children":[],"key":"NvgDFmtXOD"}],"key":"H1A9HxLwjk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_train.shape","key":"IXwa0UOYDc"},{"type":"outputs","id":"Gc7xo7UYW8U_siKQOU0CM","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/plain":{"content":"(60000, 10)","content_type":"text/plain"}}},"children":[],"key":"qqFyFmmWVq"}],"key":"jfnX9BxTRU"}],"key":"el1JHipe4c"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_train[0:5]","key":"GHb1HOSCln"},{"type":"outputs","id":"8_2dWa40IfNjlsI49GdED","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/plain":{"content":"array([[0., 0., 0., 0., 0., 1., 0., 0., 0., 0.],\n       [1., 0., 0., 0., 0., 0., 0., 0., 0., 0.],\n       [0., 0., 0., 0., 1., 0., 0., 0., 0., 0.],\n       [0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],\n       [0., 0., 0., 0., 0., 0., 0., 0., 0., 1.]], dtype=float32)","content_type":"text/plain"}}},"children":[],"key":"B8xhWfwNud"}],"key":"VAkXyjp036"}],"key":"W4FAkIih6O"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_test.shape","key":"CHLpggS6bZ"},{"type":"outputs","id":"IFJjgxe6c8_gir6u-XPhw","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/plain":{"content":"(10000, 10)","content_type":"text/plain"}}},"children":[],"key":"uNO75h5yAk"}],"key":"DISod1Cajt"}],"key":"TQwRSKgR3z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_test[0:5]","key":"pIQjNCFfQT"},{"type":"outputs","id":"wvk_J1iP7dGCwcZA-vN7x","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/plain":{"content":"array([[0., 0., 0., 0., 0., 0., 0., 1., 0., 0.],\n       [0., 0., 1., 0., 0., 0., 0., 0., 0., 0.],\n       [0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],\n       [1., 0., 0., 0., 0., 0., 0., 0., 0., 0.],\n       [0., 0., 0., 0., 1., 0., 0., 0., 0., 0.]], dtype=float32)","content_type":"text/plain"}}},"children":[],"key":"qy1SDGCQZm"}],"key":"x3WzrBQMM2"}],"key":"AWqNxqkOdt"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create Task 2 Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eqj9e9CvPB"}],"identifier":"create-task-2-model","label":"Create Task 2 Model","html_id":"create-task-2-model","implicit":true,"key":"R3xG4F4ycp"}],"key":"lVzknVJ7Ri"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Task 2 Model Type","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"etxHmxpOCr"}],"identifier":"define-task-2-model-type","label":"Define Task 2 Model Type","html_id":"define-task-2-model-type","implicit":true,"key":"I4HZ5B93Vg"}],"key":"uLCaqisTTx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Artificial Neural Network\nmodel = Sequential()","key":"CvZLBiqesA"},{"type":"outputs","id":"5JgOlCf1lImlsMRypX3A2","children":[],"key":"xWBtlNCywQ"}],"key":"gJ1OJ6rEng"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model","key":"IEh4xdhXoZ"},{"type":"outputs","id":"pm27jnAFLD3MHD32nO0YO","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/plain":{"content":"<keras.engine.sequential.Sequential at 0x24a43f95730>","content_type":"text/plain"}}},"children":[],"key":"gk0furDkPp"}],"key":"N2G3hIehVA"}],"key":"jTO1SbBzas"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create Task 2 Model Structure","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JTXVjXCqY8"}],"identifier":"create-task-2-model-structure","label":"Create Task 2 Model Structure","html_id":"create-task-2-model-structure","implicit":true,"key":"pSNcm0OFaB"}],"key":"Kf26ib01UW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# First layer is a convolutional layer with 6 filters, each of size 3x3\nmodel.add(Conv2D(\n    filters=6, \n    kernel_size=kernel_size,\n    strides=(1, 1),\n    activation='relu',\n    input_shape=input_shape))\n\n# Second layer is a max pooling layer with a pool size of 2x2\nmodel.add(MaxPooling2D(\n    pool_size=pool_size,\n    strides=(1, 1)))\n\n# Third layer is a convolutional layer with 16 filters, each of size 3x3\nmodel.add(Conv2D(\n    filters=16, \n    kernel_size=kernel_size,\n    strides=(1, 1),\n    activation='relu'))\n\n# Fourth layer is a max pooling layer with a pool size of 2x2\nmodel.add(MaxPooling2D(\n    pool_size=pool_size,\n    strides=(1, 1)))\n\n# Fifth layer is a flatten layer\nmodel.add(Flatten())\n\n# Sixth layer is a dense layer with 120 units\nmodel.add(Dense(120, activation='relu'))\n\n# Seventh layer is a dense layer with 84 units\nmodel.add(Dense(84, activation='relu'))\n\n# Eighth layer is a dense layer with 10 units for 10 classes in the output layer\nmodel.add(Dense(num_classes, activation='softmax'))","key":"pErTDQKAWS"},{"type":"outputs","id":"aftVvp_tO35lmcZ5gQCX0","children":[],"key":"nfwAKNc9VR"}],"key":"o6RciW5jKH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model","key":"OeivC8PM6z"},{"type":"outputs","id":"qF53paUpCdCnlC_gop2I6","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"text/plain":{"content":"<keras.engine.sequential.Sequential at 0x24a43f95730>","content_type":"text/plain"}}},"children":[],"key":"EJ7W1quhRO"}],"key":"mauUCAEqW3"}],"key":"SQDgglT2ZW"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Task 2 Model Optimizer","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sWmE0y4aTm"}],"identifier":"define-task-2-model-optimizer","label":"Define Task 2 Model Optimizer","html_id":"define-task-2-model-optimizer","implicit":true,"key":"uf88h2FWQG"}],"key":"NPAxp80s2W"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"optim = tf.keras.optimizers.Adadelta(\n    learning_rate=0.1, \n    rho=0.95, \n    decay=0.0)","key":"loSOtMhCEp"},{"type":"outputs","id":"sbRQctNuM5gRL5tJqXrcQ","children":[],"key":"rh6H8L38zL"}],"key":"U9yezYjpj1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"optim","key":"fYhxCS1YLU"},{"type":"outputs","id":"gprTEbqOsVCUrctzaZN_k","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"text/plain":{"content":"<keras.optimizer_v2.adadelta.Adadelta at 0x24a42d01fd0>","content_type":"text/plain"}}},"children":[],"key":"qfmdrts5zZ"}],"key":"kRpLe2XDxs"}],"key":"PaOsjJI65H"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compile Task 2 Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UqULP03DLb"}],"identifier":"compile-task-2-model","label":"Compile Task 2 Model","html_id":"compile-task-2-model","implicit":true,"key":"tGFHUrlTTk"}],"key":"QUBlDdojLS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# https://keras.io/optimizers/ \nmodel.compile(loss=keras.losses.categorical_crossentropy,\n              optimizer=optim,\n              metrics=['accuracy'])","key":"PetGi7QtZI"},{"type":"outputs","id":"PDs9XMTVfGrurI0n20nIC","children":[],"key":"mdUrlHG2xU"}],"key":"o0cp8cbZIQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model","key":"EUFPAR3xti"},{"type":"outputs","id":"KDOKcvB15eV9hx1ipSpSg","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/plain":{"content":"<keras.engine.sequential.Sequential at 0x24a43f95730>","content_type":"text/plain"}}},"children":[],"key":"pda18ZSlbF"}],"key":"MbViqdI8Tm"}],"key":"anfnbQEWWy"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Train Task 2 Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"flV9f4C8vx"}],"identifier":"train-task-2-model","label":"Train Task 2 Model","html_id":"train-task-2-model","implicit":true,"key":"Ethpx6HQkV"}],"key":"kFp2Pv8uRJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model_history = \\\n    model.fit(x_train, y_train,\n          batch_size=batch_size,\n          epochs=epochs,\n          verbose=2,\n          validation_data=(x_test, y_test))\n","key":"vTcK93Vnst"},{"type":"outputs","id":"mIsc7Gm4x8BXTsdeZZWur","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Epoch 1/12\n938/938 - 10s - loss: 0.3448 - accuracy: 0.8967 - val_loss: 0.1091 - val_accuracy: 0.9694\nEpoch 2/12\n938/938 - 2s - loss: 0.0940 - accuracy: 0.9723 - val_loss: 0.0704 - val_accuracy: 0.9806\nEpoch 3/12\n938/938 - 2s - loss: 0.0659 - accuracy: 0.9804 - val_loss: 0.0575 - val_accuracy: 0.9809\nEpoch 4/12\n938/938 - 2s - loss: 0.0530 - accuracy: 0.9841 - val_loss: 0.0489 - val_accuracy: 0.9841\nEpoch 5/12\n938/938 - 2s - loss: 0.0451 - accuracy: 0.9865 - val_loss: 0.0571 - val_accuracy: 0.9808\nEpoch 6/12\n938/938 - 2s - loss: 0.0392 - accuracy: 0.9887 - val_loss: 0.0464 - val_accuracy: 0.9847\nEpoch 7/12\n938/938 - 2s - loss: 0.0352 - accuracy: 0.9895 - val_loss: 0.0358 - val_accuracy: 0.9885\nEpoch 8/12\n938/938 - 2s - loss: 0.0318 - accuracy: 0.9908 - val_loss: 0.0366 - val_accuracy: 0.9875\nEpoch 9/12\n938/938 - 2s - loss: 0.0291 - accuracy: 0.9911 - val_loss: 0.0323 - val_accuracy: 0.9889\nEpoch 10/12\n938/938 - 2s - loss: 0.0265 - accuracy: 0.9923 - val_loss: 0.0316 - val_accuracy: 0.9892\nEpoch 11/12\n938/938 - 2s - loss: 0.0240 - accuracy: 0.9930 - val_loss: 0.0335 - val_accuracy: 0.9887\nEpoch 12/12\n938/938 - 2s - loss: 0.0222 - accuracy: 0.9937 - val_loss: 0.0344 - val_accuracy: 0.9894\n"},"children":[],"key":"nEVd0vJlPP"}],"key":"esTo4lKD0G"}],"key":"VpzHcBSCdv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model_history.history['loss']","key":"kP65yvEaSA"},{"type":"outputs","id":"T6pvsLw42HSJTNbwywEb1","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/plain":{"content":"[0.34479445219039917,\n 0.09400391578674316,\n 0.0658968836069107,\n 0.05295504257082939,\n 0.04514137655496597,\n 0.03916701301932335,\n 0.03520461171865463,\n 0.03181973844766617,\n 0.029129598289728165,\n 0.026451660320162773,\n 0.024046970531344414,\n 0.022170674055814743]","content_type":"text/plain"}}},"children":[],"key":"rgTPdm2a2q"}],"key":"DHL3PoAki3"}],"key":"aUeOCb4rRM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model_history.history['accuracy']","key":"nLgoOvNssJ"},{"type":"outputs","id":"NYvQ2ggaD2x6tbpndNoxw","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"text/plain":{"content":"[0.8967000246047974,\n 0.9722999930381775,\n 0.9804333448410034,\n 0.9841333627700806,\n 0.9865333437919617,\n 0.9887333512306213,\n 0.9895333051681519,\n 0.9907500147819519,\n 0.9910500049591064,\n 0.9922666549682617,\n 0.992983341217041,\n 0.9937000274658203]","content_type":"text/plain"}}},"children":[],"key":"lKbGYB5efu"}],"key":"sF1sg7jl2t"}],"key":"gBhYzLt9Oy"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Save the Fitted Task 2 Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W1CVZInr9c"}],"identifier":"save-the-fitted-task-2-model","label":"Save the Fitted Task 2 Model","html_id":"save-the-fitted-task-2-model","implicit":true,"key":"BCmoBIgdSJ"}],"key":"N1yA35n0dk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model.save(\"fitted_task2_model.keras\")  # Save the model in HDF5 format\n\n# Save the history\nimport json\nwith open(\"fitted_task2_model_history.json\", \"w\") as f:\n    json.dump(model_history.history, f)","key":"KAWvOcnDBz"},{"type":"outputs","id":"Ddbtfuf6NNYi4k3VllBy0","children":[],"key":"czZKQ9NZqV"}],"key":"wbqdmSH6F8"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load the Model if Necessary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XHjE7qVaSa"}],"identifier":"load-the-model-if-necessary","label":"Load the Model if Necessary","html_id":"load-the-model-if-necessary","implicit":true,"key":"Jkc9gifRB7"}],"key":"fc5QiAVejb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#from keras.models import load_model\n\n#model = load_model(\"fitted_baseline_model.keras\")  # Load the saved model\n\n# Load the history\n#import json\n#with open(\"fitted_baseline_model_history.json\", \"r\") as f:\n#    model_history = json.load(f)","key":"Z7wYH8uo0w"},{"type":"outputs","id":"Hl3BdExd9CgFz9H9GVVOG","children":[],"key":"CrKWhrNy3v"}],"key":"JPJtJ44XnT"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Get Model Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WC3JyzIrLJ"}],"identifier":"get-model-summary","label":"Get Model Summary","html_id":"get-model-summary","implicit":true,"key":"x0nU1NXLAC"}],"key":"fCiVcQXiUg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model.summary()","key":"UGqF9zyvTq"},{"type":"outputs","id":"uHHPjnIVkmBVdsfcGGxwb","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Model: \"sequential\"\n_________________________________________________________________\nLayer (type)                 Output Shape              Param #   \n=================================================================\nconv2d (Conv2D)              (None, 24, 24, 6)         156       \n_________________________________________________________________\nmax_pooling2d (MaxPooling2D) (None, 23, 23, 6)         0         \n_________________________________________________________________\nconv2d_1 (Conv2D)            (None, 19, 19, 16)        2416      \n_________________________________________________________________\nmax_pooling2d_1 (MaxPooling2 (None, 18, 18, 16)        0         \n_________________________________________________________________\nflatten (Flatten)            (None, 5184)              0         \n_________________________________________________________________\ndense (Dense)                (None, 120)               622200    \n_________________________________________________________________\ndense_1 (Dense)              (None, 84)                10164     \n_________________________________________________________________\ndense_2 (Dense)              (None, 10)                850       \n=================================================================\nTotal params: 635,786\nTrainable params: 635,786\nNon-trainable params: 0\n_________________________________________________________________\n"},"children":[],"key":"CnALsukrMo"}],"key":"aCfy1pCpjM"}],"key":"RPYxAZBy28"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Evaluate Task 2 Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GncA2TRFoh"}],"identifier":"evaluate-task-2-model","label":"Evaluate Task 2 Model","html_id":"evaluate-task-2-model","implicit":true,"key":"PckdkwLzWJ"}],"key":"Hl5uvtwRAg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Training Accuracy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dQeGFQTPM2"}],"identifier":"training-accuracy","label":"Training Accuracy","html_id":"training-accuracy","implicit":true,"key":"akibPEzvlB"}],"key":"LkSZdYl52c"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"loss_train, accuracy_train = model.evaluate(x_train, y_train)","key":"m8iFvhNgQ0"},{"type":"outputs","id":"W47OtZZ7KIa08I6wX7DnG","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"1875/1875 [==============================] - 3s 1ms/step - loss: 0.0209 - accuracy: 0.9940\n"},"children":[],"key":"pFpZpVTFXg"}],"key":"dAXOWN6uix"}],"key":"QgXTWo6iYU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print('Print the training loss and the accuracy of the model on the dataset')\nprint('Train Loss: {0:0.4f} Train Accuracy: {1:0.4f}'.format(loss_train, accuracy_train))","key":"hEhaoFMBcs"},{"type":"outputs","id":"l2qOphgoAmEQqnPuBwxtn","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Print the training loss and the accuracy of the model on the dataset\nTrain Loss: 0.0209 Train Accuracy: 0.9940\n"},"children":[],"key":"fRO1Oror7e"}],"key":"z0Mba1JjrN"}],"key":"hAokN2M7dK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Testing Accuracy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wZYusudCiC"}],"identifier":"testing-accuracy","label":"Testing Accuracy","html_id":"testing-accuracy","implicit":true,"key":"Cc64LspJ9l"}],"key":"svmBQSyiU0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"loss_test, accuracy_test = model.evaluate(x_test, y_test)","key":"SBdQmg7BST"},{"type":"outputs","id":"RpZeR1QJG2fdmBVTfVjJE","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"313/313 [==============================] - 1s 2ms/step - loss: 0.0344 - accuracy: 0.9894\n"},"children":[],"key":"PNdT6hD0hR"}],"key":"xOUJMqN4ow"}],"key":"Er6bY65c3r"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print('Print the testing loss and the accuracy of the model on the dataset')\nprint('Test Loss: {0:0.4f} Test Accuracy: {1:0.4f}'.format(loss_test, accuracy_test))","key":"QKln4EDeHh"},{"type":"outputs","id":"r6QqrlgpahTwic31Hwsww","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Print the testing loss and the accuracy of the model on the dataset\nTest Loss: 0.0344 Test Accuracy: 0.9894\n"},"children":[],"key":"Ksgcs2nZVr"}],"key":"IOwiaiw3s3"}],"key":"rxG8PY0xgO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#score = model.evaluate(x_test, y_test, verbose=0)\n#print('Test loss:', score[0])\n#print('Test accuracy:', score[1])","key":"gnY5ZGtEMJ"},{"type":"outputs","id":"V2qcUBnGZfwFCo52ZEFvY","children":[],"key":"mQjP75HtUx"}],"key":"XYauwY9lRy"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Use Model to Make Predictions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VcZcl4IyOK"}],"identifier":"use-model-to-make-predictions","label":"Use Model to Make Predictions","html_id":"use-model-to-make-predictions","implicit":true,"key":"vPdsZi06m7"}],"key":"NvZidIpwZ5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"########################################\n# Making predictions and evaluating the model\n#######################################\n\n# Predicting the Test set results\ny_pred = model.predict(x_test)\ny_pred[y_pred > 0.9] = 1","key":"hZol2GZ2lc"},{"type":"outputs","id":"1PJXFm4Kv1K6Q3jasdNtF","children":[],"key":"aEj4vYYHia"}],"key":"L1iVvearfT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_pred[y_pred > 0.9] = 1\ny_pred[y_pred <= 0.9] = 0","key":"Ma9NMqxFsS"},{"type":"outputs","id":"rX8Y7rB7G8iarWliqWZI2","children":[],"key":"ovxcca7o8Z"}],"key":"RwZ0uiXKnf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_pred.shape","key":"m227VyyZl2"},{"type":"outputs","id":"LKnjYYgXPF4OiTuAlgF7C","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"text/plain":{"content":"(10000, 10)","content_type":"text/plain"}}},"children":[],"key":"KVIGOsQAza"}],"key":"Ono4RyXyJs"}],"key":"Rf4K26z9so"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_pred[0]","key":"GhnW1O63Iu"},{"type":"outputs","id":"pdIiCNW5-uUpV0wTQT_C3","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":52,"metadata":{},"data":{"text/plain":{"content":"array([0., 0., 0., 0., 0., 0., 0., 1., 0., 0.], dtype=float32)","content_type":"text/plain"}}},"children":[],"key":"c0AHsndtFV"}],"key":"T1w87NDJHC"}],"key":"tBS8OVNlHc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# summarize the middle 5 cases in a table\n\nfor i in range(15,20):\n    print('actual   ', end=' ')\n    for j in range(10):\n        print('{:.1f}'.format(y_test[i][j]), end=' ')\n    print()\n    print('predicted', end=' ')\n    for j in range(10):\n        print('{:.1f}'.format(y_pred[i][j]), end=' ')\n    print()\n    print()","key":"jYovrCpVep"},{"type":"outputs","id":"Hqoe1khLwpvVdVevrbnuj","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"actual    0.0 0.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 \npredicted 0.0 0.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 \n\nactual    0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0 \npredicted 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0 \n\nactual    0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0 0.0 0.0 \npredicted 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0 0.0 0.0 \n\nactual    0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 \npredicted 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 \n\nactual    0.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 0.0 \npredicted 0.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 0.0 \n\n"},"children":[],"key":"uZiiPZbEAa"}],"key":"PYLbTSEg8n"}],"key":"PsJt9I0tQM"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Making the Confusion Matrix","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tqZxlQF9sT"}],"identifier":"making-the-confusion-matrix","label":"Making the Confusion Matrix","html_id":"making-the-confusion-matrix","implicit":true,"key":"R0Wtd78HX9"}],"key":"rncoHfH29g"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_pred[0]","key":"sHytZp1MzD"},{"type":"outputs","id":"pFj5YQyCqRuOMYrJcikdp","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":54,"metadata":{},"data":{"text/plain":{"content":"array([0., 0., 0., 0., 0., 0., 0., 1., 0., 0.], dtype=float32)","content_type":"text/plain"}}},"children":[],"key":"ikWl23LFbR"}],"key":"mewcQhMM9h"}],"key":"zLDZlhvhB9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_test[0]","key":"lLO5BVf3J8"},{"type":"outputs","id":"YV13BuT_04BSE7Qqu4qD4","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":55,"metadata":{},"data":{"text/plain":{"content":"array([0., 0., 0., 0., 0., 0., 0., 1., 0., 0.], dtype=float32)","content_type":"text/plain"}}},"children":[],"key":"E569OAaWUA"}],"key":"DvFSPQIrUv"}],"key":"Md9ybtLWdd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_pred.shape","key":"CNgBPQsxcT"},{"type":"outputs","id":"jpA17QnoftfnVTB9Btd4S","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":56,"metadata":{},"data":{"text/plain":{"content":"(10000, 10)","content_type":"text/plain"}}},"children":[],"key":"wbzyjKev9m"}],"key":"T66D8YR96Z"}],"key":"If8x4WoKJt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_test.shape","key":"Vh7DW68bmA"},{"type":"outputs","id":"uq1mnF9eJ7MYDw7hSLCW-","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":57,"metadata":{},"data":{"text/plain":{"content":"(10000, 10)","content_type":"text/plain"}}},"children":[],"key":"NdOUXg7dym"}],"key":"D4qWqkcofk"}],"key":"tN24w1YPzu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Convert one-hot encoded arrays to label indices\ny_pred_labels = np.argmax(y_pred, axis=1)\ny_test_labels = np.argmax(y_test, axis=1)","key":"lactyBxv3T"},{"type":"outputs","id":"YL4oa49ty-7Er1e-hmOBs","children":[],"key":"th8PtHE6g7"}],"key":"iXda3MRkLy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_pred_labels[0:15]","key":"w9hgbtuQsn"},{"type":"outputs","id":"6JmBp6Ur9RA1jVBYTgXAt","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":59,"metadata":{},"data":{"text/plain":{"content":"array([7, 2, 1, 0, 4, 1, 4, 9, 5, 9, 0, 6, 9, 0, 1], dtype=int64)","content_type":"text/plain"}}},"children":[],"key":"TLYc0sesQr"}],"key":"xQ2btI7Hrx"}],"key":"VIlIiOajvM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_test_labels[0:15]","key":"OintOzZbkZ"},{"type":"outputs","id":"YKO19xS51CPoIpSl-whjl","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":60,"metadata":{},"data":{"text/plain":{"content":"array([7, 2, 1, 0, 4, 1, 4, 9, 5, 9, 0, 6, 9, 0, 1], dtype=int64)","content_type":"text/plain"}}},"children":[],"key":"ACzZXn2oFD"}],"key":"GDoJQY2rvg"}],"key":"Pp5ZC2BOhR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Making the Confusion Matrix\ncm = confusion_matrix(y_test_labels, y_pred_labels)\nprint('Print the Confusion Matrix:')\nprint(cm)","key":"rTnHLFgB4W"},{"type":"outputs","id":"_KVh3s8u-SqxzzPPbxkC1","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Print the Confusion Matrix:\n[[ 977    0    0    0    0    0    1    1    1    0]\n [   8 1127    0    0    0    0    0    0    0    0]\n [  30    2  998    0    1    0    0    1    0    0]\n [  25    0    0  985    0    0    0    0    0    0]\n [  30    0    0    0  951    0    0    0    0    1]\n [  23    0    0    1    0  867    1    0    0    0]\n [  34    1    0    0    1    3  919    0    0    0]\n [  31    0    1    0    0    0    0  996    0    0]\n [  56    0    2    1    0    0    0    2  911    2]\n [  41    2    0    0    1    0    0    0    0  965]]\n"},"children":[],"key":"ia76uAboWW"}],"key":"YpHxpiK2lo"}],"key":"FhA4ipL4C1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(classification_report(y_test_labels, y_pred_labels))","key":"hHvemQ1JGr"},{"type":"outputs","id":"4cyJuGJxQjgR1Gc5mHw8c","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"              precision    recall  f1-score   support\n\n           0       0.78      1.00      0.87       980\n           1       1.00      0.99      0.99      1135\n           2       1.00      0.97      0.98      1032\n           3       1.00      0.98      0.99      1010\n           4       1.00      0.97      0.98       982\n           5       1.00      0.97      0.98       892\n           6       1.00      0.96      0.98       958\n           7       1.00      0.97      0.98      1028\n           8       1.00      0.94      0.97       974\n           9       1.00      0.96      0.98      1009\n\n    accuracy                           0.97     10000\n   macro avg       0.98      0.97      0.97     10000\nweighted avg       0.98      0.97      0.97     10000\n\n"},"children":[],"key":"xXIrUJxypL"}],"key":"AdQl6tfugK"}],"key":"hHe9oksQFd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"disp = ConfusionMatrixDisplay(confusion_matrix=cm, display_labels=np.arange(10))\ndisp.plot()\nplt.savefig('confusion_matrix_baseline.png')\nplt.show()","key":"lpkHwUPdd9"},{"type":"outputs","id":"dN_ii8EBRps-rrcHpF2wx","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fd43804ac8b6851f52b02e2fd04b6cf6","path":"/build/fd43804ac8b6851f52b02e2fd04b6cf6.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"cc3D1vVBat"}],"key":"WMGh0UqUO4"}],"key":"oi8LUSuU1i"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot The Accuracy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XJR6n7uGEI"}],"identifier":"plot-the-accuracy","label":"Plot The Accuracy","html_id":"plot-the-accuracy","implicit":true,"key":"bh9ihE8bTK"}],"key":"Z35g3VaLLG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print('Plot the accuracy')\n# Keras 2.2.4 recognizes 'acc' and 2.3.1 recognizes 'accuracy'\n# use the command python -c 'import keras; print(keras.__version__)' on MAC or Linux to check Keras' version\nplt.plot(model_history.history['accuracy'], label='Training Accuracy')\n#plt.plot(model_history.history['val_accuracy'], label='Validation Accuracy')\nplt.title('5x5 Kernel Model Accuracy')\nplt.ylabel('Accuracy')\nplt.xlabel('Epoch')\nplt.yticks(np.arange(0.9, 1.2, step=0.01))\nplt.xticks(np.arange(0, 14, step=1))\nplt.ylim(0.9, 1)\nplt.xlim(0, 12)\nplt.grid()\nplt.legend(loc='lower right')\nplt.savefig('task2_model_accuracy.png')\nplt.show()","key":"Zx5hRPvAzF"},{"type":"outputs","id":"3RM71svrfzGvVJlDHg-j4","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Plot the accuracy\n"},"children":[],"key":"jCQHWnPIzG"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6bf65c0e421032d74a4445f892d110fe","path":"/build/6bf65c0e421032d74a4445f892d110fe.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"SL9tR6LIH7"}],"key":"GsLnyIkDPx"}],"key":"O9EUWkvrlX"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the Loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tcbda8IxRF"}],"identifier":"plot-the-loss","label":"Plot the Loss","html_id":"plot-the-loss","implicit":true,"key":"xMfGEg6Zfr"}],"key":"pW7vxUHH17"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print('Plot the loss')\nplt.plot(model_history.history['loss'], label='Training Loss')\n#plt.plot(model_history.history['val_loss'], label='Validation Loss')\nplt.title('5x5 Kernel Model Loss')\nplt.ylabel('Loss')\nplt.xlabel('Epoch')\nplt.yticks(np.arange(0, 0.40, step=0.025))\nplt.xticks(np.arange(0, 14, step=1))\nplt.ylim(0, 0.35)\nplt.xlim(0, 12)\nplt.grid()\nplt.legend(loc='upper right')\nplt.savefig('task2_model_loss.png')\nplt.show()","key":"VF0RvJ9A3J"},{"type":"outputs","id":"JNBrShPtU_3mUB87lbfR1","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Plot the loss\n"},"children":[],"key":"DjeaAv9rOY"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c291a9c8546889c28e64337088e46501","path":"/build/c291a9c8546889c28e64337088e46501.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"lAqd6pgqHr"}],"key":"o7LZf5ZBus"}],"key":"AwgxYLxUBW"}],"key":"D3957bxrUC"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"CSE572 Statistical Machine Learning - Project 2 - K Means Clustering Strategy Project","url":"/sections/mcs-projects/cse575-stats-ml/project-2/project-2","group":"Master's in Computer Science (Cybersecurity) Projects"},"next":{"title":"Master of Science in Engineering: Electrical Engineering - Projects","url":"/sections/mse-projects/mse-projects-head","group":"Master of Science in Engineering - Electrical Engineering Projects"}}},"domain":"http://localhost:3001"}