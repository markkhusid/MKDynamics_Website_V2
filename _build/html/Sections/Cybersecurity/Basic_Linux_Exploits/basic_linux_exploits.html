
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Basic Linux Exploits &#8212; MK Dynamics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-BZ3C1QVH0B"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-BZ3C1QVH0B');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-BZ3C1QVH0B');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Sections/Cybersecurity/Basic_Linux_Exploits/basic_linux_exploits';</script>
    <link rel="icon" href="../../../_static/spacey.jpg"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Disassembling Binaries" href="../Disassembling_Binaries/disassembling_binaries.html" />
    <link rel="prev" title="Cybersecurity" href="../cybersecurity.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/spacey.jpg" class="logo__image only-light" alt="MK Dynamics - Home"/>
    <img src="../../../_static/spacey.jpg" class="logo__image only-dark pst-js-only" alt="MK Dynamics - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../intro.html">
                    MK Dynamics
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Cybersecurity</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../cybersecurity.html">Cybersecurity</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Basic Linux Exploits</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Disassembling_Binaries/disassembling_binaries.html">Disassembling Binaries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../Disassembling_Binaries/Fortran/fortran.html">Fortran</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../Disassembling_Binaries/Fortran/ARM64/arm64.html">ARM 64 Bit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Disassembling_Binaries/Fortran/ARM32/arm32.html">ARM32</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Disassembling_Binaries/Fortran/AMD64/amd64.html">AMD64</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Disassembling_Binaries/Fortran/i386/i386.html">Intel 32 - Bit</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../Disassembling_Binaries/C/c.html">C</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Disassembling_Binaries/C%2B%2B/c%2B%2B.html">C++</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Disassembling_Binaries/Ada/ada.html">Ada</a></li>
<li class="toctree-l3"><a class="reference internal" href="../Disassembling_Binaries/Pascal/pascal.html">Pascal</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../LiveOverflow/liveoverflow.html">LiveOverflow</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../Protostar/protostar.html">Protostar Exploit Exercises</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../Protostar/Stack0/stack0.html">Stack 0</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../Protostar/Stack0/Stack0_x86/stack0_x86.html">x86 32-Bit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Protostar/Stack0/Stack0_AMD64/stack0_AMD64.html">AMD64</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Protostar/Stack0/Stack0_ARM32/stack0_ARM32.html">ARM 32 - Bit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Protostar/Stack0/Stack0_ARM64/stack0_ARM64.html">ARM 64 - Bit</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../SLAE64/SLAE64.html">SLAE64 - x86_64 Assembly Language and Shellcoding on Linux</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../SLAE64/Modules/Module_1/Section_3_GDB_Test/section_3_GDB_test.html">Lesson 3 - GDB Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../SLAE64/Modules/Module_1/Section_5_Hello_World/section_5_hello_world.html">Section 5 - Hello World</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../Shellcode_Generation_and_Testing/shellcode_generation_and_testing.html">Shellcode Generation and Testing</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Computer Programming</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Computer_Programming/computer_programming.html">Computer Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Computer_Programming/Assembly/assembly.html">Assembly Language Programming</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Computer_Programming/CPP/cpp.html">C++ Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Computer_Programming/CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp__HEAD__.html">Object Oriented Programming Using C++</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_1.html">Chapter 1: Why Object-Oriented Programming in C++?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_2.html">Chapter 2: Native Types and Statements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_3.html">Chapter 3: Functions and Pointers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_4.html">Chapter 4: Implementing ADTs in the Base Language</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_5.html">Chapter 5: Data Hiding and Member Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_6.html">Chapter 6: Object Creation and Destruction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_7.html">Chapter 7: Ad Hoc Polymorphism</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Computer_Programming/Fortran/fortran.html">Fortran Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Computer_Programming/Fortran/Modern_Fortran/modern_fortran.html">Modern Fortran</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Modern_Fortran/Cold_Front_Calculator.html">Cold Front Calculator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Modern_Fortran/Cold_Front_Calculator_with_Loop.html">Cold Front Calculator With Loop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Modern_Fortran/Tsunami_Simulator.html">Tsunami Simulator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Modern_Fortran/Tsunami_Simulator_Plotter.html">Tsunami Simulator Plotter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Modern_Fortran/Tsunami_Simulator_with_Modules.html">Tsunami Simulator with Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Modern_Fortran/Tsunami_Simulator_with_Modules_Plotter.html">Tsunami Simulator with Modules Plotter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Modern_Fortran/Print_Compiler_Version.html">Print Compiler Version</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Modern_Fortran/Analyzing_Time_Series_Data_with_Arrays.html">Analyzing Time Series Data with Arrays</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Computer_Programming/Fortran/Intro_to_Fortran/intro_to_fortran.html">Introduction to Programming Using Fortran</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Intro_to_Fortran/Section_7_Period_Calculator.html">Section 7: Pendulum Period Calculator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Intro_to_Fortran/Section_9_3_SOS_Difference.html">Section 9.3: Difference Between Sum of Squares and Square of Sums</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Intro_to_Fortran/Section_12_8_Line_Numbers.html">Section 12.8: Line Numbers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Intro_to_Fortran/Section_14_Pi_Estimation.html">Section 14: Pi Estimation</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Computer_Programming/Fortran/Guide_to_Fortran_2008_Programming/guide_to_fortran_2008_programming.html">Guide to Fortran 2008 Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Guide_to_Fortran_2008_Programming/Section_1_8_Ex_2_Quadratic_Formula.html">Section 1.8 Example 2: Quadratic Equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Guide_to_Fortran_2008_Programming/Section_1_16_Factorial_Recursion.html">Section 1.16: Factorial Recursion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Guide_to_Fortran_2008_Programming/Section_2_1_Associate_Construct.html">Section 2.1: Statement Blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Guide_to_Fortran_2008_Programming/Section_2_1_Statement_Blocks.html">Section 2.1: Associate Construct</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Guide_to_Fortran_2008_Programming/Section_3_4_Putting_Procedures_in_a_Module.html">Section 3.4: Putting Procedures in a Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Guide_to_Fortran_2008_Programming/Section_3_6_Ex_1_Median_of_Three.html">Section 3.6: Median of Three</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Guide_to_Fortran_2008_Programming/Section_3_8_Argument_Passing.html">Section 3.8: Argument Passing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Guide_to_Fortran_2008_Programming/Section_3_17_Case_Study__Adaptive_Numberical_Integration.html">Section 3.17: Case Study: Adaptive Numerical Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Guide_to_Fortran_2008_Programming/Section_4_1_Elsewhere_Example.html">Section 4.1: Elsewhere Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Guide_to_Fortran_2008_Programming/Section_8_1_Submodules.html">Section 8.1: Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Guide_to_Fortran_2008_Programming/Section_8_2_Time_Matrix_Multiply.html">Section 8.2: Time Matrix Multiply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Guide_to_Fortran_2008_Programming/Section_8_7_Generic_Elemental_Procedures.html">Section 8.7: Generic Elemental Procedures</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Guide_to_Fortran_2008_Programming/Section_8_8_Findloc_Function.html">Section 8.8: Findloc Function</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Computer_Programming/Fortran/Fortran_MOOC/fortran_mooc.html">Fortran MOOC</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Fortran_MOOC/Section_Arrays.html">Section: Arrays</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Fortran_MOOC/Section_Ball_Throw__Head__.html">Section: Ball Throw</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Fortran_MOOC/Section_Bit_Manipulations__Head__.html">Section: Bit Manipulations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Fortran_MOOC/Section_Floating_Point.html">Section: Floating Point</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Fortran_MOOC/Section_Call_By_Semantics.html">Section: Call By Semantics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Fortran_MOOC/Section_Computing_Pi.html">Section: Computing Pi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Fortran_MOOC/Section_Implicit_vs_Explicit_Loops__Head__.html">Section: Implicit vs Explicit Loops</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Fortran_MOOC/Section_Block_Matrices__Head__.html">Section: Block Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/Fortran_MOOC/Section_BLAS_LAPACK__Head__.html">Section: BLAS/LAPACK</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Computer_Programming/Fortran/DFFT/DFFT.html">Discretized Fourier Transform of Arbitrary Signal Using FFTW3 in Fortran</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/DFFT/Sine_Wave_10_Hz/sine_wave_10_hz.html">Sine Wave at 10Hz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/DFFT/Square_Wave_1_Hz_50_pct/square_wave_1_hz_50_pct.html">Square Wave at 1Hz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/DFFT/2_Sine_Waves/2sineXHz.html">Two Sine Waves with Different Frequencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/DFFT/Switched_Sine_Wave_1_kHz/switched_sine_wave_1_kHz.html">Switched 1 kHz Sine Wave</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Computer_Programming/Fortran/CSV_Fortran/CSV_Fortran__HEAD__.html">CSV Fortran Module</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/CSV_Fortran/csv_fortran_read_csv.html">Section: Read CSV Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Fortran/CSV_Fortran/csv_fortran_write_csv.html">Section: Write CSV Files</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../Computer_Programming/Javascript/javascript.html">Javascript Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Computer_Programming/PHP/php.html">PHP Programming</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Computer_Programming/Python/python.html">Python Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Computer_Programming/Python/Python_Playground/Python_Playground__HEAD__.html">Python Playground: Geeky Projects for the Curious Programmer</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Python/Python_Playground/Section_Chapter_2_Draw_Circle.html">Chapter 2: Draw Circle using Turtle Graphics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Python/Python_Playground/Section_Chapter_2_Draw_Spiro.html">Chapter 2: Draw Spiro using Turtle Graphics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Python/Python_Playground/Section_Chapter_3_Conway.html">Chapter 3: Conway’s Game of Life</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Computer_Programming/Python/Python_Playground/Section_Chapter_4_Karplus_Strong.html">Chapter 4: Karplus Strong Algorithm</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Electronics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Electronics/electronics.html">Electronics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Electronics/Analog_and_Digital/analog_and_digital.html">Analog and Digital Electronics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../Electronics/Analog_and_Digital/AD9850_DDS/AD9850_DDS.html">Variable Frequency Oscillator Using Direct Digital Synthesis</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../Electronics/Dual_Diode_Box/dual_diode_box.html">Dual Diode Box</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Electronics/Single_Board_Computers_Running_Linux/single_board_computers_running_linux.html">Single Board Computers Running Linux</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Finite Element Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Finite_Element_Analysis/finite_element_analysis.html">Finite Element Analysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Finite_Element_Analysis/CAELinux_for_Thermal_Analysis/caelinux_for_thermal_analysis.html">CAELinux for Thermal Analysis</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Ham Radio</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Ham_Radio/ham_radio.html">Ham Radio</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Ham_Radio/Ham_Radio_Projects/ham_radio_projects.html">Ham Radio Projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Ham_Radio/Antenna_Simulation_using_4NEC2/antenna_simulation_using_4NEC2.html">Antenna Simulation using 4NEC2</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">About Me</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../About_Me/aboutme.html">About Me</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../About_Me/Resume/resume.html">My Resume</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../About_Me/Certificates/certificates.html">My Certificates</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../About_Me/Certificates/certificates_coursera.html">Coursera Certificates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../About_Me/Certificates/certificates_kaggle.html">Kaggle Certificates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../About_Me/Certificates/certificates_tryhackme.html">Try Hack Me Certificates</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Website Updates</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../Website_Updates/website_updates.html">Website Updates</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Misc/misc__head__.html">Miscellaneous Home</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../Misc/useful_links.html">Useful Links</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../Misc/cybersecurity_links.html">Cybersecurity Online Resources</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/markkhusid/MKDynamics_Website_V2" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/markkhusid/MKDynamics_Website_V2/issues/new?title=Issue%20on%20page%20%2FSections/Cybersecurity/Basic_Linux_Exploits/basic_linux_exploits.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/Sections/Cybersecurity/Basic_Linux_Exploits/basic_linux_exploits.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Basic Linux Exploits</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resources-used">Resources Used</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smashing-the-stack-of-a-vulnerable-program-and-causing-a-buffer-overflow">Smashing the Stack of a Vulnerable Program and Causing a Buffer Overflow</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#brief-synopsis-of-meet-c">Brief synopsis of meet.c</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#disabling-address-space-layout-randomization-aslr">Disabling Address Space Layout Randomization (ASLR)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smashing-the-stack-of-a-vulnerable-program-and-causing-a-buffer-overflow-overflowing-the-buffer-of-the-vulnerable-program-meet-c">Smashing the Stack of a Vulnerable Program and Causing a Buffer Overflow - Overflowing the Buffer of the Vulnerable Program meet.c</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compiling-meet-c-with-nx-disabled-with-debugging-information-and-static-compilation">Compiling meet.c with NX disabled, with debugging information and static compilation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-executable-meet-normally">Running the executable <em>meet</em> normally</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fuzzing-the-inputs-to-the-executable-meet">Fuzzing the inputs to the executable <em>meet</em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inserting-shellcode-into-a-vulnerable-processs-from-the-command-line-to-obtain-a-command-shell">Inserting Shellcode into a Vulnerable Processs from the Command Line to Obtain a Command Shell</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#breaking-down-the-attack-string-in-detail">Breaking Down the Attack String in Detail</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-of-the-cmd-cmd-cmd-cmd-format">Use of the “$(<em>cmd</em>; <em>cmd</em>; <em>cmd</em>; <em>cmd</em>)” format</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-to-craft-an-attack-string">Using “$()” to craft an attack string</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#putting-it-all-together">Putting it all together</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discovering-the-memory-address-of-the-buffer-we-wish-to-overflow">Discovering the memory address of the buffer we wish to overflow</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-how-many-bytes-we-need-to-inject-into-the-vulnerable-buffer-to-overwrite-the-instruction-pointer-eip">Calculating how many bytes we need to inject into the vulnerable buffer to overwrite the instruction pointer EIP.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#state-of-execution-just-before-the-saved-eip-is-popped-off-of-the-stack-and-execution-is-supposed-to-return-back-to-the-main-function-in-the-executable-meet-according-to-the-gef-ui-for-gdb">State of execution just before the saved EIP is popped off of the stack, and execution is supposed to return back to the main function in the executable <em>meet</em>, according to the GEF UI for GDB.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#state-of-execution-just-before-the-saved-eip-is-popped-off-of-the-stack-and-execution-is-supposed-to-return-back-to-the-main-function-in-the-executable-meet-according-to-the-peda-ui-for-gdb">State of execution just before the saved EIP is popped off of the stack, and execution is supposed to return back to the main function in the executable <em>meet</em>, according to the PEDA UI for GDB.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#discovering-the-memory-address-of-the-stack">Discovering the memory address of the stack</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variations-in-the-top-of-the-stack-with-multiple-attack-attempts-from-the-command-line">Variations in the top of the stack with multiple attack attempts from the command line</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-small-program-that-displays-the-current-state-of-the-stack-pointer">A small program that displays the current state of the stack pointer</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="basic-linux-exploits">
<h1>Basic Linux Exploits<a class="headerlink" href="#basic-linux-exploits" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>In the realm of cybersecurity, understanding how to exploit vulnerabilities is crucial for both offensive and defensive roles. This guide aims to provide a basic understanding of Linux exploits, with a particular focus on buffer overflows.</p>
<p>Buffer overflows are a common type of software vulnerability where an application writes more data to a buffer than it can hold, causing the excess data to overflow into adjacent memory spaces. This can lead to erratic program behavior, including memory access errors, incorrect results, program termination, or a breach of system security.</p>
<p>Throughout this guide, we will delve into the mechanics of buffer overflows, demonstrate how they can be exploited, and discuss strategies for prevention. We will also explore how to inject shellcode into a vulnerable program from the command line, investigate errors, and debug these errors with the Gnu DeBugger (GDB).</p>
<p>This guide is intended for educational purposes only. The techniques and concepts discussed should only be applied in controlled environments or for legitimate cybersecurity activities such as penetration testing or vulnerability assessments.</p>
</section>
<section id="resources-used">
<h2>Resources Used<a class="headerlink" href="#resources-used" title="Link to this heading">#</a></h2>
<p>This section will borrow heavily from “Gray Hat Hacking, The Ethical Hacker’s Handbook”, by Regaldo, et. al, McGraw Hill, 4th. Edition.<br />
<a class="reference external" href="https://www.amazon.com/Hacking-Ethical-Hackers-Handbook-Fourth/dp/0071832386/ref=sr_1_2?ie=UTF8&amp;amp;qid=1540671368&amp;amp;sr=8-2&amp;amp;keywords=gray+hat+hacking">Gray Hat Hacking (Amazon)</a></p>
<p>Note that there is a 5th Edition available at the time of this writing.</p>
<p>We will also make use of the classic discussion on Buffer Overflows by Aleph One.<br />
<a class="reference external" href="https://insecure.org/stf/smashstack.html">Aleph One’s Classic on Buffer Overflows.</a></p>
<p>We will also use tips and tricks from the following:</p>
<p>Open Security Training’s course on Introduction to Exploits 1<br />
<a class="reference external" href="http://www.opensecuritytraining.info/">Open Security Training</a></p>
<p>“The Shellcoder’s Handboook”, by Anley et. al, Wiley, 2nd Edition<br />
<a class="reference external" href="https://www.amazon.com/Shellcoders-Handbook-Discovering-Exploiting-Security/dp/047008023X/ref=sr_1_2?ie=UTF8&amp;amp;qid=1540671203&amp;amp;sr=8-2&amp;amp;keywords=the+shellcoders+handbook">The Shellcoder’s Handbook (Amazon)</a></p>
<section id="smashing-the-stack-of-a-vulnerable-program-and-causing-a-buffer-overflow">
<h3>Smashing the Stack of a Vulnerable Program and Causing a Buffer Overflow<a class="headerlink" href="#smashing-the-stack-of-a-vulnerable-program-and-causing-a-buffer-overflow" title="Link to this heading">#</a></h3>
<p>The following image was taken from the following presentation:</p>
<p>Stack-Based Buffer Overflows Attacker<br />
By: Laurence Davis<br />
<a class="reference external" href="https://slideplayer.com/slide/4775349/">Stack-Based Buffer Overflows</a></p>
<figure class="align-center" id="buffer-overflow-image-jpeg">
<a class="reference internal image-reference" href="../../../_images/buffer_overflow_image.jpeg"><img alt="buffer_overflow_image.jpeg" src="../../../_images/buffer_overflow_image.jpeg" style="width: 1200px; height: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">Buffer overflow corrupting return address on the stack</span><a class="headerlink" href="#buffer-overflow-image-jpeg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>By overfilling the function’s local variables with data, one is able to overwrite the saved EIP (return pointer in the figure). This is a vulnerability in the way the kernel and C compiler handles function calls, because shellcode can be inserted onto the stack and the saved return address may be overwritten to point to the shellcode. However, as seen in the section on Shellcoding, modern kernels will not allow execution of data on the stack. So even though this vulnerability has for the most part been patched, we will still learn it because fundamentally, it is the basis for many such vulnerabilities, found even in modern kernels.</p>
<p>We will now investigate exploiting this vulnerability with a simple vulnerable C test program called <em>meet.c</em> shown below.</p>
<p>The vulnerable C program: meet.c</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span><span class="c1">                              // needed for screen printing</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string.h&gt;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">greeting</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">temp1</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">temp2</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">    </span><span class="c1">// greeting function to say hello</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">name</span><span class="p">[</span><span class="mi">400</span><span class="p">];</span><span class="w">                             </span><span class="c1">// string variable to hold name</span>
<span class="w">    </span><span class="n">printf</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;The address of the name array is: %p</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="n">name</span><span class="p">);</span><span class="w">		</span><span class="c1">// for diagnostics</span>
<span class="w">    </span><span class="n">printf</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;The address of temp1 is: %p</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp1</span><span class="p">);</span><span class="w">			</span><span class="c1">// for diagnostics</span>
<span class="w">    </span><span class="n">printf</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;The address of temp2 is: %p</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;</span><span class="n">temp2</span><span class="p">);</span><span class="w">			</span><span class="c1">// for diagnostics</span>
<span class="w">    </span><span class="n">strcpy</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">temp2</span><span class="p">);</span><span class="w">                       </span><span class="c1">// copy the function argumemt to name</span>
<span class="w">    </span><span class="n">printf</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;Hello %s %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">temp1</span><span class="p">,</span><span class="w"> </span><span class="n">name</span><span class="p">);</span><span class="w">      </span><span class="c1">// print out the greeting</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">argv</span><span class="p">[])</span><span class="w"> </span><span class="p">{</span><span class="w">           </span><span class="c1">// note the format for the argumemts</span>
<span class="w">    </span><span class="n">greeting</span><span class="w"> </span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span><span class="w">                </span><span class="c1">// call function, pass title and name</span>
<span class="w">    </span><span class="n">printf</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;Bye %s %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span><span class="w">   </span><span class="c1">// say &quot;bye&quot;</span>
<span class="p">}</span><span class="w">                                               </span><span class="c1">// exit program</span>
</pre></div>
</div>
<p><a class="reference download internal" download="" href="../../../_downloads/43f936978eed5af25f2bcad86ad3aef8/meet.c"><span class="xref download myst">Click here to download meet.c</span></a></p>
</section>
<section id="brief-synopsis-of-meet-c">
<h3>Brief synopsis of meet.c<a class="headerlink" href="#brief-synopsis-of-meet-c" title="Link to this heading">#</a></h3>
<p>In the program <em>meet.c</em>, we include string.h in order to make use of the vulnerable strcpy command. The format of the strcpy command is as follows:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">strcpy</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">dest</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">src</span><span class="p">);</span>
</pre></div>
</div>
<p>From the man page for strcpy:</p>
<blockquote>
<div><p><em>The strcpy() function copies the string pointed to by src, including the terminating null byte (‘\0’), to the buffer pointed to by dest. The strings may not overlap, and the destination string dest must be large enough to receive the copy. Beware of buffer overruns!</em></p>
</div></blockquote>
<p>The program’s main function reads in two arguments, which are stored in the argv array of strings. They are argv[1] and argv[2] for the first and second arguments, respectively.</p>
<p>The main function calls a function called <em>greeting</em>. Greeting has a local variable that is 400 bytes long called <em>name</em>. This local variable acts like an input buffer. In order to aid in understanding the memory layout of this program, I have added three diagnostic statements that print out the memory addresses of the local variable <em>name</em>, as well as the two function arguments, <em>temp1</em> and <em>temp2.</em></p>
<p>Now this is where things get interesting. For educational purposes, the VERY vulnerable <em>strcpy</em> function is called from within the function called <em>greeting</em>. What <em>strcpy</em> will do is to copy the argument <em>temp2</em> into the buffer <em>name</em>, WITHOUT any bounds checking. This means that if the argument <em>temp2</em> is carefully crafted, the buffer <em>name</em> can be overflowed. When it is overflowed, it will overwrite adjacent data, which includes the return address to the calling function main!</p>
<p>Normally used, the function called <em>greeting</em> then prints out the string Hello, followed by the first argument, and the contents of the buffer called <em>name</em>. Control is then returned back to the main function, which prints out the string, Bye, followed by the first and second arguments from the command line. We will now investigate attacking the aforementioned built-in vulnerability in this program. But first, we must set up the environment.</p>
</section>
<section id="disabling-address-space-layout-randomization-aslr">
<h3>Disabling Address Space Layout Randomization (ASLR)<a class="headerlink" href="#disabling-address-space-layout-randomization-aslr" title="Link to this heading">#</a></h3>
<p>As mentioned previously, modern Linux kernels use several strategies to overcome vulnerabilities such as buffer overflows. One of these strategies is known as Address Space Layout Randomization (ASLR). Essentially, the kernel randomizes the process’s address space, which includes the stack, thereby precluding the ability to brute force overwriting of the stored return address on the stack. Every attempt will require injection of a new malicious address that points back to the shellcode. This is extremely difficult to guess, if not impossible.</p>
<p>Another strategy is to simply not allow execution of data on the stack. Since the buffer and hence the injected shellcode resides entirely on the stack, execution of the shellcode will not be allowed by the kernel, and the process will crash.</p>
<p>To get around such protections, for pedagogical reasons, we will disable both ASLR and allow execution of data on the stack. This will require either recompiling the C program with executable stack or enabling executable stack at the kernel level. In order to disable ASLR, a bash shell may be opened with the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>setarch<span class="w"> </span>i386<span class="w"> </span>-R<span class="w"> </span>/bin/bash
</pre></div>
</div>
<p>or by disabling ASLR at the kernel level. To minimize variables, it is better to do this at the kernel level; however, this is not a good idea on your main system for security reasons. Therefore, we will spin up a 32-bit Ubuntu virtual machine and disable these protections at the kernel level, as shown in the image below:</p>
<figure class="align-center" id="setting-up-32bit-vm-jpg">
<a class="reference internal image-reference" href="../../../_images/setting_up_32bit_vm.jpg"><img alt="setting_up_32bit_vm.jpg" src="../../../_images/setting_up_32bit_vm.jpg" style="width: 1200px; height: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">Disabling ASLR in the 32-bit Ubuntu Virtual Machine</span><a class="headerlink" href="#setting-up-32bit-vm-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>As can be seen from the screenshot above, it is not directly possible to disable non-executable stack or data execution protections, also called NX. This must be done at the UEFI or BIOS level. It is however, possible to disable ASLR by using the command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;0&quot;</span>&gt;<span class="w"> </span>/proc/sys/kernel/randomize<span class="se">\_</span>va<span class="se">\_</span>space
</pre></div>
</div>
<p>In order test that the process’ address space is not randomized, we issue the following command a few times and observe that the address space is constant between issuing the command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cat<span class="w"> </span>/proc/self/maps
</pre></div>
</div>
<p>[…. memory layout table ….]</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cat<span class="w"> </span>/proc/self/maps<span class="w">  </span>
</pre></div>
</div>
<p>[…. unchanged memory layout table ….]</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>cat<span class="w"> </span>/proc/self/maps
</pre></div>
</div>
<p>[…. unchanged memory layout table ….]</p>
<p>The following screenshot shows these commands in the 32-bit Ubuntu VM:</p>
<figure class="align-center" id="vm-mem-map-info-aslr-off-jpg">
<a class="reference internal image-reference" href="../../../_images/VM_mem_map_info_ASLR_off.jpg"><img alt="VM_mem_map_info_ASLR_off.jpg" src="../../../_images/VM_mem_map_info_ASLR_off.jpg" style="width: 1200px; height: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">Process memory map showing no randomization of address space layout</span><a class="headerlink" href="#vm-mem-map-info-aslr-off-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>As can be seen from the above screenshot, the address space layout is not randomized. Each invocation of the cat /proc/self/maps command produces the same results. Of particular interest is that the stack’s address remains constant at:</p>
<blockquote>
<div><p>bffdf000-c0000000 rw-p 00000000 00:00 0 [stack]</p>
</div></blockquote>
<p>Notice that the stack has permissions of rw, but not exectute.</p>
<p>In order to overcome the inability to disable non-executable (NX) stack or data segments at the kernel level, we will have to remember to issue special directives to the compiler when compiling vulnerable programs. These compiler directives are:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gcc<span class="w"> </span>..._<span class="se">\-</span>zexecstack<span class="w"> </span>-fno-stack-protector_...
</pre></div>
</div>
<p>The directive <em>-zexecstack</em> tells the compiler to enable an executable stack, while the directive <em>-fno-stack-protector</em> tells the compiler to disable stack corruption protections.</p>
<p>We are now ready to attempt to overflow the buffer of the vulnerable program from the command line.</p>
</section>
</section>
<section id="smashing-the-stack-of-a-vulnerable-program-and-causing-a-buffer-overflow-overflowing-the-buffer-of-the-vulnerable-program-meet-c">
<h2>Smashing the Stack of a Vulnerable Program and Causing a Buffer Overflow - Overflowing the Buffer of the Vulnerable Program meet.c<a class="headerlink" href="#smashing-the-stack-of-a-vulnerable-program-and-causing-a-buffer-overflow-overflowing-the-buffer-of-the-vulnerable-program-meet-c" title="Link to this heading">#</a></h2>
<section id="compiling-meet-c-with-nx-disabled-with-debugging-information-and-static-compilation">
<h3>Compiling meet.c with NX disabled, with debugging information and static compilation<a class="headerlink" href="#compiling-meet-c-with-nx-disabled-with-debugging-information-and-static-compilation" title="Link to this heading">#</a></h3>
<p>As described in the previous section, it is first necessary to compile <em>meet.c</em> with executable stack protections off. We will also include lots of debugging information, and we will compile the program with the <em>-static</em> flag, so that all of the called system libraries will be included in the executable. Having all of the called system libraries included tends to aid debugging, since the GNU Debugger (GDB) will not have to jump around memory as much. Finally, we will force 32-bit compilation. Since we will be running the executable on a 32-bit Virtual Machine (VM), this might be a moot point, but we will do it anyway to minimize differences in executable operation among different systems.</p>
<p>To compile meet.c, we issue the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gcc<span class="w"> </span>-m32<span class="w"> </span>-static<span class="w"> </span>-ggdb3<span class="w"> </span>-zexecstack<span class="w"> </span>-fno-stack-protector<span class="w"> </span>-mpreferred-stack-boundary<span class="o">=</span><span class="m">2</span><span class="w"> </span>meet.c<span class="w"> </span>-o<span class="w"> </span>meet
</pre></div>
</div>
<p>The results of this command are shown in the image below:</p>
<figure class="align-center" id="compiling-meet-c-in-vm-jpg">
<a class="reference internal image-reference" href="../../../_images/compiling_meet_c_in_VM.jpg"><img alt="compiling_meet_c_in_VM.jpg" src="../../../_images/compiling_meet_c_in_VM.jpg" style="width: 1200px; height: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4 </span><span class="caption-text">Compiling meet.c statically, with NX disabled and extensive debugging information</span><a class="headerlink" href="#compiling-meet-c-in-vm-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The command we used to compile meet.c had the following arguments:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head text-left"><p>Argument</p></th>
<th class="head text-left"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-left"><p>-m32</p></td>
<td class="text-left"><p>Compile into 32-bit mode.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>-static</p></td>
<td class="text-left"><p>Compile the program statically, with all libraries included within the executable.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>-ggdb3</p></td>
<td class="text-left"><p>Include maximum debugging information.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>-zexecstack</p></td>
<td class="text-left"><p>Allow an executable stack. Basically one part in overiding NX.</p></td>
</tr>
<tr class="row-even"><td class="text-left"><p>-fno-stack-protector</p></td>
<td class="text-left"><p>Disable stack corruption protections. Second part in overiding NX.</p></td>
</tr>
<tr class="row-odd"><td class="text-left"><p>-mpreferred-stack-boundary=2</p></td>
<td class="text-left"><p>Sets the size of each entry in the stack to 2^2=4 bytes long. This makes it easier four our data alignment purposes, since we will be dealing with 32-bit or 4 byte memory locations.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="running-the-executable-meet-normally">
<h3>Running the executable <em>meet</em> normally<a class="headerlink" href="#running-the-executable-meet-normally" title="Link to this heading">#</a></h3>
<p>We run the program <em>meet</em> normally with the arguments Mr Mark as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./meet<span class="w"> </span>Mr<span class="w"> </span>Mark
</pre></div>
</div>
<p>After issuing the command, we get the following output:</p>
<figure class="align-center" id="running-meet-normally-jpeg">
<a class="reference internal image-reference" href="../../../_images/running_meet_normally.jpg"><img alt="running_meet_normally.jpeg" src="../../../_images/running_meet_normally.jpg" style="width: 1200px; height: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5 </span><span class="caption-text">Running the executable meet normally with the arguments Mr Mark</span><a class="headerlink" href="#running-meet-normally-jpeg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>As can be seen from the above screen capture, the program prints out the memory addresses of the buffer we will overflow, which is the 400 byte buffer called <em>name</em>. It also prints out the memory addresses of the two arguments, <em>temp1</em> and <em>temp2</em>. The astute observer will notice that these addresses are actually within the stack segment! Notice also that <em>temp2</em> is exactly 4 bytes away from <em>temp1.</em></p>
<p>The program then prints out the string Hello, followed by the program arguments. Finally, the program prints out the string Bye, followed by the program arguments.</p>
</section>
<section id="fuzzing-the-inputs-to-the-executable-meet">
<h3>Fuzzing the inputs to the executable <em>meet</em><a class="headerlink" href="#fuzzing-the-inputs-to-the-executable-meet" title="Link to this heading">#</a></h3>
<p>To find the size of the buffer, we will increase the number of bytes input into the second argument until the program begins to crash. Actually, we could have tried the first argument, but we would have found that the first argument is very resilient, since it is not actually taking part in the vulnerable strcpy command. This could have been surmised from reverse engineering the binary, if the source code was not available. Below we show what happens even when we inject 500 “A“‘s into the first argument. In the second image, we will attempt to insert 2000 “A“‘s and see what happens.</p>
<figure class="align-center" id="fuzzing-first-arg-to-meet-c-jpg">
<a class="reference internal image-reference" href="../../../_images/fuzzing_first_arg_to_meet_c.jpg"><img alt="fuzzing_first_arg_to_meet_c.jpg" src="../../../_images/fuzzing_first_arg_to_meet_c.jpg" style="width: 1200px; height: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 6 </span><span class="caption-text">Attempt at fuzzing first argument with 500 “A“‘s into the executable <em>meet</em></span><a class="headerlink" href="#fuzzing-first-arg-to-meet-c-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>In the figure above, we first try 10 “A“‘s and then 500 “A“‘s, and nothing seems to break. Again, this is because only the second argument participates in the vulnerable strcpy command. To make absolutely sure, in the figure below, we inject 2000 “A“‘s into the first argument of the executable <em>meet</em>.</p>
<figure class="align-center" id="fuzzing-first-arg-to-meet-c-with-2000-a-jpg">
<a class="reference internal image-reference" href="../../../_images/fuzzing_first_arg_to_meet_c_with_2000_A.jpg"><img alt="fuzzing_first_arg_to_meet_c_with_2000_A.jpg" src="../../../_images/fuzzing_first_arg_to_meet_c_with_2000_A.jpg" style="width: 1200px; height: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 7 </span><span class="caption-text">Attempt at fuzzing first argument with 2000 “A“‘s into the executable <em>meet</em></span><a class="headerlink" href="#fuzzing-first-arg-to-meet-c-with-2000-a-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>In the figure above, nothing seems to break. We therefore focus on the second argument. Our goal is to find the size of the vulnerable buffer, so we start low and work our way up until we encounter a segmentation fault. This fault will indicate that our input has overwritten the return address of the the main function within the executable <em>meet</em>.</p>
<figure class="align-center" id="fuzzing-second-arg-to-meet-c-jpg">
<a class="reference internal image-reference" href="../../../_images/fuzzing_second_arg_to_meet_c.jpg"><img alt="fuzzing_second_arg_to_meet_c.jpg" src="../../../_images/fuzzing_second_arg_to_meet_c.jpg" style="width: 1200px; height: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 8 </span><span class="caption-text">Attempt at fuzzing the second argument with an increasing number of “A“‘s into the executable <em>meet</em></span><a class="headerlink" href="#fuzzing-second-arg-to-meet-c-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Still no segmentation faults. We continue increasing the number of “A“‘s in the figure below.</p>
<figure class="align-center" id="fuzzing-second-arg-to-meet-c-to-get-seg-fault-jpg">
<a class="reference internal image-reference" href="../../../_images/fuzzing_second_arg_to_meet_c_to_get_seg_fault.jpg"><img alt="fuzzing_second_arg_to_meet_c_to_get_seg_fault.jpg" src="../../../_images/fuzzing_second_arg_to_meet_c_to_get_seg_fault.jpg" style="width: 1200px; height: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 9 </span><span class="caption-text">Segmentation fault found!</span><a class="headerlink" href="#fuzzing-second-arg-to-meet-c-to-get-seg-fault-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>We can see that we have found the segmentation fault after injecting 400 “A“‘s into the second argument. 398 and 399 did not do it. From this we can surmise that the first argument “Mr” took two bytes and the second argument took 400 bytes, and this was enough to overwrite the main function’s return address. Since the saved base pointer took four bytes and the saved return address took an additional four bytes, we have probably overwritten the saved base pointer, at which the main function used this corrupted base pointer for its stack frame operations. But since we have corrupted the saved base pointer, the program tried to access an invalid part of memory, and hence we obtained the segmentation fault.</p>
<p>From this we can surmise that the vulnerable buffer size is about 400 bytes. Let us fire up the Gnu DeBugger on the segmentation fault and see what happened. Before we do this, we install the PEDA extension for GDB to make life easier. This can be found at:<br />
<a class="reference external" href="https://github.com/longld/peda">Python Exploit Development Assistance</a></p>
<figure class="align-center" id="finding-assembly-inst-that-caused-seg-fault-jpg">
<a class="reference internal image-reference" href="../../../_images/finding_assembly_inst_that_caused_seg_fault.jpg"><img alt="finding_assembly_inst_that_caused_seg_fault.jpg" src="../../../_images/finding_assembly_inst_that_caused_seg_fault.jpg" style="width: 1200px; height: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 10 </span><span class="caption-text">Finding root cause of the segmentation fault</span><a class="headerlink" href="#finding-assembly-inst-that-caused-seg-fault-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>We can see from GDB that the exact instruction that caused the segmentation fault was found at the address main+35:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">-------------------------------------</span><span class="n">code</span><span class="o">-------------------------------------</span><span class="p">]</span>
   <span class="mh">0x8048903</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">26</span><span class="o">&gt;</span><span class="p">:</span>	<span class="n">add</span>    <span class="n">esp</span><span class="p">,</span><span class="mh">0x8</span>
   <span class="mh">0x8048906</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">29</span><span class="o">&gt;</span><span class="p">:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">ebp</span><span class="o">+</span><span class="mh">0xc</span><span class="p">]</span>
   <span class="mh">0x8048909</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">32</span><span class="o">&gt;</span><span class="p">:</span>	<span class="n">add</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x8</span>
<span class="o">=&gt;</span> <span class="mh">0x804890c</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">35</span><span class="o">&gt;</span><span class="p">:</span>	<span class="n">mov</span>    <span class="n">edx</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">eax</span><span class="p">]</span>
   <span class="mh">0x804890e</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">37</span><span class="o">&gt;</span><span class="p">:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">ebp</span><span class="o">+</span><span class="mh">0xc</span><span class="p">]</span>
   <span class="mh">0x8048911</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">40</span><span class="o">&gt;</span><span class="p">:</span>	<span class="n">add</span>    <span class="n">eax</span><span class="p">,</span><span class="mh">0x4</span>
   <span class="mh">0x8048914</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">43</span><span class="o">&gt;</span><span class="p">:</span>	<span class="n">mov</span>    <span class="n">eax</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">eax</span><span class="p">]</span>
   <span class="mh">0x8048916</span> <span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">45</span><span class="o">&gt;</span><span class="p">:</span>	<span class="n">push</span>   <span class="n">edx</span>
</pre></div>
</div>
<p>The instruction attempted to load into EDX the contents of the memory address pointed to by EAX. We can observe that the contents of the registers was:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">----------------------------------</span><span class="n">registers</span><span class="o">-----------------------------------</span><span class="p">]</span>
<span class="n">EAX</span><span class="p">:</span> <span class="mh">0x41414149</span> <span class="p">(</span><span class="s1">&#39;IAAA&#39;</span><span class="p">)</span>
<span class="n">EBX</span><span class="p">:</span> <span class="mh">0x80481a8</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">_init</span><span class="o">&gt;</span><span class="p">:</span>	<span class="n">push</span>   <span class="n">ebx</span><span class="p">)</span>
<span class="n">ECX</span><span class="p">:</span> <span class="mh">0x7ffffe66</span> 
<span class="n">EDX</span><span class="p">:</span> <span class="mh">0x80eb4d4</span> <span class="o">--&gt;</span> <span class="mh">0x0</span> 
<span class="n">ESI</span><span class="p">:</span> <span class="mh">0x80ea00c</span> <span class="o">--&gt;</span> <span class="mh">0x8066fc0</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">__strcpy_sse2</span><span class="o">&gt;</span><span class="p">:</span>	<span class="n">mov</span>    <span class="n">edx</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">esp</span><span class="o">+</span><span class="mh">0x4</span><span class="p">])</span>
<span class="n">EDI</span><span class="p">:</span> <span class="mh">0x45</span> <span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
<span class="n">EBP</span><span class="p">:</span> <span class="mh">0xbfffed00</span> <span class="p">(</span><span class="s1">&#39;A&#39;</span> <span class="o">&lt;</span><span class="n">repeats</span> <span class="mi">184</span> <span class="n">times</span><span class="o">&gt;</span><span class="p">)</span>
<span class="n">ESP</span><span class="p">:</span> <span class="mh">0xbfffedc8</span> <span class="o">--&gt;</span> <span class="mh">0x0</span> 
<span class="n">EIP</span><span class="p">:</span> <span class="mh">0x804890c</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">main</span><span class="o">+</span><span class="mi">35</span><span class="o">&gt;</span><span class="p">:</span>	<span class="n">mov</span>    <span class="n">edx</span><span class="p">,</span><span class="n">DWORD</span> <span class="n">PTR</span> <span class="p">[</span><span class="n">eax</span><span class="p">])</span>
<span class="n">EFLAGS</span><span class="p">:</span> <span class="mh">0x10202</span> <span class="p">(</span><span class="n">carry</span> <span class="n">parity</span> <span class="n">adjust</span> <span class="n">zero</span> <span class="n">sign</span> <span class="n">trap</span> <span class="n">INTERRUPT</span> <span class="n">direction</span> <span class="n">overflow</span><span class="p">)</span>
</pre></div>
</div>
<p>Looking specifically at EAX, it contained 0x41414149. 0x41 is the ASCII code for the capital A. We can see that when the CPU tried to access the contents of the memory location pointed to by EAX, we got the segmentation fault. This is because the memory address 0x41414149 is outside of the program’s allowable access segments.</p>
<p>What appears to have happened is that the return address was not overwritten, because the program was able to return to main. However, it appears that argc and argv where overwritten by the buffer overflow. Recall that argc contains the number of arguments, including the command itself. In our case, argc would have been 2, since it starts at 0.  Recall that the name of the executable corresponds to argc = 0, the second argument corresponds to argc = 1, and the the fuzzing string (i.e. the 400 “A“‘s) corresponds to argc = 2.</p>
<p>argv[ ] is an array of strings. Each string in argv are the arguments, where argv[0] is the command itself. In our case, argv[1] would have been “Mr” and argv[2] would have been 400 “A“‘s. What we are really after is to overwrite EIP. To do that, we will have to add an additional 8 “A”s, which equals a total of 8 bytes. 4 of those bytes will overwrite the saved EBP, and the other 4 bytes will overwrite the saved EIP. We show the results of running <em>meet</em> with 408 “A“‘s for the second argument in the screen shot below:</p>
<figure class="align-center" id="fuzzing-second-arg-to-meet-to-overwrite-eip-jpg">
<a class="reference internal image-reference" href="../../../_images/fuzzing_second_arg_to_meet_to_overwrite_EIP.jpg"><img alt="fuzzing_second_arg_to_meet_to_overwrite_EIP.jpg" src="../../../_images/fuzzing_second_arg_to_meet_to_overwrite_EIP.jpg" style="width: 1200px; height: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 11 </span><span class="caption-text">Overwriting EIP by injecting 408 “A“‘s into the second argument to the executable <em>meet</em></span><a class="headerlink" href="#fuzzing-second-arg-to-meet-to-overwrite-eip-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Now that we have found a way to overwrite EIP, we can basically get the CPU to execute arbitrary code within the processes memory segment. If we could insert shellcode into the second argument, and then overwrite the return address to point to the start of the shellcode, then we will cause the process to spawn a shell. If this process was running under root privileges, then the shell will be a root shell, where we can basically control the entire system. Let us try to do this from the command line.</p>
</section>
<section id="inserting-shellcode-into-a-vulnerable-processs-from-the-command-line-to-obtain-a-command-shell">
<h3>Inserting Shellcode into a Vulnerable Processs from the Command Line to Obtain a Command Shell<a class="headerlink" href="#inserting-shellcode-into-a-vulnerable-processs-from-the-command-line-to-obtain-a-command-shell" title="Link to this heading">#</a></h3>
<p>In this section, our goal is to try to insert shellcode into the vulnerable executable <em>meet</em>. We will then do the same thing in GDB to see exactly what happens.</p>
<p>We will approah this section by showing a successful attack of a vulnerable program from the command line, and then dissect every aspect of how this was achieved. In order to show how dramatic such an attack can be, we will escalate the privileges of the vulnerable program to that of super user (SUID). This will cause the vulnerable program to drop out of normal execution and into a command shell with root privileges.</p>
<figure class="align-center" id="changing-meet-to-suid-jpg">
<a class="reference internal image-reference" href="../../../_images/changing_meet_to_suid.jpg"><img alt="changing_meet_to_suid.jpg" src="../../../_images/changing_meet_to_suid.jpg" style="width: 1200px; height: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 12 </span><span class="caption-text">Changing the execution privileges of the executable <em>meet</em> to SUID</span><a class="headerlink" href="#changing-meet-to-suid-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>By issuing the command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>chmod<span class="w"> </span>u+s<span class="w"> </span>meet
</pre></div>
</div>
<p>we give the executable <em>meet</em> the privileges to execute at the root level.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p><strong>DO NOT LEAVE A VULNERABLE EXECUTABLE WITH SUID ROOT PRIVILEGES ON YOUR SYSTEM AFTER YOU ARE DONE!  REMOVE THE SUID PRIVILEGES OR DELETE THE EXECUTABLE.</strong></p>
</div>
<p>We then inject our attack payload into the second parameter, because as discussed previously, the first parameter is not vulnerable to this attack. The attack and results are shown below:</p>
<figure class="align-center" id="cmd-line-sc-injection-root-shell-jpg">
<a class="reference internal image-reference" href="../../../_images/cmd_line_sc_injection_root_shell.jpg"><img alt="cmd_line_sc_injection_root_shell.jpg" src="../../../_images/cmd_line_sc_injection_root_shell.jpg" style="width: 1200px; height: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 13 </span><span class="caption-text">Injecting payload into the vulnerable parameter of the executable <em>meet</em> to obtain a root shell</span><a class="headerlink" href="#cmd-line-sc-injection-root-shell-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p><strong>SUCCESS!</strong> We have obtained a root shell. We will now dissect the attack string in detail.</p>
<p>By issuing the command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>./meet<span class="w"> </span>mr<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>perl<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;print &quot;\\x90&quot;x200&#39;</span><span class="p">;</span><span class="w"> </span>cat<span class="w"> </span>sc<span class="p">;</span><span class="w"> </span>perl<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;print &quot;\\x90&quot;x27&#39;</span><span class="w"> </span><span class="p">;</span>perl<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;print &quot;\\x18\\xf2\\xff\\xbf&quot;x38&#39;</span><span class="k">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>we were able to overflow a buffer within the executable <em>meet</em>, and overwrite the return address. By doing so, we hijacked the instruction pointer EIP to execute our arbitrary code. In this case, our arbitrary code was shellcode, which provides a command shell. Since the executable <em>meet</em> ran at the root privilege level, once the shell is spawned, any command entered runs at the root privilege level.</p>
<p>We will now break down the attack string in great detail.</p>
</section>
</section>
<hr class="docutils" />
<section id="breaking-down-the-attack-string-in-detail">
<h2>Breaking Down the Attack String in Detail<a class="headerlink" href="#breaking-down-the-attack-string-in-detail" title="Link to this heading">#</a></h2>
<section id="use-of-the-cmd-cmd-cmd-cmd-format">
<h3>Use of the “$(<em>cmd</em>; <em>cmd</em>; <em>cmd</em>; <em>cmd</em>)” format<a class="headerlink" href="#use-of-the-cmd-cmd-cmd-cmd-format" title="Link to this heading">#</a></h3>
<p>The attack string used the format:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;</span><span class="k">$(</span>_cmd_<span class="p">;</span><span class="w"> </span>_cmd_<span class="p">;</span><span class="w"> </span>_cmd_<span class="p">;</span><span class="w"> </span>_cmd_<span class="k">)</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>The shell command format $() replaces the unweildy backtick “ ` “ format, making an entered command much easier to read and understand. Individual commands within the parentheses can be separated by a semicolon. The quotation marks on the outside, i.e. “$()” tell the command shell to treat everything within the quotes as a literal string. See below for examples:</p>
<figure class="align-center" id="using-quotes-on-command-line-jpg">
<a class="reference internal image-reference" href="../../../_images/using_quotes_on_command_line.jpg"><img alt="using_quotes_on_command_line.jpg" src="../../../_images/using_quotes_on_command_line.jpg" style="width: 1200px; height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 14 </span><span class="caption-text">Demonstration of the effect of quotation marks at the Linux command prompt</span><a class="headerlink" href="#using-quotes-on-command-line-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>As can be seen from the above screen shot, putting separated commands into quotes causes everything contained within the quotes to be treated as a single string. This is a good property for injecting shellcode from the command line into a vulnerable executable.</p>
<p>We will now examine using $() and “$()” on the command line.</p>
<figure class="align-center" id="using-dollar-paranthesis-on-command-line-jpg">
<a class="reference internal image-reference" href="../../../_images/using_dollar_paranthesis_on_command_line.jpg"><img alt="using_dollar_paranthesis_on_command_line.jpg" src="../../../_images/using_dollar_paranthesis_on_command_line.jpg" style="width: 1200px; height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 15 </span><span class="caption-text">Using $() and “$()” on command line</span><a class="headerlink" href="#using-dollar-paranthesis-on-command-line-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>As can be seen from the screenshot above, putting commands separated by a semicolon within $(), causes the the output of the commands to be substituted into their place and the output to be executed by the shell. In the case of the first command <em>date</em>, the output is Sun, for Sunday, and the shell tries to execute Sun, but this is not a valid Linux command, so the command shell throws an error.</p>
<p>Alternatively, putting multiple commands separated by a semicolon within “$()” causes all of the commands to be executed, and the outputs of all of the commands are substituted in, wherein the shell tries to execute the outputs as if they were an actual shell command. That is why the shell returns an error in the screenshot above.</p>
<p>We will now put these concepts together to craft an attack string.</p>
</section>
<section id="using-to-craft-an-attack-string">
<h3>Using “$()” to craft an attack string<a class="headerlink" href="#using-to-craft-an-attack-string" title="Link to this heading">#</a></h3>
<p>We begin by using two shell commands:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>perl<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;perl command&#39;</span><span class="w">  </span>
<span class="w">   </span>
xxd<span class="w"> </span>filename
</pre></div>
</div>
<p>These commands can be broken down as follows:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>perl -e ‘perl command’</p></td>
<td><p>Execute perl command contained within the single quotes</p></td>
</tr>
<tr class="row-odd"><td><p>xxd filename</p></td>
<td><p>Display the hexadecimal values of the characters contained within the file called filename</p></td>
</tr>
</tbody>
</table>
</div>
<p>We will now use these commands to craft an attack string.</p>
<p>We will craft an attack string using perl commands and pipe the output of the attack string into xxd, to see whether the hexadecimal values align properly in memory and do not contain any bad characters, such a null byte, i.e. \x00, or the linefeed character, i.e. \x0a. The null byte is bad because many string processing functions in C interpret the null byte as the end of the string. So if our attack string contains a null byte in the middle of it, then only a portion of the attack string will enter into the vulnerable function. This will cause the attack string to fail. Likewise, the linefeed character will cause the parsing units of the string manipulation functions to interpret the linefeed as a user hitting the enter key. This will again cause premature failure of the attack string.</p>
<p>Let us try a simple example, such as:</p>
<figure class="align-center" id="example-piping-into-xxd-jpg">
<a class="reference internal image-reference" href="../../../_images/example_piping_into_xxd.jpg"><img alt="example_piping_into_xxd.jpg" src="../../../_images/example_piping_into_xxd.jpg" style="width: 1200px; height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 16 </span><span class="caption-text">Example of piping data into xxd to observe the hexadecimal values of the characters</span><a class="headerlink" href="#example-piping-into-xxd-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>In the above screenshot, we use the echo command to take the entire output of the commands within the “$()” and echo it to the screen. However, since we are using the unix pipe, the output is instead piped to the xxd command, which displays the hexadecimal values of the characters. Notice that there is a problem right at the end. There is a 0x0a character, which is the linefeed that the echo command affixes to the end. To suppress this trailing linefeed, the -n switch is used with the echo command. In the second issuance of the echo command, the trailing linefeed is suppressed, and we get a nice collection of hexadecimal values to fill 64 spots.</p>
<p>We can now move forward with constructing the attack string.</p>
</section>
<section id="putting-it-all-together">
<h3>Putting it all together<a class="headerlink" href="#putting-it-all-together" title="Link to this heading">#</a></h3>
<p>Recall that the attack string was:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>./meet<span class="w"> </span>mr<span class="w"> </span><span class="s2">&quot;</span><span class="k">$(</span>perl<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;print &quot;\\x90&quot;x200&#39;</span><span class="p">;</span><span class="w"> </span>cat<span class="w"> </span>sc<span class="p">;</span><span class="w"> </span>perl<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;print &quot;\\x90&quot;x27&#39;</span><span class="w"> </span><span class="p">;</span>perl<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;print &quot;\\x18\\xf2\\xff\\xbf&quot;x38&#39;</span><span class="k">)</span><span class="s2">&quot;</span><span class="w"> </span>
</pre></div>
</div>
<p>We will focus on everything contained within the “$()” by piping it into xxd and seeing what we are actually putting into the vulnerable buffer.</p>
<figure class="align-center" id="piping-attack-string-into-xxd-jpg">
<a class="reference internal image-reference" href="../../../_images/piping_attack_string_into_xxd.jpg"><img alt="piping_attack_string_into_xxd.jpg" src="../../../_images/piping_attack_string_into_xxd.jpg" style="width: 1200px; height: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 17 </span><span class="caption-text">Piping the attack string into xxd</span><a class="headerlink" href="#piping-attack-string-into-xxd-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>From the above screenshot, we can see that the attack string contains a prologue of 0x90 characters. The 0x90 is the hexadecimal value of the opcode for No OPeration, or the NOP. Since the CPU can not distingush data from executable code, the CPU begins executing the <strong><em>data</em> as if it were <em>code</em></strong>. This prologue of NOP instructions is called a NOP sled. The NOP sled is used to make it easier by relieving the requirement to be absolutely exact with the return address at the end of the attack string. The CPU’s instruction pointer needs to be made to fall anywhere within this NOP sled, so that it will begin sliding down the NOP sled and eventually hit the shellcode. We have highlighted the shellcode for clarity. The shellcode was developed within another section of this website and can be found here:</p>
<p><a class="reference internal" href="../Shellcode_Generation_and_Testing/shellcode_generation_and_testing.html"><span class="std std-doc">Shellcode Generation and Testing</span></a></p>
<p>How can we make the CPU’s instruction pointer point to somewhere in the NOP sled? This is where real hacking skill comes in. After the NOP sled and shellcode, we need to overflow the rest of the buffer with the memory address <em>of the buffer</em>.</p>
<p>From where do we get this address? In our case, we have access to the source code and debugging information. Without the source code and debugging information, we would need to engage in reverse engineering of the executable. This is not impossible, but obviously much harder to do. For our purposes here, we will work on the easier case of knowing the exact memory address of the buffer we wish to overflow.</p>
<p>In our easier case, there are two ways of finding out the memory address of the buffer we wish to overflow.</p>
<ul class="simple">
<li><p>Modifiying the source code to print out the memory address of the buffer.</p></li>
<li><p>Using the debugger GDB to find out the memory address of the buffer.</p></li>
</ul>
<p>This may seem to easy to many of you, and indeed it is. So we will also explore trying to overflow the buffer when knowing only the location of the stack pointer.</p>
</section>
<section id="discovering-the-memory-address-of-the-buffer-we-wish-to-overflow">
<h3>Discovering the memory address of the buffer we wish to overflow<a class="headerlink" href="#discovering-the-memory-address-of-the-buffer-we-wish-to-overflow" title="Link to this heading">#</a></h3>
<p>We now explore how to discover the memory address of the buffer we wish to overflow. Recall that when running the vulnerable executable <em>meet</em> with normal inputs, we obtain the following output:</p>
<figure class="align-center" id="running-meet-normally-jpg">
<a class="reference internal image-reference" href="../../../_images/running_meet_normally.jpg"><img alt="running_meet_normally.jpg" src="../../../_images/running_meet_normally.jpg" style="width: 1200px; height: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 18 </span><span class="caption-text">Running meet.c normally</span><a class="headerlink" href="#running-meet-normally-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>We can see from the above screenshot that the memory address of the buffer that we want to overflow is:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>The<span class="w"> </span>address<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>name<span class="w"> </span>array<span class="w"> </span>is:<span class="w"> </span>0xbfffee28
</pre></div>
</div>
<p>The memory address 0xbfffee28 is what we need to append to the end of the shellcode enough times so that this address will overwrite the saved EIP. By doing so, when the CPU reaches the <em>ret</em> assembly instruction as it leaves the called function <em>greeting</em>, it will load the instruction pointer with the memory address 0xbfffee28, and then begin execution of the instructions there. Those instructions are the NOP sled, followed by our shellcode!</p>
<p>Of course, it is not always that simple. This address needs to be four byte aligned and input into the attack string in reverse order, since memory in IA32 is written in Little-Endian format. So in the case of 0xbfffee28, we would write it as \x28\xee\xff\xbf. In order to align the address to 4 bytes, we will need to add some NOP instruction padding so that the address 0xbfffee28 does not sit in the next byte location in memory after the shellcode, but rather in a fresh new 32 bit (4 byte) location. Otherwise, this address will be a shifted version of itself when the CPU tries to read it off of the stack. In that case, the address may be read as 0xee28bfff or 0xffee28bf. I both of those cases, the program will most certainly crash with an out of bounds or illegal instruction segmentation fault.</p>
<p>Note that this address may change slightly with each execution of the program <em>meet</em>; therefore, some persistance is necessary when attacking from the command line. We will now explore using the debugger GDB for finding out the address of the buffer we want to overflow. Refer to the screenshot below:</p>
<figure class="align-center" id="finding-the-mem-address-of-name-gef-jpg">
<a class="reference internal image-reference" href="../../../_images/finding_the_mem_address_of_name_GEF.jpg"><img alt="finding_the_mem_address_of_name_GEF.jpg" src="../../../_images/finding_the_mem_address_of_name_GEF.jpg" style="width: 1200px; height: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 19 </span><span class="caption-text">Discovering the memory address of the buffer we want to overflow. The buffer is called “name”</span><a class="headerlink" href="#finding-the-mem-address-of-name-gef-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>We can see from the GEF User Interface (UI) to GDB that we are at the vulnerable <em>strcpy</em> function:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">strcpy</span><span class="w"> </span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">temp2</span><span class="p">);</span><span class="w"> </span><span class="c1">// copy the function argumemt to name</span>
</pre></div>
</div>
<p>By the C calling convention, arguments passed to a function are pushed onto the stack in reverse order. We can see from the screenshot that <em>temp1</em> is at ESP+8, ESP+4 contains the memory address of <em>temp2</em> and at ESP we have the memory address of the local variable <em>name</em>. In this case, the memory address is 0xbfffea58. Note that we are looking for the memory address of the local variable <em>name</em>, NOT what the register ESP (stack pointer) points to, but rather what is at the memory address that the ESP points to. In other words, ESP points to an address on the stack, 0xbfffea50, and at this memory address, there is stored another memory address which is 0xbfffea58. The contents of the memory location at the address 0xbfffea58 is the value 6, which is really just a random value, since the local variable <em>name</em> is uninitialized.</p>
<p>To confirm these statements, we observe the stack after the strcpy function returns.</p>
<figure class="align-center" id="state-of-cpu-and-mem-after-strcpy-gef-jpg">
<a class="reference internal image-reference" href="../../../_images/state_of_CPU_and_mem_after_strcpy_GEF.jpg"><img alt="state_of_CPU_and_mem_after_strcpy_GEF.jpg" src="../../../_images/state_of_CPU_and_mem_after_strcpy_GEF.jpg" style="width: 1200px; height: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 20 </span><span class="caption-text">State of CPU registers, stack and relevant memory addresses after the strcpy command</span><a class="headerlink" href="#state-of-cpu-and-mem-after-strcpy-gef-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>We can see from the above screen shot that the passed argument <em>temp2</em>, at stack memory location 0xbfffea54, has been copied to stack location 0xbfffea50. These correspond to ESP + 4 and ESP respectively.</p>
<p>We also observe that the function strcpy returns a pointer to a character (i.e. a string), and by convention, this pointer is returned into the register EAX. From the Linux man page for strcpy:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="nf">strcpy</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">dest</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">src</span><span class="p">);</span>
</pre></div>
</div>
<p>We can observe from the above screenshot that the returned value into EAX is: 0xbfffea58, which is the memory address of the local variable <em>name</em> on the stack. This is the memory address of the buffer we need to overflow.</p>
</section>
<section id="calculating-how-many-bytes-we-need-to-inject-into-the-vulnerable-buffer-to-overwrite-the-instruction-pointer-eip">
<h3>Calculating how many bytes we need to inject into the vulnerable buffer to overwrite the instruction pointer EIP.<a class="headerlink" href="#calculating-how-many-bytes-we-need-to-inject-into-the-vulnerable-buffer-to-overwrite-the-instruction-pointer-eip" title="Link to this heading">#</a></h3>
<p>So how many attack string bytes do we need to put onto the stack? We will need to fill up 400 bytes of the buffer called <em>name</em>. This is the local variable in the function greeting. Then we need 400 bytes for the argument passed to the function greeting called <em>temp2</em>, 4 bytes for the argument passed to the function greeting called <em>temp1</em>. Finally we need 4 bytes for the saved EBP. That is a total of 808 bytes. The next 4 bytes that we must overwrite is the <strong>saved instruction pointer EIP</strong>.</p>
<p>See the below screenshots for the state of execution just before the saved EIP is popped off of the stack, and execution is supposed to return back to the main function in the executable <em>meet</em>. Execution never returns to the main function, but instead the shellcode is executed.</p>
</section>
<section id="state-of-execution-just-before-the-saved-eip-is-popped-off-of-the-stack-and-execution-is-supposed-to-return-back-to-the-main-function-in-the-executable-meet-according-to-the-gef-ui-for-gdb">
<h3>State of execution just before the saved EIP is popped off of the stack, and execution is supposed to return back to the main function in the executable <em>meet</em>, according to the GEF UI for GDB.<a class="headerlink" href="#state-of-execution-just-before-the-saved-eip-is-popped-off-of-the-stack-and-execution-is-supposed-to-return-back-to-the-main-function-in-the-executable-meet-according-to-the-gef-ui-for-gdb" title="Link to this heading">#</a></h3>
<figure class="align-center" id="just-before-attacked-ret-popped-from-stack-gef-jpg">
<a class="reference internal image-reference" href="../../../_images/just_before_attacked_ret_popped_from_stack_GEF.jpg"><img alt="just_before_attacked_ret_popped_from_stack_GEF.jpg" src="../../../_images/just_before_attacked_ret_popped_from_stack_GEF.jpg" style="width: 1200px; height: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 21 </span><span class="caption-text">Stack just before return to main as per GEF</span><a class="headerlink" href="#just-before-attacked-ret-popped-from-stack-gef-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="state-of-execution-just-before-the-saved-eip-is-popped-off-of-the-stack-and-execution-is-supposed-to-return-back-to-the-main-function-in-the-executable-meet-according-to-the-peda-ui-for-gdb">
<h3>State of execution just before the saved EIP is popped off of the stack, and execution is supposed to return back to the main function in the executable <em>meet</em>, according to the PEDA UI for GDB.<a class="headerlink" href="#state-of-execution-just-before-the-saved-eip-is-popped-off-of-the-stack-and-execution-is-supposed-to-return-back-to-the-main-function-in-the-executable-meet-according-to-the-peda-ui-for-gdb" title="Link to this heading">#</a></h3>
<figure class="align-center" id="just-before-attacked-ret-popped-from-stack-peda-jpg">
<a class="reference internal image-reference" href="../../../_images/just_before_attacked_ret_popped_from_stack_PEDA.jpg"><img alt="just_before_attacked_ret_popped_from_stack_PEDA.jpg" src="../../../_images/just_before_attacked_ret_popped_from_stack_PEDA.jpg" style="width: 1200px; height: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 22 </span><span class="caption-text">Stack just before return to main as per PEDA</span><a class="headerlink" href="#just-before-attacked-ret-popped-from-stack-peda-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>We can see from the above screenshots, for both the PEDA GDB UI and the GEF GDB UI, that the memory address of the <em>name</em> local variable is: 0xbfffef3a. However, the address of the top of the stack is different. For GEF it is 0xbfffebec, and for PEDA it is 0xbfffec0c. This discrepancy was caused by the executable <em>meet</em> being started as two different processes, each with its own address space. One process was started for GEF, and another one for PEDA.</p>
<p>Therefore we should not be surprised that the top of the stack is different on each invocation of an executable, even with address randomization turned on. To make the calculation, we simply subtract the address of the top of the stack from the address of the buffer. In both cases, we obtain the following calculations:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>GDB UI Name</p></th>
<th class="head"><p>Memory Address of Buffer</p></th>
<th class="head"><p>Memory Address of Top of Stack</p></th>
<th class="head"><p>Difference in Hex [bytes]</p></th>
<th class="head"><p>Difference in Decimal [bytes]</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>GEF</p></td>
<td><p>0xbfffef3a</p></td>
<td><p>0xbfffebec</p></td>
<td><p>0x34e</p></td>
<td><p>846</p></td>
</tr>
<tr class="row-odd"><td><p>PEDA</p></td>
<td><p>0xbfffef3a</p></td>
<td><p>0xbfffec0c</p></td>
<td><p>0x32e</p></td>
<td><p>814</p></td>
</tr>
</tbody>
</table>
</div>
<p>The difference in bytes is the number of bytes that we need to inject into the vulnerable buffer to overwrite the saved EIP.</p>
<p>Stated mathematically, we have:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>GEF<span class="w"> </span>0xbfffef3a<span class="w"> </span>-<span class="w"> </span><span class="nv">0xbfffebec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x34e<span class="w"> </span><span class="nv">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">846</span><span class="w"> </span>bytes<span class="w">  </span>
<span class="w">   </span>
PEDA<span class="w"> </span>0xbfffef3a<span class="w"> </span>-<span class="w"> </span><span class="nv">0xbfffec0c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>0x32e<span class="w"> </span><span class="nv">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">814</span><span class="w"> </span>bytes
</pre></div>
</div>
<p>The astute reader will notice that we calculated the theoretical number of bytes needed to overwrite the saved EIP was 812 bytes. However, in both cases, GEF and PEDA, we have more than 812 bytes. The reason is that we are allowed to overwrite even through the top of the stack, as long as the saved EIP is overwritten with the address of the overflowed buffer, and this address is aligned correctly to 4 bytes. If it is misaligned, then instead of reading 0xbfffef3a from the top of the stack, the CPU might read a shifted version of this. If this happens, the CPU will jump to this shifted version of the address that we want, and will most likely halt on a segmentation fault.</p>
<p>In order to verify that the attack string arranges its return addresses correctly aligned to 4 bytes, we could do a number of things. Within GDB, we could simply issue the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>x/300x<span class="w"> </span><span class="nv">$esp</span>+812
</pre></div>
</div>
<p>This command will show us the contents of the stack memory starting at ESP and going down by 812 bytes. This will show us the entire attack string in stack memory, with some margin. We will now demonstrate this in the screenshot below.</p>
<figure class="align-center" id="examining-812-bytes-below-esp-jpg">
<a class="reference internal image-reference" href="../../../_images/examining_812_bytes_below_ESP.jpg"><img alt="examining_812_bytes_below_ESP.jpg" src="../../../_images/examining_812_bytes_below_ESP.jpg" style="width: 1200px; height: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 23 </span><span class="caption-text">Examining stack memory 812 bytes below ESP</span><a class="headerlink" href="#examining-812-bytes-below-esp-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Referring to the screenshot above, we wanted to observe the contents of stack memory starting at ESP and going down by 812 bytes. Notice that since the stack grows downward, we need to do the opposite operation, and <em>add</em> 812 bytes, rather than subtract. To look at a byte, we need two hexadecimal digits; therefore, looking at 300 hexadecimal digits will show us 900 bytes. This will enable us to see our entire attack string in stack memory, with some margin. To accomplish this, we enter the following command:</p>
<p>Notice from the above screenshot that there is a NULL byte just ahead of our NOP sled. Since we are aiming for the middle of the NOP sled, this leading NULL bytes is of little consquence. Now that we have discovered the address of the vulnerable buffer, and figured out how many bytes we need to inject into it for a successful buffer overflow, we will now look at how to discover the stack address from the command line.</p>
</section>
</section>
<section id="discovering-the-memory-address-of-the-stack">
<h2>Discovering the memory address of the stack<a class="headerlink" href="#discovering-the-memory-address-of-the-stack" title="Link to this heading">#</a></h2>
<section id="variations-in-the-top-of-the-stack-with-multiple-attack-attempts-from-the-command-line">
<h3>Variations in the top of the stack with multiple attack attempts from the command line<a class="headerlink" href="#variations-in-the-top-of-the-stack-with-multiple-attack-attempts-from-the-command-line" title="Link to this heading">#</a></h3>
<p>Before we can figure out the return address to place onto the stack so that we can successfuly overwrite the saved EIP, we need to know the current address of the stack. This is a little bit tricky, because every time the attack is attempted, the stack address changes a little bit, even with ASLR turned off. The reason is that Linux tries to reclaim memory after the failed attack completes, and other processes are always executing at the same time, so the stack address tends to shift around a bit, by about 500 to 1000 bytes.</p>
<p>While this is not a large range, it is enough to render the attack string useless, as it will probably crash with a segmentation fault, or the attack will simply be ignored. This all depends on which way the top of the stack has shifted in memory. However, command line attacks are still possible as the stack will most likely stay at the same location for a few attempted attacks.</p>
<p>In the next section, we will demonstrate a small C program that can print out the current memory address of the stack.</p>
</section>
<section id="a-small-program-that-displays-the-current-state-of-the-stack-pointer">
<h3>A small program that displays the current state of the stack pointer<a class="headerlink" href="#a-small-program-that-displays-the-current-state-of-the-stack-pointer" title="Link to this heading">#</a></h3>
<p>To discover the address of the stack segment in memory, we use the program listed below:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>

<span class="kt">unsigned</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="nf">get_sp</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">__asm__</span><span class="p">(</span><span class="s">&quot;movl %esp, %eax&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Stack pointer (ESP): 0x%x</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">get_sp</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The program uses inline assembly within C. By convention, a the return value of a C function returns is contained within EAX. By calling the function get_sp, the ESP register is copied to EAX and returned to the printf statement. In this way, we obtain what is contained within ESP, the top of the stack.</p>
<p>This returned value is printed out as a memory address via the 0x%x format string. The screenshot below will display the output of running this program a few times.</p>
<figure class="align-center" id="running-get-sp-many-times-jpg">
<a class="reference internal image-reference" href="../../../_images/running_get_sp_many_times.jpg"><img alt="running_get_sp_many_times.jpg" src="../../../_images/running_get_sp_many_times.jpg" style="width: 1200px; height: 600px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 24 </span><span class="caption-text">Running get_sp many times to obtain the same memory address of the stack</span><a class="headerlink" href="#running-get-sp-many-times-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Now that we have the address of the stack, or ESP, we can now make the calculation to figure out the return address that we want to append to the end of our attack string. We use our trusty HP48G calculator emulator for this purpose.</p>
<figure class="align-left" id="calculating-return-address-w-dec-bytes-before-jpg">
<a class="reference internal image-reference" href="../../../_images/calculating_return_address_w_dec_bytes_before.jpg"><img alt="calculating_return_address_w_dec_bytes_before.jpg" src="../../../_images/calculating_return_address_w_dec_bytes_before.jpg" style="height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 25 </span><span class="caption-text">(A)</span><a class="headerlink" href="#calculating-return-address-w-dec-bytes-before-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="calculating-return-address-w-hex-bytes-before-jpg">
<a class="reference internal image-reference" href="../../../_images/calculating_return_address_w_hex_bytes_before.jpg"><img alt="calculating_return_address_w_hex_bytes_before.jpg" src="../../../_images/calculating_return_address_w_hex_bytes_before.jpg" style="height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 26 </span><span class="caption-text">(B)</span><a class="headerlink" href="#calculating-return-address-w-hex-bytes-before-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-left" id="calculating-return-address-w-hex-bytes-after-minus-jpg">
<a class="reference internal image-reference" href="../../../_images/calculating_return_address_w_hex_bytes_after_minus.jpg"><img alt="calculating_return_address_w_hex_bytes_after_minus.jpg" src="../../../_images/calculating_return_address_w_hex_bytes_after_minus.jpg" style="height: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 27 </span><span class="caption-text">(C)</span><a class="headerlink" href="#calculating-return-address-w-hex-bytes-after-minus-jpg" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></p>
<p>Referring to the above calculator images: in (A) we have the address of the stack, 0xbfffee98 and 812 bytes that we will subtract; in (B) we have the same as in (A), but the 812 in decimal was converted to hex for clarity; and in (C) we have the result of the subtraction.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "markkhusid/MKDynamics_Website_V2",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Sections/Cybersecurity/Basic_Linux_Exploits"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../cybersecurity.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Cybersecurity</p>
      </div>
    </a>
    <a class="right-next"
       href="../Disassembling_Binaries/disassembling_binaries.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Disassembling Binaries</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resources-used">Resources Used</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#smashing-the-stack-of-a-vulnerable-program-and-causing-a-buffer-overflow">Smashing the Stack of a Vulnerable Program and Causing a Buffer Overflow</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#brief-synopsis-of-meet-c">Brief synopsis of meet.c</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#disabling-address-space-layout-randomization-aslr">Disabling Address Space Layout Randomization (ASLR)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#smashing-the-stack-of-a-vulnerable-program-and-causing-a-buffer-overflow-overflowing-the-buffer-of-the-vulnerable-program-meet-c">Smashing the Stack of a Vulnerable Program and Causing a Buffer Overflow - Overflowing the Buffer of the Vulnerable Program meet.c</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compiling-meet-c-with-nx-disabled-with-debugging-information-and-static-compilation">Compiling meet.c with NX disabled, with debugging information and static compilation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#running-the-executable-meet-normally">Running the executable <em>meet</em> normally</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fuzzing-the-inputs-to-the-executable-meet">Fuzzing the inputs to the executable <em>meet</em></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inserting-shellcode-into-a-vulnerable-processs-from-the-command-line-to-obtain-a-command-shell">Inserting Shellcode into a Vulnerable Processs from the Command Line to Obtain a Command Shell</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#breaking-down-the-attack-string-in-detail">Breaking Down the Attack String in Detail</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#use-of-the-cmd-cmd-cmd-cmd-format">Use of the “$(<em>cmd</em>; <em>cmd</em>; <em>cmd</em>; <em>cmd</em>)” format</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-to-craft-an-attack-string">Using “$()” to craft an attack string</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#putting-it-all-together">Putting it all together</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#discovering-the-memory-address-of-the-buffer-we-wish-to-overflow">Discovering the memory address of the buffer we wish to overflow</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-how-many-bytes-we-need-to-inject-into-the-vulnerable-buffer-to-overwrite-the-instruction-pointer-eip">Calculating how many bytes we need to inject into the vulnerable buffer to overwrite the instruction pointer EIP.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#state-of-execution-just-before-the-saved-eip-is-popped-off-of-the-stack-and-execution-is-supposed-to-return-back-to-the-main-function-in-the-executable-meet-according-to-the-gef-ui-for-gdb">State of execution just before the saved EIP is popped off of the stack, and execution is supposed to return back to the main function in the executable <em>meet</em>, according to the GEF UI for GDB.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#state-of-execution-just-before-the-saved-eip-is-popped-off-of-the-stack-and-execution-is-supposed-to-return-back-to-the-main-function-in-the-executable-meet-according-to-the-peda-ui-for-gdb">State of execution just before the saved EIP is popped off of the stack, and execution is supposed to return back to the main function in the executable <em>meet</em>, according to the PEDA UI for GDB.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#discovering-the-memory-address-of-the-stack">Discovering the memory address of the stack</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#variations-in-the-top-of-the-stack-with-multiple-attack-attempts-from-the-command-line">Variations in the top of the stack with multiple attack attempts from the command line</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#a-small-program-that-displays-the-current-state-of-the-stack-pointer">A small program that displays the current state of the stack pointer</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Mark Khusid
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>