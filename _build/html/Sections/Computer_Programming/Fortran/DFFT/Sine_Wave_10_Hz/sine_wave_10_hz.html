
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Sine Wave at 10Hz &#8212; MK Dynamics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!-- 
    this give us a css class that will be invisible only if js is disabled 
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../_static/styles/theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />
<link href="../../../../../_static/styles/pydata-sphinx-theme.css?digest=26a4bc78f4c0ddb94549" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../../../_static/scripts/fontawesome.js?digest=26a4bc78f4c0ddb94549"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549" />
<link rel="preload" as="script" href="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549" />

    <script src="../../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Sections/Computer_Programming/Fortran/DFFT/Sine_Wave_10_Hz/sine_wave_10_hz';</script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="Square Wave at 1Hz" href="../Square_Wave_1_Hz_50_pct/square_wave_1_hz_50_pct.html" />
    <link rel="prev" title="Discretized Fourier Transform of Arbitrary Signal Using FFTW3 in Fortran" href="../DFFT.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../../_static/spacey.jpg" class="logo__image only-light" alt="MK Dynamics - Home"/>
    <img src="../../../../../_static/spacey.jpg" class="logo__image only-dark pst-js-only" alt="MK Dynamics - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../../intro.html">
                    MK Dynamics
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Cybersecurity</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../Cybersecurity/cybersecurity.html">Cybersecurity</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../Cybersecurity/Protostar/protostar.html">Protostar Exploit Exercises</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../Cybersecurity/Protostar/Stack0/stack0.html">Stack 0</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Cybersecurity/Protostar/Stack0/stack0_x86.html">Protostar Exploit Exercises - Stack0 - First Stack Buffer Overflow to modify Variable</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../Cybersecurity/LiveOverflow/liveoverflow.html">LiveOverflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../Cybersecurity/Basic_Linux_Exploits/basic_linux_exploits.html">Basic Linux Exploits</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../Cybersecurity/Disassembling_Binaries/disassembling_binaries.html">Disassembling Binaries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../../Cybersecurity/Disassembling_Binaries/Fortran/fortran.html">Fortran</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../../Cybersecurity/Disassembling_Binaries/Fortran/ARM64/arm64.html">ARM 64 Bit</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Computer Programming</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../../computer_programming.html">Computer Programming</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../CPP/cpp.html">C++ Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp__HEAD__.html">Object Oriented Programming Using C++</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_1.html">Chapter 1: Why Object-Oriented Programming in C++?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_2.html">Chapter 2: Native Types and Statements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_3.html">Chapter 3: Functions and Pointers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_4.html">Chapter 4: Implementing ADTs in the Base Language</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_5.html">Chapter 5: Data Hiding and Member Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_6.html">Chapter 6: Object Creation and Destruction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_7.html">Chapter 7: Ad Hoc Polymorphism</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Python/python.html">Python Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../Python/Python_Playground/Python_Playground__HEAD__.html">Python Playground: Geeky Projects for the Curious Programmer</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Python/Python_Playground/Section_Chapter_2_Draw_Circle.html">Chapter 2: Draw Circle using Turtle Graphics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Python/Python_Playground/Section_Chapter_2_Draw_Spiro.html">Chapter 2: Draw Spiro using Turtle Graphics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Python/Python_Playground/Section_Chapter_3_Conway.html">Chapter 3: Conway’s Game of Life</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Python/Python_Playground/Section_Chapter_4_Karplus_Strong.html">Chapter 4: Karplus Strong Algorithm</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../../fortran.html">Fortran Programming</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Modern_Fortran/modern_fortran.html">Modern Fortran</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Modern_Fortran/Cold_Front_Calculator.html">Cold Front Calculator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Modern_Fortran/Cold_Front_Calculator_with_Loop.html">Cold Front Calculator With Loop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Modern_Fortran/Tsunami_Simulator.html">Tsunami Simulator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Modern_Fortran/Tsunami_Simulator_Plotter.html">Tsunami Simulator Plotter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Modern_Fortran/Tsunami_Simulator_with_Modules.html">Tsunami Simulator with Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Modern_Fortran/Tsunami_Simulator_with_Modules_Plotter.html">Tsunami Simulator with Modules Plotter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Modern_Fortran/Print_Compiler_Version.html">Print Compiler Version</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Modern_Fortran/Analyzing_Time_Series_Data_with_Arrays.html">Analyzing Time Series Data with Arrays</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Intro_to_Fortran/intro_to_fortran.html">Introduction to Programming Using Fortran</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Intro_to_Fortran/Section_7_Period_Calculator.html">Section 7: Pendulum Period Calculator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Intro_to_Fortran/Section_9_3_SOS_Difference.html">Section 9.3: Difference Between Sum of Squares and Square of Sums</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Intro_to_Fortran/Section_12_8_Line_Numbers.html">Section 12.8: Line Numbers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Intro_to_Fortran/Section_14_Pi_Estimation.html">Section 14: Pi Estimation</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Guide_to_Fortran_2008_Programming/guide_to_fortran_2008_programming.html">Guide to Fortran 2008 Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Guide_to_Fortran_2008_Programming/Section_1_8_Ex_2_Quadratic_Formula.html">Section 1.8 Example 2: Quadratic Equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Guide_to_Fortran_2008_Programming/Section_1_16_Factorial_Recursion.html">Section 1.16: Factorial Recursion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Guide_to_Fortran_2008_Programming/Section_2_1_Associate_Construct.html">Section 2.1: Statement Blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Guide_to_Fortran_2008_Programming/Section_2_1_Statement_Blocks.html">Section 2.1: Associate Construct</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Guide_to_Fortran_2008_Programming/Section_3_4_Putting_Procedures_in_a_Module.html">Section 3.4: Putting Procedures in a Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Guide_to_Fortran_2008_Programming/Section_3_6_Ex_1_Median_of_Three.html">Section 3.6: Median of Three</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Guide_to_Fortran_2008_Programming/Section_3_8_Argument_Passing.html">Section 3.8: Argument Passing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Guide_to_Fortran_2008_Programming/Section_3_17_Case_Study__Adaptive_Numberical_Integration.html">Section 3.17: Case Study: Adaptive Numerical Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Guide_to_Fortran_2008_Programming/Section_4_1_Elsewhere_Example.html">Section 4.1: Elsewhere Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Guide_to_Fortran_2008_Programming/Section_8_1_Submodules.html">Section 8.1: Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Guide_to_Fortran_2008_Programming/Section_8_2_Time_Matrix_Multiply.html">Section 8.2: Time Matrix Multiply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Guide_to_Fortran_2008_Programming/Section_8_7_Generic_Elemental_Procedures.html">Section 8.7: Generic Elemental Procedures</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Guide_to_Fortran_2008_Programming/Section_8_8_Findloc_Function.html">Section 8.8: Findloc Function</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Fortran_MOOC/fortran_mooc.html">Fortran MOOC</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran_MOOC/Section_Arrays.html">Section: Arrays</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran_MOOC/Section_Ball_Throw__Head__.html">Section: Ball Throw</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran_MOOC/Section_Floating_Point.html">Section: Floating Point</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran_MOOC/Section_Call_By_Semantics.html">Section: Call By Semantics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran_MOOC/Section_Computing_Pi.html">Section: Computing Pi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran_MOOC/Section_Implicit_vs_Explicit_Loops__Head__.html">Section: Implicit vs Explicit Loops</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran_MOOC/Section_Block_Matrices__Head__.html">Section: Block Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran_MOOC/Section_BLAS_LAPACK__Head__.html">Section: BLAS/LAPACK</a></li>
</ul>
</details></li>
<li class="toctree-l3 current active has-children"><a class="reference internal" href="../DFFT.html">Discretized Fourier Transform of Arbitrary Signal Using FFTW3 in Fortran</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l4 current active"><a class="current reference internal" href="#">Sine Wave at 10Hz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Square_Wave_1_Hz_50_pct/square_wave_1_hz_50_pct.html">Square Wave at 1Hz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../2_Sine_Waves/2sineXHz.html">Two Sine Waves with Different Frequencies</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Electronics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../Electronics/electronics.html">Electronics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../Electronics/Analog_and_Digital/analog_and_digital.html">Analog and Digital Electronics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../Electronics/Analog_and_Digital/AD9850_DDS/AD9850_DDS.html">Variable Frequency Oscillator Using Direct Digital Synthesis</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">About Me</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../About_Me/aboutme.html">About Me</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../About_Me/Resume/resume.html">My Resume</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../About_Me/Certificates/certificates.html">My Certificates</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../About_Me/Certificates/certificates_coursera.html">Coursera Certificates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../About_Me/Certificates/certificates_kaggle.html">Kaggle Certificates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../About_Me/Certificates/certificates_tryhackme.html">Try Hack Me Certificates</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Misc</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../../markdown-notebooks.html">Notebooks with MyST Markdown</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../notebooks.html">Content with notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../README.html">MKDynamics_Website_V2</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/markkhusid/MKDynamics_Website_V2" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/markkhusid/MKDynamics_Website_V2/issues/new?title=Issue%20on%20page%20%2FSections/Computer_Programming/Fortran/DFFT/Sine_Wave_10_Hz/sine_wave_10_hz.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../../_sources/Sections/Computer_Programming/Fortran/DFFT/Sine_Wave_10_Hz/sine_wave_10_hz.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Sine Wave at 10Hz</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scilab-code">SciLAB Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#execute-the-scilab-code">Execute the SciLAB Code</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-domain-plot">Time Domain Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frequency-domain-plot">Frequency Domain Plot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-the-time-domain-data">Saving The Time Domain Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#processing-of-csv-file-into-a-format-suitable-for-input-into-the-fortran-2003-dfft-code">Processing of CSV File into a Format Suitable for Input into the Fortran 2003 DFFT Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#execute-the-python-script">Execute the Python Script</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fortran-2003-code">Fortran 2003 Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compile-the-fortran-2003-code">Compile the Fortran 2003 Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#execute-the-fortran-2003-code">Execute the Fortran 2003 Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-dfft-results">Visualize the DFFT Results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#results">Results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dfft-magnitude-plot">DFFT Magnitude Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dfft-phase-plot">DFFT Phase Plot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="sine-wave-at-10hz">
<h1>Sine Wave at 10Hz<a class="headerlink" href="#sine-wave-at-10hz" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>This example demonstrates the computation of the Discretized Fourier Transform of a sine wave at 10 Hz using the FFTW3 library in Fortran. The sine wave is generated using SciLAB and the DFFT is computed using the Fortran 2003 code. The time domain and frequency domain plots are generated using GNUPlot.</p>
</section>
<section id="scilab-code">
<h2>SciLAB Code<a class="headerlink" href="#scilab-code" title="Link to this heading">#</a></h2>
<p>The SciLAB code to generate the sine wave is as follows:</p>
<div class="highlight-scilab notranslate"><div class="highlight"><pre><span></span><span class="c1">// Generate a sine wave at 10 Hz</span>
<span class="c1">// Frequency components of a signal</span>
<span class="c1">//----------------------------------</span>
<span class="c1">// build a signal sampled at 1000hz  containing a pure frequency</span>
<span class="c1">// at 10Hz</span>
<span class="n">sample_rate</span><span class="p">=</span><span class="mi">1000</span><span class="p">;</span>
<span class="n">frequency</span><span class="p">=</span><span class="mi">10</span><span class="p">;</span>

<span class="c1">// time vector which goes from 0 to 1 with a step of 1/sample_rate</span>
<span class="n">t</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="o">/</span><span class="n">sample_rate</span><span class="p">:</span><span class="mi">1</span><span class="p">;</span>

<span class="c1">// number of samples</span>
<span class="n">N</span><span class="p">=</span><span class="nb">size</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="s">&#39;*&#39;</span><span class="p">);</span><span class="w"> </span><span class="c1">//number of samples</span>

<span class="c1">// generate the signal</span>
<span class="n">s</span><span class="p">=</span><span class="nb">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="no">%pi</span><span class="o">*</span><span class="n">frequency</span><span class="o">*</span><span class="n">t</span><span class="p">);</span>

<span class="c1">// compute the fft of the signal</span>
<span class="n">y</span><span class="p">=</span><span class="nb">fft</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>

<span class="c1">//s is real so the fft response is conjugate symmetric and we retain only the first N/2 points</span>
<span class="n">f</span><span class="p">=</span><span class="n">sample_rate</span><span class="o">*</span><span class="p">(</span><span class="mi">0</span><span class="p">:(</span><span class="n">N</span><span class="o">/</span><span class="mi">2</span><span class="p">))</span><span class="o">/</span><span class="n">N</span><span class="p">;</span><span class="w"> </span><span class="c1">//associated frequency vector</span>

<span class="c1">// number of samples</span>
<span class="n">n</span><span class="p">=</span><span class="nb">size</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="s">&#39;*&#39;</span><span class="p">)</span>

<span class="c1">// plot the fft</span>
<span class="n">h</span><span class="p">=</span><span class="mi">0</span><span class="p">;</span>
<span class="n">scf</span><span class="p">(</span><span class="n">h</span><span class="p">);</span>
<span class="nb">xset</span><span class="p">(</span><span class="s">&#39;window&#39;</span><span class="p">,</span><span class="n">h</span><span class="p">);</span>
<span class="nb">xtitle</span><span class="p">(</span><span class="s">&#39;DFFT of 10Hz Sine Wave in SciLAB&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Freq [Hz]&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Amplitude [Arb]&#39;</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="nb">abs</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">)))</span>

<span class="c1">// plot the time domain signal</span>
<span class="n">h</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span>
<span class="n">scf</span><span class="p">(</span><span class="n">h</span><span class="p">);</span>
<span class="nb">xset</span><span class="p">(</span><span class="s">&#39;window&#39;</span><span class="p">,</span><span class="n">h</span><span class="p">);</span>
<span class="nb">xtitle</span><span class="p">(</span><span class="s">&#39;s(t)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Time [s]&#39;</span><span class="p">,</span><span class="w"> </span><span class="s">&#39;Amplitude [Arb]&#39;</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="w"> </span><span class="n">s</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="execute-the-scilab-code">
<h2>Execute the SciLAB Code<a class="headerlink" href="#execute-the-scilab-code" title="Link to this heading">#</a></h2>
<p>To execute the SciLAB code, copy and paste the code into the SciLAB console and press Enter.  The time domain and frequency domain plots will be displayed.  The results are shown below:</p>
<section id="time-domain-plot">
<h3>Time Domain Plot<a class="headerlink" href="#time-domain-plot" title="Link to this heading">#</a></h3>
<img alt="../../../../../_images/scilab_sine_wave2_10Hz.jpeg" src="../../../../../_images/scilab_sine_wave2_10Hz.jpeg" />
</section>
<section id="frequency-domain-plot">
<h3>Frequency Domain Plot<a class="headerlink" href="#frequency-domain-plot" title="Link to this heading">#</a></h3>
<img alt="../../../../../_images/scilab_sine_wave2_10Hz_FFT.jpg" src="../../../../../_images/scilab_sine_wave2_10Hz_FFT.jpg" />
</section>
</section>
<section id="saving-the-time-domain-data">
<h2>Saving The Time Domain Data<a class="headerlink" href="#saving-the-time-domain-data" title="Link to this heading">#</a></h2>
<p>The time-domain data is selected in SciLAB and saved into a CSV file.</p>
</section>
<section id="processing-of-csv-file-into-a-format-suitable-for-input-into-the-fortran-2003-dfft-code">
<h2>Processing of CSV File into a Format Suitable for Input into the Fortran 2003 DFFT Code<a class="headerlink" href="#processing-of-csv-file-into-a-format-suitable-for-input-into-the-fortran-2003-dfft-code" title="Link to this heading">#</a></h2>
<p>Since the output of SciLAB is a comma separated value (CSV) file, a method is needed that will process that file into another file, where the commas are removed and each data element is on a separate line.
Additionally, a the data elements need to be reformatted into fixed floating point, since the “e”
floating point format was noticed to possibly cause errors when input into the FFTW3 algorithm.
These operations were done using a Python script, with its powerful object-oriented file techniques and its included CSV library. The Python script is shown below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/python3</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Assign constants for better code readability</span>
<span class="n">first_arg</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">second_arg</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># Call the system to get the command line arguments and pull out items from the list</span>
<span class="n">input_file</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="n">first_arg</span><span class="p">]</span>
<span class="n">intermediate_file</span> <span class="o">=</span> <span class="s1">&#39;intermediate.dat&#39;</span>
<span class="n">output_file</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="n">second_arg</span><span class="p">]</span>

<span class="c1"># Simple string manipulation that traverses text file until EOF </span>
<span class="c1"># and calls method to replace commas with newline characters</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">intermediate_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
  <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">infile</span><span class="p">:</span>
      <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">))</span>

<span class="c1"># Close the input file, as it is no longer needed.</span>
<span class="n">infile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
      
<span class="c1"># Now go through the intermediate file (the file that contains one data element per line)</span>
<span class="c1"># and reformat all of the data elements into fixed floating point with 20 decimal precision.</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">intermediate_file</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
  <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">infile</span><span class="p">:</span>
      <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%20.20f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
            
<span class="c1"># Close the intermediate file and final output file.</span>
<span class="n">infile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">outfile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># Clean away the intermediate file.  The next line may be commented out if the intermediate </span>
<span class="c1"># file is required.</span>
<span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">intermediate_file</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="execute-the-python-script">
<h2>Execute the Python Script<a class="headerlink" href="#execute-the-python-script" title="Link to this heading">#</a></h2>
<p>Run by typing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./convert_csv.py<span class="w"> </span>infile.csv<span class="w"> </span>outfile.dat
</pre></div>
</div>
<p>where infile.csv is the data file in CSV format, and outfile.dat is the processed file
Obtain the line count of the processed file by typing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wc<span class="w"> </span>-l<span class="w"> </span>outfile.dat
</pre></div>
</div>
</section>
<section id="fortran-2003-code">
<h2>Fortran 2003 Code<a class="headerlink" href="#fortran-2003-code" title="Link to this heading">#</a></h2>
<p>The Fortran 2003 code to compute the Discretized Fourier Transform of the sine wave at 10 Hz is as follows:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">! DFFT from Processed Data File</span>
<span class="c">! Written by Mark Khusid 2015</span>
<span class="c">!</span>
<span class="c">! 2018</span>
<span class="c">! Version 6</span>
<span class="c">! Increased amount of command line arguments to 5 from 3.  The added two were sample rate and number of periods.</span>
<span class="c">! Cleaned up indentation and formatting.</span>
<span class="c">! Modified the write_DFFT_to_file subroutine to output not only the DFFT data element but also the corrected frequency</span>
<span class="c">! on each line of the data file.  The DFFT data element and corrected frequency are separated by a space</span>
<span class="c">! Obtained the corrected frequency based on the sampe rate and the next power of two of the total number of samples (i.e. 100 samples -&gt; next power of 2 = 128.)</span>
<span class="c">! Since there are num_bins_int number of data elements in FFT array, and the FFT array is symmetric, we divide the magnitude by half the num_bins_int to get the normalized magnitude.</span>
<span class="c">!</span>
<span class="c">! Version 5</span>
<span class="c">! Commented out debug code and rearranged some inconsequential lines.</span>
<span class="c">!</span>
<span class="c">! 2015</span>
<span class="c">! Version 4</span>
<span class="c">! Numerous fixes.  Changed code to allocate memory based on the next power of 2 relative</span>
<span class="c">! to the number of element in the input file.  For example, a data file with 1000 data elements</span>
<span class="c">! will cause arrays to be allocated with 1024 elements.  This is done to prevent errors in the FFT.</span>
<span class="c">! Extra array space above and beyond what is in data file is padded with zeros.</span>
<span class="c">! Reformatted most of the debug output.</span>
<span class="c">! Used ATAN2, separate variables and formatting to ensure that small values of the real part will not </span>
<span class="c">! cause phase errors.</span>
<span class="c">!</span>
<span class="c">! Version 3</span>
<span class="c">! This version counts the number of data elements in the file automatically.</span>
<span class="c">! This version is rewritten to make use of subroutines.</span>

<span class="k">module </span><span class="n">MKDynamics_FFT</span>

<span class="w">    </span><span class="k">use</span><span class="p">,</span><span class="w"> </span><span class="k">intrinsic</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="nb">iso_c_binding</span>
<span class="nb">      </span><span class="k">include</span><span class="w"> </span><span class="s1">&#39;fftw3.f03&#39;</span>
<span class="w">      </span>
<span class="w">      </span><span class="k">type</span><span class="p">(</span><span class="kt">C_PTR</span><span class="p">)</span><span class="w">         			</span><span class="kd">::</span><span class="w"> </span><span class="n">plan</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! Input file name, output file name and number of bins, sample rate, number of periods</span>
<span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w">                                      </span><span class="kd">::</span><span class="w"> </span><span class="n">num_expected_args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! FFTW input array</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="kt">C_DOUBLE</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:),</span><span class="w"> </span><span class="k">allocatable</span><span class="w">			    </span><span class="kd">::</span><span class="w"> </span><span class="n">in</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! FFTW output array</span>
<span class="w">      </span><span class="kt">complex</span><span class="p">(</span><span class="kt">C_DOUBLE_COMPLEX</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:),</span><span class="w"> </span><span class="k">allocatable</span><span class="w">	</span><span class="kd">::</span><span class="w"> </span><span class="n">out</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! Holds the data read from the input file</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="kt">C_DOUBLE</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(:),</span><span class="w"> </span><span class="k">allocatable</span><span class="w">   			                </span><span class="kd">::</span><span class="w"> </span><span class="n">temp_real_array</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! Used to perform complex math</span>
<span class="w">      </span><span class="kt">real</span><span class="p">(</span><span class="kt">C_DOUBLE</span><span class="p">)</span><span class="w">                                                                      </span><span class="kd">::</span><span class="w"> </span><span class="n">magnitude</span><span class="p">,</span><span class="w"> </span><span class="n">phase</span><span class="p">,</span><span class="w"> </span><span class="n">temp_real</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! For checking if EOF reached</span>
<span class="w">      </span><span class="kt">integer</span><span class="w">                                                                             </span><span class="kd">::</span><span class="w"> </span><span class="n">EOF_marker</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! For checking if files opened successfully</span>
<span class="w">      </span><span class="kt">integer</span><span class="w">                                     			                </span><span class="kd">::</span><span class="w"> </span><span class="n">file_good1</span><span class="p">,</span><span class="w"> </span><span class="n">file_good2</span><span class="p">,</span><span class="w"> </span><span class="n">file_good3</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! For checking if files written successfully</span>
<span class="w">      </span><span class="kt">integer</span><span class="w">                                                                             </span><span class="kd">::</span><span class="w"> </span><span class="n">good_write1</span><span class="p">,</span><span class="w"> </span><span class="n">good_write2</span><span class="w">			</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! Counter used to traverse arrays</span>
<span class="w">      </span><span class="kt">integer</span><span class="w">                     							</span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! Contains number of arguments for verification of proper command line call</span>
<span class="w">      </span><span class="kt">integer</span><span class="w">                     							</span><span class="kd">::</span><span class="w"> </span><span class="n">num_args</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! Holds obtained number of bins</span>
<span class="w">      </span><span class="kt">integer</span><span class="w">                     							</span><span class="kd">::</span><span class="w"> </span><span class="n">num_bins_int</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! Holds memory allocation status of arrays</span>
<span class="w">      </span><span class="kt">integer</span><span class="w">						                           	</span><span class="kd">::</span><span class="w"> </span><span class="n">status1</span><span class="p">,</span><span class="w"> </span><span class="n">status2</span><span class="p">,</span><span class="w"> </span><span class="n">status3</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! Holds file names</span>
<span class="w">      </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span><span class="w">               						</span><span class="kd">::</span><span class="w"> </span><span class="n">input_file</span><span class="p">,</span><span class="w"> </span><span class="n">output_mag_file</span>
<span class="w">      </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span><span class="w">				                   		</span><span class="kd">::</span><span class="w"> </span><span class="n">output_phase_file</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! Holds sample rate argument string that will be converted to an integer</span>
<span class="w">      </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span><span class="w">                                       </span><span class="kd">::</span><span class="w"> </span><span class="n">sample_rate_string</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! Holds number of periods argument string that will be converted to an integer</span>
<span class="w">      </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span><span class="w">                                       </span><span class="kd">::</span><span class="w"> </span><span class="n">num_periods_string</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! Used to calculate the next power of 2 above input file size.  i.e. 1000 element array is increased to 1024 elements</span>
<span class="w">      </span><span class="kt">real</span><span class="w">			                         				</span><span class="kd">::</span><span class="w"> </span><span class="n">num_log2_bins_real</span>
<span class="w">      </span><span class="kt">integer</span><span class="w">							                        </span><span class="kd">::</span><span class="w"> </span><span class="n">num_bins_int_pow2</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! Used to hold the sample rate of the input data file</span>
<span class="w">      </span><span class="kt">integer</span><span class="w">                                                 </span><span class="kd">::</span><span class="w"> </span><span class="n">sample_rate</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! Used to hold the number of periods of the input data file</span>
<span class="w">      </span><span class="kt">integer</span><span class="w">                                                 </span><span class="kd">::</span><span class="w"> </span><span class="n">num_periods</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! Used to hold the total number of samples within the input data file</span>
<span class="w">      </span><span class="kt">integer</span><span class="w">                                                 </span><span class="kd">::</span><span class="w"> </span><span class="n">num_samples</span>
<span class="w">         </span>
<span class="w">    </span><span class="k">contains</span>
<span class="k">      subroutine </span><span class="n">close_files_and_exit</span>
<span class="w">        </span><span class="k">close</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="k">close</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="w">        </span><span class="k">close</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Files closed.....&#39;</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Exiting.....&#39;</span>
<span class="w">        </span><span class="k">stop</span>
<span class="k">      end subroutine </span><span class="n">close_files_and_exit</span>
<span class="w">      </span>
<span class="w">      </span><span class="k">subroutine </span><span class="n">close_files_deallocate_and_exit</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">state</span>
<span class="w">        </span><span class="k">close</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="k">close</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="w">        </span><span class="k">close</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="w">        </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">in</span><span class="p">)</span>
<span class="w">        </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="w">        </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">temp_real_array</span><span class="p">)</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">state</span><span class="w"> </span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Files closed and memory deallocated&#39;</span>
<span class="w">              </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Exiting.....&#39;</span>
<span class="w">          </span><span class="k">stop</span>
<span class="k">          else</span>
<span class="k">              print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Files closed and memory deallocated&#39;</span>
<span class="w">          </span><span class="k">end if</span>
<span class="k">      end subroutine </span><span class="n">close_files_deallocate_and_exit</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! From stack overflow</span>
<span class="w">      </span><span class="k">elemental subroutine </span><span class="n">str2int</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="nb">int</span><span class="p">)</span>
<span class="w">          </span><span class="k">implicit none</span>
<span class="w">          </span><span class="c">! Arguments</span>
<span class="w">          </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">str</span>
<span class="w">          </span><span class="kt">integer</span><span class="p">,</span><span class="k">intent</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">         </span><span class="kd">::</span><span class="w"> </span><span class="nb">int</span>
<span class="nb">  </span>
<span class="nb">          </span><span class="k">read</span><span class="p">(</span><span class="n">str</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w">  </span><span class="nb">int</span>
<span class="nb">      </span><span class="k">end subroutine </span><span class="n">str2int</span>
<span class="w">      </span>
<span class="w">      </span><span class="k">subroutine </span><span class="n">get_args</span>
<span class="w">      </span><span class="c">! Verify that the number of arguments is correct.  Should be 5, otherwise display</span>
<span class="w">        </span><span class="c">! error and terminate program</span>
<span class="w">        </span><span class="n">num_args</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">command_argument_count</span><span class="p">()</span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">num_args</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">num_expected_args</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Improper number of arguments&#39;</span>
<span class="w">              </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Argument list:&#39;</span>
<span class="w">              </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&lt;input file name&gt; &lt;output magnitude file name&gt; &lt;output phase file name&gt; &lt;sample rate&gt; &lt;number of periods&gt;&#39;</span><span class="w"> </span>
<span class="w">              </span><span class="k">call </span><span class="n">close_files_and_exit</span><span class="w">	</span><span class="c">! Graceful exit, no cleanup  </span>
<span class="w">          </span><span class="k">end if</span>
<span class="w">        </span>
<span class="w">        </span><span class="c">! Call subroutines that obtain the command line arguments and load the appropriate variables</span>
<span class="w">        </span><span class="k">call </span><span class="nb">get_command_argument</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">input_file</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="nb">get_command_argument</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">output_mag_file</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="nb">get_command_argument</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">output_phase_file</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="nb">get_command_argument</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="n">sample_rate_string</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="nb">get_command_argument</span><span class="w"> </span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">num_periods_string</span><span class="p">)</span>
<span class="w">        </span>
<span class="w">        </span><span class="c">! Debug code that ensures command line arguments were passed in properly</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;The first argument is (input file name) -&gt;&#39;</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">input_file</span>
<span class="w">        </span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;The second argument is (output magnitude file name) -&gt;&#39;</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">output_mag_file</span>
<span class="w">        </span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;The third argument is (output phase file name) -&gt;&#39;</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">output_phase_file</span>
<span class="w">        </span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;The fourth argument is (sample rate) as string -&gt;&#39;</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">sample_rate_string</span>
<span class="w">        </span><span class="k">call </span><span class="n">str2int</span><span class="p">(</span><span class="n">sample_rate_string</span><span class="p">,</span><span class="w"> </span><span class="n">sample_rate</span><span class="p">)</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;The fourth argument is (sample rate) as integer -&gt;&#39;</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">sample_rate</span>
<span class="w">        </span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;The fifth argument is (number of periods) as string -&gt;&#39;</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">num_periods_string</span>
<span class="w">        </span><span class="k">call </span><span class="n">str2int</span><span class="p">(</span><span class="n">num_periods_string</span><span class="p">,</span><span class="w"> </span><span class="n">num_periods</span><span class="p">)</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;The fifth argument is (number of periods) as integer -&gt;&#39;</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">num_periods</span>
<span class="w">        </span>
<span class="w">      </span><span class="k">end subroutine </span><span class="n">get_args</span>
<span class="w">    </span>
<span class="w">      </span><span class="k">subroutine </span><span class="n">open_files</span>
<span class="w">      </span><span class="c">! Begin to open files</span>
<span class="w">        </span><span class="k">open</span><span class="w"> </span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">input_file</span><span class="p">),</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="s2">&quot;old&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">file_good1</span><span class="p">,</span><span class="w"> </span><span class="n">form</span><span class="o">=</span><span class="s2">&quot;formatted&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">access</span><span class="o">=</span><span class="s2">&quot;sequential&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="s2">&quot;read&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="c">!open (unit=1, file=TRIM(input_file), IOSTAT=file_good1)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">file_good1</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Error opening input file!&#39;</span>
<span class="w">          </span><span class="k">call </span><span class="n">close_files_and_exit</span><span class="w">	</span><span class="c">! Graceful exit, no cleanup  </span>
<span class="w">        </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">file_good1</span><span class="w"> </span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Input file opened successfully...&#39;</span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">        </span>
<span class="k">        open</span><span class="w"> </span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">output_mag_file</span><span class="p">),</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">file_good2</span><span class="p">,</span><span class="w"> </span><span class="n">form</span><span class="o">=</span><span class="s2">&quot;formatted&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">access</span><span class="o">=</span><span class="s2">&quot;sequential&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">file_good2</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Error creating output magnitude file!&#39;</span>
<span class="w">          </span><span class="k">call </span><span class="n">close_files_and_exit</span><span class="w">	</span><span class="c">! Graceful exit, no cleanup  </span>
<span class="w">        </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">file_good2</span><span class="w"> </span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Output magnitude file created successfully...&#39;</span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">  </span>
<span class="k">        open</span><span class="w"> </span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="o">=</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">output_phase_file</span><span class="p">),</span><span class="w"> </span><span class="n">status</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">file_good3</span><span class="p">,</span><span class="w"> </span><span class="n">form</span><span class="o">=</span><span class="s2">&quot;formatted&quot;</span><span class="p">,</span><span class="w"> </span><span class="nb">access</span><span class="o">=</span><span class="s2">&quot;sequential&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">file_good3</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Error creating output phase file!&#39;</span>
<span class="w">          </span><span class="k">call </span><span class="n">close_files_and_exit</span><span class="w">	</span><span class="c">! Graceful exit, no cleanup  </span>
<span class="w">        </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">file_good3</span><span class="w"> </span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Output phase file created successfully...&#39;</span>
<span class="w">        </span><span class="k">end if</span>
<span class="w">  </span>
<span class="w">      </span><span class="c">!   Debug code follows.  Tests to see if file opened properly.</span>
<span class="w">        </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="n">unit</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">fmt</span><span class="o">=</span><span class="s1">&#39;(f20.10)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EOF_marker</span><span class="p">)</span><span class="w"> </span><span class="n">temp_real</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;The status of EOF_marker is&#39;</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">EOF_marker</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;The first element read was&#39;</span>
<span class="w">        </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">temp_real</span>
<span class="w">      </span><span class="c">!   Debug code ends</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">open_files</span>
<span class="w">      </span>
<span class="w">      </span><span class="k">subroutine </span><span class="n">get_num_data_elements</span>
<span class="w">        </span><span class="c">! Traverse through data file and count number of data elements in file</span>
<span class="w">        </span><span class="c">! Get first data element from file to see whether it is the EOF character</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Entering get_num_data_elements procedure&#39;</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span>
<span class="w">          </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">          </span><span class="k">rewind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">          </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(f30.20)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EOF_marker</span><span class="p">)</span><span class="w"> </span><span class="n">temp_real</span>
<span class="w">      </span><span class="c">!	Debug code starts here</span>
<span class="w">          </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a, i4)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;The counter is -&gt;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span>
<span class="w">          </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a, f30.20)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;The first data element was -&gt;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">temp_real</span>
<span class="w">          </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a, i4)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;The EOF marker is -&gt;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">EOF_marker</span>
<span class="w">      </span><span class="c">!	print *</span>
<span class="w">      </span><span class="c">! 	print *</span>
<span class="w">      </span><span class="c">!	Debug code ends here</span>
<span class="w">  </span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">EOF_marker</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;ERROR: Input file is empty&#39;</span>
<span class="w">              </span><span class="k">call </span><span class="n">close_files_and_exit</span><span class="w">	</span><span class="c">! Graceful exit, no cleanup  </span>
<span class="w">          </span><span class="k">end if</span>
<span class="w">  </span>
<span class="w">        </span><span class="c">! Establish loop that will count number of elements in file</span>
<span class="w">          </span><span class="n">count_loop</span><span class="p">:</span><span class="w"> </span><span class="k">do</span>
<span class="k">              if</span><span class="w"> </span><span class="p">(</span><span class="n">EOF_marker</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">                  print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;EOF reached&#39;</span>
<span class="w">                  </span><span class="k">exit </span><span class="n">count_loop</span>
<span class="w">              </span><span class="k">else</span>
<span class="k">                  </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span>
<span class="w">                  </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(f30.20)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EOF_marker</span><span class="p">)</span><span class="w"> </span><span class="n">temp_real</span>
<span class="w">                  </span><span class="c">!write (*, &#39;(a, i4, a, f30.20)&#39;), &#39;The data element at&#39;, i, &#39; was -&gt;&#39;, temp_real</span>
<span class="w">                  </span><span class="c">!write (*, &#39;(a, i4)&#39;), &#39;The EOF_marker is -&gt;&#39;, EOF_marker</span>
<span class="w">              </span><span class="k">end if</span>
<span class="k">          end do </span><span class="n">count_loop</span>
<span class="w">  </span>
<span class="w">          </span><span class="c">! Copy over the number of counted elements into the num_bins_int variable less one for the EOF character</span>
<span class="w">          </span><span class="n">num_bins_int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span>
<span class="w">          </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a, i10)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;The number of lines in the input file is -&gt;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">num_bins_int</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Exiting get_num_data_elements procedure&#39;</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span>
<span class="w">      </span><span class="k">end subroutine </span><span class="n">get_num_data_elements</span>
<span class="w">    </span>
<span class="w">      </span><span class="k">subroutine </span><span class="n">allocate_memory</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! Allocate memory based on the number of bins</span>
<span class="w">      </span><span class="c">! The number of bins will be used to find the next power of 2.</span>
<span class="w">      </span><span class="c">! Display success status of memory allocation</span>
<span class="w">      </span><span class="c">! If there is a problem with memory allocation, display error and terminate</span>
<span class="w">      </span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Entering allocate_memory procedure&#39;</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span>
<span class="w">          </span><span class="n">num_log2_bins_real</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">log</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">num_bins_int</span><span class="p">))</span><span class="o">/</span><span class="nb">log</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="w">          </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a, f20.4)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;The closest log base 2 bins is (as real)-&gt;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">num_log2_bins_real</span>
<span class="w">          </span><span class="n">num_bins_int_pow2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="nb">ceiling</span><span class="p">(</span><span class="n">num_log2_bins_real</span><span class="p">))</span>
<span class="w">          </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a, i8)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;The closest number of power of 2 bins is (as integer)-&gt;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">num_bins_int_pow2</span>
<span class="w">      </span>
<span class="w">          </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">in</span><span class="p">(</span><span class="n">num_bins_int_pow2</span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">status1</span><span class="p">)</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span>
<span class="w">          </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a, l)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Was memory allocated successfully for input array? -&gt;&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">  </span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status1</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Memory allocation error on input array&#39;</span>
<span class="w">              </span><span class="k">call </span><span class="n">close_files_and_exit</span><span class="w">	</span><span class="c">! Graceful exit, no cleanup  </span>
<span class="w">          </span><span class="k">end if</span>
<span class="k">          write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a, i10)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Input Array allocated with size -&gt;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>
<span class="w">      </span>
<span class="w">          </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">out</span><span class="p">(</span><span class="n">num_bins_int_pow2</span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">status2</span><span class="p">)</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span>
<span class="w">          </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a, l)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Was memory allocated successfully for output array? -&gt;&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="w">  </span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status2</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Memory allocation error on output array&#39;</span>
<span class="w">              </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">in</span><span class="p">)</span>
<span class="w">              </span><span class="k">call </span><span class="n">close_files_and_exit</span><span class="w">	</span><span class="c">! Graceful exit, no cleanup  </span>
<span class="w">          </span><span class="k">end if</span>
<span class="k">          write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a, i10)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Output Array allocated with size -&gt;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="w">      </span>
<span class="w">          </span><span class="k">allocate</span><span class="w"> </span><span class="p">(</span><span class="n">temp_real_array</span><span class="p">(</span><span class="n">num_bins_int_pow2</span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">status3</span><span class="p">)</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span>
<span class="w">          </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a, l)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Was memory allocated successfully for scratchpad array? -&gt;&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">temp_real_array</span><span class="p">)</span><span class="w">  </span>
<span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">status3</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">              print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Memory allocation error on scratchpad array&#39;</span>
<span class="w">              </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">in</span><span class="p">)</span>
<span class="w">              </span><span class="k">deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="w">              </span><span class="k">call </span><span class="n">close_files_and_exit</span><span class="w">	</span><span class="c">! Graceful exit, no cleanup  </span>
<span class="w">          </span><span class="k">end if</span>
<span class="k">          write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a, i10)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Scratchpad Array allocated with size -&gt;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">temp_real_array</span><span class="p">)</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Exiting allocate_memory procedure&#39;</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span>
<span class="w">      </span><span class="k">end subroutine </span><span class="n">allocate_memory</span>
<span class="w">        </span>
<span class="w">      </span><span class="k">subroutine </span><span class="n">read_from_file_into_array</span>
<span class="w">      </span><span class="c">! Establish a loop that reads the file from 1 to num_bins_int</span>
<span class="w">      </span><span class="c">! Bring file pointer for input file back to first element </span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;***** Subroutine read_from_file_into_array ******&#39;</span>
<span class="w">          </span><span class="k">rewind</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">          </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_bins_int</span>
<span class="w">              </span><span class="k">read</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(f30.20)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">EOF_marker</span><span class="p">)</span><span class="w"> </span><span class="n">temp_real_array</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w">		</span><span class="c">! read data element from file</span>
<span class="w">              </span><span class="c">! Debug code starts here</span>
<span class="w">              </span><span class="c">!write (*, &#39;(a, i4)&#39;), &#39;The EOF marker is -&gt;&#39;, EOF_marker</span>
<span class="w">              </span><span class="c">!write (*, &#39;(a, i4)&#39;) &#39;The counter is -&gt;&#39;, i</span>
<span class="w">              </span><span class="c">!write (*, &#39;(a, 30f30.20)&#39;) &#39;The data element was -&gt; &#39;, temp_real_array(i)</span>
<span class="w">              </span><span class="c">!print *</span>
<span class="w">              </span><span class="c">!print *</span>
<span class="w">              </span><span class="c">! Debug code ends here</span>
<span class="w">          </span><span class="k">end do</span>
<span class="k">      </span>
<span class="k">          print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Padding remainder of array with zeros to fill up to size of next power of 2....&#39;</span>
<span class="w">          </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="n">num_bins_int</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_bins_int_pow2</span>
<span class="w">              </span><span class="n">temp_real_array</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span>
<span class="w">              </span><span class="c">!write (*, &#39;(a, i4)&#39;) &#39;The counter is -&gt;&#39;, i</span>
<span class="w">              </span><span class="c">!write (*, &#39;(a, 30f30.20)&#39;) &#39;The data element was -&gt; &#39;, temp_real_array(i)</span>
<span class="w">          </span><span class="k">end do</span>
<span class="k">      </span>
<span class="k">          print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Exiting read_from_file_into_array procedure&#39;</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span>
<span class="w">      </span><span class="k">end subroutine </span><span class="n">read_from_file_into_array</span>
<span class="w">        </span>
<span class="w">      </span><span class="k">subroutine </span><span class="n">compute_DFFT</span>
<span class="w">          </span><span class="c">! *************** FFT COMPUTATION SECTION **********************</span>
<span class="w">          </span>
<span class="w">          </span><span class="c">! Establish array of reals that is the input the FFTW3 function</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Entering compute_DFFT procedure&#39;</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span>
<span class="w">          </span>
<span class="w">          </span><span class="n">in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">temp_real_array</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;num_bins_int_pow2 -&gt;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">num_bins_int_pow2</span>
<span class="w">          </span><span class="c">! Use built in fucntion to create FFTW3 plan.  Tells FFTW3 what to do.</span>
<span class="w">          </span><span class="n">plan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fftw_plan_dft_r2c_1d</span><span class="p">((</span><span class="n">num_bins_int_pow2</span><span class="p">),</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">out</span><span class="p">,</span><span class="w"> </span><span class="n">FFTW_ESTIMATE</span><span class="p">)</span>
<span class="w">          </span><span class="c">!print *, &#39;The FFTW3 plan is -&gt;&#39;</span>
<span class="w">          </span><span class="c">!call fftw_print_plan(plan)</span>
<span class="w">          </span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span>
<span class="w">              </span>
<span class="w">          </span><span class="c">! Debug code starts here</span>
<span class="w">          </span><span class="c">!print *, &quot;The contents of the input array is -&gt;&quot;</span>
<span class="w">      </span><span class="c">! 	do i = 1,num_bins_int_pow2			 </span>
<span class="w">      </span><span class="c">! 	  write (*, &#39;(f30.20)&#39;), in(i)</span>
<span class="w">      </span><span class="c">! 	end do</span>
<span class="w">          </span><span class="c">! Debug code ends here</span>
<span class="w">          </span>
<span class="w">          </span><span class="c">! Execute FFTW3 to produce DFFT on data from file stored in array</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Executing DFFT on input array...&quot;</span>
<span class="w">          </span><span class="k">call </span><span class="n">fftw_execute_dft_r2c</span><span class="p">(</span><span class="n">plan</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="p">,</span><span class="w"> </span><span class="n">out</span><span class="p">)</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;DFFT execution successfull&quot;</span>
<span class="w">          </span>
<span class="w">  </span>
<span class="w">          </span><span class="c">! Debug code starts here</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;The contents of the output array is -&gt;&quot;</span>
<span class="w">  </span><span class="c">!     	do i = 1,num_bins_int_pow2			 </span>
<span class="w">  </span><span class="c">!     	  write (*, &#39;(f30.20, f30.20)&#39;) out(i)</span>
<span class="w">  </span><span class="c">!     	end do</span>
<span class="w">          </span><span class="c">! Debug code ends here</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Exiting compute_DFFT procedure&#39;</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span>
<span class="w">      </span><span class="k">end subroutine </span><span class="n">compute_DFFT</span>
<span class="w">        </span>
<span class="w">      </span><span class="k">subroutine </span><span class="n">write_DFFT_to_file</span>
<span class="w">          </span><span class="kt">real</span><span class="w">                    </span><span class="kd">::</span><span class="w"> </span><span class="n">real_float</span><span class="p">,</span><span class="w"> </span><span class="n">imag_float</span><span class="p">,</span><span class="w"> </span><span class="n">corrected_frequency</span>
<span class="w">          </span><span class="kt">real</span><span class="w">                    </span><span class="kd">::</span><span class="w"> </span><span class="n">pi</span>
<span class="w">          </span><span class="c">!integer(kind=8)         :: real_int, imag_int</span>
<span class="w">  </span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Entering write_DFFT_to_file procedure&#39;</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span>
<span class="w">      </span>
<span class="w">          </span><span class="n">pi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="o">*</span><span class="nb">atan</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
<span class="w">  </span>
<span class="w">          </span><span class="n">num_samples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sample_rate</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">num_periods</span>
<span class="w">          </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(a, i8)&#39;</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;The number of total number of samples is -&gt; &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">num_samples</span>
<span class="w">      </span>
<span class="w">          </span><span class="c">! Traverse through output array that contains the complex DFFT, calculate magnitude and</span>
<span class="w">          </span><span class="c">! write results to output file.  Since output is symmetric, we only want half of the output array.</span>
<span class="w">          </span><span class="c">! The magnitude and phase will have each data element along side its corresponding corrected frequency</span>
<span class="w">          </span><span class="c">! in two columns, separated by a space, i.e. DFFT_magnitude corrected_frequency, on each line in the output file.</span>
<span class="w">          </span><span class="c">!do i = 1, 100</span>
<span class="w">          </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,(</span><span class="n">num_bins_int_pow2</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="w">          </span><span class="c">!do i = 1, (num_bins_int/2)</span>
<span class="w">  </span>
<span class="w">              </span><span class="c">! Lines below for debug</span>
<span class="w">              </span><span class="c">!write (*, &#39;(a, i4)&#39;), &#39;The counter i is -&gt;&#39;, i</span>
<span class="w">              </span><span class="c">!write (*, &#39;(a, f30.20, f30.20)&#39;), &#39;The DFFT data element is -&gt; &#39;, out(i)</span>
<span class="w">              </span>
<span class="w">              </span><span class="c">! Obtain the real part of the complex data stored in output array as float</span>
<span class="w">              </span><span class="n">real_float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">out</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="w">              </span><span class="c">!write (*, &#39;(a, f30.20)&#39;), &#39;The value of real_float is -&gt;&#39;, real_float</span>
<span class="w">                  </span>
<span class="w">              </span><span class="c">! Obtain the imaginary part of the complex data stored in output array as float</span>
<span class="w">              </span><span class="n">imag_float</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">aimag</span><span class="p">(</span><span class="n">out</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<span class="w">              </span><span class="c">!write (*, &#39;(a, f30.20)&#39;), &#39;The value of imag_float is -&gt;&#39;, imag_float</span>
<span class="w">              </span>
<span class="w">              </span><span class="c">! Obtain the corrected frequency based on the sampe rate and the next power of two of the total number of samples (i.e. 100 samples -&gt; next power of 2 = 128.)</span>
<span class="w">              </span><span class="c">!corrected_frequency = floor(float(i) * (float(sample_rate)/float(num_bins_int_pow2)))</span>
<span class="w">              </span><span class="n">corrected_frequency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">sample_rate</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">num_bins_int_pow2</span><span class="p">)))</span>
<span class="w">              </span>
<span class="w">              </span><span class="c">! Since there are num_bins_int number of data elements in FFT array, and the FFT array is symmetric, we divide the magnitude by half the num_bins_int to get the normalized magnitude.</span>
<span class="w">              </span><span class="n">magnitude</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nb">sqrt</span><span class="p">((</span><span class="n">real_float</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="n">imag_float</span><span class="o">**</span><span class="mi">2</span><span class="p">)))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">num_bins_int</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="w">              </span>
<span class="w">              </span><span class="n">phase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">atan2</span><span class="p">(</span><span class="n">imag_float</span><span class="p">,</span><span class="n">real_float</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">180</span><span class="o">/</span><span class="n">pi</span><span class="p">)</span>
<span class="w">              </span><span class="c">!write (*, &#39;(a, i8, a, f30.20, a, f30.5)&#39;) &#39;Counter -&gt; &#39;, i, &amp;</span>
<span class="w">              </span><span class="c">!&#39; Magnitude -&gt; &#39;, magnitude, &#39; Frequency -&gt; &#39;, corrected_frequency</span>
<span class="w">              </span><span class="c">!write (*, &#39;(a, f30.20)&#39;), &#39;The phase is -&gt; &#39;, phase</span>
<span class="w">              </span>
<span class="w">              </span><span class="c">!print *</span>
<span class="w">              </span>
<span class="w">              </span><span class="c">! Write out the DFFT magnitude, a space character and the corrected frequency</span>
<span class="w">              </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(f30.20, a, f30.20)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">good_write1</span><span class="p">)</span><span class="w"> </span><span class="n">magnitude</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">corrected_frequency</span>
<span class="w">              </span>
<span class="w">              </span><span class="c">! Write out the DFFT phase, a space character and the corrected frequency</span>
<span class="w">              </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;(f30.20, a, f30.20)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">good_write2</span><span class="p">)</span><span class="w"> </span><span class="n">phase</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">corrected_frequency</span>
<span class="w">              </span>
<span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">good_write1</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                  </span><span class="c">!print *, &#39;The state of good_write1 is:&#39;</span>
<span class="w">                  </span><span class="c">!print *, good_write1</span>
<span class="w">                  </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Error writing to magnitude file!&#39;</span>
<span class="w">                  </span><span class="k">call </span><span class="n">close_files_deallocate_and_exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">              </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">good_write2</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                  </span><span class="c">!print *, &#39;The state of good_write2 is:&#39;</span>
<span class="w">                  </span><span class="c">!print *, good_write2</span>
<span class="w">                  </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Error writing to phase file!&#39;</span>
<span class="w">                  </span><span class="k">call </span><span class="n">close_files_deallocate_and_exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">              </span><span class="k">end if</span>
<span class="k">  </span>
<span class="k">      end do</span>
<span class="w">  </span>
<span class="w">      </span><span class="c">! Tell user that output file was written successfully</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">good_write1</span><span class="w"> </span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Output magnitude file written successfully....&#39;</span>
<span class="w">      </span><span class="k">endif</span>
<span class="k">      </span>
<span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">good_write2</span><span class="w"> </span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Output phase file written successfully....&#39;</span>
<span class="w">      </span><span class="k">endif</span>
<span class="w">      </span>
<span class="w">      </span><span class="c">! Deallocate memory held by plan</span>
<span class="w">      </span><span class="k">call </span><span class="n">fftw_destroy_plan</span><span class="p">(</span><span class="n">plan</span><span class="p">)</span>
<span class="w">      </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Plan destroyed successfully....&#39;</span>
<span class="w">      </span><span class="c">! </span>
<span class="w">      </span><span class="c">! !   The following debug code checks to see if the Inverse DFFT will produce the original input data  </span>
<span class="w">      </span><span class="c">! !   print *, &quot;Output file written successfully!&quot;</span>
<span class="w">      </span><span class="c">! !     </span>
<span class="w">      </span><span class="c">! !   Swapping arrays to see if I can retrieve signal in time domain from signal in frequency domain</span>
<span class="w">      </span><span class="c">! !   in = out</span>
<span class="w">      </span><span class="c">! !     </span>
<span class="w">      </span><span class="c">! !   plan = fftw_plan_dft_1d(n, in, out, FFTW_BACKWARD, FFTW_ESTIMATE)</span>
<span class="w">      </span><span class="c">! !     </span>
<span class="w">      </span><span class="c">! !   print *, &quot;The contents of the input array is -&gt;&quot;</span>
<span class="w">      </span><span class="c">! !   do i = 1,num_bins_int</span>
<span class="w">      </span><span class="c">! !     print *, in(i)</span>
<span class="w">      </span><span class="c">! !   end do</span>
<span class="w">      </span><span class="c">! !     </span>
<span class="w">      </span><span class="c">! !   print *</span>
<span class="w">      </span><span class="c">! !     </span>
<span class="w">      </span><span class="c">! !   print *, &quot;Executing DFT on input array...&quot;</span>
<span class="w">      </span><span class="c">! !   call fftw_execute_dft(plan, in, out)</span>
<span class="w">      </span><span class="c">! !     </span>
<span class="w">      </span><span class="c">! !   print *, &quot;The contents of the output array is -&gt;&quot;</span>
<span class="w">      </span><span class="c">! !   do i = 1,num_bins_int</span>
<span class="w">      </span><span class="c">! !     print *, out(i)</span>
<span class="w">      </span><span class="c">! !   end do</span>
<span class="w">      </span><span class="c">! !     </span>
<span class="w">      </span><span class="c">! !   print *</span>
<span class="w">      </span><span class="c">! !     </span>
<span class="w">      </span><span class="c">! !   call fftw_destroy_plan(plan)</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Exiting write_DFFT_to_file procedure&#39;</span>
<span class="w">          </span><span class="k">print</span><span class="w"> </span><span class="o">*</span>
<span class="w">  </span>
<span class="w">    </span><span class="k">end subroutine </span><span class="n">write_DFFT_to_file</span>
<span class="w">  </span>
<span class="w">  </span><span class="k">end module </span><span class="n">MKDynamics_FFT</span>
<span class="w">  </span>
<span class="w">  </span><span class="k">program </span><span class="n">module_test</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">use </span><span class="n">MKDynamics_FFT</span>
<span class="w">    </span><span class="k">implicit none</span>
<span class="k">    </span>
<span class="k">    print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;MKDyanmics_FFT Program Version 5.&#39;</span>
<span class="w">  </span>
<span class="w">    </span><span class="k">call </span><span class="n">get_args</span>
<span class="w">    </span><span class="k">call </span><span class="n">open_files</span>
<span class="w">    </span><span class="k">call </span><span class="n">get_num_data_elements</span>
<span class="w">    </span><span class="k">call </span><span class="n">allocate_memory</span>
<span class="w">    </span><span class="k">call </span><span class="n">read_from_file_into_array</span>
<span class="w">    </span><span class="k">call </span><span class="n">compute_DFFT</span>
<span class="w">    </span><span class="k">call </span><span class="n">write_DFFT_to_file</span>
<span class="w">    </span><span class="k">call </span><span class="n">close_files_deallocate_and_exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Program completed successfully&#39;</span>
<span class="w">    </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Exiting.....&#39;</span><span class="w">  </span>
<span class="w">  </span>
<span class="w">  </span><span class="k">end program </span><span class="n">module_test</span>
<span class="w">  </span>
<span class="w">  </span>
</pre></div>
</div>
</section>
<section id="compile-the-fortran-2003-code">
<h2>Compile the Fortran 2003 Code<a class="headerlink" href="#compile-the-fortran-2003-code" title="Link to this heading">#</a></h2>
<p>To compile the Fortran 2003 code, type the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gfortran<span class="w"> </span>-o<span class="w"> </span>dfft_fftw3<span class="w"> </span>dfft_fftw3.f08<span class="w"> </span>-lfftw3
</pre></div>
</div>
</section>
<section id="execute-the-fortran-2003-code">
<h2>Execute the Fortran 2003 Code<a class="headerlink" href="#execute-the-fortran-2003-code" title="Link to this heading">#</a></h2>
<p>To execute the Fortran 2003 code, type the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./dfft_fftw3<span class="w"> </span>outfile.dat<span class="w"> </span>DFFT_mag_file.dat<span class="w"> </span>DFFT_phase_file.dat
</pre></div>
</div>
<p>where outfile.dat is the output of the Python script, DFFT_mag_file.dat is the DFFT magnitude
DFFT_phase_file.dat is the DFFT phase (if applicable).</p>
</section>
<section id="visualize-the-dfft-results">
<h2>Visualize the DFFT Results<a class="headerlink" href="#visualize-the-dfft-results" title="Link to this heading">#</a></h2>
<p>The DFFT results are visualized using GNUPlot.  The GNUPlot script is as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="w"> </span>term<span class="w"> </span>wxt<span class="w"> </span><span class="m">0</span>
<span class="nb">set</span><span class="w"> </span>xrange<span class="w"> </span><span class="o">[</span><span class="m">0</span>:50<span class="o">]</span>
<span class="nb">set</span><span class="w"> </span>title<span class="w"> </span><span class="s2">&quot;DFFT Magnitude of 10Hz Sine Wave&quot;</span>
<span class="nb">set</span><span class="w"> </span>xlabel<span class="w"> </span><span class="s2">&quot;Frequency [Hz]&quot;</span>
<span class="nb">set</span><span class="w"> </span>ylabel<span class="w"> </span><span class="s2">&quot;Arbitrary Units [Arb]&quot;</span>
plot<span class="w"> </span><span class="s2">&quot;DFFT_mag_file.dat&quot;</span><span class="w"> </span>using<span class="w"> </span><span class="m">1</span><span class="w"> </span>with<span class="w"> </span>lines

<span class="nb">set</span><span class="w"> </span>term<span class="w"> </span>wxt<span class="w"> </span><span class="m">1</span>
<span class="nb">set</span><span class="w"> </span>xrange<span class="w"> </span><span class="o">[</span><span class="m">0</span>:50<span class="o">]</span>
<span class="nb">set</span><span class="w"> </span>title<span class="w"> </span><span class="s2">&quot;DFFT Phase of 10Hz Sine Wave&quot;</span>
<span class="nb">set</span><span class="w"> </span>xlabel<span class="w"> </span><span class="s2">&quot;Frequency [Hz]&quot;</span>
<span class="nb">set</span><span class="w"> </span>ylabel<span class="w"> </span><span class="s2">&quot;Phase [degrees]&quot;</span>
plot<span class="w"> </span><span class="s2">&quot;DFFT_phase_file.dat&quot;</span><span class="w"> </span>using<span class="w"> </span><span class="m">1</span><span class="w"> </span>with<span class="w"> </span>lines
</pre></div>
</div>
<p>To execute the GNUPlot script, type the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gnuplot<span class="w"> </span>-persist<span class="w"> </span>plot_dfft.gnu
</pre></div>
</div>
<p>or start GNUPlot and type the following to load the script:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>load<span class="w"> </span><span class="s1">&#39;plot_dfft.gnu&#39;</span>
</pre></div>
</div>
</section>
<section id="results">
<h2>Results<a class="headerlink" href="#results" title="Link to this heading">#</a></h2>
<p>The magnitude and phase plots are shown below:</p>
<section id="dfft-magnitude-plot">
<h3>DFFT Magnitude Plot<a class="headerlink" href="#dfft-magnitude-plot" title="Link to this heading">#</a></h3>
<img alt="../../../../../_images/DFFT_mag_sine_wave2_10Hz1.jpeg" src="../../../../../_images/DFFT_mag_sine_wave2_10Hz1.jpeg" />
</section>
<section id="dfft-phase-plot">
<h3>DFFT Phase Plot<a class="headerlink" href="#dfft-phase-plot" title="Link to this heading">#</a></h3>
<img alt="../../../../../_images/DFFT_phase_sine_wave2_10Hz.jpeg" src="../../../../../_images/DFFT_phase_sine_wave2_10Hz.jpeg" />
</section>
</section>
<section id="discussion">
<h2>Discussion<a class="headerlink" href="#discussion" title="Link to this heading">#</a></h2>
<p>The DFFT of the sine wave at 10 Hz was successfully computed using the FFTW3 library in Fortran. The results were visualized using GNUPlot. The magnitude and phase plots are shown above.</p>
<p>The phase plot above displays overall quantization noise and computation noise of FFTW3, since
pure frequency sine wave with zero phase should have been a straight line at 0 degrees.
This plot gives a feel for the accuracy of the computational engine.</p>
<p>There appears to be good correlation between the DFFT magnitude plot generated by SciLAB and
the DFFT magnitude plot generated by the Fortran 2003 code. Of note are is the anomalous
phase results in the output of the Fortran 2003 code. It is unknown at this time what is causing it.  It would be interesting to see the results on a signal with known phase shift.</p>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h2>
<p>The Discretized Fourier Transform of a sine wave at 10 Hz was successfully computed using the FFTW3 library in Fortran. The results were visualized using GNUPlot. The magnitude and phase plots are shown above.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Sections/Computer_Programming/Fortran/DFFT/Sine_Wave_10_Hz"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../DFFT.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Discretized Fourier Transform of Arbitrary Signal Using FFTW3 in Fortran</p>
      </div>
    </a>
    <a class="right-next"
       href="../Square_Wave_1_Hz_50_pct/square_wave_1_hz_50_pct.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Square Wave at 1Hz</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#scilab-code">SciLAB Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#execute-the-scilab-code">Execute the SciLAB Code</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-domain-plot">Time Domain Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frequency-domain-plot">Frequency Domain Plot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#saving-the-time-domain-data">Saving The Time Domain Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#processing-of-csv-file-into-a-format-suitable-for-input-into-the-fortran-2003-dfft-code">Processing of CSV File into a Format Suitable for Input into the Fortran 2003 DFFT Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#execute-the-python-script">Execute the Python Script</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fortran-2003-code">Fortran 2003 Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compile-the-fortran-2003-code">Compile the Fortran 2003 Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#execute-the-fortran-2003-code">Execute the Fortran 2003 Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-the-dfft-results">Visualize the DFFT Results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#results">Results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dfft-magnitude-plot">DFFT Magnitude Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dfft-phase-plot">DFFT Phase Plot</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#discussion">Discussion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Mark Khusid
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../../../_static/scripts/bootstrap.js?digest=26a4bc78f4c0ddb94549"></script>
<script defer src="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=26a4bc78f4c0ddb94549"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>