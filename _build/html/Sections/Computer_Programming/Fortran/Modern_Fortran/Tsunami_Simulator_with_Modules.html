
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Tsunami Simulator with Modules &#8212; MK Dynamics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-BZ3C1QVH0B"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-BZ3C1QVH0B');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-BZ3C1QVH0B');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Sections/Computer_Programming/Fortran/Modern_Fortran/Tsunami_Simulator_with_Modules';</script>
    <link rel="icon" href="../../../../_static/spacey.jpg"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Tsunami Simulator with Modules Plotter" href="Tsunami_Simulator_with_Modules_Plotter.html" />
    <link rel="prev" title="Tsunami Simulator Plotter" href="Tsunami_Simulator_Plotter.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../_static/spacey.jpg" class="logo__image only-light" alt="MK Dynamics - Home"/>
    <img src="../../../../_static/spacey.jpg" class="logo__image only-dark pst-js-only" alt="MK Dynamics - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../intro.html">
                    MK Dynamics
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Cybersecurity</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Cybersecurity/cybersecurity.html">Cybersecurity</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Cybersecurity/Basic_Linux_Exploits/basic_linux_exploits.html">Basic Linux Exploits</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/disassembling_binaries.html">Disassembling Binaries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/Fortran/fortran.html">Fortran</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/Fortran/ARM64/arm64.html">ARM 64 Bit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/Fortran/ARM32/arm32.html">ARM32</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/Fortran/AMD64/amd64.html">AMD64</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/Fortran/i386/i386.html">Intel 32 - Bit</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/C/c.html">C</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/C%2B%2B/c%2B%2B.html">C++</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/Ada/ada.html">Ada</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/Pascal/pascal.html">Pascal</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Cybersecurity/LiveOverflow/liveoverflow.html">LiveOverflow</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Cybersecurity/Protostar/protostar.html">Protostar Exploit Exercises</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../Cybersecurity/Protostar/Stack0/stack0.html">Stack 0</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Protostar/Stack0/Stack0_x86/stack0_x86.html">x86 32-Bit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Protostar/Stack0/Stack0_AMD64/stack0_AMD64.html">AMD64</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Protostar/Stack0/Stack0_ARM32/stack0_ARM32.html">ARM 32 - Bit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Protostar/Stack0/Stack0_ARM64/stack0_ARM64.html">ARM 64 - Bit</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Cybersecurity/SLAE64/SLAE64.html">SLAE64 - x86_64 Assembly Language and Shellcoding on Linux</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../Cybersecurity/SLAE64/Modules/Module_1/Section_3_GDB_Test/section_3_GDB_test.html">Lesson 3 - GDB Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Cybersecurity/SLAE64/Modules/Module_1/Section_5_Hello_World/section_5_hello_world.html">Section 5 - Hello World</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Cybersecurity/Shellcode_Generation_and_Testing/shellcode_generation_and_testing.html">Shellcode Generation and Testing</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Computer Programming</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../computer_programming.html">Computer Programming</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../Assembly/assembly.html">Assembly Language Programming</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../C/c__HEAD__.html">C Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../C/Backdoored_Webserver/backdoored_webserver.html">Backdoored Webserver</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../CPP/cpp.html">C++ Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp__HEAD__.html">Object Oriented Programming Using C++</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_1.html">Chapter 1: Why Object-Oriented Programming in C++?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_2.html">Chapter 2: Native Types and Statements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_3.html">Chapter 3: Functions and Pointers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_4.html">Chapter 4: Implementing ADTs in the Base Language</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_5.html">Chapter 5: Data Hiding and Member Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_6.html">Chapter 6: Object Creation and Destruction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_7.html">Chapter 7: Ad Hoc Polymorphism</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../fortran.html">Fortran Programming</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active has-children"><a class="reference internal" href="modern_fortran.html">Modern Fortran</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="Cold_Front_Calculator.html">Cold Front Calculator</a></li>
<li class="toctree-l4"><a class="reference internal" href="Cold_Front_Calculator_with_Loop.html">Cold Front Calculator With Loop</a></li>
<li class="toctree-l4"><a class="reference internal" href="Tsunami_Simulator.html">Tsunami Simulator</a></li>
<li class="toctree-l4"><a class="reference internal" href="Tsunami_Simulator_Plotter.html">Tsunami Simulator Plotter</a></li>
<li class="toctree-l4 current active"><a class="current reference internal" href="#">Tsunami Simulator with Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="Tsunami_Simulator_with_Modules_Plotter.html">Tsunami Simulator with Modules Plotter</a></li>
<li class="toctree-l4"><a class="reference internal" href="Print_Compiler_Version.html">Print Compiler Version</a></li>
<li class="toctree-l4"><a class="reference internal" href="Analyzing_Time_Series_Data_with_Arrays.html">Analyzing Time Series Data with Arrays</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../Intro_to_Fortran/intro_to_fortran.html">Introduction to Programming Using Fortran</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../Intro_to_Fortran/Section_7_Period_Calculator.html">Section 7: Pendulum Period Calculator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intro_to_Fortran/Section_9_3_SOS_Difference.html">Section 9.3: Difference Between Sum of Squares and Square of Sums</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intro_to_Fortran/Section_12_8_Line_Numbers.html">Section 12.8: Line Numbers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intro_to_Fortran/Section_14_Pi_Estimation.html">Section 14: Pi Estimation</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/guide_to_fortran_2008_programming.html">Guide to Fortran 2008 Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_1_8_Ex_2_Quadratic_Formula.html">Section 1.8 Example 2: Quadratic Equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_1_16_Factorial_Recursion.html">Section 1.16: Factorial Recursion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_2_1_Associate_Construct.html">Section 2.1: Statement Blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_2_1_Statement_Blocks.html">Section 2.1: Associate Construct</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_3_4_Putting_Procedures_in_a_Module.html">Section 3.4: Putting Procedures in a Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_3_6_Ex_1_Median_of_Three.html">Section 3.6: Median of Three</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_3_8_Argument_Passing.html">Section 3.8: Argument Passing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_3_17_Case_Study__Adaptive_Numberical_Integration.html">Section 3.17: Case Study: Adaptive Numerical Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_4_1_Elsewhere_Example.html">Section 4.1: Elsewhere Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_8_1_Submodules.html">Section 8.1: Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_8_2_Time_Matrix_Multiply.html">Section 8.2: Time Matrix Multiply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_8_7_Generic_Elemental_Procedures.html">Section 8.7: Generic Elemental Procedures</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_8_8_Findloc_Function.html">Section 8.8: Findloc Function</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../Fortran_MOOC/fortran_mooc.html">Fortran MOOC</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays.html">Section: Arrays</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_Ball_Throw__Head__.html">Section: Ball Throw</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_Bit_Manipulations__Head__.html">Section: Bit Manipulations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_Floating_Point.html">Section: Floating Point</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_Call_By_Semantics.html">Section: Call By Semantics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_Computing_Pi.html">Section: Computing Pi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_Implicit_vs_Explicit_Loops__Head__.html">Section: Implicit vs Explicit Loops</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_Block_Matrices__Head__.html">Section: Block Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_BLAS_LAPACK__Head__.html">Section: BLAS/LAPACK</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../Neural_Fortran/neural_fortran__HEAD__.html">Neural Fortran</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../Neural_Fortran/Section_Examples_Sine_Wave.html">Neural Fortran Examples: Sine Wave</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../DFFT/DFFT.html">Discretized Fourier Transform of Arbitrary Signal Using FFTW3 in Fortran</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../DFFT/Sine_Wave_10_Hz/sine_wave_10_hz.html">Sine Wave at 10Hz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../DFFT/Square_Wave_1_Hz_50_pct/square_wave_1_hz_50_pct.html">Square Wave at 1Hz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../DFFT/2_Sine_Waves/2sineXHz.html">Two Sine Waves with Different Frequencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../DFFT/Switched_Sine_Wave_1_kHz/switched_sine_wave_1_kHz.html">Switched 1 kHz Sine Wave</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../CSV_Fortran/CSV_Fortran__HEAD__.html">CSV Fortran Module</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../CSV_Fortran/csv_fortran_read_csv.html">Section: Read CSV Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CSV_Fortran/csv_fortran_write_csv.html">Section: Write CSV Files</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../Javascript/javascript.html">Javascript Programming</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Kaggle/kaggle__HEAD__.html">Kaggle</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Kaggle/Python/python__HEAD__.html">Python</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Kaggle/Python/Python_Tutorial/python_tutorial.html">Python Tutorial: Hello, Python!</a></li>

<li class="toctree-l4"><a class="reference internal" href="../../Kaggle/Python/Python_Exercise/python_exercise.html">Python Exercise</a></li>

</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../PHP/php.html">PHP Programming</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Python/python.html">Python Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Python/Python_Playground/Python_Playground__HEAD__.html">Python Playground: Geeky Projects for the Curious Programmer</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Python/Python_Playground/Section_Chapter_2_Draw_Circle.html">Chapter 2: Draw Circle using Turtle Graphics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Python/Python_Playground/Section_Chapter_2_Draw_Spiro.html">Chapter 2: Draw Spiro using Turtle Graphics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Python/Python_Playground/Section_Chapter_3_Conway.html">Chapter 3: Conway’s Game of Life</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Python/Python_Playground/Section_Chapter_4_Karplus_Strong.html">Chapter 4: Karplus Strong Algorithm</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Electronics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Electronics/electronics.html">Electronics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Electronics/Analog_and_Digital/analog_and_digital.html">Analog and Digital Electronics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../Electronics/Analog_and_Digital/AD9850_DDS/AD9850_DDS.html">Variable Frequency Oscillator Using Direct Digital Synthesis</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Electronics/Power_Electronics/power_electronics__HEAD__.html">Power Electronics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../Electronics/Power_Electronics/Power_Supplies/power_supplies__HEAD__.html">Power Supplies</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Electronics/Power_Electronics/Power_Supplies/Forward_Converter_100V_to_5V_10A/forward_converter_100V_to_5V_10A.html">Forward Converter 100V to 5V at 10A</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Electronics/Solar_Power_Projects/solar_power_projects__HEAD__.html">Solar Power Projects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Electronics/Single_Board_Computers_Running_Linux/single_board_computers_running_linux.html">Single Board Computers Running Linux</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Finite Element Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Finite_Element_Analysis/finite_element_analysis.html">Finite Element Analysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Finite_Element_Analysis/CAELinux_for_Thermal_Analysis/caelinux_for_thermal_analysis.html">CAELinux for Thermal Analysis</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Ham Radio</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Ham_Radio/ham_radio.html">Ham Radio</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Ham_Radio/Ham_Radio_Projects/ham_radio_projects.html">Ham Radio Projects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../Ham_Radio/Ham_Radio_Projects/Packet_Radio/packet_radio.html">Packet Radio</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Ham_Radio/Antenna_Simulation_using_4NEC2/antenna_simulation_using_4NEC2.html">Antenna Simulation using 4NEC2</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">About Me</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../About_Me/aboutme.html">About Me</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../About_Me/Resume/resume.html">My Resume</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../About_Me/Certificates/certificates.html">My Certificates</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../About_Me/Certificates/certificates_coursera.html">Coursera Certificates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../About_Me/Certificates/certificates_kaggle.html">Kaggle Certificates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../About_Me/Certificates/certificates_tryhackme.html">Try Hack Me Certificates</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Website Updates</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../Website_Updates/website_updates.html">Website Updates</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Misc/misc__head__.html">Miscellaneous Home</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Misc/useful_links.html">Useful Links</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Misc/cybersecurity_links.html">Cybersecurity Online Resources</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/markkhusid/MKDynamics_Website_V2/master?urlpath=lab/tree/Sections/Computer_Programming/Fortran/Modern_Fortran/Tsunami_Simulator_with_Modules.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://datahub.berkeley.edu/hub/user-redirect/git-pull?repo=https%3A//github.com/markkhusid/MKDynamics_Website_V2&urlpath=lab/tree/MKDynamics_Website_V2/Sections/Computer_Programming/Fortran/Modern_Fortran/Tsunami_Simulator_with_Modules.ipynb&branch=master" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../../../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/markkhusid/MKDynamics_Website_V2/blob/master/Sections/Computer_Programming/Fortran/Modern_Fortran/Tsunami_Simulator_with_Modules.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/markkhusid/MKDynamics_Website_V2" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/markkhusid/MKDynamics_Website_V2/issues/new?title=Issue%20on%20page%20%2FSections/Computer_Programming/Fortran/Modern_Fortran/Tsunami_Simulator_with_Modules.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../_sources/Sections/Computer_Programming/Fortran/Modern_Fortran/Tsunami_Simulator_with_Modules.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tsunami Simulator with Modules</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#program-to-calculate-the-temperature-due-to-a-cold-front-using-a-loop">Program to Calculate the Temperature due to a Cold Front Using a Loop</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-file-mod-inital-f08-contains">The file mod_inital.f08 contains:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-file-mod-diff-f08-contains">The file mod_diff.f08 contains:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main-program">Main Program</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#program-explanation">Program Explanation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-mod-diff">Module: <code class="docutils literal notranslate"><span class="pre">mod_diff</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-mod-initial">Module: <code class="docutils literal notranslate"><span class="pre">mod_initial</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#details">Details:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#program-structure">Program Structure:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#operations">Operations:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-methods">Numerical Methods:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#program-compilation-and-execution">Program Compilation and Execution</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="tsunami-simulator-with-modules">
<h1>Tsunami Simulator with Modules<a class="headerlink" href="#tsunami-simulator-with-modules" title="Link to this heading">#</a></h1>
<p>Adapted from: “<a class="reference external" href="https://www.manning.com/books/modern-fortran">Modern Fortran: Building Efficient Parallel Applications</a>” by Milan Curcic (Manning)</p>
<section id="program-to-calculate-the-temperature-due-to-a-cold-front-using-a-loop">
<h2>Program to Calculate the Temperature due to a Cold Front Using a Loop<a class="headerlink" href="#program-to-calculate-the-temperature-due-to-a-cold-front-using-a-loop" title="Link to this heading">#</a></h2>
<p>In this section the Tsunami Simulator is rewritten using Fortran Modules.</p>
<section id="the-file-mod-inital-f08-contains">
<h3>The file mod_inital.f08 contains:<a class="headerlink" href="#the-file-mod-inital-f08-contains" title="Link to this heading">#</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">module </span><span class="n">mod_initial</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">private</span>
<span class="k">    public</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">set_gaussian</span>

<span class="k">contains</span>
<span class="k">    </span>
<span class="k">    pure subroutine </span><span class="n">set_gaussian</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">icenter</span><span class="p">,</span><span class="w"> </span><span class="n">decay</span><span class="p">)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="w"> </span><span class="n">out</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span><span class="p">(:)</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">icenter</span>
<span class="w">        </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">decay</span>
<span class="w">        </span>
<span class="w">        </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="w">    </span>
<span class="w">        </span><span class="k">do</span><span class="w"> </span><span class="k">concurrent</span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">size</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="w">            </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="n">decay</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">icenter</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="w">        </span><span class="k">end do</span>
<span class="k">    end subroutine </span><span class="n">set_gaussian</span>
<span class="w">    </span>
<span class="k">end module </span><span class="n">mod_initial</span>
</pre></div>
</div>
</section>
<section id="the-file-mod-diff-f08-contains">
<h3>The file mod_diff.f08 contains:<a class="headerlink" href="#the-file-mod-diff-f08-contains" title="Link to this heading">#</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">! %module magic necessary so that jupyter fortran kernel knows that </span>
<span class="c">! the code below is to be compiled as a module and not executable code.</span>
<span class="c">!%module: mod_diff </span>
<span class="k">module </span><span class="n">mod_diff</span>

<span class="w">    </span><span class="k">use </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">int32</span><span class="p">,</span><span class="w"> </span><span class="n">real32</span>
<span class="w">    </span><span class="k">implicit none</span>
<span class="k">    </span>
<span class="k">    private</span>
<span class="k">    public</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">diff_upwind</span><span class="p">,</span><span class="w"> </span><span class="n">diff_centered</span>
<span class="w">    </span>
<span class="k">contains</span>

<span class="k">    pure function </span><span class="n">diff_upwind</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span><span class="p">(:)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">)</span><span class="w">             </span><span class="kd">::</span><span class="w"> </span><span class="n">dx</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w">           </span><span class="kd">::</span><span class="w"> </span><span class="n">im</span>
<span class="w">        </span>
<span class="w">        </span><span class="n">im</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">        </span><span class="n">dx</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
<span class="w">        </span><span class="n">dx</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="n">im</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="n">im</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">im</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="k">end function </span><span class="n">diff_upwind</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">pure function </span><span class="n">diff_centered</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x</span><span class="p">(:)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">)</span><span class="w">             </span><span class="kd">::</span><span class="w"> </span><span class="n">dx</span><span class="p">(</span><span class="n">size</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w">           </span><span class="kd">::</span><span class="w"> </span><span class="n">im</span>
<span class="w">        </span>
<span class="w">        </span><span class="n">im</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="w">        </span><span class="n">dx</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
<span class="w">        </span><span class="n">dx</span><span class="p">(</span><span class="n">im</span><span class="p">)</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="n">im</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="n">dx</span><span class="p">(</span><span class="mi">2</span><span class="p">:</span><span class="n">im</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="n">im</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">im</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="w">    </span><span class="k">end function </span><span class="n">diff_centered</span>
<span class="w">    </span>
<span class="k">end module </span><span class="n">mod_diff</span>
</pre></div>
</div>
</section>
<section id="main-program">
<h3>Main Program<a class="headerlink" href="#main-program" title="Link to this heading">#</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">program </span><span class="n">tsunami</span>

<span class="w">    </span><span class="k">use </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">int32</span><span class="p">,</span><span class="w"> </span><span class="n">real32</span>
<span class="w">    </span><span class="k">use </span><span class="n">mod_diff</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="w">        </span><span class="p">:</span><span class="w"> </span><span class="n">diff</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">diff_centered</span>
<span class="w">    </span><span class="k">use </span><span class="n">mod_initial</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="w">     </span><span class="p">:</span><span class="w"> </span><span class="n">set_gaussian</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">implicit none</span>
<span class="k">    </span>
<span class="k">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">n</span>
<span class="w">    </span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">grid_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">num_time_steps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5000</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">),</span><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.02</span><span class="p">,</span><span class="w"> </span><span class="n">dx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">9.8</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">),</span><span class="w">   </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">hmean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>
<span class="w">    </span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">)</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">h</span><span class="p">(</span><span class="n">grid_size</span><span class="p">),</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="n">grid_size</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="kt">integer</span><span class="p">(</span><span class="n">int32</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">icenter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span>
<span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">real32</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">decay</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.02</span>
<span class="w">    </span>
<span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">file_exists</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">open</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;tsunami_simulator_with_modules_data.txt&#39;</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">grid_size</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">stop</span><span class="w"> </span><span class="s1">&#39;grid_size must be &gt; 0&#39;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dt</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">stop</span><span class="w"> </span><span class="s1">&#39;time step dt must be &gt; 0&#39;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">dx</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">stop</span><span class="w"> </span><span class="s1">&#39;grid spacing dx must be &gt; 0&#39;</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">call </span><span class="n">set_gaussian</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="n">icenter</span><span class="p">,</span><span class="w"> </span><span class="n">decay</span><span class="p">)</span>
<span class="w">    </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span>
<span class="w">    </span><span class="c">!print *, 0, h</span>
<span class="w">    </span><span class="k">write</span><span class="w"> </span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">h</span>
<span class="w">    </span><span class="k">close</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="w">    </span>
<span class="w">    </span><span class="n">time_loop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_time_steps</span>
<span class="w">        </span>
<span class="w">        </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">u</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">diff</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">g</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">diff</span><span class="p">(</span><span class="n">h</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dx</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dt</span>
<span class="w">        </span><span class="n">h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">h</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">diff</span><span class="p">(</span><span class="n">u</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="n">hmean</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">h</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">dx</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dt</span>
<span class="w">        </span>
<span class="w">        </span><span class="c">!print *, n, h</span>
<span class="w">        </span>
<span class="w">        </span><span class="k">inquire</span><span class="p">(</span><span class="k">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;tsunami_simulator_with_modules_data.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">exist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">file_exists</span><span class="p">)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">file_exists</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">            open</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;tsunami_simulator_with_modules_data.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;old&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;append&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;write&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">else</span>
<span class="k">            open</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;tsunami_simulator_with_modules_data.txt&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;new&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;write&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">        </span>
<span class="k">        write</span><span class="w"> </span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="n">h</span>

<span class="w">    </span><span class="k">end do </span><span class="n">time_loop</span>
<span class="w">     </span>
<span class="w">    </span><span class="k">close</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="w">    </span>
<span class="k">end program </span><span class="n">tsunami</span>
</pre></div>
</div>
</section>
</section>
<section id="program-explanation">
<h2>Program Explanation<a class="headerlink" href="#program-explanation" title="Link to this heading">#</a></h2>
<p>The following explanation is given by “Code Copilot” within ChatGPT 4.</p>
<p>The Fortran module <code class="docutils literal notranslate"><span class="pre">mod_diff.f90</span></code> defines a module named <code class="docutils literal notranslate"><span class="pre">mod_diff</span></code> that provides numerical differentiation functionalities tailored for use in simulations or numerical methods. Here’s an overview of its content:</p>
<section id="module-mod-diff">
<h3>Module: <code class="docutils literal notranslate"><span class="pre">mod_diff</span></code><a class="headerlink" href="#module-mod-diff" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Dependencies</strong>: It uses the standard Fortran module <code class="docutils literal notranslate"><span class="pre">iso_fortran_env</span></code> for access to predefined kinds like <code class="docutils literal notranslate"><span class="pre">int32</span></code> for integers and <code class="docutils literal notranslate"><span class="pre">real32</span></code> for single-precision floating-point numbers.</p></li>
<li><p><strong>Functions</strong>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">diff_upwind(x)</span></code>: This function implements the upwind differencing scheme. It is used to approximate derivatives in problems where information propagates in one direction (like fluid flow in one direction). The output <code class="docutils literal notranslate"><span class="pre">dx</span></code> is a vector where each element is calculated as the difference between consecutive elements of the input vector <code class="docutils literal notranslate"><span class="pre">x</span></code>, except the first element, which is the difference between the first and last elements, simulating a wrap-around or periodic boundary condition.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">diff_centered(x)</span></code>: This function implements the centered differencing scheme, which is more accurate but also more sensitive to numerical errors. The function computes differences such that each element of the result <code class="docutils literal notranslate"><span class="pre">dx</span></code> is the difference between elements of <code class="docutils literal notranslate"><span class="pre">x</span></code> that are one step apart, with special handling for the first and last elements to manage boundary effects.</p></li>
</ul>
</li>
</ul>
<p>These functions are declared as <code class="docutils literal notranslate"><span class="pre">pure</span></code>, which in Fortran ensures that they do not have side-effects, an essential property for functions that are intended to be used in parallel computations or where determinism is critical.</p>
<p>Both functions are designed to operate on arrays of single-precision floating-point numbers, indicating their intended use in applications where performance and memory usage are balanced against the precision of calculations.</p>
<p>This module can be used in larger Fortran programs or simulations where numerical differentiation is required, such as in fluid dynamics, weather modeling, or other computational physics simulations.</p>
<p>Let’s proceed to analyze the other files for a complete understanding of the entire program.</p>
<p>The Fortran module <code class="docutils literal notranslate"><span class="pre">mod_initial.f90</span></code> defines a module named <code class="docutils literal notranslate"><span class="pre">mod_initial</span></code> that includes functionality for initializing arrays based on specific patterns. Here’s an overview of its content:</p>
</section>
<section id="module-mod-initial">
<h3>Module: <code class="docutils literal notranslate"><span class="pre">mod_initial</span></code><a class="headerlink" href="#module-mod-initial" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Subroutine</strong>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">set_gaussian(x,</span> <span class="pre">icenter,</span> <span class="pre">decay)</span></code>: This subroutine initializes an array <code class="docutils literal notranslate"><span class="pre">x</span></code> with a Gaussian (or normal distribution) curve centered at the index <code class="docutils literal notranslate"><span class="pre">icenter</span></code> with a specified <code class="docutils literal notranslate"><span class="pre">decay</span></code> rate. This pattern is commonly used in simulations for setting initial conditions where phenomena like wave packets or other localized features are described.</p></li>
</ul>
</li>
</ul>
</section>
<section id="details">
<h3>Details:<a class="headerlink" href="#details" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Input/Output</strong>: The subroutine operates directly on the array <code class="docutils literal notranslate"><span class="pre">x</span></code> passed to it, modifying it in place (as indicated by <code class="docutils literal notranslate"><span class="pre">intent(in</span> <span class="pre">out)</span></code>). This approach is typical in Fortran where arrays are often modified directly rather than returned.</p></li>
<li><p><strong>Parameters</strong>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">icenter</span></code>: An integer specifying the center position of the Gaussian distribution within the array.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">decay</span></code>: A real number that controls the width of the bell curve; higher values make the curve narrower.</p></li>
</ul>
</li>
<li><p><strong>Loop</strong>:</p>
<ul>
<li><p>The Gaussian values are computed using a concurrent loop (<code class="docutils literal notranslate"><span class="pre">do</span> <span class="pre">concurrent</span></code>), which allows for parallel computation where supported. Each element <code class="docutils literal notranslate"><span class="pre">x(i)</span></code> is set to <code class="docutils literal notranslate"><span class="pre">exp(-decay</span> <span class="pre">*</span> <span class="pre">(i</span> <span class="pre">-</span> <span class="pre">icenter)**2)</span></code>, which is the formula for a Gaussian function.</p></li>
</ul>
</li>
</ul>
<p>This module is particularly useful in simulations where initial conditions need to be defined in a spatially varying manner, such as setting up initial wave conditions in a medium or initial concentration distributions in simulations of diffusion processes.</p>
<p>We will next examine the main program file <code class="docutils literal notranslate"><span class="pre">tsunami_simulator_with_modules.f90</span></code> to understand how these modules are utilized in a larger context.</p>
<p>The Fortran program <code class="docutils literal notranslate"><span class="pre">tsunami_simulator_with_modules.f90</span></code> implements a simple model for simulating tsunami waves using numerical methods. Here’s a detailed explanation of the program:</p>
</section>
<section id="program-structure">
<h3>Program Structure:<a class="headerlink" href="#program-structure" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Modules Used</strong>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">mod_diff</span></code>: Provides the <code class="docutils literal notranslate"><span class="pre">diff_centered</span></code> function for numerical differentiation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mod_initial</span></code>: Contains the <code class="docutils literal notranslate"><span class="pre">set_gaussian</span></code> subroutine for initializing wave heights.</p></li>
</ul>
</li>
<li><p><strong>Main Variables</strong>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">grid_size</span></code>: Defines the size of the grid (number of spatial points).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_time_steps</span></code>: Specifies the number of time steps for the simulation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dt</span></code>: Time step increment.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dx</span></code>: Spatial step increment.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">g</span></code>: Gravitational constant (approximately 9.8 m/s²).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hmean</span></code>: Mean height of the ocean layer.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">h</span></code>: Array representing the height of the wave at each grid point.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">u</span></code>: Array representing the velocity of the wave at each grid point.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">icenter</span></code> and <code class="docutils literal notranslate"><span class="pre">decay</span></code>: Parameters for the initial Gaussian distribution of the wave.</p></li>
</ul>
</li>
</ul>
</section>
<section id="operations">
<h3>Operations:<a class="headerlink" href="#operations" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Initial Conditions</strong>: The water height array <code class="docutils literal notranslate"><span class="pre">h</span></code> is initialized using a Gaussian distribution centered at <code class="docutils literal notranslate"><span class="pre">icenter</span></code> with a decay specified by <code class="docutils literal notranslate"><span class="pre">decay</span></code>. The velocity array <code class="docutils literal notranslate"><span class="pre">u</span></code> is initialized to zero.</p></li>
<li><p><strong>Output File</strong>: Data is initially written to a file <code class="docutils literal notranslate"><span class="pre">tsunami_simulator_with_modules_data.txt</span></code>, and the wave height at each time step is appended to this file.</p></li>
<li><p><strong>Simulation Loop (<code class="docutils literal notranslate"><span class="pre">time_loop</span></code>)</strong>:</p>
<ul class="simple">
<li><p>The velocities (<code class="docutils literal notranslate"><span class="pre">u</span></code>) are updated based on the gradient of the velocities and heights. The updates are scaled by <code class="docutils literal notranslate"><span class="pre">dt/dx</span></code> to maintain stability and accuracy.</p></li>
<li><p>The heights (<code class="docutils literal notranslate"><span class="pre">h</span></code>) are updated based on the divergence of the product of velocity and the sum of mean height and wave height. This mimics the conservation of mass in a fluid.</p></li>
</ul>
</li>
<li><p><strong>File Handling</strong>: Checks if the output file exists and writes data accordingly. If the file does not exist, it is created.</p></li>
</ol>
</section>
<section id="numerical-methods">
<h3>Numerical Methods:<a class="headerlink" href="#numerical-methods" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The simulation uses centered differences (<code class="docutils literal notranslate"><span class="pre">diff_centered</span></code> from <code class="docutils literal notranslate"><span class="pre">mod_diff</span></code>) to compute spatial derivatives. Centered differences provide a good balance between accuracy and numerical stability.</p></li>
<li><p>The time integration method appears to be a straightforward forward Euler method, which is simple but conditionally stable.</p></li>
</ul>
<p>This program is an example of how modular Fortran programming can be used to build clean and maintainable scientific simulations. The use of separate modules for different functionalities (like initial condition setting and differentiation) makes the code easier to manage and modify.</p>
</section>
</section>
<section id="program-compilation-and-execution">
<h2>Program Compilation and Execution<a class="headerlink" href="#program-compilation-and-execution" title="Link to this heading">#</a></h2>
<p>The above program is compiled and run using Fortran Package Manager (fpm):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">root_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">code_dir</span> <span class="o">=</span> <span class="n">root_dir</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="s2">&quot;Fortran_Code/Tsunami_Simulator_with_Modules&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">code_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">build_status</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;fpm build 2&gt;/dev/null&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exec_status</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;fpm run 2&gt;/dev/null&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The above Fortran code writes the calculations to a file called <strong>tsunami_simulator_with_modules_data.txt</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">output_filename</span> <span class="o">=</span> <span class="s1">&#39;tsunami_simulator_with_modules_data.txt&#39;</span>
<span class="n">data_file</span> <span class="o">=</span> <span class="n">code_dir</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">output_filename</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_fwf</span><span class="p">(</span><span class="n">data_file</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">table</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>91</th>
      <th>92</th>
      <th>93</th>
      <th>94</th>
      <th>95</th>
      <th>96</th>
      <th>97</th>
      <th>98</th>
      <th>99</th>
      <th>100</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0.000010</td>
      <td>0.000025</td>
      <td>0.000063</td>
      <td>0.000148</td>
      <td>0.000335</td>
      <td>0.000732</td>
      <td>0.001534</td>
      <td>0.003089</td>
      <td>0.005976</td>
      <td>...</td>
      <td>1.459711e-38</td>
      <td>1.021038e-39</td>
      <td>6.862018e-41</td>
      <td>4.430906e-42</td>
      <td>2.746545e-43</td>
      <td>1.681558e-44</td>
      <td>1.401298e-45</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0.000012</td>
      <td>0.000029</td>
      <td>0.000071</td>
      <td>0.000166</td>
      <td>0.000372</td>
      <td>0.000801</td>
      <td>0.001661</td>
      <td>0.003311</td>
      <td>0.006346</td>
      <td>...</td>
      <td>1.171803e-37</td>
      <td>8.800796e-39</td>
      <td>6.354580e-40</td>
      <td>4.410867e-41</td>
      <td>2.942727e-42</td>
      <td>1.891753e-43</td>
      <td>1.261169e-44</td>
      <td>0.000000e+00</td>
      <td>3.892368e-07</td>
      <td>9.964396e-07</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>0.000015</td>
      <td>0.000037</td>
      <td>0.000089</td>
      <td>0.000204</td>
      <td>0.000447</td>
      <td>0.000944</td>
      <td>0.001921</td>
      <td>0.003764</td>
      <td>0.007097</td>
      <td>...</td>
      <td>9.342945e-37</td>
      <td>7.469310e-38</td>
      <td>5.746058e-39</td>
      <td>4.253277e-40</td>
      <td>3.029047e-41</td>
      <td>2.075323e-42</td>
      <td>1.525808e-08</td>
      <td>3.906043e-08</td>
      <td>1.202751e-06</td>
      <td>3.060115e-06</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>0.000021</td>
      <td>0.000050</td>
      <td>0.000118</td>
      <td>0.000264</td>
      <td>0.000566</td>
      <td>0.001169</td>
      <td>0.002327</td>
      <td>0.004463</td>
      <td>0.008249</td>
      <td>...</td>
      <td>6.785309e-36</td>
      <td>5.755973e-37</td>
      <td>4.703170e-38</td>
      <td>3.701251e-39</td>
      <td>5.981168e-10</td>
      <td>1.531169e-09</td>
      <td>7.646778e-08</td>
      <td>1.950150e-07</td>
      <td>2.517209e-06</td>
      <td>6.346270e-06</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>0.000030</td>
      <td>0.000070</td>
      <td>0.000161</td>
      <td>0.000351</td>
      <td>0.000736</td>
      <td>0.001487</td>
      <td>0.002896</td>
      <td>0.005436</td>
      <td>0.009836</td>
      <td>...</td>
      <td>4.514822e-35</td>
      <td>4.051931e-36</td>
      <td>2.344618e-11</td>
      <td>6.002181e-11</td>
      <td>4.146878e-09</td>
      <td>1.058688e-08</td>
      <td>2.303804e-07</td>
      <td>5.845143e-07</td>
      <td>4.464170e-06</td>
      <td>1.112178e-05</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4996</th>
      <td>96</td>
      <td>0.178242</td>
      <td>0.145647</td>
      <td>0.101621</td>
      <td>0.100381</td>
      <td>0.122926</td>
      <td>0.120063</td>
      <td>0.123888</td>
      <td>0.116525</td>
      <td>-0.085472</td>
      <td>...</td>
      <td>3.023120e+00</td>
      <td>5.041199e+00</td>
      <td>4.517421e+00</td>
      <td>2.471580e+00</td>
      <td>9.274478e-01</td>
      <td>2.414372e-01</td>
      <td>-1.293256e-02</td>
      <td>1.105624e-01</td>
      <td>1.427006e-01</td>
      <td>1.615230e-01</td>
    </tr>
    <tr>
      <th>4997</th>
      <td>97</td>
      <td>0.166096</td>
      <td>0.137091</td>
      <td>-0.096517</td>
      <td>0.101448</td>
      <td>0.132967</td>
      <td>0.122498</td>
      <td>0.113014</td>
      <td>0.109682</td>
      <td>-0.084616</td>
      <td>...</td>
      <td>1.779129e+00</td>
      <td>4.351381e+00</td>
      <td>5.147950e+00</td>
      <td>3.494045e+00</td>
      <td>1.534592e+00</td>
      <td>4.983789e-01</td>
      <td>9.174558e-02</td>
      <td>-7.311907e-02</td>
      <td>1.347228e-01</td>
      <td>1.539230e-01</td>
    </tr>
    <tr>
      <th>4998</th>
      <td>98</td>
      <td>0.150033</td>
      <td>0.127765</td>
      <td>-0.095495</td>
      <td>0.104681</td>
      <td>0.140813</td>
      <td>0.123673</td>
      <td>0.101828</td>
      <td>0.102024</td>
      <td>-0.084990</td>
      <td>...</td>
      <td>7.355422e-01</td>
      <td>3.197397e+00</td>
      <td>5.167335e+00</td>
      <td>4.501298e+00</td>
      <td>2.378713e+00</td>
      <td>9.002837e-01</td>
      <td>2.534103e-01</td>
      <td>-1.492602e-02</td>
      <td>1.189377e-01</td>
      <td>1.425529e-01</td>
    </tr>
    <tr>
      <th>4999</th>
      <td>99</td>
      <td>0.130618</td>
      <td>0.118058</td>
      <td>-0.098317</td>
      <td>0.109524</td>
      <td>0.145394</td>
      <td>0.123321</td>
      <td>-0.091511</td>
      <td>-0.094122</td>
      <td>-0.086058</td>
      <td>...</td>
      <td>2.072203e-02</td>
      <td>1.919918e+00</td>
      <td>4.503167e+00</td>
      <td>5.186921e+00</td>
      <td>3.417265e+00</td>
      <td>1.503764e+00</td>
      <td>5.057256e-01</td>
      <td>7.775510e-02</td>
      <td>-8.935884e-02</td>
      <td>1.256339e-01</td>
    </tr>
    <tr>
      <th>5000</th>
      <td>0</td>
      <td>0.108276</td>
      <td>0.108241</td>
      <td>0.104191</td>
      <td>0.115224</td>
      <td>0.146075</td>
      <td>0.121337</td>
      <td>-0.083074</td>
      <td>-0.086573</td>
      <td>-0.087238</td>
      <td>...</td>
      <td>3.938838e-01</td>
      <td>8.310862e-01</td>
      <td>3.336946e+00</td>
      <td>5.263032e+00</td>
      <td>4.469062e+00</td>
      <td>2.348540e+00</td>
      <td>8.970855e-01</td>
      <td>2.271172e-01</td>
      <td>-3.692843e-02</td>
      <td>1.003862e-01</td>
    </tr>
  </tbody>
</table>
<p>5001 rows × 101 columns</p>
</div></div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "markkhusid/MKDynamics_Website_V2",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Sections/Computer_Programming/Fortran/Modern_Fortran"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Tsunami_Simulator_Plotter.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tsunami Simulator Plotter</p>
      </div>
    </a>
    <a class="right-next"
       href="Tsunami_Simulator_with_Modules_Plotter.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Tsunami Simulator with Modules Plotter</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#program-to-calculate-the-temperature-due-to-a-cold-front-using-a-loop">Program to Calculate the Temperature due to a Cold Front Using a Loop</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-file-mod-inital-f08-contains">The file mod_inital.f08 contains:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-file-mod-diff-f08-contains">The file mod_diff.f08 contains:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main-program">Main Program</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#program-explanation">Program Explanation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-mod-diff">Module: <code class="docutils literal notranslate"><span class="pre">mod_diff</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#module-mod-initial">Module: <code class="docutils literal notranslate"><span class="pre">mod_initial</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#details">Details:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#program-structure">Program Structure:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#operations">Operations:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-methods">Numerical Methods:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#program-compilation-and-execution">Program Compilation and Execution</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Mark Khusid
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>