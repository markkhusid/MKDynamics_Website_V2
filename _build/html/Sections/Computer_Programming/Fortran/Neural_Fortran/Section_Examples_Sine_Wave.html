
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Neural Fortran Examples: Sine Wave &#8212; MK Dynamics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-BZ3C1QVH0B"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-BZ3C1QVH0B');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-BZ3C1QVH0B');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Sections/Computer_Programming/Fortran/Neural_Fortran/Section_Examples_Sine_Wave';</script>
    <link rel="icon" href="../../../../_static/spacey.jpg"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Discretized Fourier Transform of Arbitrary Signal Using FFTW3 in Fortran" href="../DFFT/DFFT.html" />
    <link rel="prev" title="Neural Fortran" href="neural_fortran__HEAD__.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../_static/spacey.jpg" class="logo__image only-light" alt="MK Dynamics - Home"/>
    <img src="../../../../_static/spacey.jpg" class="logo__image only-dark pst-js-only" alt="MK Dynamics - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../intro.html">
                    MK Dynamics
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Cybersecurity</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Cybersecurity/cybersecurity.html">Cybersecurity</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Cybersecurity/Basic_Linux_Exploits/basic_linux_exploits.html">Basic Linux Exploits</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/disassembling_binaries.html">Disassembling Binaries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/Fortran/fortran.html">Fortran</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/Fortran/ARM64/arm64.html">ARM 64 Bit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/Fortran/ARM32/arm32.html">ARM32</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/Fortran/AMD64/amd64.html">AMD64</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/Fortran/i386/i386.html">Intel 32 - Bit</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/C/c.html">C</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/C%2B%2B/c%2B%2B.html">C++</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/Ada/ada.html">Ada</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/Pascal/pascal.html">Pascal</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Cybersecurity/LiveOverflow/liveoverflow.html">LiveOverflow</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Cybersecurity/Protostar/protostar.html">Protostar Exploit Exercises</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../Cybersecurity/Protostar/Stack0/stack0.html">Stack 0</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Protostar/Stack0/Stack0_x86/stack0_x86.html">x86 32-Bit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Protostar/Stack0/Stack0_AMD64/stack0_AMD64.html">AMD64</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Protostar/Stack0/Stack0_ARM32/stack0_ARM32.html">ARM 32 - Bit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Protostar/Stack0/Stack0_ARM64/stack0_ARM64.html">ARM 64 - Bit</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Cybersecurity/SLAE64/SLAE64.html">SLAE64 - x86_64 Assembly Language and Shellcoding on Linux</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../Cybersecurity/SLAE64/Modules/Module_1/Section_3_GDB_Test/section_3_GDB_test.html">Lesson 3 - GDB Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Cybersecurity/SLAE64/Modules/Module_1/Section_5_Hello_World/section_5_hello_world.html">Section 5 - Hello World</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Cybersecurity/Shellcode_Generation_and_Testing/shellcode_generation_and_testing.html">Shellcode Generation and Testing</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Computer Programming</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../computer_programming.html">Computer Programming</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../Assembly/assembly.html">Assembly Language Programming</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../C/c__HEAD__.html">C Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../C/Backdoored_Webserver/backdoored_webserver.html">Backdoored Webserver</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../CPP/cpp.html">C++ Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp__HEAD__.html">Object Oriented Programming Using C++</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_1.html">Chapter 1: Why Object-Oriented Programming in C++?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_2.html">Chapter 2: Native Types and Statements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_3.html">Chapter 3: Functions and Pointers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_4.html">Chapter 4: Implementing ADTs in the Base Language</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_5.html">Chapter 5: Data Hiding and Member Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_6.html">Chapter 6: Object Creation and Destruction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_7.html">Chapter 7: Ad Hoc Polymorphism</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../fortran.html">Fortran Programming</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="../Modern_Fortran/modern_fortran.html">Modern Fortran</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../Modern_Fortran/Cold_Front_Calculator.html">Cold Front Calculator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Modern_Fortran/Cold_Front_Calculator_with_Loop.html">Cold Front Calculator With Loop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Modern_Fortran/Tsunami_Simulator.html">Tsunami Simulator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Modern_Fortran/Tsunami_Simulator_Plotter.html">Tsunami Simulator Plotter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Modern_Fortran/Tsunami_Simulator_with_Modules.html">Tsunami Simulator with Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Modern_Fortran/Tsunami_Simulator_with_Modules_Plotter.html">Tsunami Simulator with Modules Plotter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Modern_Fortran/Print_Compiler_Version.html">Print Compiler Version</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Modern_Fortran/Analyzing_Time_Series_Data_with_Arrays.html">Analyzing Time Series Data with Arrays</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../Intro_to_Fortran/intro_to_fortran.html">Introduction to Programming Using Fortran</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../Intro_to_Fortran/Section_7_Period_Calculator.html">Section 7: Pendulum Period Calculator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intro_to_Fortran/Section_9_3_SOS_Difference.html">Section 9.3: Difference Between Sum of Squares and Square of Sums</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intro_to_Fortran/Section_12_8_Line_Numbers.html">Section 12.8: Line Numbers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Intro_to_Fortran/Section_14_Pi_Estimation.html">Section 14: Pi Estimation</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/guide_to_fortran_2008_programming.html">Guide to Fortran 2008 Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_1_8_Ex_2_Quadratic_Formula.html">Section 1.8 Example 2: Quadratic Equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_1_16_Factorial_Recursion.html">Section 1.16: Factorial Recursion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_2_1_Associate_Construct.html">Section 2.1: Statement Blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_2_1_Statement_Blocks.html">Section 2.1: Associate Construct</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_3_4_Putting_Procedures_in_a_Module.html">Section 3.4: Putting Procedures in a Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_3_6_Ex_1_Median_of_Three.html">Section 3.6: Median of Three</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_3_8_Argument_Passing.html">Section 3.8: Argument Passing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_3_17_Case_Study__Adaptive_Numberical_Integration.html">Section 3.17: Case Study: Adaptive Numerical Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_4_1_Elsewhere_Example.html">Section 4.1: Elsewhere Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_8_1_Submodules.html">Section 8.1: Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_8_2_Time_Matrix_Multiply.html">Section 8.2: Time Matrix Multiply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_8_7_Generic_Elemental_Procedures.html">Section 8.7: Generic Elemental Procedures</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Guide_to_Fortran_2008_Programming/Section_8_8_Findloc_Function.html">Section 8.8: Findloc Function</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../Fortran_MOOC/fortran_mooc.html">Fortran MOOC</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_Arrays.html">Section: Arrays</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_Ball_Throw__Head__.html">Section: Ball Throw</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_Bit_Manipulations__Head__.html">Section: Bit Manipulations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_Floating_Point.html">Section: Floating Point</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_Call_By_Semantics.html">Section: Call By Semantics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_Computing_Pi.html">Section: Computing Pi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_Implicit_vs_Explicit_Loops__Head__.html">Section: Implicit vs Explicit Loops</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_Block_Matrices__Head__.html">Section: Block Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../Fortran_MOOC/Section_BLAS_LAPACK__Head__.html">Section: BLAS/LAPACK</a></li>
</ul>
</details></li>
<li class="toctree-l3 current active has-children"><a class="reference internal" href="neural_fortran__HEAD__.html">Neural Fortran</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l4 current active"><a class="current reference internal" href="#">Neural Fortran Examples: Sine Wave</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../DFFT/DFFT.html">Discretized Fourier Transform of Arbitrary Signal Using FFTW3 in Fortran</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../DFFT/Sine_Wave_10_Hz/sine_wave_10_hz.html">Sine Wave at 10Hz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../DFFT/Square_Wave_1_Hz_50_pct/square_wave_1_hz_50_pct.html">Square Wave at 1Hz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../DFFT/2_Sine_Waves/2sineXHz.html">Two Sine Waves with Different Frequencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../DFFT/Switched_Sine_Wave_1_kHz/switched_sine_wave_1_kHz.html">Switched 1 kHz Sine Wave</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../CSV_Fortran/CSV_Fortran__HEAD__.html">CSV Fortran Module</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../CSV_Fortran/csv_fortran_read_csv.html">Section: Read CSV Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../CSV_Fortran/csv_fortran_write_csv.html">Section: Write CSV Files</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../Javascript/javascript.html">Javascript Programming</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Kaggle/kaggle__HEAD__.html">Kaggle</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Kaggle/Python/python__HEAD__.html">Python</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Kaggle/Python/Python_Tutorial/python_tutorial.html">Python Tutorial: Hello, Python!</a></li>

<li class="toctree-l4"><a class="reference internal" href="../../Kaggle/Python/Python_Exercise/python_exercise.html">Python Exercise</a></li>

</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../PHP/php.html">PHP Programming</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Python/python.html">Python Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Python/Python_Playground/Python_Playground__HEAD__.html">Python Playground: Geeky Projects for the Curious Programmer</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Python/Python_Playground/Section_Chapter_2_Draw_Circle.html">Chapter 2: Draw Circle using Turtle Graphics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Python/Python_Playground/Section_Chapter_2_Draw_Spiro.html">Chapter 2: Draw Spiro using Turtle Graphics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Python/Python_Playground/Section_Chapter_3_Conway.html">Chapter 3: Conway’s Game of Life</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Python/Python_Playground/Section_Chapter_4_Karplus_Strong.html">Chapter 4: Karplus Strong Algorithm</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../Jupyter_Widgets/Using_Interact.html">IPyWidgets: Using Interact</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Electronics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Electronics/electronics.html">Electronics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Electronics/Analog_and_Digital/analog_and_digital.html">Analog and Digital Electronics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../Electronics/Analog_and_Digital/AD9850_DDS/AD9850_DDS.html">Variable Frequency Oscillator Using Direct Digital Synthesis</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Electronics/Power_Electronics/power_electronics__HEAD__.html">Power Electronics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../Electronics/Power_Electronics/Power_Supplies/power_supplies__HEAD__.html">Power Supplies</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Electronics/Power_Electronics/Power_Supplies/Forward_Converter_100V_to_5V_10A/forward_converter_100V_to_5V_10A.html">Forward Converter 100V to 5V at 10A</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Electronics/Solar_Power_Projects/solar_power_projects__HEAD__.html">Solar Power Projects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Electronics/Single_Board_Computers_Running_Linux/single_board_computers_running_linux.html">Single Board Computers Running Linux</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Finite Element Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Finite_Element_Analysis/finite_element_analysis.html">Finite Element Analysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Finite_Element_Analysis/CAELinux_for_Thermal_Analysis/caelinux_for_thermal_analysis.html">CAELinux for Thermal Analysis</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Ham Radio</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Ham_Radio/ham_radio.html">Ham Radio</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Ham_Radio/Ham_Radio_Projects/ham_radio_projects.html">Ham Radio Projects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../Ham_Radio/Ham_Radio_Projects/Packet_Radio/packet_radio.html">Packet Radio</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Ham_Radio/Antenna_Simulation_using_4NEC2/antenna_simulation_using_4NEC2.html">Antenna Simulation using 4NEC2</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">About Me</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../About_Me/aboutme.html">About Me</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../About_Me/Resume/resume.html">My Resume</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../About_Me/Certificates/certificates.html">My Certificates</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../About_Me/Certificates/certificates_coursera.html">Coursera Certificates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../About_Me/Certificates/certificates_kaggle.html">Kaggle Certificates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../About_Me/Certificates/certificates_tryhackme.html">Try Hack Me Certificates</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Website Updates</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../Website_Updates/website_updates.html">Website Updates</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Misc/misc__head__.html">Miscellaneous Home</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Misc/useful_links.html">Useful Links</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Misc/cybersecurity_links.html">Cybersecurity Online Resources</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/markkhusid/MKDynamics_Website_V2/master?urlpath=lab/tree/Sections/Computer_Programming/Fortran/Neural_Fortran/Section_Examples_Sine_Wave.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://datahub.berkeley.edu/hub/user-redirect/git-pull?repo=https%3A//github.com/markkhusid/MKDynamics_Website_V2&urlpath=lab/tree/MKDynamics_Website_V2/Sections/Computer_Programming/Fortran/Neural_Fortran/Section_Examples_Sine_Wave.ipynb&branch=master" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../../../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/markkhusid/MKDynamics_Website_V2/blob/master/Sections/Computer_Programming/Fortran/Neural_Fortran/Section_Examples_Sine_Wave.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/markkhusid/MKDynamics_Website_V2" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/markkhusid/MKDynamics_Website_V2/issues/new?title=Issue%20on%20page%20%2FSections/Computer_Programming/Fortran/Neural_Fortran/Section_Examples_Sine_Wave.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../_sources/Sections/Computer_Programming/Fortran/Neural_Fortran/Section_Examples_Sine_Wave.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Neural Fortran Examples: Sine Wave</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-network-theory-by-chatgpt-o1">Neural Network Theory by ChatGPT o1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dense-neural-network-structure">Dense Neural Network Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forward-pass-equations">Forward Pass Equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-with-gradient-descent">Training With Gradient Descent</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code-analysis-by-chatgtp-o1">Code Analysis by ChatGTP o1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports-and-declarations">1. <strong>Imports and Declarations</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#csv-logging-initialization">2. <strong>CSV Logging Initialization</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-network-dimensions-and-data-arrays">3. <strong>Neural Network Dimensions and Data Arrays</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#csv-file-initialization">3.1 <strong>CSV File Initialization</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-test-data">4. <strong>Creating Test Data</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constructing-the-neural-network">5. <strong>Constructing the Neural Network</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-loop">6. <strong>Training Loop</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mini-batch-data-generation">6.1 <strong>Mini-Batch Data Generation</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#per-sample-forward-backward">6.2 <strong>Per-Sample Forward/Backward</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediction-on-the-test-sample">6.3 <strong>Prediction on the Test Sample</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-mean-squared-error">6.4 <strong>Compute Mean Squared Error</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#logging-each-sample-to-csv">6.5 <strong>Logging Each Sample to CSV</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#occasional-print-of-mse">6.6 <strong>Occasional Print of MSE</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#closing-steps">7. <strong>Closing Steps</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-of-the-workflow">8. <strong>Summary of the Workflow</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#program-code">Program Code</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#section-examples-sine-wave-f90">section_examples_sine_wave.f90</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-the-program-using-fpm-fortran-package-manager">Build the Program using FPM (Fortran Package Manager)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-program-using-fpm-fortran-package-manager">Run the Program using FPM (Fortran Package Manager)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-neural-network-predictions-and-mean-squared-error">Plot the Neural Network Predictions and Mean Squared Error</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-the-data-from-the-csv-file">Read the Data from the CSV File</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#group-and-average-the-mean-squared-error-by-iteration">Group and Average the Mean Squared Error by Iteration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-neural-network-predictions-vs-true-sine-wave">Plot the Neural Network Predictions vs True Sine Wave</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-mean-squared-error-vs-iteration">Plot the Mean Squared Error vs Iteration</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="neural-fortran-examples-sine-wave">
<h1>Neural Fortran Examples: Sine Wave<a class="headerlink" href="#neural-fortran-examples-sine-wave" title="Link to this heading">#</a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>In this example, we will train a neural network to approximate the sine function. We will use a simple feedforward neural network with two hidden layers. The network will be trained using the backpropagation algorithm.  The data will be written to a CSV file using the CSV Fortran library <a class="github reference external" href="https://github.com/jacobwilliams/csv-fortran">jacobwilliams/csv-fortran</a>. The neural network will be implemented in Fortran using the Neural Fortran library <a class="github reference external" href="https://github.com/modern-fortran/neural-fortran">modern-fortran/neural-fortran</a>.</p>
<p>Once the data is collected and saved to a CSV file, Pandas and Matplotlib will be used to plot the learned sine wave and mean squared error versus the learning iteration number.</p>
</section>
<section id="neural-network-theory-by-chatgpt-o1">
<h2>Neural Network Theory by ChatGPT o1<a class="headerlink" href="#neural-network-theory-by-chatgpt-o1" title="Link to this heading">#</a></h2>
<p>Below is a concise yet mathematically grounded overview of <strong>dense neural networks</strong>, sometimes referred to as <strong>feedforward</strong> or <strong>fully connected</strong> networks. We will cover their core structure, forward-pass equations, and typical training approach.</p>
</section>
<hr class="docutils" />
<section id="dense-neural-network-structure">
<h2>Dense Neural Network Structure<a class="headerlink" href="#dense-neural-network-structure" title="Link to this heading">#</a></h2>
<p>A <strong>dense (fully connected) neural network</strong> consists of layers of neurons, where each neuron in one layer connects to <strong>every</strong> neuron in the next layer via a trainable weight. Suppose we have a network with <span class="math notranslate nohighlight">\(L\)</span> layers, indexed by <span class="math notranslate nohighlight">\( \ell = 1, 2, \ldots, L\)</span>. Each layer <span class="math notranslate nohighlight">\(\ell\)</span> has <span class="math notranslate nohighlight">\(n_\ell\)</span> neurons. For simplicity, let <span class="math notranslate nohighlight">\(\mathbf{x} \in \mathbb{R}^{n_0}\)</span> be the input, where <span class="math notranslate nohighlight">\(n_0\)</span> is the input dimension, and let <span class="math notranslate nohighlight">\(\mathbf{y} \in \mathbb{R}^{n_L}\)</span> be the network’s output.</p>
<p>A typical layer <span class="math notranslate nohighlight">\(\ell\)</span> of the network (for <span class="math notranslate nohighlight">\(1 \le \ell \le L\)</span>) is described by a linear transformation followed by an elementwise non-linear activation. Specifically,</p>
<div class="math notranslate nohighlight">
\[
  \mathbf{z}^{(\ell)} 
  \;=\; W^{(\ell)}\, \mathbf{h}^{(\ell-1)} \;+\; \mathbf{b}^{(\ell)},
\]</div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(W^{(\ell)} \in \mathbb{R}^{n_\ell \times n_{\ell-1}}\)</span> is the weight matrix for layer <span class="math notranslate nohighlight">\(\ell\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{b}^{(\ell)} \in \mathbb{R}^{n_\ell}\)</span> is the bias vector.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathbf{h}^{(\ell-1)} \in \mathbb{R}^{n_{\ell-1}}\)</span> is the output (also called the activation) of the previous layer (<span class="math notranslate nohighlight">\(\ell-1\)</span>).</p></li>
</ul>
<p>Next, we apply a (usually nonlinear) activation function <span class="math notranslate nohighlight">\(\sigma(\cdot)\)</span> elementwise:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  \mathbf{h}^{(\ell)} 
  \;=\; \sigma\bigl(\mathbf{z}^{(\ell)}\bigr)
  \;=\; 
  \begin{bmatrix}
    \sigma(z_1^{(\ell)}) \\[6pt]
    \sigma(z_2^{(\ell)}) \\[6pt]
    \vdots \\[6pt]
    \sigma(z_{n_\ell}^{(\ell)}) \\[6pt]
  \end{bmatrix}.
\end{split}\]</div>
<p>For instance, <span class="math notranslate nohighlight">\(\sigma\)</span> might be the ReLU function <span class="math notranslate nohighlight">\(\max(0, z)\)</span>, the sigmoid function <span class="math notranslate nohighlight">\(\tfrac{1}{1 + e^{-z}}\)</span>, or <span class="math notranslate nohighlight">\(\tanh\)</span>. The final output layer might also have a special activation (e.g., softmax for classification).</p>
</section>
<hr class="docutils" />
<section id="forward-pass-equations">
<h2>Forward Pass Equations<a class="headerlink" href="#forward-pass-equations" title="Link to this heading">#</a></h2>
<p>Using the above notation, we initialize the network’s input as</p>
<div class="math notranslate nohighlight">
\[
  \mathbf{h}^{(0)} \;=\; \mathbf{x}.
\]</div>
<p>Then for each layer <span class="math notranslate nohighlight">\(\ell = 1, 2, \ldots, L\)</span>, we compute</p>
<div class="math notranslate nohighlight">
\[
  \mathbf{z}^{(\ell)} = W^{(\ell)}\, \mathbf{h}^{(\ell-1)} + \mathbf{b}^{(\ell)}, 
  \quad
  \mathbf{h}^{(\ell)} = \sigma\bigl(\mathbf{z}^{(\ell)}\bigr).
\]</div>
<p>At the final layer, <span class="math notranslate nohighlight">\(\mathbf{h}^{(L)}\)</span> becomes the network’s output <span class="math notranslate nohighlight">\(\mathbf{y}\)</span>. Hence, a forward pass through a dense network is just iterating these matrix-vector multiplications and elementwise activations.</p>
</section>
<hr class="docutils" />
<section id="training-with-gradient-descent">
<h2>Training With Gradient Descent<a class="headerlink" href="#training-with-gradient-descent" title="Link to this heading">#</a></h2>
<p>To train the network, we typically have a dataset of inputs <span class="math notranslate nohighlight">\(\{\mathbf{x}_i\}\)</span> and corresponding targets <span class="math notranslate nohighlight">\(\{\mathbf{t}_i\}\)</span>. We define a <strong>loss function</strong> <span class="math notranslate nohighlight">\(\mathcal{L}\)</span>, such as mean squared error (for regression) or cross-entropy (for classification). For a single training example <span class="math notranslate nohighlight">\((\mathbf{x}, \mathbf{t})\)</span>, we might write</p>
<div class="math notranslate nohighlight">
\[
  \mathcal{L}(\mathbf{t}, \mathbf{y}) 
  \;=\; \frac{1}{2} \|\mathbf{y} - \mathbf{t}\|^2
  \quad\text{(for an example squared error case).}
\]</div>
<p>The <strong>backpropagation</strong> algorithm computes partial derivatives of <span class="math notranslate nohighlight">\(\mathcal{L}\)</span> with respect to each network parameter <span class="math notranslate nohighlight">\(\{W^{(\ell)}, \mathbf{b}^{(\ell)}\}\)</span>. Gradient-based optimizers (e.g., stochastic gradient descent) then update the parameters in the direction that reduces the loss:</p>
<div class="math notranslate nohighlight">
\[
  W^{(\ell)} \;\leftarrow\; W^{(\ell)} \;-\; \eta \,\frac{\partial \mathcal{L}}{\partial W^{(\ell)}}
  \quad,\quad
  \mathbf{b}^{(\ell)} \;\leftarrow\; \mathbf{b}^{(\ell)} \;-\; \eta \,\frac{\partial \mathcal{L}}{\partial \mathbf{b}^{(\ell)}},
\]</div>
<p>where <span class="math notranslate nohighlight">\(\eta\)</span> is the learning rate. Repeated over many iterations (epochs), the network learns weights that (hopefully) minimize the loss on the training set and generalize to unseen data.</p>
<hr class="docutils" />
<p>This dense architecture is the foundational design for many neural networks. While modern advances (like convolutional or transformer layers) may structure connections differently, the core linear+activation principle remains central to deep learning.</p>
</section>
<section id="code-analysis-by-chatgtp-o1">
<h2>Code Analysis by ChatGTP o1<a class="headerlink" href="#code-analysis-by-chatgtp-o1" title="Link to this heading">#</a></h2>
<p>Below is a detailed walkthrough of how the <strong><code class="docutils literal notranslate"><span class="pre">program</span> <span class="pre">sine</span></code></strong> works, focusing on what each block of code accomplishes and how it fits into the overall workflow of training a sine-wave–inspired neural network. We will cover:</p>
<ol class="arabic simple">
<li><p><strong>Imports and Declarations</strong></p></li>
<li><p><strong>CSV Logging Initialization</strong></p></li>
<li><p><strong>Creating Test Data</strong></p></li>
<li><p><strong>Defining the Neural Network</strong></p></li>
<li><p><strong>Training Loop</strong> (Forward &amp; Backward passes, updating weights)</p></li>
<li><p><strong>Computing Mean Squared Error</strong></p></li>
<li><p><strong>Logging Data to CSV</strong></p></li>
</ol>
<p>Throughout, note that the network code comes from a library <code class="docutils literal notranslate"><span class="pre">nf</span></code> (with <code class="docutils literal notranslate"><span class="pre">dense</span></code>, <code class="docutils literal notranslate"><span class="pre">input</span></code>, <code class="docutils literal notranslate"><span class="pre">network</span></code>, <code class="docutils literal notranslate"><span class="pre">sgd</span></code>), and CSV output is handled by <code class="docutils literal notranslate"><span class="pre">csv_module</span></code>. The code also uses single-precision real numbers (<code class="docutils literal notranslate"><span class="pre">real32</span></code>) for training variables and a double-precision <code class="docutils literal notranslate"><span class="pre">pi</span></code> in some places.</p>
</section>
<hr class="docutils" />
<section id="imports-and-declarations">
<h2>1. <strong>Imports and Declarations</strong><a class="headerlink" href="#imports-and-declarations" title="Link to this heading">#</a></h2>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">program </span><span class="n">sine</span>
<span class="w">  </span><span class="k">use </span><span class="n">csv_module</span>
<span class="w">  </span><span class="k">use </span><span class="n">nf</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dense</span><span class="p">,</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">network</span><span class="p">,</span><span class="w"> </span><span class="n">sgd</span>
<span class="w">  </span><span class="k">use </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">real32</span>

<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">atan</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">csv_module</span></code></strong>: A module that provides CSV reading/writing functionality.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">nf</span></code></strong>: A custom or third-party neural network framework that exposes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dense</span></code>: A fully connected (dense) layer constructor.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">input</span></code>: An input layer constructor.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">network</span></code>: A type or class that composes layers and provides <code class="docutils literal notranslate"><span class="pre">forward</span></code>, <code class="docutils literal notranslate"><span class="pre">backward</span></code>, <code class="docutils literal notranslate"><span class="pre">update</span></code>, <code class="docutils literal notranslate"><span class="pre">predict</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sgd</span></code>: A function or type for the Stochastic Gradient Descent optimizer.</p></li>
</ul>
</li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">iso_fortran_env,</span> <span class="pre">only:</span> <span class="pre">real32</span></code></strong>: Imports the <code class="docutils literal notranslate"><span class="pre">real32</span></code> kind for single-precision floats (32-bit).</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">implicit</span> <span class="pre">none</span></code></strong>: Requires explicit declarations for all variables.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">pi</span></code></strong>: Defined via <code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">*</span> <span class="pre">atan(1.)</span></code>, which yields <span class="math notranslate nohighlight">\(\pi \approx 3.14159265...\)</span>.</p></li>
</ol>
</section>
<hr class="docutils" />
<section id="csv-logging-initialization">
<h2>2. <strong>CSV Logging Initialization</strong><a class="headerlink" href="#csv-logging-initialization" title="Link to this heading">#</a></h2>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">type</span><span class="p">(</span><span class="n">csv_file</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sine_NN_data_file</span>
<span class="w">  </span><span class="k">type</span><span class="p">(</span><span class="n">network</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">net</span>

<span class="w">  </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">status_ok</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">sine_NN_data_file</span></code></strong>: A <code class="docutils literal notranslate"><span class="pre">csv_file</span></code> object that will handle CSV writing.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">net</span></code></strong>: A neural network object.</p></li>
</ul>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">num_iterations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100000</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">test_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">50</span>
<span class="w">  </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">learning_rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">num_iterations</span></code></strong>: The number of training iterations (epochs).</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">test_size</span></code></strong>: The number of data points for both testing and each training mini-batch (30).</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">learning_rate</span></code></strong>: The initial learning rate (0.1) for the <code class="docutils literal notranslate"><span class="pre">sgd</span></code> optimizer.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="neural-network-dimensions-and-data-arrays">
<h2>3. <strong>Neural Network Dimensions and Data Arrays</strong><a class="headerlink" href="#neural-network-dimensions-and-data-arrays" title="Link to this heading">#</a></h2>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">num_inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">num_outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">num_neurons_first_layer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">num_neurons_second_layer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">num_inputs</span></code></strong>: The network expects 1D input.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">num_outputs</span></code></strong>: The network outputs 1 value.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">num_neurons_first_layer</span></code>, <code class="docutils literal notranslate"><span class="pre">num_neurons_second_layer</span></code></strong>: Two hidden layers with 10 neurons each.</p></li>
</ul>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">test_size</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x_test</span><span class="p">,</span><span class="w"> </span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">x_train</span><span class="p">,</span><span class="w"> </span><span class="n">y_train</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span>
<span class="w">  </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x_train_arr_temp</span>
<span class="w">  </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">y_train_arr_temp</span>
<span class="w">  </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x_test_arr_temp</span>
<span class="w">  </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">y_pred_arr_temp</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">x_test,</span> <span class="pre">y_test</span></code></strong>: Arrays of size <code class="docutils literal notranslate"><span class="pre">test_size</span></code> to store the input and target for the sine wave <em>test set</em>.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">x_train,</span> <span class="pre">y_train</span></code></strong>: Arrays of size <code class="docutils literal notranslate"><span class="pre">test_size</span></code> for the random training mini-batch each iteration.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">y_pred</span></code></strong>: Predictions made on the test data, also size <code class="docutils literal notranslate"><span class="pre">test_size</span></code>.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">x_train_arr_temp,</span> <span class="pre">y_train_arr_temp,</span> <span class="pre">x_test_arr_temp,</span> <span class="pre">y_pred_arr_temp</span></code></strong>: All <code class="docutils literal notranslate"><span class="pre">dimension(1)</span></code>.</p>
<ul class="simple">
<li><p>These hold <strong>single-sample</strong> data for the neural network calls. The library expects arrays, even for single-value input.</p></li>
<li><p>For instance, <code class="docutils literal notranslate"><span class="pre">x_train(j)</span></code> is stored in <code class="docutils literal notranslate"><span class="pre">x_train_arr_temp(1)</span></code> before calling <code class="docutils literal notranslate"><span class="pre">forward</span></code>.</p></li>
</ul>
</li>
</ol>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">num_iterations</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mean_squared_error</span>
<span class="w">  </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span>

<span class="w">  </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x_train_temp</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">mean_squared_error</span></code></strong>: An array storing MSE for each of the <code class="docutils literal notranslate"><span class="pre">num_iterations</span></code>.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">x_train_temp</span></code></strong>: A random value used to generate the training data.</p></li>
</ul>
<hr class="docutils" />
<section id="csv-file-initialization">
<h3>3.1 <strong>CSV File Initialization</strong><a class="headerlink" href="#csv-file-initialization" title="Link to this heading">#</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">call </span><span class="n">sine_NN_data_file</span><span class="p">%</span><span class="n">initialize</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<span class="w">  </span><span class="p">...</span>
<span class="w">  </span><span class="k">call </span><span class="n">sine_NN_data_file</span><span class="p">%</span><span class="k">open</span><span class="p">(</span><span class="s1">&#39;sine_NN_data.csv&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n_cols</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="n">status_ok</span><span class="o">=</span><span class="n">status_ok</span><span class="p">)</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">status_ok</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">    </span><span class="p">...</span>
<span class="w">  </span><span class="k">end if</span>
<span class="w">  </span><span class="p">...</span>
<span class="w">  </span><span class="k">call </span><span class="n">sine_NN_data_file</span><span class="p">%</span><span class="n">add</span><span class="p">([</span><span class="s1">&#39;Iteration&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;x_test___&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;y_test___&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                              </span><span class="s1">&#39;x_train__&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;y_train__&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;y_pred___&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;MSE______&#39;</span><span class="p">])</span>
<span class="w">  </span><span class="k">call </span><span class="n">sine_NN_data_file</span><span class="p">%</span><span class="n">next_row</span><span class="p">()</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">initialize</span></code></strong>: Prepares the CSV object.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">open</span></code></strong>: Opens a file named <code class="docutils literal notranslate"><span class="pre">sine_NN_data.csv</span></code>. The code also specifies <code class="docutils literal notranslate"><span class="pre">n_cols=7</span></code>, meaning each row will eventually have up to 7 columns.</p></li>
<li><p><strong>Header</strong>: <code class="docutils literal notranslate"><span class="pre">add([...])</span></code> writes a header row with column labels, then <code class="docutils literal notranslate"><span class="pre">next_row()</span></code> finalizes that line.</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="creating-test-data">
<h2>4. <strong>Creating Test Data</strong><a class="headerlink" href="#creating-test-data" title="Link to this heading">#</a></h2>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="n">x_test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">2.0d0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">test_size</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">test_size</span><span class="p">)]</span>
<span class="w">  </span><span class="n">y_test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nb">sin</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.0d0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2.0d0</span>
</pre></div>
</div>
<ul class="simple">
<li><p>For each <code class="docutils literal notranslate"><span class="pre">j</span></code> in <code class="docutils literal notranslate"><span class="pre">[1..test_size]</span></code>, compute <span class="math notranslate nohighlight">\(\displaystyle x\_test(j) = \frac{(j - 1)\times 2\pi}{\text{test\_size}}\)</span>.</p>
<ul>
<li><p>This distributes 30 points evenly between <code class="docutils literal notranslate"><span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">2π</span></code>.</p></li>
</ul>
</li>
<li><p>The target is <code class="docutils literal notranslate"><span class="pre">y_test(j)</span> <span class="pre">=</span> <span class="pre">(sin(x_test(j))</span> <span class="pre">+</span> <span class="pre">1)</span> <span class="pre">/</span> <span class="pre">2</span></code>, mapping the sine wave from <code class="docutils literal notranslate"><span class="pre">[-1,</span> <span class="pre">+1]</span></code> to <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">1]</span></code>.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="constructing-the-neural-network">
<h2>5. <strong>Constructing the Neural Network</strong><a class="headerlink" href="#constructing-the-neural-network" title="Link to this heading">#</a></h2>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="n">net</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">network</span><span class="p">([</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="n">input</span><span class="p">(</span><span class="n">num_inputs</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="n">dense</span><span class="p">(</span><span class="n">num_neurons_first_layer</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="n">dense</span><span class="p">(</span><span class="n">num_neurons_second_layer</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="n">dense</span><span class="p">(</span><span class="n">num_outputs</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">  </span><span class="p">])</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">network([...])</span></code></strong>: Creates a layered neural network object with the following sequence:</p>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">input(num_inputs)</span></code></strong>: 1D input layer.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">dense(num_neurons_first_layer)</span></code></strong>: A fully connected layer with 10 neurons.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">dense(num_neurons_second_layer)</span></code></strong>: Another hidden layer with 10 neurons.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">dense(num_outputs)</span></code></strong>: Final layer that outputs a single value.</p></li>
</ol>
</li>
</ul>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">call </span><span class="n">net</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">print_info</span><span class="p">()</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Prints summary info about the network (number of parameters, layer shapes, etc.).</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="training-loop">
<h2>6. <strong>Training Loop</strong><a class="headerlink" href="#training-loop" title="Link to this heading">#</a></h2>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_iterations</span>
</pre></div>
</div>
<p>A loop over the total epochs (<code class="docutils literal notranslate"><span class="pre">num_iterations</span></code> = 100,000). Each iteration does:</p>
<section id="mini-batch-data-generation">
<h3>6.1 <strong>Mini-Batch Data Generation</strong><a class="headerlink" href="#mini-batch-data-generation" title="Link to this heading">#</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">test_size</span>
<span class="w">      </span><span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">x_train_temp</span><span class="p">)</span>
<span class="w">      </span><span class="n">x_train</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x_train_temp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">2.0d0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span>
<span class="w">      </span><span class="n">y_train</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nb">sin</span><span class="p">(</span><span class="n">x_train</span><span class="p">(</span><span class="n">j</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.0d0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2.0d0</span>
</pre></div>
</div>
<ul class="simple">
<li><p>For each of the <code class="docutils literal notranslate"><span class="pre">test_size</span></code> samples in the batch:</p>
<ol class="arabic simple">
<li><p>Generate a random number <code class="docutils literal notranslate"><span class="pre">x_train_temp</span></code> in [0, 1).</p></li>
<li><p>Scale it to <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">2π]</span></code>.</p></li>
<li><p>Compute <code class="docutils literal notranslate"><span class="pre">y_train(j)</span></code> as <code class="docutils literal notranslate"><span class="pre">(sin(x_train(j))</span> <span class="pre">+</span> <span class="pre">1.0)/2.0</span></code>, so the sine wave is in [0, 1].</p></li>
</ol>
</li>
</ul>
</section>
<section id="per-sample-forward-backward">
<h3>6.2 <strong>Per-Sample Forward/Backward</strong><a class="headerlink" href="#per-sample-forward-backward" title="Link to this heading">#</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">      </span><span class="n">x_train_arr_temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x_train</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">      </span><span class="n">y_train_arr_temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y_train</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>

<span class="w">      </span><span class="k">call </span><span class="n">net</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">forward</span><span class="p">(</span><span class="n">x_train_arr_temp</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">net</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">backward</span><span class="p">(</span><span class="n">y_train_arr_temp</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">net</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">update</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">sgd</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">))</span>
</pre></div>
</div>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">x_train_arr_temp</span></code></strong> and <strong><code class="docutils literal notranslate"><span class="pre">y_train_arr_temp</span></code></strong> are 1-element arrays. Some neural net frameworks require arrays even for single-value inputs.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">forward(...)</span></code></strong> passes the single sample through the network, producing internal activations.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">backward(...)</span></code></strong> uses the single-sample label <code class="docutils literal notranslate"><span class="pre">y_train_arr_temp</span></code> to compute gradients (loss derivative w.r.t. weights).</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">update(...)</span></code></strong> applies <strong>Stochastic Gradient Descent</strong> with <code class="docutils literal notranslate"><span class="pre">learning_rate=0.1</span></code> to update network weights.</p></li>
</ul>
<p><strong>Important</strong>: This code does a per-sample update inside the loop over <code class="docutils literal notranslate"><span class="pre">j</span></code>. This is effectively “online” or “sample-by-sample” training, repeated <code class="docutils literal notranslate"><span class="pre">test_size</span></code> times per iteration.</p>
</section>
<section id="prediction-on-the-test-sample">
<h3>6.3 <strong>Prediction on the Test Sample</strong><a class="headerlink" href="#prediction-on-the-test-sample" title="Link to this heading">#</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">      </span><span class="n">x_test_arr_temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x_test</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">      </span><span class="n">y_pred_arr_temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">net</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">x_test_arr_temp</span><span class="p">)</span>
<span class="w">      </span><span class="n">y_pred</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y_pred_arr_temp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="k">end do</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Takes the test input <code class="docutils literal notranslate"><span class="pre">x_test(j)</span></code>, passes it through the network to get <code class="docutils literal notranslate"><span class="pre">y_pred_arr_temp</span></code> (again a 1-element array).</p></li>
<li><p>Store <code class="docutils literal notranslate"><span class="pre">y_pred(j)</span> <span class="pre">=</span> <span class="pre">y_pred_arr_temp(1)</span></code>.</p></li>
</ul>
<p>After this inner loop, we have:</p>
<ul class="simple">
<li><p>A mini-batch of <code class="docutils literal notranslate"><span class="pre">test_size</span></code> random training samples used for weight updates.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">y_pred</span></code></strong> for each of the 30 test points in <code class="docutils literal notranslate"><span class="pre">x_test</span></code>.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="compute-mean-squared-error">
<h3>6.4 <strong>Compute Mean Squared Error</strong><a class="headerlink" href="#compute-mean-squared-error" title="Link to this heading">#</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">((</span><span class="n">y_pred</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y_test</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">test_size</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Compare the network’s predictions <code class="docutils literal notranslate"><span class="pre">y_pred</span></code> with the true test values <code class="docutils literal notranslate"><span class="pre">y_test</span></code>.</p></li>
<li><p>The MSE for iteration <code class="docutils literal notranslate"><span class="pre">i</span></code> is the average of squared differences.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="logging-each-sample-to-csv">
<h3>6.5 <strong>Logging Each Sample to CSV</strong><a class="headerlink" href="#logging-each-sample-to-csv" title="Link to this heading">#</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">test_size</span>
<span class="w">      </span><span class="k">call </span><span class="n">sine_NN_data_file</span><span class="p">%</span><span class="n">add</span><span class="p">([</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">int_fmt</span><span class="o">=</span><span class="s1">&#39;(i6)&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">sine_NN_data_file</span><span class="p">%</span><span class="n">add</span><span class="p">([</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">        </span><span class="n">x_test</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span>
<span class="w">        </span><span class="n">y_test</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">        </span><span class="n">x_train</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">        </span><span class="n">y_train</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">        </span><span class="n">y_pred</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">        </span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">        </span><span class="n">real_fmt</span><span class="o">=</span><span class="s1">&#39;(f9.6)&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">sine_NN_data_file</span><span class="p">%</span><span class="n">next_row</span><span class="p">()</span>
<span class="w">    </span><span class="k">end do</span>
</pre></div>
</div>
<ul class="simple">
<li><p>We output <strong>50 rows</strong> per iteration. Each row records:</p>
<ol class="arabic simple">
<li><p><strong>Iteration</strong> number <code class="docutils literal notranslate"><span class="pre">i</span></code>.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">x_test(j)</span></code></strong>: The j-th test input.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">y_test(j)</span></code></strong>: The sine wave’s true value at <code class="docutils literal notranslate"><span class="pre">x_test(j)</span></code>.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">x_train(j)</span></code></strong>: The j-th random training sample.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">y_train(j)</span></code></strong>: The training label for that sample.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">y_pred(j)</span></code></strong>: The network’s prediction for <code class="docutils literal notranslate"><span class="pre">x_test(j)</span></code>.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">mean_squared_error(i)</span></code></strong>: The iteration’s MSE.</p></li>
</ol>
</li>
</ul>
<p>Hence, each iteration appends 50 lines to the CSV file, for a total of: <span class="math notranslate nohighlight">\(50 \times \text{num_iterations}\)</span> lines.</p>
</section>
<hr class="docutils" />
<section id="occasional-print-of-mse">
<h3>6.6 <strong>Occasional Print of MSE</strong><a class="headerlink" href="#occasional-print-of-mse" title="Link to this heading">#</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">num_iterations</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      print</span><span class="w"> </span><span class="s1">&#39;(&quot;Iteration: &quot;, I6, &quot; | MSE: &quot;, F9.6)&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">    </span><span class="k">end if</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Every 1/10th of <code class="docutils literal notranslate"><span class="pre">num_iterations</span></code> (in this case, every 10000 iterations if <code class="docutils literal notranslate"><span class="pre">num_iterations=100000</span></code>), print the iteration number and current MSE to the console.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="closing-steps">
<h2>7. <strong>Closing Steps</strong><a class="headerlink" href="#closing-steps" title="Link to this heading">#</a></h2>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="w">  </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;[*] Training complete!&#39;</span>
<span class="w">  </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;[*] Saving data to the CSV file...&#39;</span>
<span class="w">  </span><span class="p">...</span>
<span class="w">  </span><span class="k">call </span><span class="n">sine_NN_data_file</span><span class="p">%</span><span class="k">close</span><span class="p">(</span><span class="n">status_ok</span><span class="o">=</span><span class="n">status_ok</span><span class="p">)</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">status_ok</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">    print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;[!] Error closing the CSV file...&#39;</span>
<span class="w">    </span><span class="k">stop</span>
<span class="k">  end if</span>
<span class="k">end program </span><span class="n">sine</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Signals the end of training and closes the CSV file, ensuring everything is written to disk properly.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="summary-of-the-workflow">
<h2>8. <strong>Summary of the Workflow</strong><a class="headerlink" href="#summary-of-the-workflow" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p><strong>Initialize</strong>: Creates a CSV object, sets up the neural network, and preps hyperparameters.</p></li>
<li><p><strong>Generate</strong> a small, fixed test set (<code class="docutils literal notranslate"><span class="pre">x_test,</span> <span class="pre">y_test</span></code>) spanning 0 to <span class="math notranslate nohighlight">\(2\pi\)</span>.</p></li>
<li><p><strong>Create</strong> the network with 1 input neuron, two hidden layers of 10 each, and 1 output.</p></li>
<li><p><strong>Training</strong> (outer loop over <code class="docutils literal notranslate"><span class="pre">i</span></code>):</p>
<ul class="simple">
<li><p>Build a random mini-batch of <code class="docutils literal notranslate"><span class="pre">test_size</span></code> samples (<code class="docutils literal notranslate"><span class="pre">x_train,</span> <span class="pre">y_train</span></code>).</p></li>
<li><p>For each sample:</p>
<ul>
<li><p>Convert the single value to a 1-element array, do <code class="docutils literal notranslate"><span class="pre">forward/backward/update</span></code>.</p></li>
<li><p>Predict on the corresponding test sample <code class="docutils literal notranslate"><span class="pre">x_test(j)</span></code>.</p></li>
</ul>
</li>
<li><p>Compute MSE over all 50 test points.</p></li>
<li><p>Write iteration data (50 rows) into a CSV file.</p></li>
<li><p>Occasionally print progress.</p></li>
</ul>
</li>
<li><p><strong>Finish</strong>: Print completion message, close the CSV file.</p></li>
</ol>
<p><strong>Key Observations</strong>:</p>
<ul class="simple">
<li><p>The code mixes “training data” that’s random each iteration with a fixed “test set” (<code class="docutils literal notranslate"><span class="pre">x_test</span></code>). This is somewhat unusual—often you keep a consistent training set or you randomize from a larger pool. But it works here as a demonstration of incremental training for the sine function.</p></li>
<li><p>The network is updated on a per-sample basis, repeated 50 times per iteration. That’s effectively a “mini-batch” of size 1 repeated 50 times.</p></li>
<li><p>The final CSV ends up quite large: <code class="docutils literal notranslate"><span class="pre">num_iterations</span> <span class="pre">×</span> <span class="pre">test_size</span></code> lines, with 7 columns each.</p></li>
</ul>
<p>This design shows how to integrate data generation, single-sample training steps, and CSV logging within a single Fortran program using a custom <code class="docutils literal notranslate"><span class="pre">network</span></code> library.</p>
</section>
<section id="program-code">
<h2>Program Code<a class="headerlink" href="#program-code" title="Link to this heading">#</a></h2>
<section id="section-examples-sine-wave-f90">
<h3>section_examples_sine_wave.f90<a class="headerlink" href="#section-examples-sine-wave-f90" title="Link to this heading">#</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">program </span><span class="n">sine</span>
<span class="w">  </span><span class="k">use </span><span class="n">csv_module</span>
<span class="w">  </span><span class="k">use </span><span class="n">nf</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dense</span><span class="p">,</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">network</span><span class="p">,</span><span class="w"> </span><span class="n">sgd</span>
<span class="w">  </span><span class="k">use </span><span class="n">iso_fortran_env</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">real32</span>

<span class="w">  </span><span class="k">implicit none</span>

<span class="k">  </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">atan</span><span class="p">(</span><span class="mf">1.</span><span class="p">)</span>
<span class="w">  </span>
<span class="w">  </span><span class="c">! CSV file objects for the training, testing, and prediction data</span>
<span class="w">  </span><span class="k">type</span><span class="p">(</span><span class="n">csv_file</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">sine_NN_data_file</span>
<span class="w">  </span><span class="k">type</span><span class="p">(</span><span class="n">network</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">net</span>

<span class="w">  </span><span class="c">! Status of the CSV file operations</span>
<span class="w">  </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">status_ok</span>
<span class="w"> </span>
<span class="w">  </span><span class="c">! Neural Network Training parameters</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">num_iterations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100000</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">test_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">50</span>
<span class="w">  </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">learning_rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span>
<span class="w">  </span>
<span class="w">  </span><span class="c">! Neural Network (Fully Connected) Parameters</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">num_inputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">num_outputs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">num_neurons_first_layer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>
<span class="w">  </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">num_neurons_second_layer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span>

<span class="w">  </span><span class="c">! Training, Testing, and Prediction Data</span>
<span class="w">  </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">test_size</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x_test</span><span class="p">,</span><span class="w"> </span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">x_train</span><span class="p">,</span><span class="w"> </span><span class="n">y_train</span><span class="p">,</span><span class="w"> </span><span class="n">y_pred</span>
<span class="w">  </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x_train_arr_temp</span>
<span class="w">  </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">y_train_arr_temp</span>
<span class="w">  </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x_test_arr_temp</span>
<span class="w">  </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">y_pred_arr_temp</span>
<span class="w">  </span>
<span class="w">  </span><span class="c">! Mean Squared Error</span>
<span class="w">  </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">),</span><span class="w"> </span><span class="k">dimension</span><span class="p">(</span><span class="n">num_iterations</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">mean_squared_error</span>

<span class="w">  </span><span class="c">! Loop variables</span>
<span class="w">  </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span>

<span class="w">  </span><span class="c">! Temporary variables</span>
<span class="w">  </span><span class="kt">real</span><span class="p">(</span><span class="nb">kind</span><span class="o">=</span><span class="n">real32</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">x_train_temp</span>

<span class="w">  </span><span class="c">! Initialize the CSV file</span>
<span class="w">  </span><span class="k">call </span><span class="n">sine_NN_data_file</span><span class="p">%</span><span class="n">initialize</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span>
<span class="w">  </span>
<span class="w">  </span><span class="c">! Open the CSV file</span>
<span class="w">  </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;[*] Opening the CSV file...&#39;</span>
<span class="w">  </span><span class="k">call </span><span class="n">sine_NN_data_file</span><span class="p">%</span><span class="k">open</span><span class="p">(</span><span class="s1">&#39;sine_NN_data.csv&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">n_cols</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="n">status_ok</span><span class="o">=</span><span class="n">status_ok</span><span class="p">)</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">status_ok</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">    print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;[!] Error opening the CSV file...&#39;</span>
<span class="w">    </span><span class="k">stop</span>
<span class="k">  end if</span>

<span class="w">  </span><span class="c">! Add header to the CSV file</span>
<span class="w">  </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;[*] Adding header to the CSV file...&#39;</span>
<span class="w">  </span><span class="k">call </span><span class="n">sine_NN_data_file</span><span class="p">%</span><span class="n">add</span><span class="p">([</span><span class="s1">&#39;Iteration&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;x_test___&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;y_test___&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;x_train__&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;y_train__&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;y_pred___&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;MSE______&#39;</span><span class="p">])</span>
<span class="w">  </span><span class="k">call </span><span class="n">sine_NN_data_file</span><span class="p">%</span><span class="n">next_row</span><span class="p">()</span>
<span class="w">  </span>
<span class="w">  </span><span class="k">print</span><span class="w"> </span><span class="s1">&#39;(&quot;[*] Creating Sine Wave Testing Data&quot;)&#39;</span>

<span class="w">  </span><span class="c">! Create the Sine Wave Testing Data</span>
<span class="w">  </span><span class="n">x_test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[((</span><span class="n">j</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">2.0d0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">test_size</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">test_size</span><span class="p">)]</span>
<span class="w">  </span><span class="n">y_test</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nb">sin</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.0d0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2.0d0</span>

<span class="w">  </span><span class="c">! Create the Neural Network</span>
<span class="w">  </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;[*] Creating the Neural Network...&#39;</span>
<span class="w">  </span><span class="k">print</span><span class="w"> </span><span class="s1">&#39;(60(&quot;=&quot;))&#39;</span>
<span class="w">  </span><span class="n">net</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">network</span><span class="p">([</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="n">input</span><span class="p">(</span><span class="n">num_inputs</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="n">dense</span><span class="p">(</span><span class="n">num_neurons_first_layer</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="n">dense</span><span class="p">(</span><span class="n">num_neurons_second_layer</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">    </span><span class="n">dense</span><span class="p">(</span><span class="n">num_outputs</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">  </span><span class="p">])</span>

<span class="w">  </span><span class="c">! Print the Neural Network information</span>
<span class="w">  </span><span class="k">call </span><span class="n">net</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">print_info</span><span class="p">()</span>
<span class="w">  </span><span class="k">print</span><span class="w"> </span><span class="o">*</span>

<span class="w">  </span><span class="c">! Train the Neural Network</span>
<span class="w">  </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;[*] Training the Neural Network...&#39;</span>
<span class="w">  </span><span class="k">print</span><span class="w"> </span><span class="s1">&#39;(60(&quot;=&quot;))&#39;</span>

<span class="w">  </span><span class="c">! Loop over the number of iterations (epochs)</span>
<span class="w">  </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_iterations</span>

<span class="w">    </span><span class="c">! Train the Neural Network on the mini - batch of training data</span>
<span class="w">    </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">test_size</span>
<span class="w">      </span><span class="c">! Generate a random mini - batch of training data</span>
<span class="w">      </span><span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">x_train_temp</span><span class="p">)</span>
<span class="w">      </span><span class="n">x_train</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x_train_temp</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mf">2.0d0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pi</span>
<span class="w">      </span><span class="n">y_train</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nb">sin</span><span class="p">(</span><span class="n">x_train</span><span class="p">(</span><span class="n">j</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">1.0d0</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">2.0d0</span>

<span class="w">      </span><span class="c">! Forward / backward pass and update the weights</span>
<span class="w">      </span><span class="n">x_train_arr_temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x_train</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">      </span><span class="n">y_train_arr_temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y_train</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">net</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">forward</span><span class="p">(</span><span class="n">x_train_arr_temp</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">net</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">backward</span><span class="p">(</span><span class="n">y_train_arr_temp</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">net</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">update</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="n">sgd</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">))</span>

<span class="w">      </span><span class="c">! Evaluate the Neural Network on the testing data</span>
<span class="w">      </span><span class="n">x_test_arr_temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x_test</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
<span class="w">      </span><span class="n">y_pred_arr_temp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">net</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">predict</span><span class="p">(</span><span class="n">x_test_arr_temp</span><span class="p">)</span>
<span class="w">      </span><span class="n">y_pred</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y_pred_arr_temp</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="k">end do</span>
<span class="w">    </span>
<span class="w">    </span><span class="c">! Calculate the mean squared error</span>
<span class="w">    </span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sum</span><span class="p">((</span><span class="n">y_pred</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y_test</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">test_size</span>

<span class="w">    </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">test_size</span>
<span class="w">      </span><span class="c">! Save the iteration number, testing, training, prediction and mean squared error data to the CSV file</span>
<span class="w">      </span><span class="c">! For each interation there will be test_size rows of data of testing, training, prediction and mean squared error</span>
<span class="w">      </span><span class="k">call </span><span class="n">sine_NN_data_file</span><span class="p">%</span><span class="n">add</span><span class="p">([</span><span class="n">i</span><span class="p">],</span><span class="w"> </span><span class="n">int_fmt</span><span class="o">=</span><span class="s1">&#39;(i6)&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">sine_NN_data_file</span><span class="p">%</span><span class="n">add</span><span class="p">([</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">        </span><span class="n">x_test</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span>
<span class="w">        </span><span class="n">y_test</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">        </span><span class="n">x_train</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">        </span><span class="n">y_train</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">        </span><span class="n">y_pred</span><span class="p">(</span><span class="n">j</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">        </span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">i</span><span class="p">)],</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">        </span><span class="n">real_fmt</span><span class="o">=</span><span class="s1">&#39;(f9.6)&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">sine_NN_data_file</span><span class="p">%</span><span class="n">next_row</span><span class="p">()</span>
<span class="w">    </span><span class="k">end do</span>

<span class="w">    </span><span class="c">! Print the MSE every (num_iterations/10) iterations</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">mod</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">num_iterations</span><span class="o">/</span><span class="mi">10</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">      print</span><span class="w"> </span><span class="s1">&#39;(&quot;Iteration: &quot;, I6, &quot; | MSE: &quot;, F9.6)&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">        </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="w">    </span><span class="k">end if</span>
<span class="k">  </span>
<span class="k">  end do</span>

<span class="k">  print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;[*] Training complete!&#39;</span>
<span class="w">  </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;[*] Saving data to the CSV file...&#39;</span>

<span class="w">  </span><span class="c">! Close the CSV file</span>
<span class="w">  </span><span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;[*] Closing the CSV file...&#39;</span>
<span class="w">  </span><span class="k">call </span><span class="n">sine_NN_data_file</span><span class="p">%</span><span class="k">close</span><span class="p">(</span><span class="n">status_ok</span><span class="o">=</span><span class="n">status_ok</span><span class="p">)</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">status_ok</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">    print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;[!] Error closing the CSV file...&#39;</span>
<span class="w">    </span><span class="k">stop</span>
<span class="k">  end if</span>
<span class="k">  </span>
<span class="k">end program </span><span class="n">sine</span>
</pre></div>
</div>
<p>The above program is compiled and run using Fortran Package Manager (fpm).  The following FPM configuration file (fpm.toml) was used:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Section_Examples_Sine_Wave&quot;</span>

<span class="k">[build]</span>
<span class="n">auto-executables</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="n">auto-tests</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
<span class="n">auto-examples</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>

<span class="k">[install]</span>
<span class="n">library</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span>

<span class="k">[dependencies]</span>
<span class="n">csv-fortran</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">git</span><span class="p">=</span><span class="s2">&quot;https://github.com/jacobwilliams/csv-fortran.git&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="n">neural-fortran</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">git</span><span class="p">=</span><span class="s2">&quot;https://github.com/modern-fortran/neural-fortran.git&quot;</span><span class="w"> </span><span class="p">}</span>

<span class="k">[[executable]]</span>
<span class="n">name</span><span class="o">=</span><span class="s2">&quot;Section_Examples_Sine_Wave&quot;</span>
<span class="n">source-dir</span><span class="o">=</span><span class="s2">&quot;app&quot;</span>
<span class="n">main</span><span class="o">=</span><span class="s2">&quot;section_examples_sine_wave.f90&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="build-the-program-using-fpm-fortran-package-manager">
<h2>Build the Program using FPM (Fortran Package Manager)<a class="headerlink" href="#build-the-program-using-fpm-fortran-package-manager" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">root_dir</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="n">root_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">code_dir</span> <span class="o">=</span> <span class="n">root_dir</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="s2">&quot;Fortran_Code/Section_Examples_Sine_Wave&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">code_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">build_status</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;fpm build 2&gt;/dev/null&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-the-program-using-fpm-fortran-package-manager">
<h2>Run the Program using FPM (Fortran Package Manager)<a class="headerlink" href="#run-the-program-using-fpm-fortran-package-manager" title="Link to this heading">#</a></h2>
<p>The program is run and the output is saved into a file named sine_NN_data.dat</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exec_status</span> <span class="o">=</span> \
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;fpm run 2&gt;/dev/null&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> [*] Opening the CSV file...
 [*] Adding header to the CSV file...
[*] Creating Sine Wave Testing Data
 [*] Creating the Neural Network...
============================================================
Layer: input
------------------------------------------------------------
Output shape: 1
Parameters: 0

Layer: dense
------------------------------------------------------------
Input shape: 1
Output shape: 10
Parameters: 20
Activation: sigmoid

Layer: dense
------------------------------------------------------------
Input shape: 10
Output shape: 10
Parameters: 110
Activation: sigmoid

Layer: dense
------------------------------------------------------------
Input shape: 10
Output shape: 1
Parameters: 11
Activation: sigmoid


 [*] Training the Neural Network...
============================================================
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration:  10000 | MSE:  0.006610
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration:  20000 | MSE:  0.000172
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration:  30000 | MSE:  0.000130
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration:  40000 | MSE:  0.000111
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration:  50000 | MSE:  0.000100
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration:  60000 | MSE:  0.000089
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration:  70000 | MSE:  0.000080
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration:  80000 | MSE:  0.000072
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration:  90000 | MSE:  0.000063
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Iteration: 100000 | MSE:  0.000056
 [*] Training complete!
 [*] Saving data to the CSV file...
 [*] Closing the CSV file...
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-the-neural-network-predictions-and-mean-squared-error">
<h2>Plot the Neural Network Predictions and Mean Squared Error<a class="headerlink" href="#plot-the-neural-network-predictions-and-mean-squared-error" title="Link to this heading">#</a></h2>
<section id="read-the-data-from-the-csv-file">
<h3>Read the Data from the CSV File<a class="headerlink" href="#read-the-data-from-the-csv-file" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">csv_file</span> <span class="o">=</span> <span class="s2">&quot;sine_NN_data.csv&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">csv_file</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span>
        <span class="s2">&quot;Iteration&quot;</span><span class="p">,</span> <span class="s2">&quot;x_test&quot;</span><span class="p">,</span> <span class="s2">&quot;y_test&quot;</span><span class="p">,</span> <span class="s2">&quot;x_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_train&quot;</span><span class="p">,</span> <span class="s2">&quot;y_pred&quot;</span><span class="p">,</span> <span class="s2">&quot;MSE&quot;</span>
    <span class="p">])</span>
<span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 5000000 entries, 0 to 4999999
Data columns (total 7 columns):
 #   Column     Dtype  
---  ------     -----  
 0   Iteration  int64  
 1   x_test     float64
 2   y_test     float64
 3   x_train    float64
 4   y_train    float64
 5   y_pred     float64
 6   MSE        float64
dtypes: float64(6), int64(1)
memory usage: 267.0 MB
</pre></div>
</div>
</div>
</div>
</section>
<section id="group-and-average-the-mean-squared-error-by-iteration">
<h3>Group and Average the Mean Squared Error by Iteration<a class="headerlink" href="#group-and-average-the-mean-squared-error-by-iteration" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grouped</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;Iteration&quot;</span><span class="p">)</span>
<span class="n">mse_by_iter</span> <span class="o">=</span> <span class="n">grouped</span><span class="p">[</span><span class="s2">&quot;MSE&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">overall_mse</span> <span class="o">=</span> <span class="n">mse_by_iter</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Overall Mean Squared Error: </span><span class="si">{</span><span class="n">overall_mse</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Overall Mean Squared Error: 0.0012690667499999997
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-the-neural-network-predictions-vs-true-sine-wave">
<h3>Plot the Neural Network Predictions vs True Sine Wave<a class="headerlink" href="#plot-the-neural-network-predictions-vs-true-sine-wave" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iteration_step</span> <span class="o">=</span> <span class="mi">5000</span> <span class="c1"># Plot every iteration_step iteration</span>
<span class="n">iteration_list</span> <span class="o">=</span> <span class="n">mse_by_iter</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">to_list</span><span class="p">()</span>
<span class="n">iterations_to_plot</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">iteration_step</span><span class="p">,</span> <span class="n">iteration_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">iteration_step</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="n">iterations_to_plot</span><span class="p">:</span>
    <span class="n">group_df</span> <span class="o">=</span> <span class="n">grouped</span><span class="o">.</span><span class="n">get_group</span><span class="p">(</span><span class="n">iteration</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">group_df</span><span class="p">[</span><span class="s2">&quot;x_test&quot;</span><span class="p">],</span> <span class="n">group_df</span><span class="p">[</span><span class="s2">&quot;y_test&quot;</span><span class="p">],</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                 <span class="n">label</span><span class="o">=</span><span class="s2">&quot;True Sine Wave&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">group_df</span><span class="p">[</span><span class="s2">&quot;x_test&quot;</span><span class="p">],</span> <span class="n">group_df</span><span class="p">[</span><span class="s2">&quot;y_pred&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Iteration </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x_test&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;sine value&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Predicted vs. True Sine Wave (plotting every </span><span class="si">{</span><span class="n">iteration_step</span><span class="si">}</span><span class="s2">-th iteration)&quot;</span><span class="p">)</span>
<span class="c1"># Avoid repeated legend entries for the &#39;True Sine&#39; if multiple lines are drawn</span>
<span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
<span class="c1"># Filter out duplicates by building an ordered dictionary</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="n">by_label</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">handles</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">by_label</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">by_label</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower left&quot;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/164aec50b4a01b8be707f949998b99ceb855fa68a0b30b12b03f218201dd0cbd.png" src="../../../../_images/164aec50b4a01b8be707f949998b99ceb855fa68a0b30b12b03f218201dd0cbd.png" />
</div>
</div>
</section>
<section id="plot-the-mean-squared-error-vs-iteration">
<h3>Plot the Mean Squared Error vs Iteration<a class="headerlink" href="#plot-the-mean-squared-error-vs-iteration" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mse_by_iter</span><span class="o">.</span><span class="n">index</span><span class="p">[::</span><span class="mi">1000</span><span class="p">],</span> <span class="n">mse_by_iter</span><span class="o">.</span><span class="n">values</span><span class="p">[::</span><span class="mi">1000</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Mean Squared Error vs. Iteration&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Iteration&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;MSE&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/9baa2a2eb85eb54b300cc387688aed91e05f2e3300d4032690341085ec97e9e2.png" src="../../../../_images/9baa2a2eb85eb54b300cc387688aed91e05f2e3300d4032690341085ec97e9e2.png" />
</div>
</div>
</section>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h2>
<p>We have successfully trained a neural network to approximate the sine function. The neural network was implemented in Fortran using the Neural Fortran library. The data was written to a CSV file using the CSV Fortran library. The neural network predictions and mean squared error were plotted using Python.</p>
<p>As can be seen from the plot, the neural network was able to approximate the sine function quite well. The mean squared error decreased over time as the neural network was trained. This example demonstrates how neural networks can be used to approximate complex functions such as the sine function.</p>
<p>As the iteration number reached 100,000, the neural network predictions closely matched the true sine wave function. The mean squared error decreased over time as the neural network was trained. This example demonstrates how neural networks can be used to approximate complex functions such as the sine function.</p>
<p>A great improvement on this code would be to implement the training loop using OpenMP.  This would allow the training loop to be parallelized and run on multiple cores.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "markkhusid/MKDynamics_Website_V2",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "py311_env"
        },
        kernelOptions: {
            name: "py311_env",
            path: "./Sections/Computer_Programming/Fortran/Neural_Fortran"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'py311_env'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="neural_fortran__HEAD__.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Neural Fortran</p>
      </div>
    </a>
    <a class="right-next"
       href="../DFFT/DFFT.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Discretized Fourier Transform of Arbitrary Signal Using FFTW3 in Fortran</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-network-theory-by-chatgpt-o1">Neural Network Theory by ChatGPT o1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dense-neural-network-structure">Dense Neural Network Structure</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forward-pass-equations">Forward Pass Equations</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-with-gradient-descent">Training With Gradient Descent</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#code-analysis-by-chatgtp-o1">Code Analysis by ChatGTP o1</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports-and-declarations">1. <strong>Imports and Declarations</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#csv-logging-initialization">2. <strong>CSV Logging Initialization</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#neural-network-dimensions-and-data-arrays">3. <strong>Neural Network Dimensions and Data Arrays</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#csv-file-initialization">3.1 <strong>CSV File Initialization</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-test-data">4. <strong>Creating Test Data</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#constructing-the-neural-network">5. <strong>Constructing the Neural Network</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-loop">6. <strong>Training Loop</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mini-batch-data-generation">6.1 <strong>Mini-Batch Data Generation</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#per-sample-forward-backward">6.2 <strong>Per-Sample Forward/Backward</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prediction-on-the-test-sample">6.3 <strong>Prediction on the Test Sample</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-mean-squared-error">6.4 <strong>Compute Mean Squared Error</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#logging-each-sample-to-csv">6.5 <strong>Logging Each Sample to CSV</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#occasional-print-of-mse">6.6 <strong>Occasional Print of MSE</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#closing-steps">7. <strong>Closing Steps</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary-of-the-workflow">8. <strong>Summary of the Workflow</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#program-code">Program Code</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#section-examples-sine-wave-f90">section_examples_sine_wave.f90</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-the-program-using-fpm-fortran-package-manager">Build the Program using FPM (Fortran Package Manager)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-program-using-fpm-fortran-package-manager">Run the Program using FPM (Fortran Package Manager)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-neural-network-predictions-and-mean-squared-error">Plot the Neural Network Predictions and Mean Squared Error</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#read-the-data-from-the-csv-file">Read the Data from the CSV File</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#group-and-average-the-mean-squared-error-by-iteration">Group and Average the Mean Squared Error by Iteration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-neural-network-predictions-vs-true-sine-wave">Plot the Neural Network Predictions vs True Sine Wave</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-mean-squared-error-vs-iteration">Plot the Mean Squared Error vs Iteration</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Mark Khusid
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>