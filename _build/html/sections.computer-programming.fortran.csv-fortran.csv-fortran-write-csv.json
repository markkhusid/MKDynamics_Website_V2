{"version":3,"kind":"Notebook","sha256":"a53535535fe7fcd8e36adc89897c86eef3e2c94a169d2e170c5cc46b4e21a051","slug":"sections.computer-programming.fortran.csv-fortran.csv-fortran-write-csv","location":"/Sections/Computer_Programming/Fortran/CSV_Fortran/csv_fortran_write_csv.ipynb","dependencies":[],"frontmatter":{"title":"Section: Write CSV Files","content_includes_title":true,"kernelspec":{"name":"py311_env","display_name":"Python 3.11","language":"python"},"authors":[{"nameParsed":{"literal":"Mark Khusid","given":"Mark","family":"Khusid"},"name":"Mark Khusid","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/markkhusid/MKDynamics_Website_V2","numbering":{"title":{"offset":4}},"source_url":"https://github.com/markkhusid/MKDynamics_Website_V2/blob/master/Sections/Computer_Programming/Fortran/CSV_Fortran/csv_fortran_write_csv.ipynb","edit_url":"https://github.com/markkhusid/MKDynamics_Website_V2/edit/master/Sections/Computer_Programming/Fortran/CSV_Fortran/csv_fortran_write_csv.ipynb","exports":[{"format":"ipynb","filename":"csv_fortran_write_csv.ipynb","url":"/build/csv_fortran_write_cs-8cdea8164fe0aa35fa35e6657f636df0.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"","value":"---\njupytext:\n  formats: md:myst\n  text_representation:\n    extension: .md\n    format_name: myst\nkernelspec:\n  display_name: Python 3\n  language: python\n  name: python3\n---","key":"YrBtVotwCw"}],"key":"rH2xw07aHy"},{"type":"block","kind":"notebook-content","data":{"vscode":{"languageId":"raw"}},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Section: Write CSV Files","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bBYj8PPwqS"}],"identifier":"section-write-csv-files","label":"Section: Write CSV Files","html_id":"section-write-csv-files","implicit":true,"key":"l5Skhr5pq8"}],"key":"yHn6H0L8C4"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this section, we will write CSV files in Fortran using the CSV_Fortran Module.  The CSV_Fortran Module is a Fortran module that provides a simple interface for reading and writing CSV files.  The module is available at ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TcM2Qf4DfF"},{"type":"link","url":"https://github.com/jacobwilliams/csv-fortran","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"https://​github​.com​/jacobwilliams​/csv​-fortran","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rxM8at96eo"}],"urlSource":"https://github.com/jacobwilliams/csv-fortran","error":true,"key":"F5aRSTiE7p"},{"type":"text","value":".  Documentation for the module is available at ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"W24f50e6HI"},{"type":"link","url":"https://jacobwilliams.github.io/csv-fortran/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"https://​jacobwilliams​.github​.io​/csv​-fortran/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WCns3FufSP"}],"urlSource":"https://jacobwilliams.github.io/csv-fortran/","key":"y4rLRMOpf5"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CClxBPaFUc"}],"key":"jMsHMebOZq"}],"key":"TrY0nwqXep"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example Programs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cNkYMJkPiT"}],"identifier":"example-programs","label":"Example Programs","html_id":"example-programs","implicit":true,"key":"eBgqiduW6c"}],"key":"FXuXdRQvKX"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the documentation for the CSV_Fortran Module, there are several example programs that demonstrate how to read and write CSV files.  We will use the example programs to demonstrate how to write CSV files in Fortran.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KiYouDNRir"}],"key":"ydkRXskSTi"}],"key":"DHPumpf6Oz"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Writing a CSV File","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OR2CnVUnhn"}],"identifier":"writing-a-csv-file","label":"Writing a CSV File","html_id":"writing-a-csv-file","implicit":true,"key":"hZ5bw0ISPa"}],"key":"kEsIi0icTG"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The following example program writes a CSV file named ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jVvgvIEOqe"},{"type":"inlineCode","value":"test.csv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yKhSJ31S2t"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p2cnYSfHiS"}],"key":"ESDyMyyGDa"}],"key":"nNibeZYEwr"},{"type":"block","kind":"notebook-content","children":[{"type":"include","file":"Fortran_Code/Section_CSV_Fortran_Write_CSV/app/section_csv_fortran_write_csv.f90","literal":true,"children":[{"type":"code","value":"program csv_write_test\n\n  use csv_module\n    use iso_fortran_env, only: wp => real64\n\n    implicit none\n\n    type(csv_file) :: f\n    logical :: status_ok\n\n    ! set optional inputs:\n    call f%initialize(verbose = .true.)\n\n    ! open the file\n    call f%open('test.csv',n_cols=4,status_ok=status_ok)\n\n    ! add header\n    call f%add(['x','y','z','t'])\n    call f%next_row()\n\n    ! add some data:\n    call f%add([1.0_wp,2.0_wp,3.0_wp],real_fmt='(F5.3)')\n    call f%add(.true.)\n    call f%next_row()\n    call f%add([4.0_wp,5.0_wp,6.0_wp],real_fmt='(F5.3)')\n    call f%add(.false.)\n    call f%next_row()\n\n    ! finished\n    call f%close(status_ok)\n  \nend program csv_write_test\n","lang":"fortran","filename":"section_csv_fortran_write_csv.f90","key":"Uusb7f9DHV"}],"key":"N4OzbLIqII"}],"key":"hbnFmfZRTw"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The program writes a CSV file named ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BGDouWfpHG"},{"type":"inlineCode","value":"test.csv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"US9wesw3Ro"},{"type":"text","value":" with the following contents:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fKkx1Z5mAC"}],"key":"s1k7LfOalh"},{"type":"code","lang":"bash","value":"x,y,z,t\n1.000,2.000,3.000,T\n4.000,5.000,6.000,F","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"key":"Di87xf6ZON"}],"key":"phEHGtd2HI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Building the Example Program using FPM (Fortran Package Manager)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fnIeCFhmIo"}],"identifier":"building-the-example-program-using-fpm-fortran-package-manager","label":"Building the Example Program using FPM (Fortran Package Manager)","html_id":"building-the-example-program-using-fpm-fortran-package-manager","implicit":true,"key":"wkITqSfbXE"}],"key":"ZwcII13zBl"},{"type":"block","kind":"notebook-content","data":{"vscode":{"languageId":"raw"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"TOML File","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oDchpyNEki"}],"identifier":"toml-file","label":"TOML File","html_id":"toml-file","implicit":true,"key":"GPkHZB22Fw"}],"key":"M5aa4vx6jE"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The above program was compiled using the Fortran Package Manager (FPM).  The following is the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gW3Q5pvgHr"},{"type":"inlineCode","value":"fpm.toml","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v8A10UEeeb"},{"type":"text","value":" file used to build the program:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AIsCnNeoRt"}],"key":"y0KTmU7UYe"}],"key":"Ycyawu1TA3"},{"type":"block","kind":"notebook-content","children":[{"type":"include","file":"Fortran_Code/Section_CSV_Fortran_Write_CSV/fpm.toml","literal":true,"children":[{"type":"code","value":"name = \"Section_CSV_Fortran_Write_CSV\"\n\n[build]\nauto-executables = true\nauto-tests = true\nauto-examples = true\n\n[install]\nlibrary = false\n\n[dependencies]\ncsv-fortran = { git=\"https://github.com/jacobwilliams/csv-fortran.git\" }\n\n[[executable]]\nname=\"Section_CSV_Fortran_Write_CSV\"\nsource-dir=\"app\"\nmain=\"section_csv_fortran_write_csv.f90\"\n\n\n","lang":"toml","filename":"fpm.toml","key":"IdfTL2hEX2"}],"key":"oyc1U4JhVb"}],"key":"TJzystYjvy"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Build the Program","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zatqZMYGJw"}],"identifier":"build-the-program","label":"Build the Program","html_id":"build-the-program","implicit":true,"key":"DIpPpCLtpE"}],"key":"YbyCGBqSjs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nroot_dir = \"\"\nroot_dir = os.getcwd()","key":"pSmSQcmiXH"},{"type":"outputs","id":"68ZWJUpcCImGQhBeq6p7k","children":[],"key":"Cvrp2e553k"}],"key":"rXJg9Kvnin"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"code_dir = root_dir + \"/\" + \"Fortran_Code/Section_CSV_Fortran_Write_CSV\"","key":"NLdfngv1xu"},{"type":"outputs","id":"1cJgf-LXE33waKvrdpqkf","children":[],"key":"BUarEMvGRU"}],"key":"qLEA1whn6f"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"os.chdir(code_dir)","key":"x8bytnTqlm"},{"type":"outputs","id":"uHI4kfBudikTeQYw-8_KL","children":[],"key":"gglN3GHDBG"}],"key":"gyQ50Upv0k"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"build_status = os.system(\"fpm build 2>/dev/null\")","key":"N6bjWBtVsB"},{"type":"outputs","id":"PUoszm1ABC1jAZORwoBB9","children":[],"key":"nie7DtQ2vt"}],"key":"BKLAsJwF3v"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Run the Program","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"T1SyPnc8Wp"}],"identifier":"run-the-program","label":"Run the Program","html_id":"run-the-program","implicit":true,"key":"pFhNWXAldz"}],"key":"aLeGQHCGMm"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The program is run and the output is saved into a file named 'data.dat","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nLNSMvIOsk"}],"key":"yCxL11LMhr"}],"key":"VB7pPwUzA7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"exec_status = \\\n    os.system(\"fpm run 2>/dev/null\")","key":"Gr6OaOv9Dh"},{"type":"outputs","id":"XZ_i0Zg57yrgDvcuZl8hl","children":[],"key":"g73S8ou3Q7"}],"key":"YVQMCC6XiD"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Examine the Output File","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Uxzp08gqqA"}],"identifier":"examine-the-output-file","label":"Examine the Output File","html_id":"examine-the-output-file","implicit":true,"key":"NgSR81SVgD"}],"key":"I1A8jS0HHj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"!cat test.csv","key":"nuyfzFJRlU"},{"type":"outputs","id":"66vNtO6wsWpARCYiK8mlT","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"\"x\",\"y\",\"z\",\"t\"\n1.000,2.000,3.000,T\n4.000,5.000,6.000,F\n"},"children":[],"key":"nYUCpCjgTD"}],"key":"hIiMJpcFnL"}],"key":"C3aV6irEBD"}],"key":"s0jjUqx5Cz"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Section: Read CSV Files","url":"/sections/computer-programming/fortran/csv-fortran/csv-fortran-read-csv","group":"Computer Programming"},"next":{"title":"NERSC - National Energy Research Scientific Computing Center","url":"/sections/computer-programming/fortran/nersc/nersc-head","group":"Computer Programming"}}},"domain":"http://localhost:3009"}