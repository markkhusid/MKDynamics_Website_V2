{"version":3,"kind":"Notebook","sha256":"6822c64d1d2e03b6fa556cedc1304079fcb64dd05156ebba0bb7383eca7c13a1","slug":"sections.computer-programming.fortran.fortran-mooc.section-blas-lapack-scal","location":"/Sections/Computer_Programming/Fortran/Fortran_MOOC/Section_BLAS_LAPACK_Scal.ipynb","dependencies":[],"frontmatter":{"title":"Section: BLAS/LAPACK - SCAL","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Mark Khusid","given":"Mark","family":"Khusid"},"name":"Mark Khusid","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/markkhusid/MKDynamics_Website_V2","numbering":{"title":{"offset":5}},"source_url":"https://github.com/markkhusid/MKDynamics_Website_V2/blob/master/Sections/Computer_Programming/Fortran/Fortran_MOOC/Section_BLAS_LAPACK_Scal.ipynb","edit_url":"https://github.com/markkhusid/MKDynamics_Website_V2/edit/master/Sections/Computer_Programming/Fortran/Fortran_MOOC/Section_BLAS_LAPACK_Scal.ipynb","exports":[{"format":"ipynb","filename":"Section_BLAS_LAPACK_Scal.ipynb","url":"/build/Section_BLAS_LAPACK_-8f977b7e564d06cc804b796ebc419075.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"","value":"---\njupytext:\n  formats: md:myst\n  text_representation:\n    extension: .md\n    format_name: myst\nkernelspec:\n  display_name: Python 3\n  language: python\n  name: python3\n---","key":"ar92eotKWw"}],"key":"O8FQOMvWkc"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Section: BLAS/LAPACK - SCAL","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QyhvI8p2RS"}],"identifier":"section-blas-lapack-scal","label":"Section: BLAS/LAPACK - SCAL","html_id":"section-blas-lapack-scal","implicit":true,"key":"n6fACEoH8v"}],"visibility":"show","key":"Zq7epUL9gq"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Adapted from: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Tn3CeTeaVN"},{"type":"link","url":"https://github.com/gjbex/Fortran-MOOC/tree/master/source_code/blas_lapack","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"https://​github​.com​/gjbex​/Fortran​-MOOC​/tree​/master​/source​_code​/blas​_lapack","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dC3RqnsVom"}],"urlSource":"https://github.com/gjbex/Fortran-MOOC/tree/master/source_code/blas_lapack","error":true,"key":"fci6q1WijC"}],"key":"IwfoyM0aUG"}],"key":"p2kk0B4xNG"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This program demonstrates using the SCAL BLAS/LAPACK subroutine to scale a vector by a constant in Fortran.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AbWaEZxtXp"}],"identifier":"this-program-demonstrates-using-the-scal-blas-lapack-subroutine-to-scale-a-vector-by-a-constant-in-fortran","label":"This program demonstrates using the SCAL BLAS/LAPACK subroutine to scale a vector by a constant in Fortran.","html_id":"this-program-demonstrates-using-the-scal-blas-lapack-subroutine-to-scale-a-vector-by-a-constant-in-fortran","implicit":true,"key":"CKSlTWAZXQ"}],"key":"IH364qQfPK"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In file ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cDmr4GetIR"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"section_blas_lapack_scal.f90","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jvMgfpBCRu"}],"key":"VG9xKxxbw6"}],"key":"e1NmKVWog9"}],"key":"bpBvhZrRlO"},{"type":"block","kind":"notebook-content","children":[{"type":"include","file":"Fortran_Code/Section_BLAS_LAPACK_Scal/app/section_blas_lapack_scal.f90","literal":true,"children":[{"type":"code","value":"program scal\n  use, intrinsic :: iso_fortran_env, only : error_unit, DP => REAL64\n  implicit none\n  integer, parameter :: rows = 3, cols = 4\n  real(kind=DP), dimension(rows, cols) :: matrix\n  real(kind=DP), dimension(rows) :: norm\n  integer :: row\n\n  ! Define the explicit interface for the BLAS subroutine dscal\n  interface\n      subroutine dscal(n, da, dx, incx)\n          import :: DP\n          integer :: n, incx\n          real(kind=DP) :: da\n          real(kind=DP), dimension(*) :: dx\n      end subroutine dscal\n  end interface\n\n  ! Initialize matrix with random numbers\n  call random_number(matrix)\n  \n  ! Print original matrix\n  print '(A)', 'original:'\n\n  ! Print matrix\n  call print_matrix(matrix)\n\n  ! Normalize along each column\n  norm = sum(matrix, dim=2)\n  print '(A, *(F12.7))', 'norm:', norm\n\n  ! Loop over rows\n  do row = 1, rows\n      print '(A, I0)', 'row: ', row\n      print '(A, F12.7)', '1/norm(row): ', 1.0_DP/norm(row)\n\n      ! In Fortran, the function call for dscal is:\n      ! call dscal(n, da, dx, incx)\n      ! where:\n      ! n is the number of elements in the vector\n      ! da is the scalar\n      ! dx is the vector\n      ! incx is the increment between elements of the vector\n      call dscal(cols, 1.0_DP/norm(row), matrix(row, :), 1)\n      \n      ! Print the matrix\n      call print_matrix(matrix)\n  end do\n  print '(A)', 'row-normalized::'\n  ! Print matrix\n  call print_matrix(matrix)\n\n  ! Normalize along each column\n  norm = sum(matrix, dim=2)\n  print '(A, *(F12.7))', 'norm:', norm\n\ncontains\n\n  subroutine print_matrix(matrix)\n      implicit none\n      real(kind=DP), dimension(:, :), intent(in) :: matrix\n      integer :: row\n\n      do row = 1, size(matrix, 1)\n          print '(*(F12.7))', matrix(row, :)\n      end do\n  end subroutine print_matrix\n\nend program scal\n","lang":"fortran","filename":"section_blas_lapack_scal.f90","key":"cYBwplXpim"}],"key":"cMBS4AK3EH"}],"key":"r6ljaTmuWc"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The above program is compiled and run using Fortran Package Manager (fpm):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yF1F8BP6ad"}],"key":"Nco4IH7Ta4"}],"key":"Z6GvIjL2nl"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Build the Program using FPM (Fortran Package Manager)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wjWMgPpGOr"}],"identifier":"build-the-program-using-fpm-fortran-package-manager","label":"Build the Program using FPM (Fortran Package Manager)","html_id":"build-the-program-using-fpm-fortran-package-manager","implicit":true,"key":"r3ZqdbJrwD"}],"visibility":"show","key":"kt2CHFxWa9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nroot_dir = \"\"\nroot_dir = os.getcwd()","key":"UJKycajyQo"},{"type":"outputs","id":"5p9ELuP5qnvccEIz1dXrv","children":[],"key":"W8rz0PtIt9"}],"key":"K9WTAfuReu"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Since the code makes use of the LAPACK library, the following FPM configuration file (fpm.toml) was used:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p5nwFoC4G2"}],"key":"NNMHG2dGvg"}],"key":"n1JqH4VPBV"},{"type":"block","kind":"notebook-content","children":[{"type":"include","file":"Fortran_Code/Section_BLAS_LAPACK_Scal/fpm.toml","literal":true,"children":[{"type":"code","value":"name = \"Section_BLAS_LAPACK_Scal\"\n\n[build]\nauto-executables = true\nauto-tests = true\nauto-examples = true\nlink = [\"blas\", \"lapack\"]\n\n[install]\nlibrary = false\n\n[[executable]]\nname=\"Section_BLAS_LAPACK_Scal\"\nsource-dir=\"app\"\nmain=\"section_blas_lapack_scal.f90\"\n","lang":"toml","filename":"fpm.toml","key":"h3dBtTuwH6"}],"key":"tGSw3O2uub"}],"key":"l47yK9Msh4"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"code_dir = root_dir + \"/\" + \"Fortran_Code/Section_BLAS_LAPACK_Scal\"","visibility":"show","key":"clOljV5QNN"},{"type":"outputs","id":"ml30Cbh6Xtva5gFD8wWcY","children":[],"visibility":"show","key":"p9lE9M7O7o"}],"visibility":"show","key":"NzXpbjEvm9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"os.chdir(code_dir)","key":"U8gJjLgzi3"},{"type":"outputs","id":"2iuUicCIQ42-QKYFaRCAM","children":[],"key":"yGHD7DORDF"}],"key":"PQ9ZJUr5GW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"build_status = os.system(\"fpm build 2>/dev/null\")","key":"wF5mImXZYd"},{"type":"outputs","id":"X2pbXQAdnobzMmeEJ3UL9","children":[],"key":"iyT6weAkZo"}],"key":"j9CN6Jmi0e"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Run the Program using FPM (Fortran Package Manager)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mpIkAHkeZ1"}],"identifier":"run-the-program-using-fpm-fortran-package-manager","label":"Run the Program using FPM (Fortran Package Manager)","html_id":"run-the-program-using-fpm-fortran-package-manager","implicit":true,"key":"pXtjaX8SVK"}],"key":"h4yOk6CTpY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"exec_status = \\\n    os.system(\"fpm run 2>/dev/null\")","key":"qEMbM4TYQt"},{"type":"outputs","id":"gXrGHPumB0ztHm_dLMiWu","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"original:\n   0.8237821   0.0533343   0.3678545   0.5416564\n   0.6819919   0.9583049   0.4784227   0.6292463\n   0.7772520   0.3168976   0.4976013   0.8041315\nnorm:   1.7866273   2.7479658   2.3958825\nrow: 1\n1/norm(row):    0.5597138\n   0.4610822   0.0298519   0.2058933   0.3031726\n   0.6819919   0.9583049   0.4784227   0.6292463\n   0.7772520   0.3168976   0.4976013   0.8041315\nrow: 2\n1/norm(row):    0.3639056\n   0.4610822   0.0298519   0.2058933   0.3031726\n   0.2481806   0.3487325   0.1741007   0.2289862\n   0.7772520   0.3168976   0.4976013   0.8041315\nrow: 3\n1/norm(row):    0.4173827\n   0.4610822   0.0298519   0.2058933   0.3031726\n   0.2481806   0.3487325   0.1741007   0.2289862\n   0.3244116   0.1322676   0.2076902   0.3356306\nrow-normalized::\n   0.4610822   0.0298519   0.2058933   0.3031726\n   0.2481806   0.3487325   0.1741007   0.2289862\n   0.3244116   0.1322676   0.2076902   0.3356306\nnorm:   1.0000000   1.0000000   1.0000000\n"},"children":[],"key":"WUwPyAZg7O"}],"key":"WRkHKFDgZW"}],"key":"aKA1RUnjZN"}],"key":"jhNqau84dY"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Section: BLAS/LAPACK - GEMV","url":"/sections/computer-programming/fortran/fortran-mooc/section-blas-lapack-gemv","group":"Computer Programming"},"next":{"title":"Section: BLAS/LAPACK - SV","url":"/sections/computer-programming/fortran/fortran-mooc/section-blas-lapack-sv","group":"Computer Programming"}}},"domain":"http://localhost:3001"}