{"version":3,"kind":"Notebook","sha256":"da73c565109c1e8e1399a4a729b1f1335bc3815fb9a17fb7f99cbceff2a4fc14","slug":"sections.computer-programming.fortran.nersc.supercomputing-crash-course.computing-pi-serial.computing-pi-serial","location":"/Sections/Computer_Programming/Fortran/NERSC/Supercomputing_Crash_Course/Computing_Pi_Serial/Computing_Pi_Serial.ipynb","dependencies":[],"frontmatter":{"title":"Crash Course in Supercomputing: Compute Pi in a Serial Fashion","content_includes_title":true,"kernelspec":{"name":"py311_env","display_name":"Python 3.11","language":"python"},"authors":[{"nameParsed":{"literal":"Mark Khusid","given":"Mark","family":"Khusid"},"name":"Mark Khusid","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/markkhusid/MKDynamics_Website_V2","numbering":{"title":{"offset":5}},"source_url":"https://github.com/markkhusid/MKDynamics_Website_V2/blob/master/Sections/Computer_Programming/Fortran/NERSC/Supercomputing_Crash_Course/Computing_Pi_Serial/Computing_Pi_Serial.ipynb","edit_url":"https://github.com/markkhusid/MKDynamics_Website_V2/edit/master/Sections/Computer_Programming/Fortran/NERSC/Supercomputing_Crash_Course/Computing_Pi_Serial/Computing_Pi_Serial.ipynb","exports":[{"format":"ipynb","filename":"Computing_Pi_Serial.ipynb","url":"/build/Computing_Pi_Serial-1712128fa473fc69ce948100b0806b78.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"","value":"---\njupytext:\n  formats: md:myst\n  text_representation:\n    extension: .md\n    format_name: myst\nkernelspec:\n  display_name: Python 3\n  language: python\n  name: python3\n---","key":"px4TB314Vt"}],"key":"dRfa8QrW6u"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Crash Course in Supercomputing: Compute Pi in a Serial Fashion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wLzoPFvS3U"}],"identifier":"crash-course-in-supercomputing-compute-pi-in-a-serial-fashion","label":"Crash Course in Supercomputing: Compute Pi in a Serial Fashion","html_id":"crash-course-in-supercomputing-compute-pi-in-a-serial-fashion","implicit":true,"key":"CJy9ms7uYx"}],"visibility":"show","key":"ysBHIFu9Dh"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Adapted from: ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nzWdIHU5F8"},{"type":"link","url":"https://github.com/NERSC/crash-course-supercomputing/tree/main/darts-suite/fortran","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"https://​github​.com​/NERSC​/crash​-course​-supercomputing​/tree​/main​/darts​-suite​/fortran","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t5zh9SPajB"}],"urlSource":"https://github.com/NERSC/crash-course-supercomputing/tree/main/darts-suite/fortran","error":true,"key":"nDY5ztiYz4"}],"key":"M53wRwlkFa"}],"key":"B1Kibds8Vy"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This program demonstrates computing ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oYYJaxCgrQ"},{"type":"inlineMath","value":"\\pi","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>","key":"ZXI87BlHLv"},{"type":"text","value":" in Fortran using the Monte Carlo method in a Serial Fashion:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ti1v48daSl"}],"identifier":"this-program-demonstrates-computing-pi-in-fortran-using-the-monte-carlo-method-in-a-serial-fashion","label":"This program demonstrates computing \\pi in Fortran using the Monte Carlo method in a Serial Fashion:","html_id":"this-program-demonstrates-computing-pi-in-fortran-using-the-monte-carlo-method-in-a-serial-fashion","implicit":true,"key":"WWkredZzZH"}],"key":"iA6lHmVbSd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In file computing_pi_serial.f90","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OOVxE6qMhb"}],"identifier":"in-file-computing-pi-serial-f90","label":"In file computing_pi_serial.f90","html_id":"in-file-computing-pi-serial-f90","implicit":true,"key":"ATPIt3spkm"}],"key":"gNPQxyNVA6"},{"type":"block","kind":"notebook-content","children":[{"type":"include","file":"code/app/compute_pi_serial.f90","literal":true,"children":[{"type":"code","value":"! Compute pi in serial\nprogram compute_pi_serial\n  use, intrinsic :: iso_fortran_env, only : DP => REAL64, I8 => INT64\n  use lcgenerator_mod,  only : lcgrandom\n  use get_nr_iters_mod, only : get_nr_iters\n  \n  implicit none\n\n  integer(kind=I8) :: num_trials, i = 0, Ncirc = 0\n  real(kind=DP) :: pi_computed = 0.0, pi_actual\n  real(kind=DP) :: x = 0.0, y = 0.0, r = 1.0\n  real(kind=DP) :: r_squared = 0.0\n\n  pi_actual = 2.0_DP * acos(0.0_DP)\n  \n  r_squared = r*r\n\n  num_trials = get_nr_iters()\n\n  do i = 1, num_trials\n    x = lcgrandom()\n    y = lcgrandom()\n    if ((x*x + y*y) <= r_squared) then\n        Ncirc = Ncirc + 1\n    end if\n  end do\n\n  pi_computed = 4.0*((1.0*Ncirc)/(1.0*num_trials))\n\n  print '(A, I10, A, F25.15)', \"After \", num_trials, \" loops, Pi = \", pi_computed\n  print '(A, F25.15)', \"Actual value of Pi = \", pi_actual\n  print '(A, F25.15)', \"Absolute difference = \", abs(pi_computed - pi_actual)\n\nend program compute_pi_serial","lang":"fortran","filename":"compute_pi_serial.f90","key":"NNvmNPtyAA"}],"key":"dF0eAaIYs0"}],"key":"TGpSG7XNhN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the file lcgenerator_mod.f90","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kkMSThtQlU"}],"identifier":"in-the-file-lcgenerator-mod-f90","label":"In the file lcgenerator_mod.f90","html_id":"in-the-file-lcgenerator-mod-f90","implicit":true,"key":"NHdgiigz3g"}],"key":"TrwDBXCqVC"},{"type":"block","kind":"notebook-content","children":[{"type":"include","file":"code/src/lcgenerator_mod.f90","literal":true,"children":[{"type":"code","value":"module lcgenerator_mod\n  use, intrinsic :: iso_fortran_env, only : DP => REAL64, I8 => INT64\n  implicit none\n  private\n  public :: lcgrandom\n\n  contains\n    real function lcgrandom()\n      integer(kind=I8), parameter :: MULTIPLIER = 1366\n      integer(kind=I8), parameter :: ADDEND = 150889\n      integer(kind=I8), parameter :: PMOD = 714025\n      integer(kind=I8), save :: random_last = 0\n\n      integer(kind=I8) :: random_next = 0\n      random_next = mod((MULTIPLIER * random_last + ADDEND), PMOD)\n      random_last = random_next\n      lcgrandom = (1.0_DP * random_next) / PMOD\n      return\n    end function lcgrandom\nend module lcgenerator_mod\n","lang":"fortran","filename":"lcgenerator_mod.f90","key":"yZzA16NMQL"}],"key":"eJjqKjiwUm"}],"key":"xvHzY46rKI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the file get_nr_iters_mod.f90","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HlQnzYbvuH"}],"identifier":"in-the-file-get-nr-iters-mod-f90","label":"In the file get_nr_iters_mod.f90","html_id":"in-the-file-get-nr-iters-mod-f90","implicit":true,"key":"r4xMHBtfQ6"}],"key":"LWhHIQpv5O"},{"type":"block","kind":"notebook-content","children":[{"type":"include","file":"code/src/get_nr_iters_mod.f90","literal":true,"children":[{"type":"code","value":"module get_nr_iters_mod\n    implicit none\n    private\n    public :: get_nr_iters\n\ncontains\n\n    function get_nr_iters() result(nr_iters)\n        use, intrinsic :: iso_fortran_env, only : error_unit\n        use, intrinsic :: iso_fortran_env, only : DP => REAL64, I8 => INT64\n        implicit none\n        integer(kind=I8) :: nr_iters\n        integer(kind=I8), parameter :: default_nr_iters = 1000_I8\n        character(len=1024) :: buffer, msg\n        integer :: istat\n\n        if (command_argument_count() >= 1) then\n            call get_command_argument(1, buffer)\n            read (buffer, fmt=*, iostat=istat, iomsg=msg) nr_iters\n            if (istat /= 0) then\n                write (unit=error_unit, fmt='(2A)') &\n                    'error: ', msg\n                stop 1\n            end if\n        else\n            nr_iters = default_nr_iters\n        end if\n    end function get_nr_iters\n\nend module get_nr_iters_mod\n","lang":"fortran","filename":"get_nr_iters_mod.f90","key":"TdXZuDRti4"}],"key":"Wt655MkaOs"}],"key":"l3e13oCUpn"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Code Analysis by Grok 4","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NKzEXXfNIH"}],"identifier":"code-analysis-by-grok-4","label":"Code Analysis by Grok 4","html_id":"code-analysis-by-grok-4","implicit":true,"key":"CbsgLoOZFg"}],"key":"uDPBXSM3RS"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Overview of the Code","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"v5sqKZJJYB"}],"identifier":"overview-of-the-code","label":"Overview of the Code","html_id":"overview-of-the-code","implicit":true,"key":"qNYsKPUiKU"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This Fortran code is a complete, self-contained program designed to approximate the value of π (pi) using the Monte Carlo simulation method. The approach is serial (non-parallel), meaning it runs sequentially on a single processor without any concurrency. The program generates pseudo-random points within a unit square and counts how many fall inside a quarter-circle inscribed in that square. The ratio of points inside the circle to the total points, multiplied by 4, provides an estimate of π.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KKFg2AmCac"}],"key":"YJDm21n1uB"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The code is structured as a main program (","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"elk3iThzv4"},{"type":"inlineCode","value":"compute_pi_serial","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"W4xOfUaJ5a"},{"type":"text","value":") and two supporting modules:","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"drTxIPoDee"}],"key":"Nn6nyYnJZC"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"get_nr_iters_mod","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"kNtCNqR2LJ"},{"type":"text","value":": Handles reading the number of iterations (trials) from command-line arguments or uses a default value.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"EaLkwP28uJ"}],"key":"eClaOryszq"}],"key":"aFFFpFbLcw"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"lcgenerator_mod","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"k87bO3kZdJ"},{"type":"text","value":": Provides a simple linear congruential generator (LCG) for pseudo-random number generation.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Oji9XzbfFZ"}],"key":"soaa0Sp7t1"}],"key":"ENuNI5kzR8"}],"key":"lRKN08cR5o"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"The code uses modern Fortran features (e.g., from Fortran 2008/2018 standards), including intrinsic modules like ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"TWb0haUr22"},{"type":"inlineCode","value":"iso_fortran_env","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"CLYVhtSH9t"},{"type":"text","value":" for portable data types (e.g., 64-bit reals and integers). It employs double-precision arithmetic for accuracy and includes error handling for input.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"HX1gwwt6Kb"}],"key":"Fv8qXLu7Cz"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"I’ll explain the code in detail, breaking it down by section: first the main program, then each module. I’ll cover the purpose, syntax, variables, logic, and any key Fortran concepts.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"P5fEC2I3M5"}],"key":"Wzzq0OTgcJ"},{"type":"heading","depth":3,"position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Main Program: ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"EMtIM45qi0"},{"type":"inlineCode","value":"compute_pi_serial","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"O078CDCDRd"}],"identifier":"main-program-compute-pi-serial","label":"Main Program: compute_pi_serial","html_id":"main-program-compute-pi-serial","implicit":true,"key":"YrB5OfztFM"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"This is the entry point of the executable. It sets up the simulation, runs the Monte Carlo loop, computes the approximation, and prints results.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"D59URZXHqf"}],"key":"V6dPRWmrNC"},{"type":"code","lang":"fortran","value":"program compute_pi_serial\n  use, intrinsic :: iso_fortran_env, only : DP => REAL64, I8 => INT64\n  use lcgenerator_mod,  only : lcgrandom\n  use get_nr_iters_mod, only : get_nr_iters\n  \n  implicit none\n\n  integer(kind=I8) :: num_trials, i = 0, Ncirc = 0\n  real(kind=DP) :: pi_computed = 0.0, pi_actual\n  real(kind=DP) :: x = 0.0, y = 0.0, r = 1.0\n  real(kind=DP) :: r_squared = 0.0\n\n  pi_actual = 2.0_DP * acos(0.0_DP)\n  \n  r_squared = r*r\n\n  num_trials = get_nr_iters()\n\n  do i = 1, num_trials\n    x = lcgrandom()\n    y = lcgrandom()\n    if ((x*x + y*y) <= r_squared) then\n        Ncirc = Ncirc + 1\n    end if\n  end do\n\n  pi_computed = 4.0*((1.0*Ncirc)/(1.0*num_trials))\n\n  print '(A, I10, A, F25.15)', \"After \", num_trials, \" loops, Pi = \", pi_computed\n  print '(A, F25.15)', \"Actual value of Pi = \", pi_actual\n  print '(A, F25.15)', \"Absolute difference = \", abs(pi_computed - pi_actual)\n\nend program compute_pi_serial","position":{"start":{"line":17,"column":1},"end":{"line":51,"column":1}},"key":"wfei7uw0Mb"},{"type":"heading","depth":4,"position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"Breakdown:","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"XHM897C8LB"}],"identifier":"breakdown","label":"Breakdown:","html_id":"breakdown","implicit":true,"key":"g97iaC6Nog"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":55,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":55,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"strong","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"text","value":"Module Imports and Aliases","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"JSocIOSSwp"}],"key":"bDrc6fYXpM"},{"type":"text","value":":","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"RhnJG1jjAg"}],"key":"RxqVusXtzt"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":56,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"use, intrinsic :: iso_fortran_env, only : DP => REAL64, I8 => INT64","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"CC2r8j4SAS"},{"type":"text","value":": This imports the intrinsic module ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"drHI942sN5"},{"type":"inlineCode","value":"iso_fortran_env","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"NaNJ1LxS5i"},{"type":"text","value":", which provides portable kind parameters for data types. ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"tcHNV091de"},{"type":"inlineCode","value":"DP","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"QApQEePxPc"},{"type":"text","value":" is aliased to ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"M2tp3krYr1"},{"type":"inlineCode","value":"REAL64","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"nyLcnSFifx"},{"type":"text","value":" (64-bit double-precision real), and ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"qBKFT5iga5"},{"type":"inlineCode","value":"I8","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"qB7J1nih0O"},{"type":"text","value":" to ","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"j7Sl9aqp9M"},{"type":"inlineCode","value":"INT64","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"WCdfOHJy6Q"},{"type":"text","value":" (64-bit integer). This ensures cross-platform consistency for high-precision calculations.","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"Ahvs55d8X9"}],"key":"gocU72RF1H"}],"key":"i1szAyeHzy"},{"type":"listItem","spread":true,"position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"use lcgenerator_mod, only : lcgrandom","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"yddfIfKQpo"},{"type":"text","value":": Imports the ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"FC0WV3Cl8Z"},{"type":"inlineCode","value":"lcgrandom","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"gpJall0K5l"},{"type":"text","value":" function from the ","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"Hm5ovFh3D6"},{"type":"inlineCode","value":"lcgenerator_mod","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"Yd2sdkuq4N"},{"type":"text","value":" module for generating pseudo-random numbers.","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"ViHLEOcEy6"}],"key":"lDgCPujRQu"}],"key":"u8LSgBQKUV"},{"type":"listItem","spread":true,"position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"use get_nr_iters_mod, only : get_nr_iters","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"p952vAwxTj"},{"type":"text","value":": Imports the ","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"BetgTHXVyZ"},{"type":"inlineCode","value":"get_nr_iters","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"gfiPUiX1Ig"},{"type":"text","value":" function from the ","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"WjVZTjnCwT"},{"type":"inlineCode","value":"get_nr_iters_mod","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"nSQGeNB7PH"},{"type":"text","value":" module to determine the number of trials.","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"aw2o2L3C4F"}],"key":"bzQPaEPapi"}],"key":"azXxaITu5o"},{"type":"listItem","spread":true,"position":{"start":{"line":59,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"implicit none","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"S5NrBjrHxy"},{"type":"text","value":": A good practice in Fortran to prevent undeclared variables; all variables must be explicitly declared.","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"tZ2apdivQS"}],"key":"tQRekExI9g"}],"key":"B60FIJqmxf"}],"key":"NeXLpwb3SP"}],"key":"XUqpreT9z2"},{"type":"listItem","spread":true,"position":{"start":{"line":61,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"strong","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"text","value":"Variable Declarations","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"E0TygS8Xho"}],"key":"bswBz4SIOQ"},{"type":"text","value":":","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"R6M6jT9V3K"}],"key":"cxtOOty6fx"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":62,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":62,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"integer(kind=I8) :: num_trials, i = 0, Ncirc = 0","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"gOQTa0k0f0"},{"type":"text","value":": Declares 64-bit integers:","position":{"start":{"line":62,"column":1},"end":{"line":62,"column":1}},"key":"cNEY1CauQj"}],"key":"jgTDYnJ1iw"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":63,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"num_trials","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"i1iqnGX6K6"},{"type":"text","value":": Total number of Monte Carlo trials (points to generate).","position":{"start":{"line":63,"column":1},"end":{"line":63,"column":1}},"key":"pbzotD2HBi"}],"key":"X5wKHT29Mb"}],"key":"DLFphrEvnG"},{"type":"listItem","spread":true,"position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"i","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"lrBXENGqM5"},{"type":"text","value":": Loop counter, initialized to 0.","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"eYxqmGnpv9"}],"key":"W8qQiAzSZ5"}],"key":"cHphtH11QN"},{"type":"listItem","spread":true,"position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"Ncirc","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"u5go9VS1Nj"},{"type":"text","value":": Counter for points inside the quarter-circle, initialized to 0.","position":{"start":{"line":65,"column":1},"end":{"line":65,"column":1}},"key":"Mvggt0X2bG"}],"key":"PzZKaE15X7"}],"key":"tcmdvdFEwr"}],"key":"dX2ygNrg9R"}],"key":"W7Uz5jvpmL"},{"type":"listItem","spread":true,"position":{"start":{"line":66,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"real(kind=DP) :: pi_computed = 0.0, pi_actual","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"ZRZRTE6tNM"},{"type":"text","value":": Double-precision reals:","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"NSGLTHyfBQ"}],"key":"vPA1kQRs7m"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":67,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"pi_computed","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"MVi9ezwGmu"},{"type":"text","value":": The approximated value of π.","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"J7stvgorTY"}],"key":"WgMslp8zwJ"}],"key":"EcU7UxOr6I"},{"type":"listItem","spread":true,"position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"pi_actual","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"g31xW1qJ9D"},{"type":"text","value":": The “true” value of π (computed using ","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"gnDDJddpIp"},{"type":"inlineCode","value":"acos","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"Og85Sm3VVg"},{"type":"text","value":").","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"KgTf2oihQR"}],"key":"qirGebMuCW"}],"key":"vLvs5zlJIY"}],"key":"J3pVd641yy"}],"key":"mLdDEIImdw"},{"type":"listItem","spread":true,"position":{"start":{"line":69,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"real(kind=DP) :: x = 0.0, y = 0.0, r = 1.0","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"QONlYCFfGL"},{"type":"text","value":": Coordinates and radius:","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"mK9Gx5yJuL"}],"key":"luhVLorf8O"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":70,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"x","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"NQQxcPjCRS"},{"type":"text","value":", ","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"eD3svCSBrc"},{"type":"inlineCode","value":"y","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"ddRLJVIAvD"},{"type":"text","value":": Pseudo-random coordinates in [0,1).","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"Xo4d7uupZh"}],"key":"oLAPS5cy7B"}],"key":"dYAbYNZuZq"},{"type":"listItem","spread":true,"position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"r","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"jelWVG8sCA"},{"type":"text","value":": Radius of the circle (fixed at 1.0 for a unit circle).","position":{"start":{"line":71,"column":1},"end":{"line":71,"column":1}},"key":"D6OCOF2wEm"}],"key":"CzjxLPOmUf"}],"key":"abvq9lpZYE"}],"key":"Q9vowI19Hi"}],"key":"fESmymhSwn"},{"type":"listItem","spread":true,"position":{"start":{"line":72,"column":1},"end":{"line":73,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"real(kind=DP) :: r_squared = 0.0","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"lXq0w8A9MS"},{"type":"text","value":": Precomputed ","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"SUa4LWVMBU"},{"type":"inlineCode","value":"r*r","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"HCPZnQvy4s"},{"type":"text","value":" (1.0) to avoid repeated multiplication in the loop for minor efficiency.","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"lzFouuDxzV"}],"key":"ii1E5ZbZOa"}],"key":"N0fpnFcIiX"}],"key":"CNveUuKaOj"}],"key":"UgsTSqzLom"},{"type":"listItem","spread":true,"position":{"start":{"line":74,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"strong","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"children":[{"type":"text","value":"Computing the Actual π","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"cmkmM5NYwA"}],"key":"fP1H8Wdg9b"},{"type":"text","value":":","position":{"start":{"line":74,"column":1},"end":{"line":74,"column":1}},"key":"kVVxjoJtdg"}],"key":"jrZi3Gb9OE"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":75,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":75,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"pi_actual = 2.0_DP * acos(0.0_DP)","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"cMkCkKyURZ"},{"type":"text","value":": Uses the intrinsic ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"veedZ5cR6A"},{"type":"inlineCode","value":"acos","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"t8Q9H5FopG"},{"type":"text","value":" function (arc cosine) to compute π. ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"aD9rAoqrPw"},{"type":"inlineCode","value":"acos(0.0)","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"fg1evKyiI3"},{"type":"text","value":" returns π/2, so multiplying by 2 gives π. The ","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"kPxOOcKj3T"},{"type":"inlineCode","value":"_DP","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"mls1gvQ17Y"},{"type":"text","value":" suffix ensures double-precision literals.","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"PWGKHwP2eu"}],"key":"tdtzuTWzFx"}],"key":"WVSLSqf4gK"}],"key":"UkKz8H1o4m"}],"key":"kmKD7ER4GC"},{"type":"listItem","spread":true,"position":{"start":{"line":77,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"strong","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"children":[{"type":"text","value":"Precomputing r_squared","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"p3COrwZPae"}],"key":"v39zcJsUaC"},{"type":"text","value":":","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"yi1Yvyjq4C"}],"key":"ZyHhQwAIfe"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":78,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":78,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"r_squared = r*r","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"vNQMc2GAvB"},{"type":"text","value":": Stores 1.0 for use in the distance check inside the loop.","position":{"start":{"line":78,"column":1},"end":{"line":78,"column":1}},"key":"vsiuZRtnaK"}],"key":"gTTQBaGKl7"}],"key":"cH16YzeDMH"}],"key":"fMWEs8u05A"}],"key":"tpnRpQeaMv"},{"type":"listItem","spread":true,"position":{"start":{"line":80,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"strong","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"children":[{"type":"text","value":"Getting Number of Trials","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"MCC6JyoipC"}],"key":"oh6c7FQ93n"},{"type":"text","value":":","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"YncEwqeaEV"}],"key":"utCzh6ag3E"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":81,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":81,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"num_trials = get_nr_iters()","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"sNBKAYZUpc"},{"type":"text","value":": Calls the function from ","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"xylIPLJF5j"},{"type":"inlineCode","value":"get_nr_iters_mod","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"C5tYbfvfxu"},{"type":"text","value":" to read the number of iterations. If no command-line argument is provided, it defaults to 1000.","position":{"start":{"line":81,"column":1},"end":{"line":81,"column":1}},"key":"xaRfueSwlw"}],"key":"ZDPNbWple5"}],"key":"hdB4s1nfsk"}],"key":"tObRqNwk84"}],"key":"ofXTJcd6eO"},{"type":"listItem","spread":true,"position":{"start":{"line":83,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"strong","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"text","value":"Monte Carlo Loop","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"uYdPyhcbGI"}],"key":"nNWlebq1D3"},{"type":"text","value":":","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"u0FO1qpwOL"}],"key":"TuRfcCzhab"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":84,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":84,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"do i = 1, num_trials","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"cl42QiqYt9"},{"type":"text","value":": A simple do-loop that runs ","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"SEZSxpCNzO"},{"type":"inlineCode","value":"num_trials","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"nB0VcjDVnd"},{"type":"text","value":" times.","position":{"start":{"line":84,"column":1},"end":{"line":84,"column":1}},"key":"Y4lXaH1lE5"}],"key":"U7RF9GeiXt"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":85,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"x = lcgrandom()","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"sq1NhKOvyD"},{"type":"text","value":": Generates a pseudo-random number in [0,1) for the x-coordinate.","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"M5LMrypkw1"}],"key":"e9aTSkWbTG"}],"key":"DuulfuHHM8"},{"type":"listItem","spread":true,"position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"y = lcgrandom()","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"DyG8evq5SR"},{"type":"text","value":": Same for y-coordinate.","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"Njuc5GBPLL"}],"key":"gGzaBoPYGS"}],"key":"DdjT9Z9ef1"},{"type":"listItem","spread":true,"position":{"start":{"line":87,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"if ((x*x + y*y) <= r_squared) then","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"OfyumFzfEq"},{"type":"text","value":": Checks if the point (x,y) is inside the quarter-circle by testing if the squared distance from origin (x² + y²) ≤ 1.0.","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"tEw0QaVysY"}],"key":"dxE2tWRCpW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"If true, ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"pk1csDTlMA"},{"type":"inlineCode","value":"Ncirc = Ncirc + 1","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"K9fg9EwEMP"},{"type":"text","value":": Increments the counter.","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"lLQo23Kn8R"}],"key":"VLPpeEbeEE"}],"key":"cZNmP3EOvp"}],"key":"fWBcrkfngK"}],"key":"dzhfflqKII"}],"key":"yOpf7W7H2s"}],"key":"do2gbdbfnm"},{"type":"listItem","spread":true,"position":{"start":{"line":89,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"This implements the core Monte Carlo method: the probability a random point in the unit square falls inside the quarter-circle is π/4, so π ≈ 4 * (Ncirc / num_trials).","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"EHouutp860"}],"key":"Fx1Ao1gps0"}],"key":"JJuAXySV1V"}],"key":"v0XPig2c8m"}],"key":"TOdFaolD64"},{"type":"listItem","spread":true,"position":{"start":{"line":91,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"strong","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"Computing the Approximation","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"Wuu9x5Bcav"}],"key":"WZrpRx9mcE"},{"type":"text","value":":","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"woq3P6cz2d"}],"key":"IOBnx0caw5"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":92,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":92,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"pi_computed = 4.0*((1.0*Ncirc)/(1.0*num_trials))","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"n0CLPcDvqm"},{"type":"text","value":": Calculates the estimate. The ","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"KgWTDN9pn0"},{"type":"inlineCode","value":"1.0*","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"EWt5qtGEmy"},{"type":"text","value":" ensures real division (avoiding integer truncation). Note: In modern Fortran, this could be simplified to ","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"Zt03GT7WuG"},{"type":"inlineCode","value":"4.0 * real(Ncirc, DP) / real(num_trials, DP)","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"ruXfuaPrzH"},{"type":"text","value":", but the code uses explicit promotion.","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"xJ7YEK42RF"}],"key":"Q9tLsRhCzY"}],"key":"d0SkWopI6o"}],"key":"VreNNGOw8r"}],"key":"ET4DXRi2wO"},{"type":"listItem","spread":true,"position":{"start":{"line":94,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"strong","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"text","value":"Output","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"kuPR7bFxMJ"}],"key":"mD1LCTGzN5"},{"type":"text","value":":","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"NJNgi5lbm3"}],"key":"Ec7ZQ3AmkT"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":95,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"print '(A, I10, A, F25.15)', \"After \", num_trials, \" loops, Pi = \", pi_computed","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"key":"nEzm6XX3bv"},{"type":"text","value":": Prints the result with 10 digits for the integer and 15 decimal places for the float.","position":{"start":{"line":95,"column":1},"end":{"line":95,"column":1}},"key":"yhIywE5gFg"}],"key":"ifyb8DQbWf"}],"key":"TZTv6h9FWB"},{"type":"listItem","spread":true,"position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Similar prints for the actual π and absolute difference (","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"WVlX9lmZBh"},{"type":"inlineCode","value":"abs(pi_computed - pi_actual)","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"nErCPvWmzt"},{"type":"text","value":").","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"QOXUi4pUL6"}],"key":"O94KvJRAFz"}],"key":"MPTABlR3MM"},{"type":"listItem","spread":true,"position":{"start":{"line":97,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Format specifiers: ","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"uPWFn0XiJg"},{"type":"inlineCode","value":"A","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"pUHfe4JAft"},{"type":"text","value":" for strings, ","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"bv63GFgANn"},{"type":"inlineCode","value":"I10","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"Hi2TkAWwBg"},{"type":"text","value":" for integers (width 10), ","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"zjyOpgvoun"},{"type":"inlineCode","value":"F25.15","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"VoZ4uar015"},{"type":"text","value":" for floats (width 25, 15 decimals).","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"WpD0B2oT8G"}],"key":"yIGI1Yp3qL"}],"key":"r1ktD495dM"}],"key":"R5o8VztnQI"}],"key":"EauFimiRIR"}],"key":"aIM2RilAnd"},{"type":"paragraph","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"text","value":"This main program is straightforward and efficient for small ","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"fRg6oH7z6O"},{"type":"inlineCode","value":"num_trials","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"mcI3wvAfuu"},{"type":"text","value":", but for large values (e.g., millions), the approximation improves, though runtime increases linearly.","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"GpQPbXEaCN"}],"key":"ls4mrAoWMO"},{"type":"heading","depth":3,"position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"children":[{"type":"text","value":"Module: ","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"cKc5448wcK"},{"type":"inlineCode","value":"get_nr_iters_mod","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"n30sLvMxut"}],"identifier":"module-get-nr-iters-mod","label":"Module: get_nr_iters_mod","html_id":"module-get-nr-iters-mod","implicit":true,"key":"IzPWkygXKd"},{"type":"paragraph","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"text","value":"This module provides a function to parse the number of iterations from command-line arguments, with error handling and a default value.","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"HG50je9XAJ"}],"key":"O5OcIv3smE"},{"type":"code","lang":"fortran","value":"module get_nr_iters_mod\n    implicit none\n    private\n    public :: get_nr_iters\n\ncontains\n\n    function get_nr_iters() result(nr_iters)\n        use, intrinsic :: iso_fortran_env, only : error_unit\n        use, intrinsic :: iso_fortran_env, only : DP => REAL64, I8 => INT64\n        implicit none\n        integer(kind=I8) :: nr_iters\n        integer(kind=I8), parameter :: default_nr_iters = 1000_I8\n        character(len=1024) :: buffer, msg\n        integer :: istat\n\n        if (command_argument_count() >= 1) then\n            call get_command_argument(1, buffer)\n            read (buffer, fmt=*, iostat=istat, iomsg=msg) nr_iters\n            if (istat /= 0) then\n                write (unit=error_unit, fmt='(2A)') &\n                    'error: ', msg\n                stop 1\n            end if\n        else\n            nr_iters = default_nr_iters\n        end if\n    end function get_nr_iters\n\nend module get_nr_iters_mod","position":{"start":{"line":105,"column":1},"end":{"line":136,"column":1}},"key":"LBQ6PL628a"},{"type":"heading","depth":4,"position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"text","value":"Breakdown:","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"Za23RlSeri"}],"identifier":"breakdown","label":"Breakdown:","html_id":"breakdown-1","implicit":true,"key":"CoNWOtp5XT"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":140,"column":1},"end":{"line":157,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":140,"column":1},"end":{"line":144,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"children":[{"type":"strong","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"children":[{"type":"text","value":"Module Structure","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"stQxTb2Bzf"}],"key":"ztwBAf3xXT"},{"type":"text","value":":","position":{"start":{"line":140,"column":1},"end":{"line":140,"column":1}},"key":"w6QR6lYVAm"}],"key":"dL8qWOZGZz"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":141,"column":1},"end":{"line":144,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"implicit none","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"k3OTK4EVuy"},{"type":"text","value":": No implicit typing.","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"w0FqxMOzNp"}],"key":"cBzESzOJzV"}],"key":"e7qO12eKPG"},{"type":"listItem","spread":true,"position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"private","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"aRemcV28ym"},{"type":"text","value":": All entities are private by default.","position":{"start":{"line":142,"column":1},"end":{"line":142,"column":1}},"key":"LZ6PET9p5Q"}],"key":"oFiI3JHQJA"}],"key":"uswZ6HtHO0"},{"type":"listItem","spread":true,"position":{"start":{"line":143,"column":1},"end":{"line":144,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"public :: get_nr_iters","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"tafXABTdt8"},{"type":"text","value":": Only the function is exposed.","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"RZcWWDAhoy"}],"key":"twjZnvZUxS"}],"key":"EMnQS5FY3P"}],"key":"qTI8RQN4x5"}],"key":"LrZIdIWnRm"},{"type":"listItem","spread":true,"position":{"start":{"line":145,"column":1},"end":{"line":150,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"children":[{"type":"strong","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"children":[{"type":"text","value":"Function ","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"GP9tSUo43t"},{"type":"inlineCode","value":"get_nr_iters","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"fm5LkjkWPT"}],"key":"iClAyC8KUU"},{"type":"text","value":":","position":{"start":{"line":145,"column":1},"end":{"line":145,"column":1}},"key":"kkwtEHFbvF"}],"key":"a7swEc9ZHu"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":146,"column":1},"end":{"line":150,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Returns an ","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"i6zP2QqIHx"},{"type":"inlineCode","value":"integer(kind=I8)","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"MinSAFFLYk"},{"type":"text","value":": The number of iterations.","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"BHKbqkQuAK"}],"key":"Pq4zPOB3qx"}],"key":"xwobA7gb5c"},{"type":"listItem","spread":true,"position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Imports: Re-imports ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"e1LqGA27sB"},{"type":"inlineCode","value":"iso_fortran_env","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"BQFUGQSeBe"},{"type":"text","value":" for ","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"b69plwGXXD"},{"type":"inlineCode","value":"error_unit","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"XXSVUhRoll"},{"type":"text","value":" (standard error stream) and types.","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"SSnd9hydiP"}],"key":"mM56XQc6kt"}],"key":"EY1WXxvR6Z"},{"type":"listItem","spread":true,"position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"integer(kind=I8), parameter :: default_nr_iters = 1000_I8","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"L3gVS0FCwm"},{"type":"text","value":": Constant default value with ","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"yOcdVN3cMT"},{"type":"inlineCode","value":"_I8","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"dPwu96ABsW"},{"type":"text","value":" kind suffix.","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"j9Ygd1PkIM"}],"key":"HVIf1s7U3a"}],"key":"MK5PBtGaDm"},{"type":"listItem","spread":true,"position":{"start":{"line":149,"column":1},"end":{"line":150,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Variables: ","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"HbW81FwqnL"},{"type":"inlineCode","value":"buffer","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"bZrE9ZN9eC"},{"type":"text","value":" (string to hold argument), ","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"poEgoaeiaZ"},{"type":"inlineCode","value":"msg","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"FlRoRJEARw"},{"type":"text","value":" (error message), ","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"f0LrymOWjn"},{"type":"inlineCode","value":"istat","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"BEpmA5fEqU"},{"type":"text","value":" (I/O status).","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"WzIH0yQe7e"}],"key":"RfbSD0oa5Y"}],"key":"FzBfEcmtAs"}],"key":"Bx9as8Jhc1"}],"key":"f37j99GTVp"},{"type":"listItem","spread":true,"position":{"start":{"line":151,"column":1},"end":{"line":157,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"strong","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"children":[{"type":"text","value":"Logic","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"vA2Wi0JeCc"}],"key":"hzs4NjIUO2"},{"type":"text","value":":","position":{"start":{"line":151,"column":1},"end":{"line":151,"column":1}},"key":"ZvpvMYAmmL"}],"key":"XpDpHRqY0H"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":152,"column":1},"end":{"line":157,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":152,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"if (command_argument_count() >= 1) then","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"maVDRcWkx2"},{"type":"text","value":": Checks if at least one command-line argument exists (using intrinsic ","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"y8rYwUsliM"},{"type":"inlineCode","value":"command_argument_count","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"WVPSiHDS2A"},{"type":"text","value":").","position":{"start":{"line":152,"column":1},"end":{"line":152,"column":1}},"key":"dxfw0ddVar"}],"key":"d3m8URmCZt"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":153,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"call get_command_argument(1, buffer)","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"VrwHDeJ7fH"},{"type":"text","value":": Retrieves the first argument into ","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"dgjgOAMgna"},{"type":"inlineCode","value":"buffer","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"ireVHZl7jf"},{"type":"text","value":".","position":{"start":{"line":153,"column":1},"end":{"line":153,"column":1}},"key":"O3cXYENIUb"}],"key":"DlAeJ0hQJ4"}],"key":"j15CMYF1kl"},{"type":"listItem","spread":true,"position":{"start":{"line":154,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"read (buffer, fmt=*, iostat=istat, iomsg=msg) nr_iters","position":{"start":{"line":154,"column":1},"end":{"line":154,"column":1}},"key":"dvRpnetwxl"},{"type":"text","value":": Parses the string as an integer (free-format ","position":{"start":{"line":154,"column":1},"end":{"line":154,"column":1}},"key":"U34QX5vi9Z"},{"type":"inlineCode","value":"*","position":{"start":{"line":154,"column":1},"end":{"line":154,"column":1}},"key":"G3kUrAc6PZ"},{"type":"text","value":").","position":{"start":{"line":154,"column":1},"end":{"line":154,"column":1}},"key":"kHTNEG4lY1"}],"key":"XtNAiOWNuK"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"If ","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"g4eabTtNLj"},{"type":"inlineCode","value":"istat /= 0","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"FW89IY0iPV"},{"type":"text","value":" (error), prints to stderr and stops with exit code 1.","position":{"start":{"line":155,"column":1},"end":{"line":155,"column":1}},"key":"ONaZ1AcgZG"}],"key":"KXwTgntyZC"}],"key":"AEHWAwGeCk"}],"key":"B5q6XeNnmZ"}],"key":"U3JJEnSVvF"}],"key":"b5YwfNDsf1"}],"key":"v4CGaR0sjm"},{"type":"listItem","spread":true,"position":{"start":{"line":156,"column":1},"end":{"line":157,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Else: Uses default 1000.","position":{"start":{"line":156,"column":1},"end":{"line":156,"column":1}},"key":"PSKtVO3rei"}],"key":"vmLuDBeqOi"}],"key":"VcZbCFxyKW"}],"key":"mxd8beL3hk"}],"key":"ilcDVkyEdk"}],"key":"yMQST4XsuT"},{"type":"paragraph","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"children":[{"type":"text","value":"This makes the program flexible: run as ","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"VmbWB97Xb2"},{"type":"inlineCode","value":"./compute_pi_serial 1000000","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"oaGtWMe3tK"},{"type":"text","value":" for 1 million trials.","position":{"start":{"line":158,"column":1},"end":{"line":158,"column":1}},"key":"XMZwQ1xK9F"}],"key":"BFj7GbAXxd"},{"type":"heading","depth":3,"position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"children":[{"type":"text","value":"Module: ","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"DtJn8rMPpA"},{"type":"inlineCode","value":"lcgenerator_mod","position":{"start":{"line":160,"column":1},"end":{"line":160,"column":1}},"key":"R7QHXO83vz"}],"identifier":"module-lcgenerator-mod","label":"Module: lcgenerator_mod","html_id":"module-lcgenerator-mod","implicit":true,"key":"GFiiX7ERyk"},{"type":"paragraph","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"children":[{"type":"text","value":"This module implements a basic linear congruential generator (LCG) for pseudo-random numbers in [0,1).","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"YLs9AcOPDw"}],"key":"Gs7SITj1V7"},{"type":"code","lang":"fortran","value":"module lcgenerator_mod\n  use, intrinsic :: iso_fortran_env, only : DP => REAL64, I8 => INT64\n  implicit none\n  private\n  public :: lcgrandom\n\n  contains\n    real function lcgrandom()\n      integer(kind=I8), parameter :: MULTIPLIER = 1366\n      integer(kind=I8), parameter :: ADDEND = 150889\n      integer(kind=I8), parameter :: PMOD = 714025\n      integer(kind=I8), save :: random_last = 0\n\n      integer(kind=I8) :: random_next = 0\n      random_next = mod((MULTIPLIER * random_last + ADDEND), PMOD)\n      random_last = random_next\n      lcgrandom = (1.0_DP * random_next) / PMOD\n      return\n    end function lcgrandom\nend module lcgenerator_mod","position":{"start":{"line":164,"column":1},"end":{"line":185,"column":1}},"key":"egPviMEA7v"},{"type":"heading","depth":4,"position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"text","value":"Breakdown:","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"ucyxQVMkXi"}],"identifier":"breakdown","label":"Breakdown:","html_id":"breakdown-2","implicit":true,"key":"ZY0N2e4W9j"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":189,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":189,"column":1},"end":{"line":192,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"strong","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"children":[{"type":"text","value":"Module Structure","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"BxxGb4BINE"}],"key":"mVkTNBt7P1"},{"type":"text","value":":","position":{"start":{"line":189,"column":1},"end":{"line":189,"column":1}},"key":"WYQaDtVPDP"}],"key":"hMV3YVbImy"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":190,"column":1},"end":{"line":192,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Imports types from ","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"jD90hSn6uO"},{"type":"inlineCode","value":"iso_fortran_env","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"Ne7Eeh1fRP"},{"type":"text","value":".","position":{"start":{"line":190,"column":1},"end":{"line":190,"column":1}},"key":"UH3cAaZ0UJ"}],"key":"IWkLujIonC"}],"key":"Li82cvQb6l"},{"type":"listItem","spread":true,"position":{"start":{"line":191,"column":1},"end":{"line":192,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"implicit none","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"tfaJcf6990"},{"type":"text","value":", ","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"ZmUno9YNfn"},{"type":"inlineCode","value":"private","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"SSzqS1xa2r"},{"type":"text","value":", ","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"R8JMygS6hT"},{"type":"inlineCode","value":"public :: lcgrandom","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"FwUz3lkUm2"},{"type":"text","value":": Similar to the previous module.","position":{"start":{"line":191,"column":1},"end":{"line":191,"column":1}},"key":"eLfGzF7GTt"}],"key":"v3jKfUCEbX"}],"key":"hwvDJ65MpE"}],"key":"wkVRVescGI"}],"key":"vbnPtLTDMp"},{"type":"listItem","spread":true,"position":{"start":{"line":193,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"children":[{"type":"strong","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"children":[{"type":"text","value":"Function ","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"NZ7zajp0YP"},{"type":"inlineCode","value":"lcgrandom","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"ZG686Y6fvq"}],"key":"QJ4KEmSYgg"},{"type":"text","value":":","position":{"start":{"line":193,"column":1},"end":{"line":193,"column":1}},"key":"Lw9P7sEuuz"}],"key":"TyRk3pu37h"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":194,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Returns a ","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"sBWINXzBLI"},{"type":"inlineCode","value":"real","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"OYTQv3Qko6"},{"type":"text","value":" (implicitly double-precision via context).","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"Gq6J6XeEDP"}],"key":"AEnoU6ncVT"}],"key":"lfDJgRQqVF"},{"type":"listItem","spread":true,"position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Parameters: LCG constants (multiplier a=1366, increment c=150889, modulus m=714025). These are from older literature (e.g., IBM RANDU-like, but custom).","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"i0MxRx0Aop"}],"key":"nJHtaqxkNE"}],"key":"VvMjd4pZkS"},{"type":"listItem","spread":true,"position":{"start":{"line":196,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"integer(kind=I8), save :: random_last = 0","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"nd0flfliiI"},{"type":"text","value":": Static variable (via ","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"Y0HxvR69ZR"},{"type":"inlineCode","value":"save","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"sIp1JN4obd"},{"type":"text","value":") to hold the previous state (seed). Initializes to 0 on first call.","position":{"start":{"line":196,"column":1},"end":{"line":196,"column":1}},"key":"rVuhGhGeVN"}],"key":"fBQw8Oq1hS"}],"key":"FXh6YOZq2K"}],"key":"BFZzwf2xCR"}],"key":"muloubJQog"},{"type":"listItem","spread":true,"position":{"start":{"line":198,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"strong","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"Logic","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"K99FD9j7Px"}],"key":"ohlApjVgBT"},{"type":"text","value":":","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"wN6NnbKbM9"}],"key":"RSwtkils7Z"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":199,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":199,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"random_next = mod((MULTIPLIER * random_last + ADDEND), PMOD)","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"ILN6U9L2jT"},{"type":"text","value":": Core LCG formula: X_{n+1} = (a * X_n + c) mod m.","position":{"start":{"line":199,"column":1},"end":{"line":199,"column":1}},"key":"p0yNtTwVVX"}],"key":"LyAunocshQ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Uses ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"tbggNC6w4b"},{"type":"inlineCode","value":"mod","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"VEO8DDTEyp"},{"type":"text","value":" for modulo operation.","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"l9Ob68DUWJ"}],"key":"VJ5TfPFD5y"}],"key":"TSNU6xHwjO"}],"key":"S3AVfrpW57"}],"key":"jn5JPO1LSA"},{"type":"listItem","spread":true,"position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"random_last = random_next","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"FmGIFsVxKq"},{"type":"text","value":": Updates the state for the next call.","position":{"start":{"line":201,"column":1},"end":{"line":201,"column":1}},"key":"MRsgUsUaFV"}],"key":"H8bkuiEv9W"}],"key":"xLXYjf8EBb"},{"type":"listItem","spread":true,"position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"lcgrandom = (1.0_DP * random_next) / PMOD","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"ue71KfzuHF"},{"type":"text","value":": Normalizes to [0,1) by dividing by m (promoting to real).","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"VtkCPQZ7aS"}],"key":"SimClQMbQC"}],"key":"PySpZtKubq"},{"type":"listItem","spread":true,"position":{"start":{"line":203,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"return","position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"key":"LeYg9Zf7kz"},{"type":"text","value":": Explicit return (optional in Fortran).","position":{"start":{"line":203,"column":1},"end":{"line":203,"column":1}},"key":"NlnX5TjIGS"}],"key":"C9J4saNVN3"}],"key":"vmHDALI3ki"}],"key":"XsmMwzN0sm"}],"key":"LHp4iF2YW8"}],"key":"Czokkrmbaq"},{"type":"paragraph","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"children":[{"type":"text","value":"This LCG is simple and deterministic (same sequence every run due to fixed seed). It’s not cryptographically secure or highly random but sufficient for this simulation. For better randomness, modern codes might use Fortran’s ","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"e2vIxMf1LE"},{"type":"inlineCode","value":"random_number","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"OfgM9rZJ8m"},{"type":"text","value":" intrinsic, but this demonstrates a custom generator.","position":{"start":{"line":205,"column":1},"end":{"line":205,"column":1}},"key":"Sw1fKP4xhB"}],"key":"OG7y7TbNla"},{"type":"heading","depth":3,"position":{"start":{"line":207,"column":1},"end":{"line":207,"column":1}},"children":[{"type":"text","value":"Key Concepts and Notes","position":{"start":{"line":207,"column":1},"end":{"line":207,"column":1}},"key":"LsioGOdOYX"}],"identifier":"key-concepts-and-notes","label":"Key Concepts and Notes","html_id":"key-concepts-and-notes","implicit":true,"key":"q9x5R6hxft"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":209,"column":1},"end":{"line":217,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"children":[{"type":"text","value":"Monte Carlo Method","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"key":"yJwnbKcBcu"}],"key":"iA4YvowQcc"},{"type":"text","value":": Statistical sampling to approximate π. Accuracy improves with more trials (O(1/sqrt(N)) convergence), but it’s probabilistic—results vary per run due to randomness.","position":{"start":{"line":209,"column":1},"end":{"line":209,"column":1}},"key":"Xik3EbYPII"}],"key":"mSql0FDLOS"}],"key":"eTfoPjZ48J"},{"type":"listItem","spread":true,"position":{"start":{"line":210,"column":1},"end":{"line":213,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"Fortran-Specifics","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"eUrxw1deNk"}],"key":"hjz6EaRIWT"},{"type":"text","value":":","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"QX80iGKV2g"}],"key":"wRLwbzWMLd"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":211,"column":1},"end":{"line":213,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Modules promote modularity and encapsulation.","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"key":"k3SzJN4QMl"}],"key":"ClWoIIxR07"}],"key":"XNyy9sB953"},{"type":"listItem","spread":true,"position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Kind parameters ensure portability.","position":{"start":{"line":212,"column":1},"end":{"line":212,"column":1}},"key":"yvkDvozTZO"}],"key":"UQOPLlCyWB"}],"key":"XxhXtu4qkM"},{"type":"listItem","spread":true,"position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"No explicit main; the ","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"nYD3pIkyOE"},{"type":"inlineCode","value":"program","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"bEsCBJlGfK"},{"type":"text","value":" block is the executable.","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"nDYgYG5ESe"}],"key":"Hek25hBgwJ"}],"key":"JHr3v6iQQ5"}],"key":"oEf1vcaL1V"}],"key":"LvKrny17O6"},{"type":"listItem","spread":true,"position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"children":[{"type":"text","value":"Compilation/Running","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"QAl6bhVkz2"}],"key":"TTcMA1hXMw"},{"type":"text","value":": Compile with ","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"GCuu5NiQ7H"},{"type":"inlineCode","value":"gfortran compute_pi_serial.f90","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"RFQZs8i65t"},{"type":"text","value":" (assuming all in one file). Run with optional argument for trials.","position":{"start":{"line":214,"column":1},"end":{"line":214,"column":1}},"key":"UmJiylAYkD"}],"key":"hBjr1aS3oY"}],"key":"Rwh2lITEfV"},{"type":"listItem","spread":true,"position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"children":[{"type":"text","value":"Limitations","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"ja6j5ETKC9"}],"key":"ynKJHCWCOc"},{"type":"text","value":": LCG period is at most m=714025, so for very large ","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"MuLN89G9S3"},{"type":"inlineCode","value":"num_trials","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"GziSFWp5E3"},{"type":"text","value":", it repeats. Not thread-safe (due to shared ","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"jgqriymLmw"},{"type":"inlineCode","value":"save","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"ODiHQePfoN"},{"type":"text","value":" variable).","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"KiaSlP7KYu"}],"key":"bpCNlK5kl0"}],"key":"h2Je9C5WO5"},{"type":"listItem","spread":true,"position":{"start":{"line":216,"column":1},"end":{"line":217,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"Extensions","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"y3Hu1sko66"}],"key":"RjfyrfVYTN"},{"type":"text","value":": Could be parallelized with OpenMP for multi-core speedup.","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"o6KgjPDoUX"}],"key":"A9Oj9RW4yi"}],"key":"fvPpeDUp3g"}],"key":"iTrRyF1zAT"},{"type":"paragraph","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"children":[{"type":"text","value":"This code is educational, demonstrating numerical methods, I/O, and modular design in Fortran.","position":{"start":{"line":218,"column":1},"end":{"line":218,"column":1}},"key":"WKWMl9efLd"}],"key":"z5DRWoNc8x"}],"key":"Dz2kimkeMo"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Code Analysis by ChatGPT 5 Thinking","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VRr69Fe2I1"}],"identifier":"code-analysis-by-chatgpt-5-thinking","label":"Code Analysis by ChatGPT 5 Thinking","html_id":"code-analysis-by-chatgpt-5-thinking","implicit":true,"key":"loIEBty9z0"}],"key":"twmAy0kaci"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"What the code does (high-level)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ssK6YMfGdv"}],"identifier":"what-the-code-does-high-level","label":"What the code does (high-level)","html_id":"what-the-code-does-high-level","implicit":true,"key":"mDnYeWSQlF"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This is a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KANTNMtAcC"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"serial Monte-Carlo estimator for ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"eqa8WgbQrk"},{"type":"inlineMath","value":"\\pi","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>","key":"iUC8KJiguH"}],"key":"JAf6ERCFwK"},{"type":"text","value":". It repeatedly draws uniform random points ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Uk5MF97bKh"},{"type":"inlineMath","value":"(x,y)\\in[0,1)\\times[0,1)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>×</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x,y)\\in[0,1)\\times[0,1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>","key":"eVgMEjos8g"},{"type":"text","value":" and counts how many fall inside the quarter of a unit circle, i.e., where ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"q00ui9pjrF"},{"type":"inlineMath","value":"x^2+y^2\\le 1","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo>≤</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">x^2+y^2\\le 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8974em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>","key":"CuwUtD71Je"},{"type":"text","value":". If ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dPP51iRGv3"},{"type":"inlineMath","value":"N","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"w8ksW8h968"},{"type":"text","value":" points are drawn and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Qj5g6nlb5y"},{"type":"inlineMath","value":"N_{\\text{circ}}","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>N</mi><mtext>circ</mtext></msub></mrow><annotation encoding=\"application/x-tex\">N_{\\text{circ}}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3175em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">circ</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Qu6ESGGJls"},{"type":"text","value":" are inside, the estimator is","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"GKjqSm8tNW"}],"key":"DzccKTEOHN"},{"type":"math","value":"\\widehat{\\pi}=4\\,\\frac{N_{\\text{circ}}}{N}.","position":{"start":{"line":5,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi>π</mi><mo stretchy=\"true\">^</mo></mover><mo>=</mo><mn>4</mn><mtext> </mtext><mfrac><msub><mi>N</mi><mtext>circ</mtext></msub><mi>N</mi></mfrac><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\widehat{\\pi}=4\\,\\frac{N_{\\text{circ}}}{N}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6706em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6706em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span><span class=\"svg-align\" style=\"top:-3.4306em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span style=\"height:0.24em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0463em;vertical-align:-0.686em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3175em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">circ</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"1","key":"zG9OS5JBfe"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Two small modules support the program:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"BiFT4g5qgp"}],"key":"sRmgKUJ7Ag"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"lcgenerator_mod.f90","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"uGlc2QujSb"},{"type":"text","value":": a tiny ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"hwgl5S3VVo"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"linear congruential generator (LCG)","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"HqU056ZNao"}],"key":"rOrQqiRpAP"},{"type":"text","value":" returning a uniform variate in ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ZxTvwLcH6T"},{"type":"inlineMath","value":"[0,1)","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">[0,1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>","key":"svrimKlEjr"},{"type":"text","value":".","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"WwthNwkLmv"}],"key":"zQuErL6qN2"}],"key":"bxuV43H6JO"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"get_nr_iters_mod.f90","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"ihO5FVt365"},{"type":"text","value":": parses the ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"eSMyDteFBX"},{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"first command-line argument","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"pd0lu7MjZt"}],"key":"VKMDXZKHJd"},{"type":"text","value":" as the number of trials (with a default if omitted).","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"P9lSjQPPhD"}],"key":"DanGwPBp1g"}],"key":"DCaz6RG0JJ"}],"key":"qGcTqpkYlt"},{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Below I walk through each file in detail, explain the Fortran choices (kinds, intrinsics, I/O), and then point out ","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"zDsczaVcxw"},{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"two important correctness/quality issues","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"b1VvpdHh9L"}],"key":"MuQ2fB8eoY"},{"type":"text","value":" and offer drop-in fixes.","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"wRWvJgLNyx"}],"key":"v66YZFdSOM"},{"type":"thematicBreak","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"WmThaYEEj7"},{"type":"heading","depth":3,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"File-by-file explanation","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"xCuaOCOZXX"}],"identifier":"file-by-file-explanation","label":"File-by-file explanation","html_id":"file-by-file-explanation","implicit":true,"key":"xmX7qxqMdN"},{"type":"heading","depth":4,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"1) ","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"rl2mJygSmL"},{"type":"inlineCode","value":"compute_pi_serial.f90","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"xNlxUwsfsO"},{"type":"text","value":" — main program","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"Q8NxCdsGCm"}],"identifier":"id-1-compute-pi-serial-f90-main-program","label":"1) compute_pi_serial.f90 — main program","html_id":"id-1-compute-pi-serial-f90-main-program","implicit":true,"key":"eD9jdMpyuh"},{"type":"heading","depth":5,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Modules and kinds","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"bl9WCXHf4R"}],"identifier":"modules-and-kinds","label":"Modules and kinds","html_id":"modules-and-kinds","implicit":true,"key":"BAQvi3pJFQ"},{"type":"code","lang":"fortran","value":"program compute_pi_serial\n  use, intrinsic :: iso_fortran_env, only : DP => REAL64, I8 => INT64\n  use lcgenerator_mod,  only : lcgrandom\n  use get_nr_iters_mod, only : get_nr_iters","position":{"start":{"line":24,"column":1},"end":{"line":29,"column":1}},"key":"DhEg6D06Kf"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":31,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"inlineCode","value":"iso_fortran_env","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"KMpNYvXRnx"},{"type":"text","value":" provides ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"pWe3i9EyHP"},{"type":"strong","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"portably sized kinds","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"DAbSLbV1oC"}],"key":"rMC1MxClSg"},{"type":"text","value":". Here:","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"WFpodWnIjf"}],"key":"GUwTtEthCV"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":33,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"DP","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"xyLDlG3F5h"},{"type":"text","value":" aliases ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"Sf7ilML0VV"},{"type":"inlineCode","value":"REAL64","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"eAxilSSc5G"},{"type":"text","value":" (IEEE double precision),","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"WSjJTaSLQ1"}],"key":"ADGqmJgE5A"}],"key":"oUZW9qmqeF"},{"type":"listItem","spread":true,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"I8","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"xTJhQFkf8Q"},{"type":"text","value":" aliases ","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"fOz7kjmmC9"},{"type":"inlineCode","value":"INT64","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"XoFxNhk999"},{"type":"text","value":" (signed 64-bit integer).","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"FY6GHMX2o0"}],"key":"ibIaUvGGxq"}],"key":"VrEm3Mh8pQ"}],"key":"eBYvqHeQnT"}],"key":"xGCZ1W89LX"},{"type":"listItem","spread":true,"position":{"start":{"line":35,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"Importing just the names you use (","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"bLlir16pHl"},{"type":"inlineCode","value":"only：…","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"YpXZp7X0Z7"},{"type":"text","value":") keeps the namespace clean and the intent explicit.","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"A2OwnSGknM"}],"key":"nUcQZ4wixT"}],"key":"OYVJHkpgxs"}],"key":"IugYhaNttr"},{"type":"heading","depth":5,"position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Declarations and initialization","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"JhUITczHhr"}],"identifier":"declarations-and-initialization","label":"Declarations and initialization","html_id":"declarations-and-initialization","implicit":true,"key":"io24Jl0KRS"},{"type":"code","lang":"fortran","value":"  integer(kind=I8) :: num_trials, i = 0, Ncirc = 0\n  real(kind=DP) :: pi_computed = 0.0, pi_actual\n  real(kind=DP) :: x = 0.0, y = 0.0, r = 1.0\n  real(kind=DP) :: r_squared = 0.0\n\n  pi_actual = 2.0_DP * acos(0.0_DP)\n  r_squared = r*r","position":{"start":{"line":39,"column":1},"end":{"line":47,"column":1}},"key":"mxIGWdO1zj"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":49,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"num_trials","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"P09J3kxk8Y"},{"type":"text","value":" is the total number of Monte-Carlo samples (draws).","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"RoFTBWldOh"}],"key":"gEFflmh7oV"}],"key":"Wh2dc8NonD"},{"type":"listItem","spread":true,"position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"Ncirc","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"O2iS6c5h3m"},{"type":"text","value":" counts hits inside the quarter circle.","position":{"start":{"line":50,"column":1},"end":{"line":50,"column":1}},"key":"UmMyYpdyyY"}],"key":"kjX8WUDsph"}],"key":"GxvVCWaj9i"},{"type":"listItem","spread":true,"position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"pi_actual","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"ZcKwsbQKBP"},{"type":"text","value":" is computed as ","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"UxUM2ko4e8"},{"type":"inlineMath","value":"2\\arccos(0)=\\pi","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>2</mn><mi>arccos</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">2\\arccos(0)=\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">arccos</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>","key":"frinkjwlyW"},{"type":"text","value":" in double precision; this avoids hard-coding a constant and is ","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"uJiHMhbbhQ"},{"type":"strong","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"portable","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"pzRLr8uTmM"}],"key":"MphagKMcFJ"},{"type":"text","value":" across compilers.","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"u5QWqf1RWH"}],"key":"u3YeACXx6c"}],"key":"qzUkkYRBF5"},{"type":"listItem","spread":true,"position":{"start":{"line":52,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"r=1","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"IjSp7mCUnA"},{"type":"text","value":" and ","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"F6C2r8DyvW"},{"type":"inlineCode","value":"r_squared=1","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"IXBf55GZk5"},{"type":"text","value":" define the unit circle.","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"i2ifDZm6iT"}],"key":"a4cSOMzkIh"}],"key":"Om8BrgG7GY"}],"key":"J9lrkeAYiG"},{"type":"blockquote","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"strong","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Minor omission to fix:","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"ViDKurdcGI"}],"key":"QemoDc5ndr"},{"type":"text","value":" the program should ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"RbtmHKFlr9"},{"type":"emphasis","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"set","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"KTDnHlAGdi"}],"key":"HCARLEyDs2"},{"type":"text","value":" ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"dpUsQ2BSB5"},{"type":"inlineCode","value":"num_trials","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"Eawn32zQJ2"},{"type":"text","value":" by calling ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"PV1q8lp9WJ"},{"type":"inlineCode","value":"get_nr_iters()","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"T3FAFvXMeu"},{"type":"text","value":" before the loop (see “Corrections & improvements”).","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"qbuUWFKibk"}],"key":"yuVSL1nYB3"}],"key":"uksqdLjE79"},{"type":"heading","depth":5,"position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"text","value":"Core Monte-Carlo loop","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"wuBHEpNKiw"}],"identifier":"core-monte-carlo-loop","label":"Core Monte-Carlo loop","html_id":"core-monte-carlo-loop","implicit":true,"key":"ScFkq9EXtS"},{"type":"code","lang":"fortran","value":"  do i = 1, num_trials\n    x = lcgrandom()\n    y = lcgrandom()\n    if ((x*x + y*y) <= r_squared) then\n        Ncirc = Ncirc + 1\n    end if\n  end do","position":{"start":{"line":58,"column":1},"end":{"line":66,"column":1}},"key":"wwufkLwXAj"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":68,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Each iteration draws two independent uniform(0,1) variates.","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"CGrm0gaVo5"}],"key":"n6RrjGDrRr"}],"key":"j3XNzSAK7U"},{"type":"listItem","spread":true,"position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The predicate ","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"RKdUroWeD5"},{"type":"inlineCode","value":"x*x + y*y <= 1.0","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"YUa2QYyLyO"},{"type":"text","value":" tests membership in the quarter circle.","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"HTOxRnm54r"}],"key":"CUy2HUwu97"}],"key":"Izs3QVVfWD"},{"type":"listItem","spread":true,"position":{"start":{"line":70,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Work and memory are ","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"do1ixznIGV"},{"type":"strong","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"inlineMath","value":"O(N)","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mi>N</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mclose\">)</span></span></span></span>","key":"qvkbtlXCUP"}],"key":"KVnWzgkcUS"},{"type":"text","value":" and ","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"vHUGEkZPeM"},{"type":"strong","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"inlineMath","value":"O(1)","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>","key":"otFbt4syGA"}],"key":"Jok020p6k4"},{"type":"text","value":" respectively.","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"i8oTrzAoBK"}],"key":"V5IQYruScw"}],"key":"YbEcJNJGG1"}],"key":"ZLpPAlsvk2"},{"type":"heading","depth":5,"position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"text","value":"Estimator and output","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"my5iOafI2a"}],"identifier":"estimator-and-output","label":"Estimator and output","html_id":"estimator-and-output","implicit":true,"key":"eMVDaJctTX"},{"type":"code","lang":"fortran","value":"  pi_computed = 4.0*((1.0*Ncirc)/(1.0*num_trials))\n\n  print '(A, I10, A, F25.15)', \"After \", num_trials, \" loops, Pi = \", pi_computed\n  print '(A, F25.15)', \"Actual value of Pi = \", pi_actual\n  print '(A, F25.15)', \"Absolute difference = \", abs(pi_computed - pi_actual)","position":{"start":{"line":74,"column":1},"end":{"line":80,"column":1}},"key":"UGCmA7W5lf"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":82,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"The estimator is ","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"PdEMTQ8pKx"},{"type":"inlineMath","value":"4\\cdot N_{\\text{circ}}/N","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>4</mn><mo>⋅</mo><msub><mi>N</mi><mtext>circ</mtext></msub><mi mathvariant=\"normal\">/</mi><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">4\\cdot N_{\\text{circ}}/N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3175em;\"><span style=\"top:-2.55em;margin-left:-0.109em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord text mtight\"><span class=\"mord mtight\">circ</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">/</span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"MEliQ80mka"},{"type":"text","value":".","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"JWEh1mv22n"}],"key":"NI1EaTKrhK"}],"key":"gVlWTR5JTR"},{"type":"listItem","spread":true,"position":{"start":{"line":83,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"children":[{"type":"text","value":"Formatting:","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"SJU7SelXOT"}],"key":"n8I2y383Gu"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":85,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"'I10'","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"SBku5bJTxP"},{"type":"text","value":" prints a right-justified integer (width 10).","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"uOmMveGEWe"}],"key":"USPQ6ZArG3"}],"key":"PVGV1m1lQ2"},{"type":"listItem","spread":true,"position":{"start":{"line":86,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"'F25.15'","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"zkdp6JDoez"},{"type":"text","value":" prints a real number with total width 25 and 15 digits after the decimal point.","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"f1yaSx3gZs"}],"key":"UK4AxeXttv"}],"key":"z5WqjdrcDI"}],"key":"kpIQgwoRmm"}],"key":"wktrlUn1ND"}],"key":"KLisHzHTLI"},{"type":"blockquote","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"strong","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"Type-precision note:","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"FZmjUWY5oZ"}],"key":"HkMDb1BOcl"},{"type":"text","value":" literals ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"HxqxU7rHhZ"},{"type":"inlineCode","value":"4.0","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"m76yTaI92p"},{"type":"text","value":" and ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"kbbN87uPdi"},{"type":"inlineCode","value":"1.0","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"VF9jGq9IeZ"},{"type":"text","value":" are ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"Nr9n83mlMk"},{"type":"strong","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"default real","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"gLDyudAXIQ"}],"key":"a1jrbOKbKe"},{"type":"text","value":" (usually 32-bit). The arithmetic will still be upcast when stored into a ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"oBXco0MqGH"},{"type":"inlineCode","value":"REAL64","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"ikEcTG9KEM"},{"type":"text","value":" variable, but you lose precision in the intermediate steps. Prefer the ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"p9RmK0zYEp"},{"type":"inlineCode","value":"_DP","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"AxZkXQcwKa"},{"type":"text","value":" suffix and/or explicit ","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"VZ4WM3qrZW"},{"type":"inlineCode","value":"real(...,kind=DP)","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"IxLqYAoliY"},{"type":"text","value":" casts (see fixes below).","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"I140ftXql9"}],"key":"OeKcRmgItl"}],"key":"foVFcH7nSl"},{"type":"thematicBreak","position":{"start":{"line":90,"column":1},"end":{"line":90,"column":1}},"key":"xV2XxSPE4B"},{"type":"heading","depth":4,"position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"text","value":"2) ","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"T48w7NJPfs"},{"type":"inlineCode","value":"lcgenerator_mod.f90","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"FLM5rAmnge"},{"type":"text","value":" — Linear congruential generator","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"S7QCPwEWdk"}],"identifier":"id-2-lcgenerator-mod-f90-linear-congruential-generator","label":"2) lcgenerator_mod.f90 — Linear congruential generator","html_id":"id-2-lcgenerator-mod-f90-linear-congruential-generator","implicit":true,"key":"dow1dVDuTq"},{"type":"code","lang":"fortran","value":"module lcgenerator_mod\n  use, intrinsic :: iso_fortran_env, only : DP => REAL64, I8 => INT64\n  implicit none\n  private\n  public :: lcgrandom","position":{"start":{"line":94,"column":1},"end":{"line":100,"column":1}},"key":"gi4RPHjcvq"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":102,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":102,"column":1},"end":{"line":103,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"private","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"yo7sBx9E5V"},{"type":"text","value":" by default shields internal names; only the function ","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"M6P5FlPFVM"},{"type":"inlineCode","value":"lcgrandom","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"WZS96dZJXp"},{"type":"text","value":" is exported.","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"z1uPI6JOw3"}],"key":"wWOzQlT4QX"}],"key":"lND8HxC0Pn"}],"key":"SvLtADfcyf"},{"type":"code","lang":"fortran","value":"contains\n  real function lcgrandom()\n    integer(kind=I8), parameter :: MULTIPLIER = 1366\n    integer(kind=I8), parameter :: ADDEND = 150889\n    integer(kind=I8), parameter :: PMOD = 714025\n    integer(kind=I8), save :: random_last = 0","position":{"start":{"line":104,"column":1},"end":{"line":111,"column":1}},"key":"q40YO2OVeM"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":113,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":113,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"text","value":"This encodes the classic LCG recurrence","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"dlqeTcVz77"}],"key":"IjnCfGNUaY"},{"type":"math","value":"X_{n+1} = (a X_n + c) \\bmod m","position":{"start":{"line":115,"column":1},"end":{"line":117,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mi>X</mi><mrow><mi>n</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>=</mo><mo stretchy=\"false\">(</mo><mi>a</mi><msub><mi>X</mi><mi>n</mi></msub><mo>+</mo><mi>c</mi><mo stretchy=\"false\">)</mo><mtext> </mtext><mo lspace=\"0.22em\" rspace=\"0.22em\"><mrow><mi mathvariant=\"normal\">m</mi><mi mathvariant=\"normal\">o</mi><mi mathvariant=\"normal\">d</mi></mrow></mo><mtext> </mtext><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">X_{n+1} = (a X_n + c) \\bmod m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8917em;vertical-align:-0.2083em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.0556em;\"></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\"><span class=\"mord\"><span class=\"mord mathrm\">mod</span></span></span><span class=\"mspace\" style=\"margin-right:0.0556em;\"></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span></span>","enumerator":"2","key":"CkFyxSOHJL"},{"type":"paragraph","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"with ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"DfUYyMtFWf"},{"type":"inlineMath","value":"a=1366","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi><mo>=</mo><mn>1366</mn></mrow><annotation encoding=\"application/x-tex\">a=1366</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1366</span></span></span></span>","key":"gQzgd4lRKB"},{"type":"text","value":", ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"V354UiWHYn"},{"type":"inlineMath","value":"c=150{,}889","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mo>=</mo><mn>150</mn><mo separator=\"true\" lspace=\"0em\" rspace=\"0em\">,</mo><mn>889</mn></mrow><annotation encoding=\"application/x-tex\">c=150{,}889</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">150</span><span class=\"mord\"><span class=\"mpunct\">,</span></span><span class=\"mord\">889</span></span></span></span>","key":"GK9axUYRq5"},{"type":"text","value":", ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"x9y8DjugHv"},{"type":"inlineMath","value":"m=714{,}025","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mn>714</mn><mo separator=\"true\" lspace=\"0em\" rspace=\"0em\">,</mo><mn>025</mn></mrow><annotation encoding=\"application/x-tex\">m=714{,}025</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">714</span><span class=\"mord\"><span class=\"mpunct\">,</span></span><span class=\"mord\">025</span></span></span></span>","key":"rCDDWepaRd"},{"type":"text","value":".","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"ZSqekGHXAD"}],"key":"usyyRoY9KK"}],"key":"ZTr4TupaWd"},{"type":"listItem","spread":true,"position":{"start":{"line":120,"column":1},"end":{"line":121,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"inlineCode","value":"save","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"ZzW7aH2MvC"},{"type":"text","value":" makes ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"XP9yBOrutp"},{"type":"inlineCode","value":"random_last","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"vI1xqLXidU"},{"type":"text","value":" ","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"KacZAItlhg"},{"type":"strong","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"children":[{"type":"text","value":"static state","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"p3Pho0LCco"}],"key":"XONapq04Cp"},{"type":"text","value":" across calls.","position":{"start":{"line":120,"column":1},"end":{"line":120,"column":1}},"key":"bJ2AyHh8ID"}],"key":"CV1wMQ73Ln"}],"key":"Hzww4sBs20"}],"key":"fA2PZBR8mz"},{"type":"code","lang":"fortran","value":"    integer(kind=I8) :: random_next = 0\n    random_next = mod((MULTIPLIER * random_last + ADDEND), PMOD)\n    random_last = random_next\n    lcgrandom = (1.0_DP * random_next) / PMOD\n    return\n  end function lcgrandom\nend module lcgenerator_mod","position":{"start":{"line":122,"column":1},"end":{"line":130,"column":1}},"key":"rU1nC93Dfu"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":132,"column":1},"end":{"line":134,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The scaled output ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"mrFcjexwAd"},{"type":"inlineMath","value":"\\in[0,1)","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∈</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\\in[0,1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5782em;vertical-align:-0.0391em;\"></span><span class=\"mrel\">∈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span>","key":"OOGFcMyEaU"},{"type":"text","value":" is computed as ","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"XkxHWdHS2s"},{"type":"inlineCode","value":"random_next / PMOD","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"IRMBwa4BUd"},{"type":"text","value":".","position":{"start":{"line":132,"column":1},"end":{"line":132,"column":1}},"key":"gMDyown7za"}],"key":"LWOi0NVY6y"}],"key":"lc4wkxlSml"},{"type":"listItem","spread":true,"position":{"start":{"line":133,"column":1},"end":{"line":134,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Using ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"M9kixRhnYS"},{"type":"inlineCode","value":"1.0_DP * random_next","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"vmOlc2wYeP"},{"type":"text","value":" forces the numerator to ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"G8zY7WLNp2"},{"type":"inlineCode","value":"REAL64","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"z0IFFCIMi2"},{"type":"text","value":". However, ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"bjRiH0aJ2m"},{"type":"strong","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"the function itself is declared as default ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"tG7UHoolfy"},{"type":"inlineCode","value":"real","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"b1VQgXbTzv"}],"key":"hh8nXgZPWY"},{"type":"text","value":", so the result is immediately ","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"SCrkem20td"},{"type":"strong","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"children":[{"type":"text","value":"down-cast","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"VaP0McyEGJ"}],"key":"jZePnhOGbp"},{"type":"text","value":" to single precision upon return. See the fix below.","position":{"start":{"line":133,"column":1},"end":{"line":133,"column":1}},"key":"HmmcRvHcHk"}],"key":"xmZIhOqco4"}],"key":"vu16PM8Vxx"}],"key":"ESW30I3Bv7"},{"type":"paragraph","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"strong","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"Quality and period.","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"eIDU0TAixJ"}],"key":"VlfFCsfMJ9"},{"type":"text","value":" With ","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"tTFFabHyOf"},{"type":"inlineMath","value":"m=714{,}025","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mn>714</mn><mo separator=\"true\" lspace=\"0em\" rspace=\"0em\">,</mo><mn>025</mn></mrow><annotation encoding=\"application/x-tex\">m=714{,}025</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">714</span><span class=\"mord\"><span class=\"mpunct\">,</span></span><span class=\"mord\">025</span></span></span></span>","key":"A2AlJaQmNj"},{"type":"text","value":" the ","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"EGtyyuAu7n"},{"type":"strong","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"children":[{"type":"text","value":"maximum period is ","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"ghKQWiYzih"},{"type":"inlineMath","value":"m","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"aODQRvXAhB"}],"key":"j3BRMFwvnA"},{"type":"text","value":"; after ~7×10^5 calls the sequence repeats. For large Monte-Carlo runs this is weak. Also, these parameters are not among the better-studied modern LCGs. This is fine pedagogically, but I would not use it for serious statistical work.","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"gPAehAoYI5"}],"key":"gafrmRfFL8"},{"type":"paragraph","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"strong","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"Reproducibility & seeding.","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"RD1DCdmjic"}],"key":"HLH6Kr8X9F"},{"type":"text","value":" The generator ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"xVkKlHKRQ6"},{"type":"strong","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"always starts at 0","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"hzjCb2GUmI"}],"key":"LlFJPTuxdo"},{"type":"text","value":", hence it is fully deterministic and reproducible across runs and compilers. You might want to add a seeding interface if you want variability.","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"IM1Zdcfle1"}],"key":"Wpkg9VS0lP"},{"type":"paragraph","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"strong","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"text","value":"Thread safety.","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"QkfnLhJmWm"}],"key":"Z36ndUUzhR"},{"type":"text","value":" The ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"VCTTnmLij2"},{"type":"inlineCode","value":"save","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"mwLafuFfF4"},{"type":"text","value":"d global state means ","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"xtJJ5K6oJm"},{"type":"strong","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"children":[{"type":"text","value":"not thread-safe","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"uXwPR4a17t"}],"key":"HBEYoMf59V"},{"type":"text","value":". It’s fine here (the program is serial).","position":{"start":{"line":139,"column":1},"end":{"line":139,"column":1}},"key":"Qx5IvY0BSb"}],"key":"eLljGOnln0"},{"type":"thematicBreak","position":{"start":{"line":141,"column":1},"end":{"line":141,"column":1}},"key":"rdyZsx1Ukz"},{"type":"heading","depth":4,"position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"3) ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"pGdR6nqeJw"},{"type":"inlineCode","value":"get_nr_iters_mod.f90","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"ME3D3iZjlh"},{"type":"text","value":" — parse number of trials","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"sxcEZQu144"}],"identifier":"id-3-get-nr-iters-mod-f90-parse-number-of-trials","label":"3) get_nr_iters_mod.f90 — parse number of trials","html_id":"id-3-get-nr-iters-mod-f90-parse-number-of-trials","implicit":true,"key":"yCUMCKsNFO"},{"type":"code","lang":"fortran","value":"module get_nr_iters_mod\n  implicit none\n  private\n  public :: get_nr_iters\ncontains\n\n  function get_nr_iters() result(nr_iters)\n    use, intrinsic :: iso_fortran_env, only : error_unit\n    use, intrinsic :: iso_fortran_env, only : DP => REAL64, I8 => INT64\n    implicit none\n    integer(kind=I8) :: nr_iters\n    integer(kind=I8), parameter :: default_nr_iters = 1000_I8\n    character(len=1024) :: buffer, msg\n    integer :: istat","position":{"start":{"line":145,"column":1},"end":{"line":160,"column":1}},"key":"pU2nfpoy9d"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":162,"column":1},"end":{"line":164,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The interface is simple: ","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"ZCqeRJrivH"},{"type":"strong","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"children":[{"type":"text","value":"no arguments","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"F1JwbFabOK"}],"key":"h4RPqBvE0K"},{"type":"text","value":"; returns an ","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"q4z8lAU8Ez"},{"type":"inlineCode","value":"INT64","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"F9XPcCJW9V"},{"type":"text","value":" count.","position":{"start":{"line":162,"column":1},"end":{"line":162,"column":1}},"key":"i3KlMywKxP"}],"key":"weUqpsfbQI"}],"key":"EDCkEfEj2W"},{"type":"listItem","spread":true,"position":{"start":{"line":163,"column":1},"end":{"line":164,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A default of ","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"nFVyaO1Yse"},{"type":"strong","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"children":[{"type":"text","value":"1000","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"HuTfDHOy3c"}],"key":"jMZOesfWBo"},{"type":"text","value":" iterations is provided.","position":{"start":{"line":163,"column":1},"end":{"line":163,"column":1}},"key":"ULMUt7wxJw"}],"key":"PlcSRBvYZ1"}],"key":"VP3yt8TQ6D"}],"key":"o36spo01yk"},{"type":"code","lang":"fortran","value":"    if (command_argument_count() >= 1) then\n        call get_command_argument(1, buffer)\n        read (buffer, fmt=*, iostat=istat, iomsg=msg) nr_iters\n        if (istat /= 0) then\n            write (unit=error_unit, fmt='(2A)') 'error: ', msg\n            stop 1\n        end if\n    else\n        nr_iters = default_nr_iters\n    end if\n  end function get_nr_iters\nend module get_nr_iters_mod","position":{"start":{"line":165,"column":1},"end":{"line":178,"column":1}},"key":"etAmYWakwZ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":180,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Uses ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"HZsFQVbUHC"},{"type":"strong","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"children":[{"type":"text","value":"deferred format read","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"TgzbBhouaZ"}],"key":"gvN9awd2bg"},{"type":"text","value":" (","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"lPQsP6EHrP"},{"type":"inlineCode","value":"fmt=*","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"w4i79P5BHx"},{"type":"text","value":") to parse the first argument into ","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"gzAaLQQIkk"},{"type":"inlineCode","value":"nr_iters","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"HslHwlMrvB"},{"type":"text","value":".","position":{"start":{"line":180,"column":1},"end":{"line":180,"column":1}},"key":"OyzGEYrQTj"}],"key":"JdU3NRcC2Q"}],"key":"Ob3EIFfiJh"},{"type":"listItem","spread":true,"position":{"start":{"line":181,"column":1},"end":{"line":182,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"On parse failure, it writes a helpful message to the ","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"vEfkFWXePk"},{"type":"strong","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"standard error unit","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"S6aPV4Cboa"}],"key":"vvh5jV14JD"},{"type":"text","value":" and exits with non-zero status (","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"vFNNsh9PuJ"},{"type":"inlineCode","value":"stop 1","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"Nx08EzqVI7"},{"type":"text","value":").","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"Tu4DpjT38h"}],"key":"cSq7APgROK"}],"key":"VXkw5iEkL1"}],"key":"IK2ELpS2DI"},{"type":"thematicBreak","position":{"start":{"line":183,"column":1},"end":{"line":183,"column":1}},"key":"FGncygTGcu"},{"type":"heading","depth":3,"position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"children":[{"type":"text","value":"Statistical properties of the estimator (why it works)","position":{"start":{"line":185,"column":1},"end":{"line":185,"column":1}},"key":"YRjYHMmCIO"}],"identifier":"statistical-properties-of-the-estimator-why-it-works","label":"Statistical properties of the estimator (why it works)","html_id":"statistical-properties-of-the-estimator-why-it-works","implicit":true,"key":"oiLMI7mqqy"},{"type":"paragraph","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"children":[{"type":"text","value":"Let ","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"FWymSjPEFW"},{"type":"inlineMath","value":"Z_i=\\mathbf{1}\\{X_i^2+Y_i^2\\le 1\\}","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>Z</mi><mi>i</mi></msub><mo>=</mo><mn mathvariant=\"bold\">1</mn><mo stretchy=\"false\">{</mo><msubsup><mi>X</mi><mi>i</mi><mn>2</mn></msubsup><mo>+</mo><msubsup><mi>Y</mi><mi>i</mi><mn>2</mn></msubsup><mo>≤</mo><mn>1</mn><mo stretchy=\"false\">}</mo></mrow><annotation encoding=\"application/x-tex\">Z_i=\\mathbf{1}\\{X_i^2+Y_i^2\\le 1\\}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0715em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0728em;vertical-align:-0.2587em;\"></span><span class=\"mord mathbf\">1</span><span class=\"mopen\">{</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.4413em;margin-left:-0.0785em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2587em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0728em;vertical-align:-0.2587em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-2.4413em;margin-left:-0.2222em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2587em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">}</span></span></span></span>","key":"VVKe3MmcMm"},{"type":"text","value":" be i.i.d. Bernoulli with ","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"lBlGtwDmE4"},{"type":"inlineMath","value":"p=\\Pr(Z=1)=\\text{Area}( \\{x^2+y^2\\le 1\\}\\cap[0,1]^2)=\\pi/4","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo>=</mo><mi>Pr</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mi>Z</mi><mo>=</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mtext>Area</mtext><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">{</mo><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><msup><mi>y</mi><mn>2</mn></msup><mo>≤</mo><mn>1</mn><mo stretchy=\"false\">}</mo><mo>∩</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><msup><mo stretchy=\"false\">]</mo><mn>2</mn></msup><mo stretchy=\"false\">)</mo><mo>=</mo><mi>π</mi><mi mathvariant=\"normal\">/</mi><mn>4</mn></mrow><annotation encoding=\"application/x-tex\">p=\\Pr(Z=1)=\\text{Area}( \\{x^2+y^2\\le 1\\}\\cap[0,1]^2)=\\pi/4</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mop\">Pr</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord text\"><span class=\"mord\">Area</span></span><span class=\"mopen\">({</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0085em;vertical-align:-0.1944em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≤</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">}</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∩</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\"><span class=\"mclose\">]</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mord\">/4</span></span></span></span>","key":"OjKZjbsoWt"},{"type":"text","value":". Then","position":{"start":{"line":187,"column":1},"end":{"line":187,"column":1}},"key":"LYR4Y3mpEj"}],"key":"LzB1r6YYYo"},{"type":"math","value":"\\widehat{\\pi}=4\\,\\bar Z,\\quad\n\\mathbb{E}[\\widehat{\\pi}]=\\pi,\\quad\n\\operatorname{Var}(\\widehat{\\pi})=\\frac{16}{N}p(1-p)\\approx\\frac{2.6968}{N}.","position":{"start":{"line":189,"column":1},"end":{"line":193,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mover accent=\"true\"><mi>π</mi><mo stretchy=\"true\">^</mo></mover><mo>=</mo><mn>4</mn><mtext> </mtext><mover accent=\"true\"><mi>Z</mi><mo>ˉ</mo></mover><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mi mathvariant=\"double-struck\">E</mi><mo stretchy=\"false\">[</mo><mover accent=\"true\"><mi>π</mi><mo stretchy=\"true\">^</mo></mover><mo stretchy=\"false\">]</mo><mo>=</mo><mi>π</mi><mo separator=\"true\">,</mo><mspace width=\"1em\"/><mi mathvariant=\"normal\">Var</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mover accent=\"true\"><mi>π</mi><mo stretchy=\"true\">^</mo></mover><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mn>16</mn><mi>N</mi></mfrac><mi>p</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mi>p</mi><mo stretchy=\"false\">)</mo><mo>≈</mo><mfrac><mn>2.6968</mn><mi>N</mi></mfrac><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">\\widehat{\\pi}=4\\,\\bar Z,\\quad\n\\mathbb{E}[\\widehat{\\pi}]=\\pi,\\quad\n\\operatorname{Var}(\\widehat{\\pi})=\\frac{16}{N}p(1-p)\\approx\\frac{2.6968}{N}.</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6706em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6706em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span><span class=\"svg-align\" style=\"top:-3.4306em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span style=\"height:0.24em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0701em;vertical-align:-0.25em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8201em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">Z</span></span><span style=\"top:-3.2523em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1667em;\"><span class=\"mord\">ˉ</span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbb\">E</span><span class=\"mopen\">[</span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6706em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span><span class=\"svg-align\" style=\"top:-3.4306em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span style=\"height:0.24em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\"><span class=\"mord mathrm\">Var</span></span><span class=\"mopen\">(</span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6706em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span><span class=\"svg-align\" style=\"top:-3.4306em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span style=\"height:0.24em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='100%' height='0.24em' viewBox='0 0 1062 239' preserveAspectRatio='none'><path d='M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22\nc-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z'/></svg></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">16</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord mathnormal\">p</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0074em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2.6968</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mord\">.</span></span></span></span></span>","enumerator":"3","key":"wWFyYBDqsz"},{"type":"paragraph","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"children":[{"type":"text","value":"So the ","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"Uo044aacjT"},{"type":"strong","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"children":[{"type":"text","value":"standard deviation","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"Spkx8jK20X"}],"key":"Sbz95BKtk6"},{"type":"text","value":" is ","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"eJEsCRALVq"},{"type":"inlineMath","value":"\\approx 1.642/\\sqrt{N}","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>≈</mo><mn>1.642</mn><mi mathvariant=\"normal\">/</mi><msqrt><mi>N</mi></msqrt></mrow><annotation encoding=\"application/x-tex\">\\approx 1.642/\\sqrt{N}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4831em;\"></span><span class=\"mrel\">≈</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1767em;vertical-align:-0.25em;\"></span><span class=\"mord\">1.642/</span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9267em;\"><span class=\"svg-align\" style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\" style=\"padding-left:0.833em;\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-2.8867em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"hide-tail\" style=\"min-width:0.853em;height:1.08em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='400em' height='1.08em' viewBox='0 0 400000 1080' preserveAspectRatio='xMinYMin slice'><path d='M95,702\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\nc69,-144,104.5,-217.7,106.5,-221\nl0 -0\nc5.3,-9.3,12,-14,20,-14\nH400000v40H845.2724\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\nM834 80h400000v40h-400000z'/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1133em;\"><span></span></span></span></span></span></span></span></span>","key":"hw6PCxgTyE"},{"type":"text","value":". As rules of thumb:","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"eXigerYqP6"}],"key":"Gt19ibVkcU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":197,"column":1},"end":{"line":199,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"N=10^3","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mn>3</mn></msup></mrow><annotation encoding=\"application/x-tex\">N=10^3</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span>","key":"YkZr0wNteA"},{"type":"text","value":" ⇒ typical absolute error ","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"key":"skR3E6iQwf"},{"type":"inlineMath","value":"\\sim 5.2\\times 10^{-2}","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∼</mo><mn>5.2</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\sim 5.2\\times 10^{-2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">5.2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span>","key":"kpXzZ1IbiZ"},{"type":"text","value":".","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"key":"j32SpPtx2F"}],"key":"N4Fhy4XKpT"}],"key":"p763n3YJFZ"},{"type":"listItem","spread":true,"position":{"start":{"line":198,"column":1},"end":{"line":199,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineMath","value":"N=10^6","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi><mo>=</mo><mn>1</mn><msup><mn>0</mn><mn>6</mn></msup></mrow><annotation encoding=\"application/x-tex\">N=10^6</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">6</span></span></span></span></span></span></span></span></span></span></span>","key":"DZU4NXJodW"},{"type":"text","value":" ⇒ ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"pIqFETpi2j"},{"type":"inlineMath","value":"\\sim 1.6\\times 10^{-3}","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo>∼</mo><mn>1.6</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>3</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">\\sim 1.6\\times 10^{-3}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.3669em;\"></span><span class=\"mrel\">∼</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1.6</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span></span>","key":"uqIGCBgGyZ"},{"type":"text","value":".","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"FWp5AJGYWr"}],"key":"HtLocTMay2"}],"key":"zPSpUt6P6Z"}],"key":"T5EArzZAXa"},{"type":"paragraph","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"Monte-Carlo converges as ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"ToU3IRBHDC"},{"type":"inlineMath","value":"O(N^{-1/2})","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>N</mi><mrow><mo>−</mo><mn>1</mn><mi mathvariant=\"normal\">/</mi><mn>2</mn></mrow></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">O(N^{-1/2})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.138em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">1/2</span></span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>","key":"VlbrpoMEOG"},{"type":"text","value":"; parallelizing increases ","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"h07kuPIgGE"},{"type":"inlineMath","value":"N","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>N</mi></mrow><annotation encoding=\"application/x-tex\">N</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span></span>","key":"T7gtrSENNs"},{"type":"text","value":" faster, but you cannot beat this rate without variance-reduction tricks.","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"h6zfHgFakk"}],"key":"HjQzR3qSm4"},{"type":"thematicBreak","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"rh1uCJUBkI"},{"type":"heading","depth":3,"position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"children":[{"type":"text","value":"Corrections & precision improvements (recommended)","position":{"start":{"line":204,"column":1},"end":{"line":204,"column":1}},"key":"caRlEAP3Uf"}],"identifier":"corrections-precision-improvements-recommended","label":"Corrections & precision improvements (recommended)","html_id":"corrections-precision-improvements-recommended","implicit":true,"key":"nyplUtYc1I"},{"type":"paragraph","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"children":[{"type":"text","value":"There are three easy fixes that make the program numerically cleaner and compile-ready.","position":{"start":{"line":206,"column":1},"end":{"line":206,"column":1}},"key":"N04wiZKy2w"}],"key":"NiZd0w3GVD"},{"type":"heading","depth":4,"position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"children":[{"type":"text","value":"A) Set ","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"LI3RNGxLpG"},{"type":"inlineCode","value":"num_trials","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"qqiAdQXTpO"},{"type":"text","value":" (and remove the stray ","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"vZW0DWqqts"},{"type":"inlineCode","value":"...","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"TaTMhPdPRB"},{"type":"text","value":" line)","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"Xigpx1KtRT"}],"identifier":"a-set-num-trials-and-remove-the-stray-line","label":"A) Set num_trials (and remove the stray ... line)","html_id":"a-set-num-trials-and-remove-the-stray-line","implicit":true,"key":"XZUqpbmF2i"},{"type":"paragraph","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"children":[{"type":"text","value":"Your ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"kiPXqXglX3"},{"type":"inlineCode","value":"compute_pi_serial.f90","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"oF3tib9MUL"},{"type":"text","value":" contains a literal line with ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"aUzDuOk4Ni"},{"type":"inlineCode","value":"...","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"BLSoSCMOv2"},{"type":"text","value":" between ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"YlgZkQ28zw"},{"type":"inlineCode","value":"r_squared = r*r","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"JcUxxZqXfr"},{"type":"text","value":" and the loop. That will not compile. Replace that region with a call to ","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"xq1A9Tut9G"},{"type":"inlineCode","value":"get_nr_iters()","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"iQIFylAxN8"},{"type":"text","value":":","position":{"start":{"line":210,"column":1},"end":{"line":210,"column":1}},"key":"PAZyJgXErn"}],"key":"qxzTV7r5cs"},{"type":"code","lang":"fortran","value":"  r_squared = r*r\n\n  ! Parse N from the command line (default 1000 if absent)\n  num_trials = get_nr_iters()","position":{"start":{"line":212,"column":1},"end":{"line":217,"column":1}},"key":"zSYjApvH6z"},{"type":"heading","depth":4,"position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"children":[{"type":"text","value":"B) Keep all arithmetic in double precision","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"oh5hg5hkhN"}],"identifier":"b-keep-all-arithmetic-in-double-precision","label":"B) Keep all arithmetic in double precision","html_id":"b-keep-all-arithmetic-in-double-precision","implicit":true,"key":"UY021GgJrW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":221,"column":1},"end":{"line":223,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Make the RNG return ","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"key":"oDvABXcAWG"},{"type":"inlineCode","value":"REAL64","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"key":"HOLBtyl3c1"},{"type":"text","value":".","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"key":"il88KSkAPv"}],"key":"LbRanQo1Gj"}],"key":"lCMywt2UnW"},{"type":"listItem","spread":true,"position":{"start":{"line":222,"column":1},"end":{"line":223,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Use double-precision literals and explicit casts in the estimator.","position":{"start":{"line":222,"column":1},"end":{"line":222,"column":1}},"key":"vNjwq8rS0j"}],"key":"cnocK1BNuW"}],"key":"HjHRAKdVsl"}],"key":"n7im8dKri4"},{"type":"paragraph","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"children":[{"type":"strong","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"odomXJhX2r"},{"type":"inlineCode","value":"lcgenerator_mod.f90","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"TbjC3m6wZx"},{"type":"text","value":":","position":{"start":{"line":224,"column":1},"end":{"line":224,"column":1}},"key":"YT8zBYt643"}],"key":"sDzZCFKLSB"}],"key":"ZL0WeUGRYp"},{"type":"code","lang":"fortran","value":"  real(kind=DP) function lcgrandom()\n    ...\n    lcgrandom = real(random_next, kind=DP) / real(PMOD, kind=DP)","position":{"start":{"line":226,"column":1},"end":{"line":230,"column":1}},"key":"o1DFIHSgG4"},{"type":"paragraph","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"children":[{"type":"strong","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"children":[{"type":"text","value":"In ","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"key":"Na7OayPtzl"},{"type":"inlineCode","value":"compute_pi_serial.f90","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"key":"WO7p54cUhV"},{"type":"text","value":":","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"key":"k0wDEEbFwK"}],"key":"whNakAOVHZ"}],"key":"MLJJMVnQOj"},{"type":"code","lang":"fortran","value":"  pi_computed = 4.0_DP * real(Ncirc, kind=DP) / real(num_trials, kind=DP)","position":{"start":{"line":234,"column":1},"end":{"line":236,"column":1}},"key":"MeVUrPlb4V"},{"type":"paragraph","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"children":[{"type":"text","value":"This avoids any intermediate rounding to single precision.","position":{"start":{"line":238,"column":1},"end":{"line":238,"column":1}},"key":"b7ZoyMxSyP"}],"key":"kJWXHBSbAX"},{"type":"heading","depth":4,"position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"children":[{"type":"text","value":"C) Optional: guard against bad inputs","position":{"start":{"line":240,"column":1},"end":{"line":240,"column":1}},"key":"hnYO3mx99a"}],"identifier":"c-optional-guard-against-bad-inputs","label":"C) Optional: guard against bad inputs","html_id":"c-optional-guard-against-bad-inputs","implicit":true,"key":"a4bJscqiRG"},{"type":"paragraph","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"children":[{"type":"text","value":"You can reject non-positive ","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"Z4GUAzbtlQ"},{"type":"inlineCode","value":"num_trials","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"tv63Ujgb3f"},{"type":"text","value":":","position":{"start":{"line":242,"column":1},"end":{"line":242,"column":1}},"key":"w7JrhZnoaO"}],"key":"c45BVEazVl"},{"type":"code","lang":"fortran","value":"  if (num_trials <= 0_I8) then\n    write(*,*) \"num_trials must be positive\"\n    stop 1\n  end if","position":{"start":{"line":244,"column":1},"end":{"line":249,"column":1}},"key":"GGbgDVlGhs"},{"type":"thematicBreak","position":{"start":{"line":251,"column":1},"end":{"line":251,"column":1}},"key":"l6yVqvXKfZ"},{"type":"heading","depth":3,"position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"children":[{"type":"text","value":"Suggested polished version of ","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"hmTfo0mJfn"},{"type":"inlineCode","value":"compute_pi_serial.f90","position":{"start":{"line":253,"column":1},"end":{"line":253,"column":1}},"key":"byLBAlajw8"}],"identifier":"suggested-polished-version-of-compute-pi-serial-f90","label":"Suggested polished version of compute_pi_serial.f90","html_id":"suggested-polished-version-of-compute-pi-serial-f90","implicit":true,"key":"ZwRQpTpTnK"},{"type":"code","lang":"fortran","value":"program compute_pi_serial\n  use, intrinsic :: iso_fortran_env, only : DP => REAL64, I8 => INT64\n  use lcgenerator_mod,  only : lcgrandom\n  use get_nr_iters_mod, only : get_nr_iters\n  implicit none\n\n  integer(I8) :: num_trials, i, Ncirc\n  real(DP)    :: pi_computed, pi_actual\n  real(DP)    :: x, y, r, r_squared\n\n  ! Initialize\n  Ncirc      = 0_I8\n  pi_computed= 0.0_DP\n  pi_actual  = 2.0_DP * acos(0.0_DP)     ! = π\n  r          = 1.0_DP\n  r_squared  = r*r\n  num_trials = get_nr_iters()\n\n  if (num_trials <= 0_I8) stop \"num_trials must be positive\"\n\n  do i = 1_I8, num_trials\n    x = lcgrandom()\n    y = lcgrandom()\n    if (x*x + y*y <= r_squared) Ncirc = Ncirc + 1_I8\n  end do\n\n  pi_computed = 4.0_DP * real(Ncirc,kind=DP) / real(num_trials,kind=DP)\n\n  print '(A, I12, A, F25.15)', \"After \", num_trials, \" loops, Pi = \", pi_computed\n  print '(A, F25.15)',         \"Actual value of Pi = \", pi_actual\n  print '(A, F25.15)',         \"Absolute difference = \", abs(pi_computed - pi_actual)\nend program compute_pi_serial","position":{"start":{"line":255,"column":1},"end":{"line":288,"column":1}},"key":"Z0RLuTBIsY"},{"type":"paragraph","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"children":[{"type":"text","value":"And in ","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"kmEFdDduWR"},{"type":"inlineCode","value":"lcgenerator_mod.f90","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"SYjdt1f6GZ"},{"type":"text","value":", change the function line to:","position":{"start":{"line":290,"column":1},"end":{"line":290,"column":1}},"key":"KjTBHgAvMo"}],"key":"jRcwDjSbX5"},{"type":"code","lang":"fortran","value":"  real(kind=DP) function lcgrandom()","position":{"start":{"line":292,"column":1},"end":{"line":294,"column":1}},"key":"HYuGPBjoWu"},{"type":"thematicBreak","position":{"start":{"line":296,"column":1},"end":{"line":296,"column":1}},"key":"YYB0l8TB5Y"},{"type":"heading","depth":3,"position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"children":[{"type":"text","value":"How to build and run","position":{"start":{"line":298,"column":1},"end":{"line":298,"column":1}},"key":"DdPHeEbZCQ"}],"identifier":"how-to-build-and-run","label":"How to build and run","html_id":"how-to-build-and-run","implicit":true,"key":"MN7S5K7K9h"},{"type":"code","lang":"bash","value":"# Build (gfortran example)\ngfortran -std=f2008 -O3 lcgenerator_mod.f90 get_nr_iters_mod.f90 compute_pi_serial.f90 -o compute_pi_serial\n\n# Run with 1,000,000 samples\n./compute_pi_serial 1000000","position":{"start":{"line":300,"column":1},"end":{"line":306,"column":1}},"key":"HmUcVzjgr2"},{"type":"paragraph","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"children":[{"type":"text","value":"You should see an estimate within ~","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"zQ4ytkRaZP"},{"type":"inlineMath","value":"1.6\\times 10^{-3}","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mn>1.6</mn><mo>×</mo><mn>1</mn><msup><mn>0</mn><mrow><mo>−</mo><mn>3</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">1.6\\times 10^{-3}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">1.6</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\">1</span><span class=\"mord\"><span class=\"mord\">0</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span></span>","key":"m5fDttxOKf"},{"type":"text","value":" of ","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"bZ4VKHJC26"},{"type":"inlineMath","value":"\\pi","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>π</mi></mrow><annotation encoding=\"application/x-tex\">\\pi</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span></span></span></span>","key":"kwqEp85spE"},{"type":"text","value":" on a typical run (with this LCG it will be deterministic per the current code).","position":{"start":{"line":308,"column":1},"end":{"line":308,"column":1}},"key":"WnfA6Mkrou"}],"key":"wyupXWPnXy"},{"type":"thematicBreak","position":{"start":{"line":310,"column":1},"end":{"line":310,"column":1}},"key":"Ss80T3YJvm"},{"type":"heading","depth":3,"position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"children":[{"type":"text","value":"Further remarks & optional enhancements","position":{"start":{"line":312,"column":1},"end":{"line":312,"column":1}},"key":"JUfGIXIHYC"}],"identifier":"further-remarks-optional-enhancements","label":"Further remarks & optional enhancements","html_id":"further-remarks-optional-enhancements","implicit":true,"key":"uwqHgNvZhm"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":314,"column":1},"end":{"line":321,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"children":[{"type":"strong","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"children":[{"type":"text","value":"RNG quality/period.","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"zq5qHCB6fV"}],"key":"K4l7345r7S"},{"type":"text","value":" The modulus ","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"lTJkYqI2Wm"},{"type":"inlineMath","value":"m=714{,}025","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><mn>714</mn><mo separator=\"true\" lspace=\"0em\" rspace=\"0em\">,</mo><mn>025</mn></mrow><annotation encoding=\"application/x-tex\">m=714{,}025</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8389em;vertical-align:-0.1944em;\"></span><span class=\"mord\">714</span><span class=\"mord\"><span class=\"mpunct\">,</span></span><span class=\"mord\">025</span></span></span></span>","key":"TcZVjcSQLR"},{"type":"text","value":" caps the period at ","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"V6X3wNui0h"},{"type":"inlineMath","value":"m","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi></mrow><annotation encoding=\"application/x-tex\">m</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span>","key":"iN2vF1xYo9"},{"type":"text","value":". If you run more draws than that, the sequence repeats. For higher-quality randomness, either use the Fortran intrinsic ","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"syE2kQTUwi"},{"type":"inlineCode","value":"random_number","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"Ha1zH9FlWk"},{"type":"text","value":" (simple, portable) or a 48- or 64-bit LCG/PCG with well-vetted parameters.","position":{"start":{"line":314,"column":1},"end":{"line":314,"column":1}},"key":"uuh99cxw63"}],"key":"AnmZDmPW3g"}],"key":"J8ZV51Tm9W"},{"type":"listItem","spread":true,"position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"strong","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"children":[{"type":"text","value":"Seeding.","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"TWlg5aHnRw"}],"key":"qJW2lHO6vd"},{"type":"text","value":" Add a ","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"j85Cew7FgZ"},{"type":"inlineCode","value":"seed_lcg(seed)","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"vOjoy3NsTy"},{"type":"text","value":" routine that sets ","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"CUW7D1WBXR"},{"type":"inlineCode","value":"random_last","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"W5Pu7RYtK6"},{"type":"text","value":", and accept a 2nd CLI argument to seed runs.","position":{"start":{"line":315,"column":1},"end":{"line":315,"column":1}},"key":"CSFERolplN"}],"key":"fqT5n7omyp"}],"key":"V2ucQk7gHA"},{"type":"listItem","spread":true,"position":{"start":{"line":316,"column":1},"end":{"line":319,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"children":[{"type":"strong","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"children":[{"type":"text","value":"Performance.","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"key":"YiGNlqDhyS"}],"key":"YvRCakB8Dn"},{"type":"text","value":" In tight loops, the ","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"key":"RwIw1HETnI"},{"type":"inlineCode","value":"mod","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"key":"jKLS24oNtZ"},{"type":"text","value":" on 64-bit integers is the main cost. For serious speed you might:","position":{"start":{"line":316,"column":1},"end":{"line":316,"column":1}},"key":"qmqIaAJl3u"}],"key":"t3elaDUvTj"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":318,"column":1},"end":{"line":319,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"keep ","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"MmDs2vOssS"},{"type":"inlineCode","value":"random_last","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"FhK860jadV"},{"type":"text","value":" and constants in 64-bit and choose ","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"jABdtfHARF"},{"type":"inlineMath","value":"m=2^{k}","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>m</mi><mo>=</mo><msup><mn>2</mn><mi>k</mi></msup></mrow><annotation encoding=\"application/x-tex\">m=2^{k}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8491em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span></span></span></span></span>","key":"OkcZK2SvSV"},{"type":"text","value":" so modulo is a mask, or","position":{"start":{"line":318,"column":1},"end":{"line":318,"column":1}},"key":"fgM8Ri80Kw"}],"key":"N01PeGroAV"}],"key":"PWwbJMycCs"},{"type":"listItem","spread":true,"position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"batch-generate variates and test multiple points per iteration (SIMD).","position":{"start":{"line":319,"column":1},"end":{"line":319,"column":1}},"key":"xmJTRuZNX6"}],"key":"VPePd1vMCx"}],"key":"B1zyqs7KLv"}],"key":"zWu0AcLJj5"}],"key":"YUiv7mstDV"},{"type":"listItem","spread":true,"position":{"start":{"line":320,"column":1},"end":{"line":321,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"children":[{"type":"strong","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"children":[{"type":"text","value":"Parallelization.","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"key":"jpB0XjS71o"}],"key":"dHLss9kJVS"},{"type":"text","value":" The serial algorithm is embarrassingly parallel. If you later add OpenMP/MPI, ensure each thread/process gets an ","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"key":"uATunbi0Rz"},{"type":"strong","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"children":[{"type":"text","value":"independent RNG stream","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"key":"mk08efG7GI"}],"key":"f9O98R2KcA"},{"type":"text","value":" (e.g., leapfrogging or distinct seeds with skip-ahead).","position":{"start":{"line":320,"column":1},"end":{"line":320,"column":1}},"key":"aE1mwxituc"}],"key":"XWLMFVwL49"}],"key":"NnMgSVSzhD"}],"key":"nJ8z50Av14"},{"type":"thematicBreak","position":{"start":{"line":322,"column":1},"end":{"line":322,"column":1}},"key":"nHye0FyhMQ"},{"type":"paragraph","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"children":[{"type":"text","value":"If you’d like, I can produce a version that uses the standard ","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"PG77QTkY5U"},{"type":"inlineCode","value":"random_number","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"xIIuNJJmQA"},{"type":"text","value":" (for quality) and a command-line seed, plus a tiny unit test to verify the variance scaling.","position":{"start":{"line":324,"column":1},"end":{"line":324,"column":1}},"key":"BniYwyT2Ma"}],"key":"vSRZO2UdS3"}],"key":"CbblNUwfYr"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The above program and modules are compiled and run using Fortran Package Manager (fpm):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P87gNXh8bK"}],"key":"ocBZpF9Z6o"}],"key":"zBWNDWGsz3"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Build the Program using FPM (Fortran Package Manager)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Tj0X7pr0Ez"}],"identifier":"build-the-program-using-fpm-fortran-package-manager","label":"Build the Program using FPM (Fortran Package Manager)","html_id":"build-the-program-using-fpm-fortran-package-manager","implicit":true,"key":"zS3TTcXwMK"}],"visibility":"show","key":"nnaVBhyVC8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nroot_dir = \"\"\nroot_dir = os.getcwd()","key":"bWqSag2YSa"},{"type":"outputs","id":"E6ocD6B24vwPLmfDqu7zL","children":[],"key":"LpulpaD8vS"}],"key":"UZUuphWgQF"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The following configuration file (fpm.toml) was used:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kdIlEo7vtM"}],"key":"CtQCA3wg1i"}],"key":"kHyTvkmdL6"},{"type":"block","kind":"notebook-content","children":[{"type":"include","file":"code/fpm.toml","literal":true,"children":[{"type":"code","value":"name = \"Compute_Pi_Serial\"\n\n[build]\nauto-executables = true\nauto-tests = true\nauto-examples = true\nmodule-naming = false\n\n[install]\nlibrary = false\ntest = false\n\n[fortran]\nimplicit-typing = false\nimplicit-external = false\nsource-form = \"free\"\n\n[[executable]]\nname = \"compute_pi_serial\"\nsource-dir = \"app\"\nmain = \"compute_pi_serial.f90\"\n\n","lang":"toml","filename":"fpm.toml","key":"PJlNjnGPZ7"}],"key":"Haw2xmmZoh"}],"key":"N3PxVvuzXD"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"code_dir = root_dir + \"/\" + \"code\"","visibility":"show","key":"y8IjqeP2Qn"},{"type":"outputs","id":"WeBDTd2b5BcqkDtqZi4TD","children":[],"visibility":"show","key":"IkPU8qkSBs"}],"visibility":"show","key":"MICTAxfwKH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"os.chdir(code_dir)","key":"iKOLMb3WDE"},{"type":"outputs","id":"wd-yjNI6aoNkgFpkboE1P","children":[],"key":"yCrpYWSbna"}],"key":"iNyXSVbCHb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"build_status = os.system(\"fpm build 2>/dev/null\")","key":"NDSQkb1Wal"},{"type":"outputs","id":"f_b5CCMFUs9kzZCuGVbUl","children":[],"key":"C2ibzkmCj1"}],"key":"O71heYMebx"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Run the Program using FPM (Fortran Package Manager)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"G6iQpF2xfZ"}],"identifier":"run-the-program-using-fpm-fortran-package-manager","label":"Run the Program using FPM (Fortran Package Manager)","html_id":"run-the-program-using-fpm-fortran-package-manager","implicit":true,"key":"pqIbPOfZPX"}],"key":"kwL6bc1o2r"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"10 Iterations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yddfXwYVK9"}],"identifier":"id-10-iterations","label":"10 Iterations","html_id":"id-10-iterations","implicit":true,"key":"fFI3VX5enm"}],"key":"oYx6oTmanF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%timeit -r 10 -n 1\nexec_status = os.system(\"fpm run -- 10 2>/dev/null > output.txt\")","key":"cdu65nS4Um"},{"type":"outputs","id":"1ADOvdLWKELua5m_Hpsy3","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"80.3 ms ± 26.5 ms per loop (mean ± std. dev. of 10 runs, 1 loop each)\n"},"children":[],"key":"wL3nICemH0"}],"key":"ECGJ5KBcuC"}],"key":"oCzKH0NRTm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%cat output.txt","key":"GZodZrCe5w"},{"type":"outputs","id":"e-UPdM8B7OqLoZmfjyrKu","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"After         10 loops, Pi =         3.200000047683716\nActual value of Pi =         3.141592653589793\nAbsolute difference =         0.058407394093923\n"},"children":[],"key":"JEypzPaJ2t"}],"key":"zfQxnmrzqa"}],"key":"jDVnvvTYU0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"100 Iterations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UCjuy5IVfp"}],"identifier":"id-100-iterations","label":"100 Iterations","html_id":"id-100-iterations","implicit":true,"key":"eTI4XXCTZ3"}],"key":"jTO2XxsFv7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%timeit -r 10 -n 1\nexec_status = os.system(\"fpm run -- 100 2>/dev/null > output.txt\")","key":"Pgqlb9bQJp"},{"type":"outputs","id":"_eH43mgivtX6uhWwbUI0k","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"33.5 ms ± 7.69 ms per loop (mean ± std. dev. of 10 runs, 1 loop each)\n"},"children":[],"key":"mgmnX828RE"}],"key":"PeHp833iVT"}],"key":"e3worNOdjm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%cat output.txt","key":"JNJGsDdjsL"},{"type":"outputs","id":"5cv0jQ5F584Ah8XiGqpfd","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"After        100 loops, Pi =         3.160417031779042\nActual value of Pi =         3.141592653589793\nAbsolute difference =         0.018824378189249\n"},"children":[],"key":"zRzPkgpZye"}],"key":"Vn42qj2qEM"}],"key":"GnqtIxQhWq"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1,000 Iterations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QfIOxcKQnT"}],"identifier":"id-1-000-iterations","label":"1,000 Iterations","html_id":"id-1-000-iterations","implicit":true,"key":"yHDMLzA5KA"}],"key":"BXMyZGBCHs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%timeit -r 10 -n 1\nexec_status = os.system(\"fpm run -- 1000 2>/dev/null > output.txt\")","key":"kiFfahPktZ"},{"type":"outputs","id":"wxFCjaGABqtuDCK1mGtsY","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"32.9 ms ± 4.03 ms per loop (mean ± std. dev. of 10 runs, 1 loop each)\n"},"children":[],"key":"hAKTiJ0bZS"}],"key":"FKmxsa2xPq"}],"key":"cIYObUbI9l"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%cat output.txt","key":"fH2W66cJhZ"},{"type":"outputs","id":"0fd2om0OguIBXjCP1Pxc8","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"After       1000 loops, Pi =         3.143555466911022\nActual value of Pi =         3.141592653589793\nAbsolute difference =         0.001962813321229\n"},"children":[],"key":"jqZUcBACPA"}],"key":"hAW9tYM8vM"}],"key":"THCIzn3nO3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"10,000 Iterations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pT4GnLVIEF"}],"identifier":"id-10-000-iterations","label":"10,000 Iterations","html_id":"id-10-000-iterations","implicit":true,"key":"kV5NLW8EL2"}],"key":"ryfSwhhTjK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%timeit -r 10 -n 1\nexec_status = os.system(\"fpm run -- 10000 2>/dev/null > output.txt\")","key":"VP0f3pCR2Q"},{"type":"outputs","id":"ScsFhqLVp8Ti-me5iJTXB","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"31.8 ms ± 3 ms per loop (mean ± std. dev. of 10 runs, 1 loop each)\n"},"children":[],"key":"FbRReQIivk"}],"key":"Lln0i7QwIz"}],"key":"z5CShuUEer"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%cat output.txt","key":"uvMfI1KNgN"},{"type":"outputs","id":"-WgXSKDCEhm7pmwSiLNjQ","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"After      10000 loops, Pi =         3.141791477611602\nActual value of Pi =         3.141592653589793\nAbsolute difference =         0.000198824021809\n"},"children":[],"key":"hl9n8dbDqv"}],"key":"SIbCjLlC0R"}],"key":"RsecXqgiJF"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"100,000 Iterations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bgjiqtRLDj"}],"identifier":"id-100-000-iterations","label":"100,000 Iterations","html_id":"id-100-000-iterations","implicit":true,"key":"aw3S9lAbf4"}],"key":"k9b9a5Pxqa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%timeit -r 10 -n 1\nexec_status = os.system(\"fpm run -- 100000 2>/dev/null > output.txt\")","key":"TwtIS4nQrT"},{"type":"outputs","id":"uJMxuU46W2vHwcSJm9XgX","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"34.4 ms ± 4.95 ms per loop (mean ± std. dev. of 10 runs, 1 loop each)\n"},"children":[],"key":"cfPeTWizCU"}],"key":"rgavSnWp7L"}],"key":"fwYLLosOiT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%cat output.txt","key":"R0fucxgOSC"},{"type":"outputs","id":"RQPLxag92VhgLVqFSPpHq","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"After     100000 loops, Pi =         3.141612616406209\nActual value of Pi =         3.141592653589793\nAbsolute difference =         0.000019962816416\n"},"children":[],"key":"MhHJg80fBZ"}],"key":"k8dNaajLLr"}],"key":"R6ANxwn41y"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1,000,000 Iterations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GXg9MintvC"}],"identifier":"id-1-000-000-iterations","label":"1,000,000 Iterations","html_id":"id-1-000-000-iterations","implicit":true,"key":"ogxrKjgdeU"}],"key":"PWxJh0lkA9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%timeit -r 10 -n 1\nexec_status = os.system(\"fpm run -- 1000000 2>/dev/null > output.txt\")","key":"nFvvSfBGYg"},{"type":"outputs","id":"rizmXw-LCVBuM0H-rR7xK","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"35.9 ms ± 5.26 ms per loop (mean ± std. dev. of 10 runs, 1 loop each)\n"},"children":[],"key":"cKD8FAhiln"}],"key":"Bb9wVQTcNz"}],"key":"sJ4Y5KlwpF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%cat output.txt","key":"G9bnI4rH0W"},{"type":"outputs","id":"F9pS1nQqOQ2X5JTNMHZtO","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"After    1000000 loops, Pi =         3.141594652402481\nActual value of Pi =         3.141592653589793\nAbsolute difference =         0.000001998812688\n"},"children":[],"key":"BYdNZsuN7R"}],"key":"oUF9idtE2u"}],"key":"wQtoC2RAYI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"10,000,000 Iterations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Svc2yiU7fd"}],"identifier":"id-10-000-000-iterations","label":"10,000,000 Iterations","html_id":"id-10-000-000-iterations","implicit":true,"key":"lz340vPJEw"}],"key":"MqPK56SP7w"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%timeit -r 10 -n 1\nexec_status = os.system(\"fpm run -- 10000000 2>/dev/null > output.txt\")","key":"Ub3msp0dy8"},{"type":"outputs","id":"xyRpV4SnhMNWWqXaWU0An","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"64.8 ms ± 7.7 ms per loop (mean ± std. dev. of 10 runs, 1 loop each)\n"},"children":[],"key":"aBwrUnzkqq"}],"key":"cynlqVWSaG"}],"key":"xf4h50BuSk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%cat output.txt","key":"zIND6yYDvH"},{"type":"outputs","id":"A1EZ9aDb_HJ4DxWbVGCaa","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"After   10000000 loops, Pi =         3.141592854147901\nActual value of Pi =         3.141592653589793\nAbsolute difference =         0.000000200558108\n"},"children":[],"key":"ARWY10L69d"}],"key":"sDcZLQkyQ1"}],"key":"NAvKOaZUcd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"100,000,000 Iterations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ls2A91fplD"}],"identifier":"id-100-000-000-iterations","label":"100,000,000 Iterations","html_id":"id-100-000-000-iterations","implicit":true,"key":"EcgresvGkI"}],"key":"DPj7wxMzqb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%timeit -r 10 -n 1\nexec_status = os.system(\"fpm run -- 100000000 2>/dev/null > output.txt\")","key":"pTxo3DnGUz"},{"type":"outputs","id":"vVn7fBqoSAAYL6mKSEtf1","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"274 ms ± 9.74 ms per loop (mean ± std. dev. of 10 runs, 1 loop each)\n"},"children":[],"key":"dhD5re3VdN"}],"key":"SQMHew5yfB"}],"key":"rxFsunJL2f"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%cat output.txt","key":"GjCUnSPG1H"},{"type":"outputs","id":"unfTFQJyzhiR-gh0M2Zvg","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"After  100000000 loops, Pi =         3.141592668260093\nActual value of Pi =         3.141592653589793\nAbsolute difference =         0.000000014670300\n"},"children":[],"key":"UrTwX9ugj6"}],"key":"MNAvgRuhQ7"}],"key":"eEgRP4S2Qs"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"1,000,000,000 Iterations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IuMKaXGcqH"}],"identifier":"id-1-000-000-000-iterations","label":"1,000,000,000 Iterations","html_id":"id-1-000-000-000-iterations","implicit":true,"key":"NLfzEO6Y0u"}],"key":"I9rQr6CWVn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%timeit -r 10 -n 1\nexec_status = os.system(\"fpm run -- 1000000000 2>/dev/null > output.txt\")","key":"RTUhkRsF6V"},{"type":"outputs","id":"uiYJ4wX6ginQSL1BjzipD","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"2.34 s ± 46.8 ms per loop (mean ± std. dev. of 10 runs, 1 loop each)\n"},"children":[],"key":"oIjB1dNNsz"}],"key":"Kga9OfqW9u"}],"key":"aLImgCxqX5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%cat output.txt","key":"l2EgdFJmeU"},{"type":"outputs","id":"1kOGj-f_7DcvKXzqgLP7r","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"After 1000000000 loops, Pi =         3.141592665675041\nActual value of Pi =         3.141592653589793\nAbsolute difference =         0.000000012085248\n"},"children":[],"key":"ZRwFugIPlU"}],"key":"pnjTck1VeK"}],"key":"qerueIC5Rz"}],"key":"p8P2QpL18i"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Supercomputing Crash Course","url":"/sections/computer-programming/fortran/nersc/supercomputing-crash-course/scc-head","group":"Computer Programming"},"next":{"title":"Javascript Programming","url":"/sections/computer-programming/javascript/javascript","group":"Computer Programming"}}},"domain":"http://localhost:3004"}