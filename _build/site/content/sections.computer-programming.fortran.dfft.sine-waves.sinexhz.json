{"version":3,"kind":"Notebook","sha256":"616fbfc2abc46faf2153b6f1d8c234d98d32965203d9a832e53ef11244daf3c8","slug":"sections.computer-programming.fortran.dfft.sine-waves.sinexhz","location":"/Sections/Computer_Programming/Fortran/DFFT/2_Sine_Waves/2sineXHz.ipynb","dependencies":[],"frontmatter":{"title":"Two Sine Waves with Different Frequencies","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Mark Khusid","given":"Mark","family":"Khusid"},"name":"Mark Khusid","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/markkhusid/MKDynamics_Website_V2","numbering":{"title":{"offset":4}},"source_url":"https://github.com/markkhusid/MKDynamics_Website_V2/blob/master/Sections/Computer_Programming/Fortran/DFFT/2_Sine_Waves/2sineXHz.ipynb","edit_url":"https://github.com/markkhusid/MKDynamics_Website_V2/edit/master/Sections/Computer_Programming/Fortran/DFFT/2_Sine_Waves/2sineXHz.ipynb","exports":[{"format":"ipynb","filename":"2sineXHz.ipynb","url":"/2sineXHz-5f7574ce6d0f215c685d7f347698504c.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this example, we will generate two sine waves with different frequencies and add them together. We will then plot the resulting signal in the time domain and in the frequency domain.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pACCDagQmh"}],"key":"oEBIFf1Qy1"}],"key":"WWnnzlaoR1"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Import Required Libraries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eM90LtqEOC"}],"identifier":"import-required-libraries","label":"Import Required Libraries","html_id":"import-required-libraries","implicit":true,"key":"KFvCt4fWk9"}],"key":"cmj6oI2ymp"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%matplotlib inline\nimport matplotlib\nimport numpy as np\nimport wave, math\n\nfrom matplotlib import pyplot as plt","key":"Ep0cNmLJKi"},{"type":"outputs","id":"-RtwRhChWLJ0X7MV8b76m","children":[],"key":"eseWXWPXHZ"}],"key":"Br6Ia2trq3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the Parameters such as the Sampling Frequency, the Duration of the Signal, and the Frequencies of the Sine Waves","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"r9gBaD8KP2"}],"identifier":"define-the-parameters-such-as-the-sampling-frequency-the-duration-of-the-signal-and-the-frequencies-of-the-sine-waves","label":"Define the Parameters such as the Sampling Frequency, the Duration of the Signal, and the Frequencies of the Sine Waves","html_id":"define-the-parameters-such-as-the-sampling-frequency-the-duration-of-the-signal-and-the-frequencies-of-the-sine-waves","implicit":true,"key":"Bdk4Bw5uRl"}],"key":"buVxIKjXKK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Variables\nsRate = 20000 # sample rate in Hertz\nfreq1 = 50.0 # frequency of first sine wave\nfreq2 = 100.0 # frequency of second sine wave\namplitude1 = 10 # amplitude of first wave\namplitude2 = 5 # amplitude of second wave\nnumPeriods = 10 # number of periods of the sine waves\nnumSamples = sRate * numPeriods # total number of samples","key":"SueNeHEgIh"},{"type":"outputs","id":"PbIr8o3KFB_pL-VJy0Idj","children":[],"key":"YxING7tg3m"}],"key":"DHsRmbl51m"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create Plotting Helper Function","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bKd7cPzWzO"}],"identifier":"create-plotting-helper-function","label":"Create Plotting Helper Function","html_id":"create-plotting-helper-function","implicit":true,"key":"cqQDjeLc4N"}],"key":"eD7eEUfFt5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Graphing helper function\ndef setup_graph(title='', x_label='', y_label='', fig_size=None):\n    fig = plt.figure()\n    if fig_size != None:\n        fig.set_size_inches(fig_size[0], fig_size[1])\n    ax = fig.add_subplot(111)\n    ax.set_title(title)\n    ax.set_xlabel(x_label)\n    ax.set_ylabel(y_label)","key":"yZzY6dgG2X"},{"type":"outputs","id":"PYzcnN4oVqfzTbnEtz6TK","children":[],"key":"UGPlYdQrbB"}],"key":"ohTs2sE3P5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generate the X-Axis for the Time Domain Signal","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oWiwZEJSny"}],"identifier":"generate-the-x-axis-for-the-time-domain-signal","label":"Generate the X-Axis for the Time Domain Signal","html_id":"generate-the-x-axis-for-the-time-domain-signal","implicit":true,"key":"ttTPITO8HP"}],"key":"P8IbWLPiu0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The X-axis for the time domain signal will be generated using the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cD7KVaBJPk"},{"type":"inlineCode","value":"numpy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sA5nfVEREG"},{"type":"text","value":" library.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"miZV3HkSMS"}],"key":"E7ve4HHknr"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To generate the X-axis for the time domain signal, we will use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"WuTak9Pces"},{"type":"inlineCode","value":"numpy.linspace","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"t4ynwG5HdE"},{"type":"text","value":" function. This function generates an array of evenly spaced numbers over a specified interval.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EtsQjfTlnI"}],"key":"TkKUPQ38Fa"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The function takes three arguments: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CYxGxk6WkP"},{"type":"inlineCode","value":"start","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DszKpQDZkb"},{"type":"text","value":", ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QTwIctGc9r"},{"type":"inlineCode","value":"stop","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"D7iq6L4jfT"},{"type":"text","value":", and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Fyj4C5f4f2"},{"type":"inlineCode","value":"num","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yMsIJFb6Ua"},{"type":"text","value":". The ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"UUBg2Y3aBm"},{"type":"inlineCode","value":"start","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ioeVb0NJPQ"},{"type":"text","value":" argument specifies the starting value of the sequence, the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"pk6lDNlpwQ"},{"type":"inlineCode","value":"stop","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"AtDuXdlyUh"},{"type":"text","value":" argument specifies the end value of the sequence, and the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"sFijw6qFQc"},{"type":"inlineCode","value":"num","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"HeiY6HPPt5"},{"type":"text","value":" argument specifies the number of samples to generate.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"ElPoLbzgwX"}],"key":"wW7IvBjy8v"}],"key":"SsP2bhh2uV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create the x axis from 0 to numPeriods, divided into numSamples samples.\nx = np.linspace(0, numPeriods, numSamples)","key":"vBIZoGNTWO"},{"type":"outputs","id":"ZuOyDMFfuFJFFQ2ts_RH_","children":[],"key":"AuhKLrJWJi"}],"key":"BNqCaiWTrQ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Display the first 10 values of the X-axis for the time domain signal.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qvy12ruKZv"}],"key":"xDzxeHu6hX"}],"key":"WqgMD5bihE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x[:10]","key":"JzZPthlgPh"},{"type":"outputs","id":"1H6a1ScS20_QTLjUdbBcw","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"array([0.0000000e+00, 5.0000250e-05, 1.0000050e-04, 1.5000075e-04,\n       2.0000100e-04, 2.5000125e-04, 3.0000150e-04, 3.5000175e-04,\n       4.0000200e-04, 4.5000225e-04])","content_type":"text/plain"}}},"children":[],"key":"qTpB0N1Hwj"}],"key":"XfJMopPk0m"}],"key":"zwmu2F1o8C"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Print out the length of x to make sure it is numSamples long.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j5wu5w9YhD"}],"key":"GlR6EewCQc"}],"key":"R8YjsdG1wX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"len(x)","key":"P46RNoT7VO"},{"type":"outputs","id":"uiX6u4unpSgwAiQK3Hhss","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"200000","content_type":"text/plain"}}},"children":[],"key":"jMyiQ9Bsbz"}],"key":"JIiTbLNwIk"}],"key":"L59qK9ntlb"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generate the Sine Waves","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n1W0Ged5O2"}],"identifier":"generate-the-sine-waves","label":"Generate the Sine Waves","html_id":"generate-the-sine-waves","implicit":true,"key":"OZEDVv7VUN"}],"key":"PhRCL3rqQJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"f1 and f2 are the first and second sine waves, respectively, that will be generated.  We use a lambda function to generate the sine waves.  The lambda function takes the time axis and returns the sine wave.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LAgAkSN0E3"}],"key":"hAVqe45twz"}],"key":"rx4bjlr7aM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f1 = lambda x: amplitude1*np.sin(freq1*2*np.pi*x)","key":"OKTlnZat1s"},{"type":"outputs","id":"NpZ3E34EdVzwSOvXB-yNm","children":[],"key":"e0TTXPUBkF"}],"key":"HY0JxxjRB3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f2 = lambda x: amplitude2*np.sin(freq2*2*np.pi*x)","key":"RMP5xRubBN"},{"type":"outputs","id":"bp6F-gz_aFV6MkRUTuODF","children":[],"key":"eIMm8DYyMK"}],"key":"gdrM5RHeBN"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Use list comprehension to generate the first sine wave.  The first sine wave is generated by applying the lambda function to each value in the time axis.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WKD6ifFZom"}],"key":"e94zxxjG4R"}],"key":"ruBgjsoUny"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sampled_f1 = [f1(i) for i in x]","key":"aQEN57iRSt"},{"type":"outputs","id":"o5L8LwFt00T-hjAPlD9VQ","children":[],"key":"sUeD5YK8qp"}],"key":"gBeYeuyx92"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Check the length of the first sine wave to make sure it is numSamples long.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zE75Fav0OY"}],"key":"wfrnL74c3H"}],"key":"A7vhG6YeNc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"len(sampled_f1)","key":"p0xZ0djEtN"},{"type":"outputs","id":"whl_oOzOmdS8AtnSzLnz7","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"200000","content_type":"text/plain"}}},"children":[],"key":"V6dWRzV5OE"}],"key":"DntMiDnGON"}],"key":"HwdU030Kr0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Likewise, we can create the second sine wave by applying the lambda function f2 to each value in the time axis.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xqj8Filmwr"}],"key":"zujd2rs8Pb"}],"key":"H2MJzEjOtR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sampled_f2 = [f2(i) for i in x]","key":"XzG71HqhkQ"},{"type":"outputs","id":"YtLc26ollY7xfwib2ryOj","children":[],"key":"vPlJOS6x94"}],"key":"T6SPcIMdvP"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Check the length of the second sine wave to make sure it is numSamples long.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"swYtiicq9L"}],"key":"JOaSIsLzoP"}],"key":"arPrBRBilj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"len(sampled_f2)","key":"PQKvDd3Ujx"},{"type":"outputs","id":"I7gfHyrkMKagxp19iDInv","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/plain":{"content":"200000","content_type":"text/plain"}}},"children":[],"key":"KaKRygAXsw"}],"key":"SwY08w6PX1"}],"key":"nd8UXODFOe"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Add the Two Sine Wave Signals Together","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TLh4nlNfTH"}],"identifier":"add-the-two-sine-wave-signals-together","label":"Add the Two Sine Wave Signals Together","html_id":"add-the-two-sine-wave-signals-together","implicit":true,"key":"crjikI9vkF"}],"key":"Aqxb56jKdz"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To generate the combined signal, we simply add the two sine wave signals together.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nCyyL3hHJ2"}],"key":"CpMWFzWx5J"}],"key":"Q2BQqAmYlZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sampled_fcomb = [(f1(i)+f2(i)) for i in x]","key":"sUk1PgfKjk"},{"type":"outputs","id":"2hNcGXUt9HGB85xEi7VJM","children":[],"key":"nrq2XvXaPy"}],"key":"NmRTGDtqrv"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Check the length of the combined signal to make sure it is numSamples long.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"o8b7jvvHYV"}],"key":"mLb7xdhgQE"}],"key":"LJ6MU8L3EC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"len(sampled_fcomb)","key":"TAwWMaqDB5"},{"type":"outputs","id":"7iUKSd8yPEHqtgERCOSd_","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":59,"metadata":{},"data":{"text/plain":{"content":"200000","content_type":"text/plain"}}},"children":[],"key":"gGsTxBdhog"}],"key":"RLqgCPygTy"}],"key":"QcLX4Ii2uB"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the Time Domain Signals","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GgQFitqhhq"}],"identifier":"plot-the-time-domain-signals","label":"Plot the Time Domain Signals","html_id":"plot-the-time-domain-signals","implicit":true,"key":"HBnTl8cEWD"}],"key":"y4zIufXU1C"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we plot the time domain signals.  We will plot the first sine wave, the second sine wave, and the combined signal.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DCuh82u8v6"}],"key":"SuL9yPVxrk"}],"key":"NJNsy7cgOe"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure()\nfig.set_size_inches(12,6)\nplt.subplots_adjust(hspace=1)\n\nplt.subplot(311)\nplt.plot(x, sampled_f1)\nplt.title('Sine wave 50Hz')\nplt.xlabel('Time [sec]')\nplt.ylabel('Amplitude [arbitrary]')\nplt.xlim(0, 0.5)\nplt.ylim(-15, 15)\n\nplt.subplot(312)\nplt.plot(x, sampled_f2)\nplt.title('Sine wave 100Hz')\nplt.xlabel('Time [sec]')\nplt.ylabel('Amplitude [arbitrary]')\nplt.xlim(0, 0.5)\nplt.ylim(-10, 10)\n\nplt.subplot(313)\nplt.plot(x, sampled_fcomb)\nplt.title('Sine wave 50Hz + Sine wave 100Hz')\nplt.xlabel('Time [sec]')\nplt.ylabel('Amplitude [arbitrary]')\nplt.xlim(0, 0.5)\nplt.ylim(-25, 25)\nfig.savefig('../images/2_sine_waves_100_Hz_50_Hz.png', dpi=300)","key":"fQxWWL7KVf"},{"type":"outputs","id":"GmCDUk1V9QTT7bI0qHysn","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"53a3f73ae6ccc9561aa2efffccf13fcf","path":"/53a3f73ae6ccc9561aa2efffccf13fcf.png"},"text/plain":{"content":"<Figure size 1200x600 with 3 Axes>","content_type":"text/plain"}}},"children":[],"key":"btuV3i5VlV"}],"key":"d7TstroyxL"}],"key":"CNJZVX9vEY"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Calculate the Fourier Transform of the Combined Signal","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A10S07ffzI"}],"identifier":"calculate-the-fourier-transform-of-the-combined-signal","label":"Calculate the Fourier Transform of the Combined Signal","html_id":"calculate-the-fourier-transform-of-the-combined-signal","implicit":true,"key":"S1oAwUOefZ"}],"key":"uhJSnvveM5"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To calculate the Fourier transform of the combined signal, we use the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uZaMqSdZNP"},{"type":"inlineCode","value":"numpy.fft.fft","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Iwtk25KrZm"},{"type":"text","value":" function. This function computes the one-dimensional discrete Fourier Transform.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"egSFUJZCrQ"}],"key":"Z4aNbp4Yk5"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The function takes the combined signal as an argument and returns the Fourier transform of the signal.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KaZhwjcOcw"}],"key":"ObFgn2thy4"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"To obtain the magnitude of the Fourier transform, we square the real parts and the imaginary parts of the Fourier transform and take the square root of the sum of the squares.  The is done for everly element in the Fourier transform.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"jHekwfjVrl"}],"key":"ZFx6KSmQVQ"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"To generate the X-axis for the frequency domain signal, we create a list of frequencies that correspond to the Fourier transform of the combined signal.  The frequencies are generated using the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"PH9RpuFn7i"},{"type":"inlineCode","value":"numpy.fft.fftfreq","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"XRMhkfZyRE"},{"type":"text","value":" function.  This function generates the frequencies for the Fourier transform of the signal.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"kiS62aU6Jc"}],"key":"ElTFjKRucD"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"The function takes the number of samples and the sampling frequency as arguments and returns an array of frequencies.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"TBxs4PG304"}],"key":"O9emfchmhe"}],"key":"hosur4hZOj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fft_output = np.fft.rfft(sampled_fcomb)\nmagnitude = [np.sqrt(i.real**2+i.imag**2)/len(fft_output) for i in fft_output]\n\nfrequencies = np.fft.fftfreq(len(fft_output), 2/sRate)","key":"aLKwXPYNhi"},{"type":"outputs","id":"gVIjjfbybFe1hnWZ26n1H","children":[],"key":"RlO2JGqJGg"}],"key":"FRaWDPRQqC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"setup_graph(x_label='frequency [Hz]', y_label='amplitude [arbitrary]', \n            title='Frequency Domain', fig_size=(12,6))\nplt.xlim(0, 200)\nplt.plot(frequencies, magnitude, 'r')\nplt.show()\n","key":"wGT3agnVrj"},{"type":"outputs","id":"5Liu7W4PMfDe78HkrVjyu","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"20965618d27de10ecd08bc9ad7b71341","path":"/20965618d27de10ecd08bc9ad7b71341.png"},"text/plain":{"content":"<Figure size 1200x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"jxtcJMfuid"}],"key":"VJ9lweFWwy"}],"key":"qbqGC0goru"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Check the length of the magnitude and the frequencies to make sure they are the same length.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x7fLqot0O9"}],"key":"MTCTb1Yqvu"}],"key":"csD1NDnY82"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"len(magnitude)","key":"mMk0ou949q"},{"type":"outputs","id":"m2qjyVcPF4bIKl90fKPMi","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"100001","content_type":"text/plain"}}},"children":[],"key":"Jmv5gi67yf"}],"key":"T3c6zQUrn4"}],"key":"J5BVXN3Vgw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"len(frequencies)","key":"i4lDy9BPZd"},{"type":"outputs","id":"z4MNlet7Ki1Z-3tgcUP2p","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/plain":{"content":"100001","content_type":"text/plain"}}},"children":[],"key":"r5gS6JbjCl"}],"key":"VSzXkYkivX"}],"key":"I3i11dOR8C"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generate Output Files","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hlBddO61Ec"}],"identifier":"generate-output-files","label":"Generate Output Files","html_id":"generate-output-files","implicit":true,"key":"vMvnE6egKr"}],"key":"G2w8TxrsXa"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Save the magnitude and the frequencies to files.  These files will be processed through the DFFT Fortran program.  The output of the program will be compared to the magnitude and frequencies generated by the Python program.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bTpNgvZV0o"}],"key":"j1pWjvmyxu"}],"key":"toC1d0r8Ya"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print ('Opening data files...')\ndataFile = open('2sineXHz.dat', 'wt')  # To be run through Fortran code. Has amplitudes only.\ntd_dataFile = open('2sineXHz_time_domain.dat', 'wt')  # Has time domain amplitude and time data\nfd_dataFile = open('2sineXHz_freq_domain.dat', 'wt')  # Has freq domain amplitude and corrected FFT frequencies (bins)\n\nprint ('Writing data files...')\nnp.savetxt(dataFile, sampled_fcomb, fmt='%10.10f', delimiter=' ', newline='\\n')\nnp.savetxt(td_dataFile, np.column_stack([sampled_fcomb, x]), fmt='%10.10f', newline='\\n')\nnp.savetxt(fd_dataFile, np.column_stack([magnitude, frequencies]), fmt='%10.10f', newline='\\n')","key":"qqnCRqAmYu"},{"type":"outputs","id":"cagefKn8sJcssSHxlkK3G","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Opening data files...\nWriting data files...\n"},"children":[],"key":"FAfVqkdYoX"}],"key":"QHogBQyPHj"}],"key":"iGX2BkbYWy"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Execute DFFT Fortran Program","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sulZvKheSD"}],"identifier":"execute-dfft-fortran-program","label":"Execute DFFT Fortran Program","html_id":"execute-dfft-fortran-program","implicit":true,"key":"xbuZtuQXWH"}],"key":"V1BNL2wviZ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The DFFT Fortran program will be executed on the data file that contains the time domain data of the combined signal.  The program will output the magnitude and phase of the Fourier transform of the signal into two separate files: DFFT_mag_file.dat and DFFT_phase_file.dat.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PVMiJRfOyY"}],"key":"QyHuCKOhMu"}],"key":"adKN6gjyPE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nexec_status = os.system(\"./dfft 2sineXHz.dat DFFT_mag_file.dat DFFT_phase_file.dat 20000 10 > log.txt\")","key":"nPcUylZKUj"},{"type":"outputs","id":"mTBzFv5-FkDVDaAisgw5o","children":[],"key":"bI94XjQtCS"}],"key":"IYDTk9g9rN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the DFFT Program Output","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B7kvH207dY"}],"identifier":"plot-the-dfft-program-output","label":"Plot the DFFT Program Output","html_id":"plot-the-dfft-program-output","implicit":true,"key":"zj3t9NR0gX"}],"key":"hummHmgW6r"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"DFFT_mag_raw_data = np.loadtxt('DFFT_mag_file.dat')\nDFFT_phase_raw_data = np.loadtxt('DFFT_phase_file.dat')","key":"dhpKtC1EYj"},{"type":"outputs","id":"xJ5muziDTxaUSBqhR8jWW","children":[],"key":"XVI4Am3AvY"}],"key":"D5TcVrCUBG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Get the frequency bins\nDFFT_freq_bins = [row[1] for row in DFFT_mag_raw_data]","key":"lwrOEYgPuH"},{"type":"outputs","id":"_ee6uft9_2cYn8HHLRnJZ","children":[],"key":"Qzny5GE6U9"}],"key":"pWB8JkSaF8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Get the magnitude data\nDFFT_mag_data = [row[0] for row in DFFT_mag_raw_data]","key":"KxYRoZwzeq"},{"type":"outputs","id":"nt75O5m8Q5FeDjceCw_kl","children":[],"key":"OPbFA095GW"}],"key":"VHeEtTdOrD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Plot the magnitude data\nsetup_graph(x_label='frequency [Hz]', y_label='amplitude [arbitrary]', \n            title='Frequency Domain', fig_size=(12,6))\nplt.plot(DFFT_freq_bins, DFFT_mag_data, 'r', label = 'DFFT Program Output')\nplt.plot(frequencies, magnitude, linestyle='--', color='blue', alpha=0.5, label = 'Python FFT Output')\nplt.legend()\nplt.xlim(0, 200)\nplt.ylim(0, 10)\nplt.show()","key":"XIRbSrtkLg"},{"type":"outputs","id":"agEWxJhZWq4A7DymOiCF_","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3d6d6443302baf188c00067252de8329","path":"/3d6d6443302baf188c00067252de8329.png"},"text/plain":{"content":"<Figure size 1200x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"mQIML91GkW"}],"key":"VunvUidmAz"}],"key":"r2mNoKKeOP"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Discussion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qIGz6uRJUl"}],"identifier":"discussion","label":"Discussion","html_id":"discussion","implicit":true,"key":"z0cagTkWnI"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"When we compare the Python program output to the DFFT program output, we see that the magnitude and phase of the Fourier transform of the signal are almost the same.  The slight differences are due to the leakage of some of the energy of the signal into the neighboring frequency bins.  This is a common problem when using the Fourier transform to analyze signals.  The leakage can be reduced by using a window function to taper the signal before taking the Fourier transform.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Ml42DrCR7e"}],"key":"x2qS6XAWQg"}],"key":"oC7TUteKAU"}],"key":"xG6Sfe0Agw"},"references":{"cite":{"order":[],"data":{}}}}