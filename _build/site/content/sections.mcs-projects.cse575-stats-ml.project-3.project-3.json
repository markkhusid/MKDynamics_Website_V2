{"version":3,"kind":"Notebook","sha256":"715e6873e0599e65ac30ca7258f6da3577b86289b28b059b186321502a9471aa","slug":"sections.mcs-projects.cse575-stats-ml.project-3.project-3","location":"/Sections/MCS_Projects/CSE575_Stats_ML/Project_3/Project_3.ipynb","dependencies":[],"frontmatter":{"title":"CSE572 Statistical Machine Learning - Project 3 - Classification Using Neural Networks and Deep Learning Project","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Mark Khusid","given":"Mark","family":"Khusid"},"name":"Mark Khusid","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/markkhusid/MKDynamics_Website_V2","numbering":{"title":{"offset":2}},"source_url":"https://github.com/markkhusid/MKDynamics_Website_V2/blob/master/Sections/MCS_Projects/CSE575_Stats_ML/Project_3/Project_3.ipynb","edit_url":"https://github.com/markkhusid/MKDynamics_Website_V2/edit/master/Sections/MCS_Projects/CSE575_Stats_ML/Project_3/Project_3.ipynb","exports":[{"format":"ipynb","filename":"Project_3.ipynb","url":"/Project_3-39d2f30e77412c63b8aaad6ae42e9d86.ipynb"}]},"widgets":{"application/vnd.jupyter.widget-state+json":{"state":{},"version_major":2,"version_minor":0}},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Import Libraries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lrZYAQwYEg"}],"identifier":"import-libraries","label":"Import Libraries","html_id":"import-libraries","implicit":true,"key":"JMjnruL5hH"}],"key":"P7pOFM2Mxy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import warnings\nwarnings.filterwarnings(\"ignore\")\nimport keras\nfrom tensorflow.keras.utils import to_categorical\nfrom keras.datasets import mnist\nfrom keras.models import Sequential\nfrom keras.layers import Dense, Dropout, Flatten\nfrom keras.layers import Conv2D, MaxPooling2D\nfrom keras import backend as K\nimport tensorflow as tf\n\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import confusion_matrix, ConfusionMatrixDisplay\n\nimport os\nimport multiprocessing\n\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n","key":"CPFQuZQ6Ya"},{"type":"outputs","id":"F7gf0_dCoRAZGl0qmtrhv","children":[],"key":"hihrTQeS2X"}],"key":"xfJ1gtkJjl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Problem Solution","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GlBFlQiDbe"}],"identifier":"problem-solution","label":"Problem Solution","html_id":"problem-solution","implicit":true,"key":"scQeDgn1Y8"}],"key":"pdkSZimEVJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Show Compute Environment","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"V0DF521pVo"}],"identifier":"show-compute-environment","label":"Show Compute Environment","html_id":"show-compute-environment","implicit":true,"key":"Sgr8SQbVL7"}],"key":"P2hihREMwn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Number of logical CPUs\nnum_cores = multiprocessing.cpu_count()\nprint(f\"Number of CPU cores available: {num_cores}\")\n\n# Number of GPUs\nprint(\"Num GPUs Available:\", len(tf.config.list_physical_devices('GPU')))","key":"KCIaqHrice"},{"type":"outputs","id":"ZfC6u4QjEZ9YJnc15JGV2","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Number of CPU cores available: 16\nNum GPUs Available: 1\n"},"children":[],"key":"wDGGCneQje"}],"key":"U647iDpE8d"}],"key":"QowsWQht4E"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Batch Size","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MLfrbBbmpc"}],"identifier":"define-batch-size","label":"Define Batch Size","html_id":"define-batch-size","implicit":true,"key":"zR4kfKVJWh"}],"key":"cz0Hl4jPOB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"batch_size = 64","key":"MYOkQW8AXt"},{"type":"outputs","id":"G-WvFaXPCSsR6SPxGX-W1","children":[],"key":"IrWxRzM0Qg"}],"key":"BezFULKjaw"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Number of Classes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vYYWmuZzFy"}],"identifier":"define-number-of-classes","label":"Define Number of Classes","html_id":"define-number-of-classes","implicit":true,"key":"aMzARRXWhS"}],"key":"jpuXl9rdd9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"num_classes = 10","key":"Mm8gUucwjw"},{"type":"outputs","id":"iXXUDgXfwCKobV9kPS7AQ","children":[],"key":"BF2PqKbTVi"}],"key":"eFtWeJURWe"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Number of Training Epochs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OpaUMDXA93"}],"identifier":"define-number-of-training-epochs","label":"Define Number of Training Epochs","html_id":"define-number-of-training-epochs","implicit":true,"key":"C23jFYWttj"}],"key":"Eogf7XQtuP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"epochs = 12","key":"aUkiRxCDk9"},{"type":"outputs","id":"4lMhEPR2LfVgGvmwUa3bs","children":[],"key":"x4Rh8hq9zW"}],"key":"cjsneo3x39"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Image Dimensions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DZpR2xxITS"}],"identifier":"define-image-dimensions","label":"Define Image Dimensions","html_id":"define-image-dimensions","implicit":true,"key":"BTWlnGGJFL"}],"key":"r9DMzTAb4C"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# input image dimensions\nimg_rows, img_cols = 28, 28","key":"GYdWfRAV49"},{"type":"outputs","id":"EJnV84VK9NhIHfM56jnDe","children":[],"key":"P1PdF3pY3K"}],"key":"synxIRvtGC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Kernel Size (Updated from (3,3) Baseline to (5,5) Task 2)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"drlLhX3TIq"}],"identifier":"define-kernel-size-updated-from-3-3-baseline-to-5-5-task-2","label":"Define Kernel Size (Updated from (3,3) Baseline to (5,5) Task 2)","html_id":"define-kernel-size-updated-from-3-3-baseline-to-5-5-task-2","implicit":true,"key":"TaWRupmzPq"}],"key":"STPKzlzG9M"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"kernel_size = (5,5)","key":"ZAmizLamUb"},{"type":"outputs","id":"_dS9lLfqTOWmVAG8fKScH","children":[],"key":"HKonweND9n"}],"key":"MphUbIhjw6"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Pooling Size","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O4GGsEmBGB"}],"identifier":"define-pooling-size","label":"Define Pooling Size","html_id":"define-pooling-size","implicit":true,"key":"fEDaZSB7YZ"}],"key":"i3U54LVTwz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pool_size = (2,2)","key":"BLsqz9iNVS"},{"type":"outputs","id":"hGEFXMr4R085wTQ-HQ7OX","children":[],"key":"jPPPcivt2t"}],"key":"mHZACaXX88"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load Data and Train / Test Split","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gIZXYkskHo"}],"identifier":"load-data-and-train-test-split","label":"Load Data and Train / Test Split","html_id":"load-data-and-train-test-split","implicit":true,"key":"ebGLpyWXJv"}],"key":"Mv4jmU69dQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# the data, split between train and test sets\n(x_train, y_train), (x_test, y_test)=tf.keras.datasets.mnist.load_data('mnist.npz')","key":"hMicMSVl9Q"},{"type":"outputs","id":"qLqBRgTtCVPiyEU0yi6Qo","children":[],"key":"b4ZCOM8aG8"}],"key":"N4ngttUqUA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_train.shape","key":"qYXVESn0Fi"},{"type":"outputs","id":"TxR39NcAxmrUWS1ZikMpf","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"(60000, 28, 28)","content_type":"text/plain"}}},"children":[],"key":"VkzxgLKpuY"}],"key":"c5qKWrUxsH"}],"key":"V5YTwPmOUB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_train.shape","key":"lhbj7nHVOd"},{"type":"outputs","id":"kxrCvhbvPPPjoE898DtLm","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"(60000,)","content_type":"text/plain"}}},"children":[],"key":"X4OaoEih9K"}],"key":"q7rt1R0mWu"}],"key":"dIoI0nQsn8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_test.shape","key":"JqBcZUPieY"},{"type":"outputs","id":"cprjjtEGQTmoDvCuaJiDB","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"(10000, 28, 28)","content_type":"text/plain"}}},"children":[],"key":"Yn2QmE4mEW"}],"key":"M8idUoGuvz"}],"key":"u0xhtsxMnw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_test.shape","key":"gEh3Mloc5P"},{"type":"outputs","id":"6wcvgSvzpidDw7EUmo3ad","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/plain":{"content":"(10000,)","content_type":"text/plain"}}},"children":[],"key":"rYfuxqX8A4"}],"key":"FzsmNtGBpv"}],"key":"OArZIjcm6s"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"EDA on Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wffMRD9uYZ"}],"identifier":"eda-on-data","label":"EDA on Data","html_id":"eda-on-data","implicit":true,"key":"UdWjZSFqWb"}],"key":"cFOr6KAK7E"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize First Train Image","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IOmNfoI9rC"}],"identifier":"visualize-first-train-image","label":"Visualize First Train Image","html_id":"visualize-first-train-image","implicit":true,"key":"MhUKJzKUOV"}],"key":"OwabtJV9KD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ticks = np.arange(0, 28+2, 2)\n#ticks","key":"moFjwRVcVh"},{"type":"outputs","id":"sCqG_it5iboDTZ3BdjWks","children":[],"key":"CQ4HY1r4lS"}],"key":"dlCUjymtn0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.imshow(x_train[0], cmap='grey')\nplt.xlim(0, 28)\nplt.xticks(ticks=ticks)\nplt.yticks(ticks=ticks)\nplt.show()","key":"krwNmd5ZbA"},{"type":"outputs","id":"EsI2UxyffgU96REBtIqQw","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6307c9063d2a896beafa2689ed8da5df","path":"/6307c9063d2a896beafa2689ed8da5df.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"cORCo2Dsvg"}],"key":"XzSF8PRQAU"}],"key":"mLrwbUbohV"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize the First 10 X Train Images","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dPE4QAb2ej"}],"identifier":"visualize-the-first-10-x-train-images","label":"Visualize the First 10 X Train Images","html_id":"visualize-the-first-10-x-train-images","implicit":true,"key":"MaS7Nlrbfg"}],"key":"ZP8aOGt3mG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Display the first 10 images\nnum_images_to_display = 10\nplt.figure(figsize=(10, 5))  # Adjust the figure size\n\nfor i in range(num_images_to_display):\n    plt.subplot(2, 5, i + 1)  # Create a 2x5 grid for 10 images\n    plt.imshow(x_train[i], cmap='gray')  # Display each image\n    plt.title(f'Train Image {i + 1}')\n    plt.axis('off')  # Hide axes for better visualization\n\nplt.tight_layout()\nplt.show()","key":"PgYv8y3oHq"},{"type":"outputs","id":"TegLrrYdfJvShewiuMV-b","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7ce587a1409319f6f079817b9548c2b6","path":"/7ce587a1409319f6f079817b9548c2b6.png"},"text/plain":{"content":"<Figure size 1000x500 with 10 Axes>","content_type":"text/plain"}}},"children":[],"key":"VflRSG4aYB"}],"key":"NpU0awzExX"}],"key":"DGzT14CDZa"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Print the First 10 Y Train Class Labels","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LQFIpr4ooi"}],"identifier":"print-the-first-10-y-train-class-labels","label":"Print the First 10 Y Train Class Labels","html_id":"print-the-first-10-y-train-class-labels","implicit":true,"key":"NhkLqREfrI"}],"key":"kvzCTL6YBx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_train[0:10]","key":"ksereAlniz"},{"type":"outputs","id":"zaMY29yYiAK5Ugzh-luFf","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/plain":{"content":"array([5, 0, 4, 1, 9, 2, 1, 3, 1, 4], dtype=uint8)","content_type":"text/plain"}}},"children":[],"key":"VR3LWqZDHw"}],"key":"dRJbm9nPW0"}],"key":"ARlh9NEjSq"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize the First X 10 Test Images","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Y3VL4jUPdi"}],"identifier":"visualize-the-first-x-10-test-images","label":"Visualize the First X 10 Test Images","html_id":"visualize-the-first-x-10-test-images","implicit":true,"key":"lh4a8WUYhQ"}],"key":"RsOShW4Jm6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Display the first 10 images\nnum_images_to_display = 10\nplt.figure(figsize=(10, 5))  # Adjust the figure size\n\nfor i in range(num_images_to_display):\n    plt.subplot(2, 5, i + 1)  # Create a 2x5 grid for 10 images\n    plt.imshow(x_test[i], cmap='gray')  # Display each image\n    plt.title(f'Test Image {i + 1}')\n    plt.axis('off')  # Hide axes for better visualization\n\nplt.tight_layout()\nplt.show()","key":"QsSFdBDKDK"},{"type":"outputs","id":"Rtld0oPY61dfl8RT_U_DR","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0e370b8936aebd53b2df30837226df74","path":"/0e370b8936aebd53b2df30837226df74.png"},"text/plain":{"content":"<Figure size 1000x500 with 10 Axes>","content_type":"text/plain"}}},"children":[],"key":"T2bzuGn38w"}],"key":"NCDjT52xQi"}],"key":"gUnWf392uG"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Print the First 10 Y Test Class Labels","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZBnIsKQxlU"}],"identifier":"print-the-first-10-y-test-class-labels","label":"Print the First 10 Y Test Class Labels","html_id":"print-the-first-10-y-test-class-labels","implicit":true,"key":"ZCK1rvUbEk"}],"key":"Shrwye8hTE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_test[0:10]","key":"U9iReooYKL"},{"type":"outputs","id":"iwmMErphxFIFtzcBRDd7u","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"array([7, 2, 1, 0, 4, 1, 4, 9, 5, 9], dtype=uint8)","content_type":"text/plain"}}},"children":[],"key":"N5u0nL1nsg"}],"key":"kJ7ijh1CRx"}],"key":"cQNbLrjuB5"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Reformat Data if Necessary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oczuwK2fvM"}],"identifier":"reformat-data-if-necessary","label":"Reformat Data if Necessary","html_id":"reformat-data-if-necessary","implicit":true,"key":"LWQ8mtvoZw"}],"key":"aNj0rgbk5C"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"if K.image_data_format() == 'channels_first':\n    x_train = x_train.reshape(x_train.shape[0], 1, img_rows, img_cols)\n    x_test = x_test.reshape(x_test.shape[0], 1, img_rows, img_cols)\n    input_shape = (1, img_rows, img_cols)\nelse:\n    x_train = x_train.reshape(x_train.shape[0], img_rows, img_cols, 1)\n    x_test = x_test.reshape(x_test.shape[0], img_rows, img_cols, 1)\n    input_shape = (img_rows, img_cols, 1)","key":"FyRJyLb7uE"},{"type":"outputs","id":"I7ehOZ5JbY3wVZqyZlEHl","children":[],"key":"odMPniwLSV"}],"key":"fm0nKA6mRs"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_train.shape","key":"d2T1UrB7zI"},{"type":"outputs","id":"VLjuIWmIBdwXrTDGwAiOQ","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/plain":{"content":"(60000, 28, 28, 1)","content_type":"text/plain"}}},"children":[],"key":"xwf9rRVdU2"}],"key":"eszPtLahQU"}],"key":"ZNNBXLNUVc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_test.shape","key":"OicP6coXvp"},{"type":"outputs","id":"Ox3oWupLYdIrraATLvK6E","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"(10000, 28, 28, 1)","content_type":"text/plain"}}},"children":[],"key":"hEyZ5WnUQr"}],"key":"U4al5lNpVh"}],"key":"MRoib754ui"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cast and Normalize Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"azV6Y7pEKn"}],"identifier":"cast-and-normalize-data","label":"Cast and Normalize Data","html_id":"cast-and-normalize-data","implicit":true,"key":"TDfq6YFwc3"}],"key":"lV1K9t0Lok"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_train = x_train.astype('float32')\nx_test = x_test.astype('float32')\nx_train /= 255\nx_test /= 255","key":"Rja8dxKQ9f"},{"type":"outputs","id":"JxGAvQ4ToftRKaS7-CS2t","children":[],"key":"y8GqKnMYLb"}],"key":"zMe2j4eTFV"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Print Out Description of Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pi7IgXJ474"}],"identifier":"print-out-description-of-data","label":"Print Out Description of Data","html_id":"print-out-description-of-data","implicit":true,"key":"MHgE52j1WY"}],"key":"qpbggqdYig"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print('x_train shape:', x_train.shape)\nprint(x_train.shape[0], 'train samples')\nprint(x_test.shape[0], 'test samples')","key":"V69v6skXj2"},{"type":"outputs","id":"hgQAOuwMkn10BckH5ReiO","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"x_train shape: (60000, 28, 28, 1)\n60000 train samples\n10000 test samples\n"},"children":[],"key":"JkGc81MvAx"}],"key":"P1I4S43rMJ"}],"key":"OYTBesI2QI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Convert Class Vectors into Binary Class Matrices","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pu685YlJPk"}],"identifier":"convert-class-vectors-into-binary-class-matrices","label":"Convert Class Vectors into Binary Class Matrices","html_id":"convert-class-vectors-into-binary-class-matrices","implicit":true,"key":"fduyeAMKCL"}],"key":"XZVenNBHCU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# convert class vectors to binary class matrices\ny_train = to_categorical(y_train, num_classes)\ny_test = to_categorical(y_test, num_classes)","key":"SbkXEniggv"},{"type":"outputs","id":"Jea0cFn4t96jmu3B3grOv","children":[],"key":"bxDJ5DDbVe"}],"key":"A2VTUzHezx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_train.shape","key":"ukSjbHlHvU"},{"type":"outputs","id":"243TPhxLp1OwvjYI0QX-H","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/plain":{"content":"(60000, 10)","content_type":"text/plain"}}},"children":[],"key":"vVLpzDoKaI"}],"key":"i3RT1AAaIo"}],"key":"bM5kSn3tLS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_train[0:5]","key":"Mn9B8zNQBP"},{"type":"outputs","id":"XNSFsYbawhf4PAVH_0_dl","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/plain":{"content":"array([[0., 0., 0., 0., 0., 1., 0., 0., 0., 0.],\n       [1., 0., 0., 0., 0., 0., 0., 0., 0., 0.],\n       [0., 0., 0., 0., 1., 0., 0., 0., 0., 0.],\n       [0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],\n       [0., 0., 0., 0., 0., 0., 0., 0., 0., 1.]], dtype=float32)","content_type":"text/plain"}}},"children":[],"key":"KwYThETna4"}],"key":"MFxjZUZpZx"}],"key":"yIsvpLRfY0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_test.shape","key":"QtVuu2Jaru"},{"type":"outputs","id":"lRRiEywfa2O92PReXzLe6","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/plain":{"content":"(10000, 10)","content_type":"text/plain"}}},"children":[],"key":"NnHH0tEclA"}],"key":"aHEv3djiAE"}],"key":"xgXxiwFUWE"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_test[0:5]","key":"jMHjbkXKdb"},{"type":"outputs","id":"V3-j-UssistPokjQ16R8m","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/plain":{"content":"array([[0., 0., 0., 0., 0., 0., 0., 1., 0., 0.],\n       [0., 0., 1., 0., 0., 0., 0., 0., 0., 0.],\n       [0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],\n       [1., 0., 0., 0., 0., 0., 0., 0., 0., 0.],\n       [0., 0., 0., 0., 1., 0., 0., 0., 0., 0.]], dtype=float32)","content_type":"text/plain"}}},"children":[],"key":"lYDNx2VUI5"}],"key":"eo66mIDG2R"}],"key":"OtbO9bIZ7E"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create Task 2 Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gQKtNQucdV"}],"identifier":"create-task-2-model","label":"Create Task 2 Model","html_id":"create-task-2-model","implicit":true,"key":"oek6nATrRa"}],"key":"SmW0vnovJi"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Task 2 Model Type","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rwQhoPcxhQ"}],"identifier":"define-task-2-model-type","label":"Define Task 2 Model Type","html_id":"define-task-2-model-type","implicit":true,"key":"X7uWjlUgBP"}],"key":"MGjeEe0xN0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Artificial Neural Network\nmodel = Sequential()","key":"Ka4nRa4y6c"},{"type":"outputs","id":"pbDkFbeq9nJM5WULZZgUg","children":[],"key":"BFy2sYQhYA"}],"key":"q7SKp1Yqjy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model","key":"KxHod0CyvZ"},{"type":"outputs","id":"XN5pSbdIif_zcrI0WfEJH","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/plain":{"content":"<keras.engine.sequential.Sequential at 0x24a43f95730>","content_type":"text/plain"}}},"children":[],"key":"c10yl4DS2X"}],"key":"KQilBFn4Gh"}],"key":"p0Xdj5Gpk4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create Task 2 Model Structure","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DzBV86aBAx"}],"identifier":"create-task-2-model-structure","label":"Create Task 2 Model Structure","html_id":"create-task-2-model-structure","implicit":true,"key":"rVP82KSZ3d"}],"key":"hUf0iOdvZa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# First layer is a convolutional layer with 6 filters, each of size 3x3\nmodel.add(Conv2D(\n    filters=6, \n    kernel_size=kernel_size,\n    strides=(1, 1),\n    activation='relu',\n    input_shape=input_shape))\n\n# Second layer is a max pooling layer with a pool size of 2x2\nmodel.add(MaxPooling2D(\n    pool_size=pool_size,\n    strides=(1, 1)))\n\n# Third layer is a convolutional layer with 16 filters, each of size 3x3\nmodel.add(Conv2D(\n    filters=16, \n    kernel_size=kernel_size,\n    strides=(1, 1),\n    activation='relu'))\n\n# Fourth layer is a max pooling layer with a pool size of 2x2\nmodel.add(MaxPooling2D(\n    pool_size=pool_size,\n    strides=(1, 1)))\n\n# Fifth layer is a flatten layer\nmodel.add(Flatten())\n\n# Sixth layer is a dense layer with 120 units\nmodel.add(Dense(120, activation='relu'))\n\n# Seventh layer is a dense layer with 84 units\nmodel.add(Dense(84, activation='relu'))\n\n# Eighth layer is a dense layer with 10 units for 10 classes in the output layer\nmodel.add(Dense(num_classes, activation='softmax'))","key":"sWSUUtRXf4"},{"type":"outputs","id":"Ds3kEUps-pzFLxUDsH9Ys","children":[],"key":"AF0xk7o8dD"}],"key":"YE7XnF6w9i"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model","key":"dAYsfD2B8T"},{"type":"outputs","id":"payBEFWGNIdSo5opg3fwb","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"text/plain":{"content":"<keras.engine.sequential.Sequential at 0x24a43f95730>","content_type":"text/plain"}}},"children":[],"key":"BG4CcXA7Ku"}],"key":"JX3xRt5vmA"}],"key":"YxY2q0nQZ7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Task 2 Model Optimizer","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hkrRxJv6mt"}],"identifier":"define-task-2-model-optimizer","label":"Define Task 2 Model Optimizer","html_id":"define-task-2-model-optimizer","implicit":true,"key":"pVpUMcAIcf"}],"key":"BEw1K1Ccez"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"optim = tf.keras.optimizers.Adadelta(\n    learning_rate=0.1, \n    rho=0.95, \n    decay=0.0)","key":"GV8e76fC8K"},{"type":"outputs","id":"gP645aNICGlWRmll9EOCy","children":[],"key":"RjyM9re1wy"}],"key":"wh7dkFo4GC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"optim","key":"ahaE6HH9uo"},{"type":"outputs","id":"3vv7J4t5nPwiou_y1MTIg","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"text/plain":{"content":"<keras.optimizer_v2.adadelta.Adadelta at 0x24a42d01fd0>","content_type":"text/plain"}}},"children":[],"key":"d0HKlOyzTx"}],"key":"prgjUa3ry0"}],"key":"e9NK1ri4zm"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compile Task 2 Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WJD9YZWURz"}],"identifier":"compile-task-2-model","label":"Compile Task 2 Model","html_id":"compile-task-2-model","implicit":true,"key":"cH5srVhXbv"}],"key":"zAY7xxjcU1"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# https://keras.io/optimizers/ \nmodel.compile(loss=keras.losses.categorical_crossentropy,\n              optimizer=optim,\n              metrics=['accuracy'])","key":"OStfkSK7wK"},{"type":"outputs","id":"cSWf98FbroAuMEcuMoCEL","children":[],"key":"yyE1qBSQZq"}],"key":"Qrkpqdp7YT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model","key":"RWIjMPPEdB"},{"type":"outputs","id":"H4V2Z7kGIo7H_MGgHFs0W","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/plain":{"content":"<keras.engine.sequential.Sequential at 0x24a43f95730>","content_type":"text/plain"}}},"children":[],"key":"DoRJigRYy2"}],"key":"ExV3D6PDq0"}],"key":"xctl4dJygM"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Train Task 2 Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Vt2Q0ztFE8"}],"identifier":"train-task-2-model","label":"Train Task 2 Model","html_id":"train-task-2-model","implicit":true,"key":"DRzmX7ArjW"}],"key":"E0JegeGnhb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model_history = \\\n    model.fit(x_train, y_train,\n          batch_size=batch_size,\n          epochs=epochs,\n          verbose=2,\n          validation_data=(x_test, y_test))\n","key":"BXadwoxrBe"},{"type":"outputs","id":"Iqwb9dJET-G3sTjPGb3Qp","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Epoch 1/12\n938/938 - 10s - loss: 0.3448 - accuracy: 0.8967 - val_loss: 0.1091 - val_accuracy: 0.9694\nEpoch 2/12\n938/938 - 2s - loss: 0.0940 - accuracy: 0.9723 - val_loss: 0.0704 - val_accuracy: 0.9806\nEpoch 3/12\n938/938 - 2s - loss: 0.0659 - accuracy: 0.9804 - val_loss: 0.0575 - val_accuracy: 0.9809\nEpoch 4/12\n938/938 - 2s - loss: 0.0530 - accuracy: 0.9841 - val_loss: 0.0489 - val_accuracy: 0.9841\nEpoch 5/12\n938/938 - 2s - loss: 0.0451 - accuracy: 0.9865 - val_loss: 0.0571 - val_accuracy: 0.9808\nEpoch 6/12\n938/938 - 2s - loss: 0.0392 - accuracy: 0.9887 - val_loss: 0.0464 - val_accuracy: 0.9847\nEpoch 7/12\n938/938 - 2s - loss: 0.0352 - accuracy: 0.9895 - val_loss: 0.0358 - val_accuracy: 0.9885\nEpoch 8/12\n938/938 - 2s - loss: 0.0318 - accuracy: 0.9908 - val_loss: 0.0366 - val_accuracy: 0.9875\nEpoch 9/12\n938/938 - 2s - loss: 0.0291 - accuracy: 0.9911 - val_loss: 0.0323 - val_accuracy: 0.9889\nEpoch 10/12\n938/938 - 2s - loss: 0.0265 - accuracy: 0.9923 - val_loss: 0.0316 - val_accuracy: 0.9892\nEpoch 11/12\n938/938 - 2s - loss: 0.0240 - accuracy: 0.9930 - val_loss: 0.0335 - val_accuracy: 0.9887\nEpoch 12/12\n938/938 - 2s - loss: 0.0222 - accuracy: 0.9937 - val_loss: 0.0344 - val_accuracy: 0.9894\n"},"children":[],"key":"XsD7GS9XLz"}],"key":"EXbp2Rt1sM"}],"key":"J6uI88TGEh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model_history.history['loss']","key":"BT4aoeOw8B"},{"type":"outputs","id":"dA2A6st5DwRJrjQ1LL0nU","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/plain":{"content":"[0.34479445219039917,\n 0.09400391578674316,\n 0.0658968836069107,\n 0.05295504257082939,\n 0.04514137655496597,\n 0.03916701301932335,\n 0.03520461171865463,\n 0.03181973844766617,\n 0.029129598289728165,\n 0.026451660320162773,\n 0.024046970531344414,\n 0.022170674055814743]","content_type":"text/plain"}}},"children":[],"key":"sAjYKEJo06"}],"key":"JzhjPKpWJe"}],"key":"BER8EmZozM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model_history.history['accuracy']","key":"P5q02zqL90"},{"type":"outputs","id":"y2OUg9xD87BGllQ7jPki7","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"text/plain":{"content":"[0.8967000246047974,\n 0.9722999930381775,\n 0.9804333448410034,\n 0.9841333627700806,\n 0.9865333437919617,\n 0.9887333512306213,\n 0.9895333051681519,\n 0.9907500147819519,\n 0.9910500049591064,\n 0.9922666549682617,\n 0.992983341217041,\n 0.9937000274658203]","content_type":"text/plain"}}},"children":[],"key":"UTauN0SKv7"}],"key":"RJHto40PzF"}],"key":"tDdmYcCBaC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Save the Fitted Task 2 Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eVgSNaA530"}],"identifier":"save-the-fitted-task-2-model","label":"Save the Fitted Task 2 Model","html_id":"save-the-fitted-task-2-model","implicit":true,"key":"S508t7Y5PD"}],"key":"aFqUn5kDaB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model.save(\"fitted_task2_model.keras\")  # Save the model in HDF5 format\n\n# Save the history\nimport json\nwith open(\"fitted_task2_model_history.json\", \"w\") as f:\n    json.dump(model_history.history, f)","key":"OwVgTutqcn"},{"type":"outputs","id":"wtR42dzw8oAAwUAwTH4xk","children":[],"key":"EHsUMy5YD3"}],"key":"cZwsv9Ea18"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load the Model if Necessary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MZP22a1SBD"}],"identifier":"load-the-model-if-necessary","label":"Load the Model if Necessary","html_id":"load-the-model-if-necessary","implicit":true,"key":"KCtzM5A3XS"}],"key":"WGn6H8tKGe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#from keras.models import load_model\n\n#model = load_model(\"fitted_baseline_model.keras\")  # Load the saved model\n\n# Load the history\n#import json\n#with open(\"fitted_baseline_model_history.json\", \"r\") as f:\n#    model_history = json.load(f)","key":"gXoDVh5VVL"},{"type":"outputs","id":"-B3ozFtAUDpWlkLuUqqUY","children":[],"key":"z0boDMKPru"}],"key":"gqELvu80iT"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Get Model Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kOleVXbqxe"}],"identifier":"get-model-summary","label":"Get Model Summary","html_id":"get-model-summary","implicit":true,"key":"jX0FkEdLE8"}],"key":"uojFuHKilZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model.summary()","key":"w9UDXDLIM2"},{"type":"outputs","id":"-IjT9Z1FpNxcKFhSJiYYw","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Model: \"sequential\"\n_________________________________________________________________\nLayer (type)                 Output Shape              Param #   \n=================================================================\nconv2d (Conv2D)              (None, 24, 24, 6)         156       \n_________________________________________________________________\nmax_pooling2d (MaxPooling2D) (None, 23, 23, 6)         0         \n_________________________________________________________________\nconv2d_1 (Conv2D)            (None, 19, 19, 16)        2416      \n_________________________________________________________________\nmax_pooling2d_1 (MaxPooling2 (None, 18, 18, 16)        0         \n_________________________________________________________________\nflatten (Flatten)            (None, 5184)              0         \n_________________________________________________________________\ndense (Dense)                (None, 120)               622200    \n_________________________________________________________________\ndense_1 (Dense)              (None, 84)                10164     \n_________________________________________________________________\ndense_2 (Dense)              (None, 10)                850       \n=================================================================\nTotal params: 635,786\nTrainable params: 635,786\nNon-trainable params: 0\n_________________________________________________________________\n"},"children":[],"key":"TCqiFgEWmd"}],"key":"BkbkfVwZn0"}],"key":"NC4Pp9fLt7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Evaluate Task 2 Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YiFnY3nD3E"}],"identifier":"evaluate-task-2-model","label":"Evaluate Task 2 Model","html_id":"evaluate-task-2-model","implicit":true,"key":"UsBV6exl6z"}],"key":"Q4DxoRGslF"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Training Accuracy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NLTeAgDNav"}],"identifier":"training-accuracy","label":"Training Accuracy","html_id":"training-accuracy","implicit":true,"key":"FUkIQZr9dH"}],"key":"s1lxZoMK8V"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"loss_train, accuracy_train = model.evaluate(x_train, y_train)","key":"rBBdu4IGRE"},{"type":"outputs","id":"EabtBRgPsV2dQ_Trch9Zq","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"1875/1875 [==============================] - 3s 1ms/step - loss: 0.0209 - accuracy: 0.9940\n"},"children":[],"key":"RDuDnntuzF"}],"key":"Cbq422WKPx"}],"key":"RrDGzb5ot2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print('Print the training loss and the accuracy of the model on the dataset')\nprint('Train Loss: {0:0.4f} Train Accuracy: {1:0.4f}'.format(loss_train, accuracy_train))","key":"qU07BHk6AH"},{"type":"outputs","id":"hJfZbUHt_YP3W8TJAlKVB","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Print the training loss and the accuracy of the model on the dataset\nTrain Loss: 0.0209 Train Accuracy: 0.9940\n"},"children":[],"key":"Hdr428VuRp"}],"key":"lRkTozz15I"}],"key":"xkQ8cr6LZz"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Testing Accuracy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fDPPzm6pk8"}],"identifier":"testing-accuracy","label":"Testing Accuracy","html_id":"testing-accuracy","implicit":true,"key":"OuxhszbNXu"}],"key":"frnNLHV1Sv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"loss_test, accuracy_test = model.evaluate(x_test, y_test)","key":"xzB8qkbZ07"},{"type":"outputs","id":"z597nqohCRCfGVVmLAO2v","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"313/313 [==============================] - 1s 2ms/step - loss: 0.0344 - accuracy: 0.9894\n"},"children":[],"key":"wkUGTgC9R9"}],"key":"w1V2aDbI2e"}],"key":"BTkz5W55Av"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print('Print the testing loss and the accuracy of the model on the dataset')\nprint('Test Loss: {0:0.4f} Test Accuracy: {1:0.4f}'.format(loss_test, accuracy_test))","key":"aD1Ig0VAkq"},{"type":"outputs","id":"zoQJc9n_lOSWjEJShPi4R","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Print the testing loss and the accuracy of the model on the dataset\nTest Loss: 0.0344 Test Accuracy: 0.9894\n"},"children":[],"key":"G8gF5eDR2r"}],"key":"IVtQCeNm3W"}],"key":"gpJp6jhkBB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#score = model.evaluate(x_test, y_test, verbose=0)\n#print('Test loss:', score[0])\n#print('Test accuracy:', score[1])","key":"NOMBtj1cPy"},{"type":"outputs","id":"mcX2BaBVr1DX90-PdROK1","children":[],"key":"Snp5h1zVj5"}],"key":"JJhcx3Ztiz"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Use Model to Make Predictions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XY0NWiSnnZ"}],"identifier":"use-model-to-make-predictions","label":"Use Model to Make Predictions","html_id":"use-model-to-make-predictions","implicit":true,"key":"eVIhrbh1rP"}],"key":"M6dXmjcC8u"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"########################################\n# Making predictions and evaluating the model\n#######################################\n\n# Predicting the Test set results\ny_pred = model.predict(x_test)\ny_pred[y_pred > 0.9] = 1","key":"vNico1kPFR"},{"type":"outputs","id":"PXJ1X7IJzZABveYld6AbH","children":[],"key":"jp8491ndV9"}],"key":"KaaAuogY7p"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_pred[y_pred > 0.9] = 1\ny_pred[y_pred <= 0.9] = 0","key":"K2XdnTZtU5"},{"type":"outputs","id":"dmov6-DgQYIyj1w_oTnUs","children":[],"key":"VQrkGKTc8c"}],"key":"sfpwRw9Hxr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_pred.shape","key":"aEcb3Yf5Cs"},{"type":"outputs","id":"d6InHJPohNSwzEWAm5xNc","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"text/plain":{"content":"(10000, 10)","content_type":"text/plain"}}},"children":[],"key":"PUVvC84pyC"}],"key":"J9z2WMEDxO"}],"key":"oLTArJIKwX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_pred[0]","key":"FBrgRNKbVj"},{"type":"outputs","id":"Z7G3HH7d_LOtIlZoylhAp","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":52,"metadata":{},"data":{"text/plain":{"content":"array([0., 0., 0., 0., 0., 0., 0., 1., 0., 0.], dtype=float32)","content_type":"text/plain"}}},"children":[],"key":"oEdO4rjKFO"}],"key":"SKCAJZF3Y1"}],"key":"sj1sxLzvpz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# summarize the middle 5 cases in a table\n\nfor i in range(15,20):\n    print('actual   ', end=' ')\n    for j in range(10):\n        print('{:.1f}'.format(y_test[i][j]), end=' ')\n    print()\n    print('predicted', end=' ')\n    for j in range(10):\n        print('{:.1f}'.format(y_pred[i][j]), end=' ')\n    print()\n    print()","key":"Q2IqEO3Oxo"},{"type":"outputs","id":"4CqNW9MFQYOibvPONuwno","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"actual    0.0 0.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 \npredicted 0.0 0.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 \n\nactual    0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0 \npredicted 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0 \n\nactual    0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0 0.0 0.0 \npredicted 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0 0.0 0.0 \n\nactual    0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 \npredicted 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 \n\nactual    0.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 0.0 \npredicted 0.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 0.0 \n\n"},"children":[],"key":"fmqQIVWx9j"}],"key":"WSPMYYgYXs"}],"key":"PCHGysoKZO"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Making the Confusion Matrix","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DelcQHbROH"}],"identifier":"making-the-confusion-matrix","label":"Making the Confusion Matrix","html_id":"making-the-confusion-matrix","implicit":true,"key":"asb1GyW8M0"}],"key":"lw6sS1PWZZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_pred[0]","key":"cVPiNSVTUj"},{"type":"outputs","id":"b7GjNDT-t1zwj9mGOJLbV","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":54,"metadata":{},"data":{"text/plain":{"content":"array([0., 0., 0., 0., 0., 0., 0., 1., 0., 0.], dtype=float32)","content_type":"text/plain"}}},"children":[],"key":"o2OS2CyLVR"}],"key":"vZVgnP9vi9"}],"key":"cwanh2YNUX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_test[0]","key":"fetke45a6q"},{"type":"outputs","id":"yXVNt-H9l60zDy1DzRSj8","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":55,"metadata":{},"data":{"text/plain":{"content":"array([0., 0., 0., 0., 0., 0., 0., 1., 0., 0.], dtype=float32)","content_type":"text/plain"}}},"children":[],"key":"vxirIqNPKY"}],"key":"O81PhgLy1J"}],"key":"vwSdOWnoo0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_pred.shape","key":"k9OBwIy5YM"},{"type":"outputs","id":"kVnv-Rk0f2ZKJfMjfjwQ1","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":56,"metadata":{},"data":{"text/plain":{"content":"(10000, 10)","content_type":"text/plain"}}},"children":[],"key":"xAy6rEPz15"}],"key":"tDbQa1qxxv"}],"key":"hMjp27UKO6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_test.shape","key":"ObjwcYxmxc"},{"type":"outputs","id":"k0o-ipps-xaKh9CLLxmr8","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":57,"metadata":{},"data":{"text/plain":{"content":"(10000, 10)","content_type":"text/plain"}}},"children":[],"key":"sTLUKYrOUE"}],"key":"zoABIC6M87"}],"key":"rStRPWqNsg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Convert one-hot encoded arrays to label indices\ny_pred_labels = np.argmax(y_pred, axis=1)\ny_test_labels = np.argmax(y_test, axis=1)","key":"zo4q3FpC5L"},{"type":"outputs","id":"aH3wk_WBk3Auzprit3FpG","children":[],"key":"QZ5yZnGNRn"}],"key":"kAYROeCePV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_pred_labels[0:15]","key":"yqhfBXaNxF"},{"type":"outputs","id":"SvzLZOEHPo5pRTyFsrKPG","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":59,"metadata":{},"data":{"text/plain":{"content":"array([7, 2, 1, 0, 4, 1, 4, 9, 5, 9, 0, 6, 9, 0, 1], dtype=int64)","content_type":"text/plain"}}},"children":[],"key":"rMEqAETKo7"}],"key":"onpMt4FH7D"}],"key":"KoaCnotzfu"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_test_labels[0:15]","key":"vNzUnHdxBp"},{"type":"outputs","id":"kTbiyrUWtWWtO_ZZvQ1Wy","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":60,"metadata":{},"data":{"text/plain":{"content":"array([7, 2, 1, 0, 4, 1, 4, 9, 5, 9, 0, 6, 9, 0, 1], dtype=int64)","content_type":"text/plain"}}},"children":[],"key":"CPMn0ExKJB"}],"key":"Md0aqBAB6M"}],"key":"kNxAwGqTNU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Making the Confusion Matrix\ncm = confusion_matrix(y_test_labels, y_pred_labels)\nprint('Print the Confusion Matrix:')\nprint(cm)","key":"w6k385nx8k"},{"type":"outputs","id":"GUYKA4jCdT5zZfD30qabe","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Print the Confusion Matrix:\n[[ 977    0    0    0    0    0    1    1    1    0]\n [   8 1127    0    0    0    0    0    0    0    0]\n [  30    2  998    0    1    0    0    1    0    0]\n [  25    0    0  985    0    0    0    0    0    0]\n [  30    0    0    0  951    0    0    0    0    1]\n [  23    0    0    1    0  867    1    0    0    0]\n [  34    1    0    0    1    3  919    0    0    0]\n [  31    0    1    0    0    0    0  996    0    0]\n [  56    0    2    1    0    0    0    2  911    2]\n [  41    2    0    0    1    0    0    0    0  965]]\n"},"children":[],"key":"LY8YUE41Q7"}],"key":"ot8AhJ98re"}],"key":"YaRs1eD5Tj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(classification_report(y_test_labels, y_pred_labels))","key":"AmYYTWHRe1"},{"type":"outputs","id":"bB5qZzJAXfEZBlWPrl4Yo","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"              precision    recall  f1-score   support\n\n           0       0.78      1.00      0.87       980\n           1       1.00      0.99      0.99      1135\n           2       1.00      0.97      0.98      1032\n           3       1.00      0.98      0.99      1010\n           4       1.00      0.97      0.98       982\n           5       1.00      0.97      0.98       892\n           6       1.00      0.96      0.98       958\n           7       1.00      0.97      0.98      1028\n           8       1.00      0.94      0.97       974\n           9       1.00      0.96      0.98      1009\n\n    accuracy                           0.97     10000\n   macro avg       0.98      0.97      0.97     10000\nweighted avg       0.98      0.97      0.97     10000\n\n"},"children":[],"key":"TVb1I4qQs7"}],"key":"wAlePza6cS"}],"key":"ajSUqYlXDC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"disp = ConfusionMatrixDisplay(confusion_matrix=cm, display_labels=np.arange(10))\ndisp.plot()\nplt.savefig('confusion_matrix_baseline.png')\nplt.show()","key":"xRxDlbaLaM"},{"type":"outputs","id":"t9CJIS1XOFeEbaXBPMg5q","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fd43804ac8b6851f52b02e2fd04b6cf6","path":"/fd43804ac8b6851f52b02e2fd04b6cf6.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"GEVJfjHXUj"}],"key":"vXX3AoakSo"}],"key":"RHn00bm3nw"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot The Accuracy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fVpWmyZZlE"}],"identifier":"plot-the-accuracy","label":"Plot The Accuracy","html_id":"plot-the-accuracy","implicit":true,"key":"GyR09Z4ylv"}],"key":"z6dNsbX41e"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print('Plot the accuracy')\n# Keras 2.2.4 recognizes 'acc' and 2.3.1 recognizes 'accuracy'\n# use the command python -c 'import keras; print(keras.__version__)' on MAC or Linux to check Keras' version\nplt.plot(model_history.history['accuracy'], label='Training Accuracy')\n#plt.plot(model_history.history['val_accuracy'], label='Validation Accuracy')\nplt.title('5x5 Kernel Model Accuracy')\nplt.ylabel('Accuracy')\nplt.xlabel('Epoch')\nplt.yticks(np.arange(0.9, 1.2, step=0.01))\nplt.xticks(np.arange(0, 14, step=1))\nplt.ylim(0.9, 1)\nplt.xlim(0, 12)\nplt.grid()\nplt.legend(loc='lower right')\nplt.savefig('task2_model_accuracy.png')\nplt.show()","key":"aiX2fZT85C"},{"type":"outputs","id":"LjJiH0qCyeGEHvVFtUnqZ","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Plot the accuracy\n"},"children":[],"key":"BgvTcB87we"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6bf65c0e421032d74a4445f892d110fe","path":"/6bf65c0e421032d74a4445f892d110fe.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"jcfPUVJaGx"}],"key":"SZbadSX046"}],"key":"dBnxQyCSIk"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the Loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tG98zKbQvA"}],"identifier":"plot-the-loss","label":"Plot the Loss","html_id":"plot-the-loss","implicit":true,"key":"qCAmwyZK1h"}],"key":"ewW5xFzzDm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print('Plot the loss')\nplt.plot(model_history.history['loss'], label='Training Loss')\n#plt.plot(model_history.history['val_loss'], label='Validation Loss')\nplt.title('5x5 Kernel Model Loss')\nplt.ylabel('Loss')\nplt.xlabel('Epoch')\nplt.yticks(np.arange(0, 0.40, step=0.025))\nplt.xticks(np.arange(0, 14, step=1))\nplt.ylim(0, 0.35)\nplt.xlim(0, 12)\nplt.grid()\nplt.legend(loc='upper right')\nplt.savefig('task2_model_loss.png')\nplt.show()","key":"dw8W9Fd9oM"},{"type":"outputs","id":"V2_Qrj-Ec7XBbXvoJb7G5","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Plot the loss\n"},"children":[],"key":"gAvevJZ06R"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c291a9c8546889c28e64337088e46501","path":"/c291a9c8546889c28e64337088e46501.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"Dn0K1BIStS"}],"key":"TKplGKTCsO"}],"key":"PwSkaYutJu"}],"key":"wSTu1cbiqU"},"references":{"cite":{"order":[],"data":{}}}}