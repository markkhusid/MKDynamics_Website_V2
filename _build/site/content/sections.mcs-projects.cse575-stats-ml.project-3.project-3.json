{"version":3,"kind":"Notebook","sha256":"715e6873e0599e65ac30ca7258f6da3577b86289b28b059b186321502a9471aa","slug":"sections.mcs-projects.cse575-stats-ml.project-3.project-3","location":"/Sections/MCS_Projects/CSE575_Stats_ML/Project_3/Project_3.ipynb","dependencies":[],"frontmatter":{"title":"CSE572 Statistical Machine Learning - Project 3 - Classification Using Neural Networks and Deep Learning Project","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Mark Khusid","given":"Mark","family":"Khusid"},"name":"Mark Khusid","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/markkhusid/MKDynamics_Website_V2","numbering":{"title":{"offset":3}},"source_url":"https://github.com/markkhusid/MKDynamics_Website_V2/blob/master/Sections/MCS_Projects/CSE575_Stats_ML/Project_3/Project_3.ipynb","edit_url":"https://github.com/markkhusid/MKDynamics_Website_V2/edit/master/Sections/MCS_Projects/CSE575_Stats_ML/Project_3/Project_3.ipynb","exports":[{"format":"ipynb","filename":"Project_3.ipynb","url":"/Project_3-39d2f30e77412c63b8aaad6ae42e9d86.ipynb"}]},"widgets":{"application/vnd.jupyter.widget-state+json":{"state":{},"version_major":2,"version_minor":0}},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Import Libraries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z2Ilu7Y2r9"}],"identifier":"import-libraries","label":"Import Libraries","html_id":"import-libraries","implicit":true,"key":"eQBUuJrNHx"}],"key":"fUeCUkX0IO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import warnings\nwarnings.filterwarnings(\"ignore\")\nimport keras\nfrom tensorflow.keras.utils import to_categorical\nfrom keras.datasets import mnist\nfrom keras.models import Sequential\nfrom keras.layers import Dense, Dropout, Flatten\nfrom keras.layers import Conv2D, MaxPooling2D\nfrom keras import backend as K\nimport tensorflow as tf\n\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import confusion_matrix, ConfusionMatrixDisplay\n\nimport os\nimport multiprocessing\n\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\n","key":"ZbxaNT8ur7"},{"type":"outputs","id":"e0HC2GnCoXMpiXfASU2MS","children":[],"key":"a0EPQyGIzO"}],"key":"GL45FAZfMN"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Problem Solution","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ytXLGoi20j"}],"identifier":"problem-solution","label":"Problem Solution","html_id":"problem-solution","implicit":true,"key":"DyoxlOOunP"}],"key":"hYZGj95aYd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Show Compute Environment","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D7PFo4EkTS"}],"identifier":"show-compute-environment","label":"Show Compute Environment","html_id":"show-compute-environment","implicit":true,"key":"vEQANK1DoC"}],"key":"ujoJjU6SNd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Number of logical CPUs\nnum_cores = multiprocessing.cpu_count()\nprint(f\"Number of CPU cores available: {num_cores}\")\n\n# Number of GPUs\nprint(\"Num GPUs Available:\", len(tf.config.list_physical_devices('GPU')))","key":"rQO27fiePQ"},{"type":"outputs","id":"D7wsrLqHol0eEoLI0mMPC","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Number of CPU cores available: 16\nNum GPUs Available: 1\n"},"children":[],"key":"Ys74Ib6uQe"}],"key":"Pv1DvL47d1"}],"key":"lgjToM4olR"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Batch Size","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MKUNW6I7eA"}],"identifier":"define-batch-size","label":"Define Batch Size","html_id":"define-batch-size","implicit":true,"key":"kUliTjF3UB"}],"key":"M3lYuunxt4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"batch_size = 64","key":"gX53kqPVAk"},{"type":"outputs","id":"jnKf40BQw5d6nzUJm8iMU","children":[],"key":"l6iGEVJyXb"}],"key":"PT6zYAZHCf"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Number of Classes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"IHR6ZwYDYX"}],"identifier":"define-number-of-classes","label":"Define Number of Classes","html_id":"define-number-of-classes","implicit":true,"key":"vHF6WnA82p"}],"key":"JnrRgld7yU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"num_classes = 10","key":"MyPawOYXNn"},{"type":"outputs","id":"WbSVOqSPbVtudR5igs6r5","children":[],"key":"jFU8q8mNyb"}],"key":"gI8SAjzqGr"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Number of Training Epochs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MxoVXWzEx6"}],"identifier":"define-number-of-training-epochs","label":"Define Number of Training Epochs","html_id":"define-number-of-training-epochs","implicit":true,"key":"ZrC6k9lz2H"}],"key":"LAkIdprU6y"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"epochs = 12","key":"tqVvX9IZut"},{"type":"outputs","id":"nd3Bz_VJkDfdEMFbrIZ4F","children":[],"key":"DH6PWIPRlO"}],"key":"KDgEm2AwQ3"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Image Dimensions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PvpfpXFKdS"}],"identifier":"define-image-dimensions","label":"Define Image Dimensions","html_id":"define-image-dimensions","implicit":true,"key":"TvpBILmGB8"}],"key":"I4Jl3Mtwn2"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# input image dimensions\nimg_rows, img_cols = 28, 28","key":"faQqWKXQhD"},{"type":"outputs","id":"VAWWMPd_YDXbfOISLeLAN","children":[],"key":"AgCfl4KOg1"}],"key":"npUTIRiyIO"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Kernel Size (Updated from (3,3) Baseline to (5,5) Task 2)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sp66dJnJK8"}],"identifier":"define-kernel-size-updated-from-3-3-baseline-to-5-5-task-2","label":"Define Kernel Size (Updated from (3,3) Baseline to (5,5) Task 2)","html_id":"define-kernel-size-updated-from-3-3-baseline-to-5-5-task-2","implicit":true,"key":"MKMk4q33Dm"}],"key":"TtVEaCGBoA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"kernel_size = (5,5)","key":"aXISkQVN01"},{"type":"outputs","id":"XO3Z_i3vIPWv2XC0GFGFN","children":[],"key":"AiFaoB9YSh"}],"key":"riQKtx84w4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Pooling Size","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C85bLNH9ks"}],"identifier":"define-pooling-size","label":"Define Pooling Size","html_id":"define-pooling-size","implicit":true,"key":"hWRr3cBNnZ"}],"key":"qT5XihfM8j"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pool_size = (2,2)","key":"flND34kJAd"},{"type":"outputs","id":"3A7fOEryv9UZbiU5FqM8y","children":[],"key":"gB0pBrqICm"}],"key":"VqUwJ4xaPn"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load Data and Train / Test Split","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZCQcPcBwoT"}],"identifier":"load-data-and-train-test-split","label":"Load Data and Train / Test Split","html_id":"load-data-and-train-test-split","implicit":true,"key":"EHx1rcwsL0"}],"key":"jaF1Ta2WDD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# the data, split between train and test sets\n(x_train, y_train), (x_test, y_test)=tf.keras.datasets.mnist.load_data('mnist.npz')","key":"y4DUPsyyle"},{"type":"outputs","id":"P1Vy1hsWXBgA-fSvvGvBz","children":[],"key":"VSyoUrsOa5"}],"key":"RkZlaI1U38"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_train.shape","key":"riwR8Cgaog"},{"type":"outputs","id":"cJv--fbK5JTzsh_BgnlhB","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":10,"metadata":{},"data":{"text/plain":{"content":"(60000, 28, 28)","content_type":"text/plain"}}},"children":[],"key":"kAyFY8ilmd"}],"key":"c6c2hIy404"}],"key":"W41YkYZ6af"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_train.shape","key":"uuRDEFiStx"},{"type":"outputs","id":"88HwbxpWw5ozIQ5mstn-h","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"(60000,)","content_type":"text/plain"}}},"children":[],"key":"ekVXmfxCnF"}],"key":"lmVmwJ3QyK"}],"key":"bMxUIkTcrU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_test.shape","key":"v0oDVN8ZNn"},{"type":"outputs","id":"DNRK8Dm4AU77glGG8zbkv","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"(10000, 28, 28)","content_type":"text/plain"}}},"children":[],"key":"KqFt96rdTM"}],"key":"whY6HCUPag"}],"key":"jb3P4wwtAG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_test.shape","key":"od4Rx53nfY"},{"type":"outputs","id":"sM4H3zthPYPXY6CtTKhYF","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/plain":{"content":"(10000,)","content_type":"text/plain"}}},"children":[],"key":"EnNjE4HjO7"}],"key":"vnFvX3bH6b"}],"key":"rCDpmZIk9X"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"EDA on Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wbiJacpG0e"}],"identifier":"eda-on-data","label":"EDA on Data","html_id":"eda-on-data","implicit":true,"key":"ALDDFL1n8V"}],"key":"kveZGcH6Q6"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize First Train Image","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YXEZXRidZ7"}],"identifier":"visualize-first-train-image","label":"Visualize First Train Image","html_id":"visualize-first-train-image","implicit":true,"key":"QpI3hMf1B8"}],"key":"BXvmHH1n8i"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ticks = np.arange(0, 28+2, 2)\n#ticks","key":"NLp2ZYEss7"},{"type":"outputs","id":"1QZHdy6T9NK4dbDMWXf3Y","children":[],"key":"DceKGKj3sm"}],"key":"W2g2diqPLr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"plt.imshow(x_train[0], cmap='grey')\nplt.xlim(0, 28)\nplt.xticks(ticks=ticks)\nplt.yticks(ticks=ticks)\nplt.show()","key":"gjBgTMzugJ"},{"type":"outputs","id":"nQEvAz1MxfZOmxFZbqM6v","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6307c9063d2a896beafa2689ed8da5df","path":"/6307c9063d2a896beafa2689ed8da5df.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"rfIXAWKEpV"}],"key":"TNg0a1ijRP"}],"key":"LDdTx9xiOW"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize the First 10 X Train Images","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pWS3TLag77"}],"identifier":"visualize-the-first-10-x-train-images","label":"Visualize the First 10 X Train Images","html_id":"visualize-the-first-10-x-train-images","implicit":true,"key":"ecx9wtkNRP"}],"key":"dkafKXG0Ux"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Display the first 10 images\nnum_images_to_display = 10\nplt.figure(figsize=(10, 5))  # Adjust the figure size\n\nfor i in range(num_images_to_display):\n    plt.subplot(2, 5, i + 1)  # Create a 2x5 grid for 10 images\n    plt.imshow(x_train[i], cmap='gray')  # Display each image\n    plt.title(f'Train Image {i + 1}')\n    plt.axis('off')  # Hide axes for better visualization\n\nplt.tight_layout()\nplt.show()","key":"RRM6hkwIS2"},{"type":"outputs","id":"Z4jfIUeWSWJrYSVHPQbAz","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7ce587a1409319f6f079817b9548c2b6","path":"/7ce587a1409319f6f079817b9548c2b6.png"},"text/plain":{"content":"<Figure size 1000x500 with 10 Axes>","content_type":"text/plain"}}},"children":[],"key":"f1Xd690VNX"}],"key":"uCYiE0Jye8"}],"key":"ZkTjzCQZTJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Print the First 10 Y Train Class Labels","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"enG8LAy0rZ"}],"identifier":"print-the-first-10-y-train-class-labels","label":"Print the First 10 Y Train Class Labels","html_id":"print-the-first-10-y-train-class-labels","implicit":true,"key":"qD1xhYo0Se"}],"key":"QNTjZjFqsd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_train[0:10]","key":"PVL1aRn2Rw"},{"type":"outputs","id":"TPNILVQpQe42G7NW9TfXn","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/plain":{"content":"array([5, 0, 4, 1, 9, 2, 1, 3, 1, 4], dtype=uint8)","content_type":"text/plain"}}},"children":[],"key":"ZRAtLR6qJX"}],"key":"FiKFrF7O7L"}],"key":"vXnGM6Xa4b"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize the First X 10 Test Images","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BwKzubryOU"}],"identifier":"visualize-the-first-x-10-test-images","label":"Visualize the First X 10 Test Images","html_id":"visualize-the-first-x-10-test-images","implicit":true,"key":"EHg1hOkbI1"}],"key":"jk5Y461tB6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Display the first 10 images\nnum_images_to_display = 10\nplt.figure(figsize=(10, 5))  # Adjust the figure size\n\nfor i in range(num_images_to_display):\n    plt.subplot(2, 5, i + 1)  # Create a 2x5 grid for 10 images\n    plt.imshow(x_test[i], cmap='gray')  # Display each image\n    plt.title(f'Test Image {i + 1}')\n    plt.axis('off')  # Hide axes for better visualization\n\nplt.tight_layout()\nplt.show()","key":"DgpQMdRiT0"},{"type":"outputs","id":"VhN2ho-EUBrs3xq4RLLSZ","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0e370b8936aebd53b2df30837226df74","path":"/0e370b8936aebd53b2df30837226df74.png"},"text/plain":{"content":"<Figure size 1000x500 with 10 Axes>","content_type":"text/plain"}}},"children":[],"key":"Of52BOGIFf"}],"key":"CZO0gxJGPR"}],"key":"oeWadHluUG"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Print the First 10 Y Test Class Labels","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q2cLWwsU6j"}],"identifier":"print-the-first-10-y-test-class-labels","label":"Print the First 10 Y Test Class Labels","html_id":"print-the-first-10-y-test-class-labels","implicit":true,"key":"HRM0swqers"}],"key":"ciGpl9JZ3a"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_test[0:10]","key":"GOO8JkbU86"},{"type":"outputs","id":"PZGs27JQdqWEUURjlWVNr","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"array([7, 2, 1, 0, 4, 1, 4, 9, 5, 9], dtype=uint8)","content_type":"text/plain"}}},"children":[],"key":"QDg6B5rAt0"}],"key":"DMEWuUlTXC"}],"key":"RY2nireLXU"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Reformat Data if Necessary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KaBf8W2bnz"}],"identifier":"reformat-data-if-necessary","label":"Reformat Data if Necessary","html_id":"reformat-data-if-necessary","implicit":true,"key":"dJupcTnuBz"}],"key":"nFJmraptkt"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"if K.image_data_format() == 'channels_first':\n    x_train = x_train.reshape(x_train.shape[0], 1, img_rows, img_cols)\n    x_test = x_test.reshape(x_test.shape[0], 1, img_rows, img_cols)\n    input_shape = (1, img_rows, img_cols)\nelse:\n    x_train = x_train.reshape(x_train.shape[0], img_rows, img_cols, 1)\n    x_test = x_test.reshape(x_test.shape[0], img_rows, img_cols, 1)\n    input_shape = (img_rows, img_cols, 1)","key":"Bhz45p5f4z"},{"type":"outputs","id":"o7PoeNvtE3vbz22CiGpU3","children":[],"key":"TbQXGyiT9a"}],"key":"F33GeSYERo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_train.shape","key":"VcnwZ1HfQd"},{"type":"outputs","id":"4qo-N_ca0e_4RP2uEztik","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/plain":{"content":"(60000, 28, 28, 1)","content_type":"text/plain"}}},"children":[],"key":"jnJrFTkmNT"}],"key":"iqtp6lUGpI"}],"key":"XdNuoPdJ5Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_test.shape","key":"AVBv0LDoCT"},{"type":"outputs","id":"fX5ZuKAq_UjKrf5wnwO-z","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"(10000, 28, 28, 1)","content_type":"text/plain"}}},"children":[],"key":"jjYpCG5nSt"}],"key":"JANJ0EYUPV"}],"key":"XenYdzyc8r"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Cast and Normalize Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ffaw2njvPM"}],"identifier":"cast-and-normalize-data","label":"Cast and Normalize Data","html_id":"cast-and-normalize-data","implicit":true,"key":"qvaM37SAZq"}],"key":"ucvnIX9aqN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x_train = x_train.astype('float32')\nx_test = x_test.astype('float32')\nx_train /= 255\nx_test /= 255","key":"l2Z7P2ISUQ"},{"type":"outputs","id":"OooOFis7K8Ug7JG7UVtaS","children":[],"key":"H5zLHP7hco"}],"key":"uPbneFR8K9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Print Out Description of Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VbcF7cJmLd"}],"identifier":"print-out-description-of-data","label":"Print Out Description of Data","html_id":"print-out-description-of-data","implicit":true,"key":"g8dvFBZfpQ"}],"key":"KQ0OOdN28B"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print('x_train shape:', x_train.shape)\nprint(x_train.shape[0], 'train samples')\nprint(x_test.shape[0], 'test samples')","key":"V7pMM82fgW"},{"type":"outputs","id":"0O21yzIS6eHM9DrQtXos3","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"x_train shape: (60000, 28, 28, 1)\n60000 train samples\n10000 test samples\n"},"children":[],"key":"jKdcmNmenj"}],"key":"dsi8ywodUr"}],"key":"stauPwbC1P"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Convert Class Vectors into Binary Class Matrices","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xDKEec7gOX"}],"identifier":"convert-class-vectors-into-binary-class-matrices","label":"Convert Class Vectors into Binary Class Matrices","html_id":"convert-class-vectors-into-binary-class-matrices","implicit":true,"key":"D8bPrzqZKB"}],"key":"Um5BBmn0sO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# convert class vectors to binary class matrices\ny_train = to_categorical(y_train, num_classes)\ny_test = to_categorical(y_test, num_classes)","key":"uaBpAmgnfZ"},{"type":"outputs","id":"S6ZpRR6_vhlhKV_dL46Ei","children":[],"key":"jhUyJwh35B"}],"key":"Cq59on2wcT"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_train.shape","key":"SLSzAWCWp7"},{"type":"outputs","id":"9YTBcpoBuf6mOjKaWNyoP","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":26,"metadata":{},"data":{"text/plain":{"content":"(60000, 10)","content_type":"text/plain"}}},"children":[],"key":"NYbYS93Tsp"}],"key":"ird23IuPeh"}],"key":"rPhS5vKmiM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_train[0:5]","key":"RG8KdewULS"},{"type":"outputs","id":"Tv3gg_oacAjUIUsUUAiJP","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":27,"metadata":{},"data":{"text/plain":{"content":"array([[0., 0., 0., 0., 0., 1., 0., 0., 0., 0.],\n       [1., 0., 0., 0., 0., 0., 0., 0., 0., 0.],\n       [0., 0., 0., 0., 1., 0., 0., 0., 0., 0.],\n       [0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],\n       [0., 0., 0., 0., 0., 0., 0., 0., 0., 1.]], dtype=float32)","content_type":"text/plain"}}},"children":[],"key":"I1OkFK0Osc"}],"key":"CI51ZmS0HS"}],"key":"SemfmXL9Fl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_test.shape","key":"jrCiXraSZb"},{"type":"outputs","id":"wRksq47YxGaBBF0wyUK6-","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":28,"metadata":{},"data":{"text/plain":{"content":"(10000, 10)","content_type":"text/plain"}}},"children":[],"key":"yzKps1WIUg"}],"key":"uqpDZKy2ZU"}],"key":"FuDLzvHCEO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_test[0:5]","key":"DOODcLthj7"},{"type":"outputs","id":"PGZ-CmJO373ycfLqcG3-x","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":29,"metadata":{},"data":{"text/plain":{"content":"array([[0., 0., 0., 0., 0., 0., 0., 1., 0., 0.],\n       [0., 0., 1., 0., 0., 0., 0., 0., 0., 0.],\n       [0., 1., 0., 0., 0., 0., 0., 0., 0., 0.],\n       [1., 0., 0., 0., 0., 0., 0., 0., 0., 0.],\n       [0., 0., 0., 0., 1., 0., 0., 0., 0., 0.]], dtype=float32)","content_type":"text/plain"}}},"children":[],"key":"PBBcdTE6Ym"}],"key":"rimTGKopb2"}],"key":"vomyqqXQNM"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create Task 2 Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dVLkWT9mUT"}],"identifier":"create-task-2-model","label":"Create Task 2 Model","html_id":"create-task-2-model","implicit":true,"key":"SY3yqNR4if"}],"key":"f1CpQKAvGg"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Task 2 Model Type","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Bv5WPb4yHF"}],"identifier":"define-task-2-model-type","label":"Define Task 2 Model Type","html_id":"define-task-2-model-type","implicit":true,"key":"l0KTVddG4s"}],"key":"zlkFw42s0U"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Artificial Neural Network\nmodel = Sequential()","key":"ieQ2Pycm4C"},{"type":"outputs","id":"Ze_NNARKxSop62rQfk80-","children":[],"key":"MABAisIDb4"}],"key":"AHNlp5fAi9"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model","key":"JJIS7l7iKj"},{"type":"outputs","id":"Xk0goBzEIVq7aTRFoaw6_","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":31,"metadata":{},"data":{"text/plain":{"content":"<keras.engine.sequential.Sequential at 0x24a43f95730>","content_type":"text/plain"}}},"children":[],"key":"HF6bxyy7qb"}],"key":"wgfjBysWt1"}],"key":"uUARwaPPeB"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create Task 2 Model Structure","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Mn8P2aJqPB"}],"identifier":"create-task-2-model-structure","label":"Create Task 2 Model Structure","html_id":"create-task-2-model-structure","implicit":true,"key":"SJJrjN93nX"}],"key":"rmJZwflW82"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# First layer is a convolutional layer with 6 filters, each of size 3x3\nmodel.add(Conv2D(\n    filters=6, \n    kernel_size=kernel_size,\n    strides=(1, 1),\n    activation='relu',\n    input_shape=input_shape))\n\n# Second layer is a max pooling layer with a pool size of 2x2\nmodel.add(MaxPooling2D(\n    pool_size=pool_size,\n    strides=(1, 1)))\n\n# Third layer is a convolutional layer with 16 filters, each of size 3x3\nmodel.add(Conv2D(\n    filters=16, \n    kernel_size=kernel_size,\n    strides=(1, 1),\n    activation='relu'))\n\n# Fourth layer is a max pooling layer with a pool size of 2x2\nmodel.add(MaxPooling2D(\n    pool_size=pool_size,\n    strides=(1, 1)))\n\n# Fifth layer is a flatten layer\nmodel.add(Flatten())\n\n# Sixth layer is a dense layer with 120 units\nmodel.add(Dense(120, activation='relu'))\n\n# Seventh layer is a dense layer with 84 units\nmodel.add(Dense(84, activation='relu'))\n\n# Eighth layer is a dense layer with 10 units for 10 classes in the output layer\nmodel.add(Dense(num_classes, activation='softmax'))","key":"XGcGfIH9YQ"},{"type":"outputs","id":"vz1Fsq9BXEYukNLL0PrVs","children":[],"key":"q2EqPG8MCe"}],"key":"OKWJLo35Ru"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model","key":"cyJQmmCD1J"},{"type":"outputs","id":"bOmFQGiVKMpCsTFxmUdxm","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":33,"metadata":{},"data":{"text/plain":{"content":"<keras.engine.sequential.Sequential at 0x24a43f95730>","content_type":"text/plain"}}},"children":[],"key":"KVNJd0IPym"}],"key":"pktBpfmLcC"}],"key":"k3MQ3UMN5I"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define Task 2 Model Optimizer","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TkD4WaUO4G"}],"identifier":"define-task-2-model-optimizer","label":"Define Task 2 Model Optimizer","html_id":"define-task-2-model-optimizer","implicit":true,"key":"uRfTbLCx4g"}],"key":"X3MojOe1Du"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"optim = tf.keras.optimizers.Adadelta(\n    learning_rate=0.1, \n    rho=0.95, \n    decay=0.0)","key":"v90zXYjVoA"},{"type":"outputs","id":"Dwr_ykB1l6O6wrs2eMf28","children":[],"key":"UonegWL9SG"}],"key":"A1aBB9WBlV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"optim","key":"YjBt8df97a"},{"type":"outputs","id":"H-hyUQ37p4J1mHg3xPS1q","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":35,"metadata":{},"data":{"text/plain":{"content":"<keras.optimizer_v2.adadelta.Adadelta at 0x24a42d01fd0>","content_type":"text/plain"}}},"children":[],"key":"mVt0SOavuy"}],"key":"rgu5OceFLR"}],"key":"MfYXLL1YQB"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compile Task 2 Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hopZSL7QPo"}],"identifier":"compile-task-2-model","label":"Compile Task 2 Model","html_id":"compile-task-2-model","implicit":true,"key":"BeDisivaPi"}],"key":"XqkE550qpe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# https://keras.io/optimizers/ \nmodel.compile(loss=keras.losses.categorical_crossentropy,\n              optimizer=optim,\n              metrics=['accuracy'])","key":"hFd6TzRHdm"},{"type":"outputs","id":"sFGI16WDnTGA-kP5-O2Qm","children":[],"key":"YJuPaZ0uVw"}],"key":"FKigMg78w0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model","key":"xsO4X0I6rT"},{"type":"outputs","id":"myiEP-AVGVLlU0qvexNIt","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":37,"metadata":{},"data":{"text/plain":{"content":"<keras.engine.sequential.Sequential at 0x24a43f95730>","content_type":"text/plain"}}},"children":[],"key":"MIdonDuJSw"}],"key":"Z00M2y7p0n"}],"key":"jEWkRPIJzR"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Train Task 2 Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j0Uv6igOeS"}],"identifier":"train-task-2-model","label":"Train Task 2 Model","html_id":"train-task-2-model","implicit":true,"key":"jW5sJMZbY7"}],"key":"XUkQrm5ALD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model_history = \\\n    model.fit(x_train, y_train,\n          batch_size=batch_size,\n          epochs=epochs,\n          verbose=2,\n          validation_data=(x_test, y_test))\n","key":"KfmjY5KuKi"},{"type":"outputs","id":"9qPEmWpiq76Rb29XSKLq2","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Epoch 1/12\n938/938 - 10s - loss: 0.3448 - accuracy: 0.8967 - val_loss: 0.1091 - val_accuracy: 0.9694\nEpoch 2/12\n938/938 - 2s - loss: 0.0940 - accuracy: 0.9723 - val_loss: 0.0704 - val_accuracy: 0.9806\nEpoch 3/12\n938/938 - 2s - loss: 0.0659 - accuracy: 0.9804 - val_loss: 0.0575 - val_accuracy: 0.9809\nEpoch 4/12\n938/938 - 2s - loss: 0.0530 - accuracy: 0.9841 - val_loss: 0.0489 - val_accuracy: 0.9841\nEpoch 5/12\n938/938 - 2s - loss: 0.0451 - accuracy: 0.9865 - val_loss: 0.0571 - val_accuracy: 0.9808\nEpoch 6/12\n938/938 - 2s - loss: 0.0392 - accuracy: 0.9887 - val_loss: 0.0464 - val_accuracy: 0.9847\nEpoch 7/12\n938/938 - 2s - loss: 0.0352 - accuracy: 0.9895 - val_loss: 0.0358 - val_accuracy: 0.9885\nEpoch 8/12\n938/938 - 2s - loss: 0.0318 - accuracy: 0.9908 - val_loss: 0.0366 - val_accuracy: 0.9875\nEpoch 9/12\n938/938 - 2s - loss: 0.0291 - accuracy: 0.9911 - val_loss: 0.0323 - val_accuracy: 0.9889\nEpoch 10/12\n938/938 - 2s - loss: 0.0265 - accuracy: 0.9923 - val_loss: 0.0316 - val_accuracy: 0.9892\nEpoch 11/12\n938/938 - 2s - loss: 0.0240 - accuracy: 0.9930 - val_loss: 0.0335 - val_accuracy: 0.9887\nEpoch 12/12\n938/938 - 2s - loss: 0.0222 - accuracy: 0.9937 - val_loss: 0.0344 - val_accuracy: 0.9894\n"},"children":[],"key":"vc2XAhyIKW"}],"key":"m3rimLGTJm"}],"key":"NGIbLkqdeQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model_history.history['loss']","key":"ZaVQDb4Nvm"},{"type":"outputs","id":"HouVpijh_Na_wxN6OQyfX","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":39,"metadata":{},"data":{"text/plain":{"content":"[0.34479445219039917,\n 0.09400391578674316,\n 0.0658968836069107,\n 0.05295504257082939,\n 0.04514137655496597,\n 0.03916701301932335,\n 0.03520461171865463,\n 0.03181973844766617,\n 0.029129598289728165,\n 0.026451660320162773,\n 0.024046970531344414,\n 0.022170674055814743]","content_type":"text/plain"}}},"children":[],"key":"kdEu4h9OxJ"}],"key":"VLO1r50CEO"}],"key":"fp8ErF9T8q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model_history.history['accuracy']","key":"YmYgp7BDEM"},{"type":"outputs","id":"KQzYrr_kXBBhYhjsLFUa3","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":40,"metadata":{},"data":{"text/plain":{"content":"[0.8967000246047974,\n 0.9722999930381775,\n 0.9804333448410034,\n 0.9841333627700806,\n 0.9865333437919617,\n 0.9887333512306213,\n 0.9895333051681519,\n 0.9907500147819519,\n 0.9910500049591064,\n 0.9922666549682617,\n 0.992983341217041,\n 0.9937000274658203]","content_type":"text/plain"}}},"children":[],"key":"yXNKtU13h6"}],"key":"ooaNcbNaSw"}],"key":"CIehGN1KGU"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Save the Fitted Task 2 Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"He2VeO27qA"}],"identifier":"save-the-fitted-task-2-model","label":"Save the Fitted Task 2 Model","html_id":"save-the-fitted-task-2-model","implicit":true,"key":"lOwi2BCxb6"}],"key":"bNR3kI40eN"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model.save(\"fitted_task2_model.keras\")  # Save the model in HDF5 format\n\n# Save the history\nimport json\nwith open(\"fitted_task2_model_history.json\", \"w\") as f:\n    json.dump(model_history.history, f)","key":"xfaxirRgG9"},{"type":"outputs","id":"pMAKj8m_hIeewzOkrJzOp","children":[],"key":"QCCn4Glm9j"}],"key":"E5oVIdl9qQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Load the Model if Necessary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"l2JxvZlRPU"}],"identifier":"load-the-model-if-necessary","label":"Load the Model if Necessary","html_id":"load-the-model-if-necessary","implicit":true,"key":"ZFIZCcahLS"}],"key":"MQGdDunb5a"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#from keras.models import load_model\n\n#model = load_model(\"fitted_baseline_model.keras\")  # Load the saved model\n\n# Load the history\n#import json\n#with open(\"fitted_baseline_model_history.json\", \"r\") as f:\n#    model_history = json.load(f)","key":"rBzKpEMQsy"},{"type":"outputs","id":"sBK_q4bLcOHGKkchtQ_W8","children":[],"key":"pjBTrkVOD7"}],"key":"ZDe2dLXgaJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Get Model Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YamjetjsJ4"}],"identifier":"get-model-summary","label":"Get Model Summary","html_id":"get-model-summary","implicit":true,"key":"diRhPDWqxS"}],"key":"kMcgKBOp0Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"model.summary()","key":"sys3wMxoOP"},{"type":"outputs","id":"Flq_qXtkLZAT0p0kqR10N","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Model: \"sequential\"\n_________________________________________________________________\nLayer (type)                 Output Shape              Param #   \n=================================================================\nconv2d (Conv2D)              (None, 24, 24, 6)         156       \n_________________________________________________________________\nmax_pooling2d (MaxPooling2D) (None, 23, 23, 6)         0         \n_________________________________________________________________\nconv2d_1 (Conv2D)            (None, 19, 19, 16)        2416      \n_________________________________________________________________\nmax_pooling2d_1 (MaxPooling2 (None, 18, 18, 16)        0         \n_________________________________________________________________\nflatten (Flatten)            (None, 5184)              0         \n_________________________________________________________________\ndense (Dense)                (None, 120)               622200    \n_________________________________________________________________\ndense_1 (Dense)              (None, 84)                10164     \n_________________________________________________________________\ndense_2 (Dense)              (None, 10)                850       \n=================================================================\nTotal params: 635,786\nTrainable params: 635,786\nNon-trainable params: 0\n_________________________________________________________________\n"},"children":[],"key":"Mh65hoZNV7"}],"key":"z90W0xa6e9"}],"key":"z8HItRHNdy"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Evaluate Task 2 Model","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a5DSQ4xoOB"}],"identifier":"evaluate-task-2-model","label":"Evaluate Task 2 Model","html_id":"evaluate-task-2-model","implicit":true,"key":"hV2msnrZbW"}],"key":"uuZE574KyK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Training Accuracy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tZPruXrjDQ"}],"identifier":"training-accuracy","label":"Training Accuracy","html_id":"training-accuracy","implicit":true,"key":"EkmCijkd3T"}],"key":"RO9c0VgAdd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"loss_train, accuracy_train = model.evaluate(x_train, y_train)","key":"wAiBy8JZfP"},{"type":"outputs","id":"IHphNjOO2oVxb2o1tV1mv","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"1875/1875 [==============================] - 3s 1ms/step - loss: 0.0209 - accuracy: 0.9940\n"},"children":[],"key":"U6yoFBQxT6"}],"key":"z8OoDRLjyP"}],"key":"r8pwET21rc"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print('Print the training loss and the accuracy of the model on the dataset')\nprint('Train Loss: {0:0.4f} Train Accuracy: {1:0.4f}'.format(loss_train, accuracy_train))","key":"eyqeBgjMKt"},{"type":"outputs","id":"Yec29yGE1qaVlc3VOvYKT","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Print the training loss and the accuracy of the model on the dataset\nTrain Loss: 0.0209 Train Accuracy: 0.9940\n"},"children":[],"key":"CzwvguFgNC"}],"key":"YEGesvZZ1O"}],"key":"AxrOiFagGq"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Testing Accuracy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wn68rTNk7Z"}],"identifier":"testing-accuracy","label":"Testing Accuracy","html_id":"testing-accuracy","implicit":true,"key":"oek2op0vlg"}],"key":"fcW2ar6YTV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"loss_test, accuracy_test = model.evaluate(x_test, y_test)","key":"mBZL8tt6fW"},{"type":"outputs","id":"7tZsioVrJAvy1Fvu04aRK","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"313/313 [==============================] - 1s 2ms/step - loss: 0.0344 - accuracy: 0.9894\n"},"children":[],"key":"Qek2PEaOed"}],"key":"FzHW35O6N7"}],"key":"p6wWAxtmxH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print('Print the testing loss and the accuracy of the model on the dataset')\nprint('Test Loss: {0:0.4f} Test Accuracy: {1:0.4f}'.format(loss_test, accuracy_test))","key":"Xhmofo4vXM"},{"type":"outputs","id":"uAgwdXt6LCBdpjsZIymL3","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Print the testing loss and the accuracy of the model on the dataset\nTest Loss: 0.0344 Test Accuracy: 0.9894\n"},"children":[],"key":"HZ1PGMdbM1"}],"key":"NGLFruZbc9"}],"key":"OHDOjZXCzS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#score = model.evaluate(x_test, y_test, verbose=0)\n#print('Test loss:', score[0])\n#print('Test accuracy:', score[1])","key":"pJ2HjGASn9"},{"type":"outputs","id":"A4K7cXQkjZxs7Zg7zqgar","children":[],"key":"Nsn1zuDdBO"}],"key":"yK36InNerI"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Use Model to Make Predictions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bHiGp86QKT"}],"identifier":"use-model-to-make-predictions","label":"Use Model to Make Predictions","html_id":"use-model-to-make-predictions","implicit":true,"key":"P8iPVmUQJz"}],"key":"D7TMMci6qS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"########################################\n# Making predictions and evaluating the model\n#######################################\n\n# Predicting the Test set results\ny_pred = model.predict(x_test)\ny_pred[y_pred > 0.9] = 1","key":"UaL1vnDttc"},{"type":"outputs","id":"Q7nHjYOjLyFK1quq1lBDx","children":[],"key":"Q7kkJJrUpT"}],"key":"hQqglCduIa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_pred[y_pred > 0.9] = 1\ny_pred[y_pred <= 0.9] = 0","key":"Vld1P9bui5"},{"type":"outputs","id":"1YpX85IDya4yCHke2YGZ8","children":[],"key":"XgSJYHmNtg"}],"key":"w2m9kuBgPA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_pred.shape","key":"djanoI4bMA"},{"type":"outputs","id":"dN3XxUdVvqeut4ttY9AQr","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":51,"metadata":{},"data":{"text/plain":{"content":"(10000, 10)","content_type":"text/plain"}}},"children":[],"key":"s3s6xgzJTH"}],"key":"fctQOBgBT6"}],"key":"Ix3HQjqlZG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_pred[0]","key":"AQwyU6dTm4"},{"type":"outputs","id":"fPTW4LD6FGlLmEqux_Sy4","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":52,"metadata":{},"data":{"text/plain":{"content":"array([0., 0., 0., 0., 0., 0., 0., 1., 0., 0.], dtype=float32)","content_type":"text/plain"}}},"children":[],"key":"wxemTrDT30"}],"key":"pSNgQhFAwN"}],"key":"SboBooqB4R"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# summarize the middle 5 cases in a table\n\nfor i in range(15,20):\n    print('actual   ', end=' ')\n    for j in range(10):\n        print('{:.1f}'.format(y_test[i][j]), end=' ')\n    print()\n    print('predicted', end=' ')\n    for j in range(10):\n        print('{:.1f}'.format(y_pred[i][j]), end=' ')\n    print()\n    print()","key":"S2SNhp4uUh"},{"type":"outputs","id":"sPk-bGlQpo04V70WP7jJE","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"actual    0.0 0.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 \npredicted 0.0 0.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 \n\nactual    0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0 \npredicted 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0 \n\nactual    0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0 0.0 0.0 \npredicted 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0 0.0 0.0 \n\nactual    0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 \npredicted 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 \n\nactual    0.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 0.0 \npredicted 0.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 0.0 \n\n"},"children":[],"key":"RFSuHD247v"}],"key":"Oospp4KsOg"}],"key":"ptM5z24z7s"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Making the Confusion Matrix","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tvYb1ciUFN"}],"identifier":"making-the-confusion-matrix","label":"Making the Confusion Matrix","html_id":"making-the-confusion-matrix","implicit":true,"key":"NxNiFKOs18"}],"key":"f7xnVQoem8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_pred[0]","key":"KPer7ksrg2"},{"type":"outputs","id":"X4kUiYHxFoD5-ko8qz3jA","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":54,"metadata":{},"data":{"text/plain":{"content":"array([0., 0., 0., 0., 0., 0., 0., 1., 0., 0.], dtype=float32)","content_type":"text/plain"}}},"children":[],"key":"NVQT8NpCO1"}],"key":"IEAHpML78A"}],"key":"ZAIAydc9Zg"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_test[0]","key":"qrcK3ANM6b"},{"type":"outputs","id":"MG-6OZPLscFhZppv3JTX8","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":55,"metadata":{},"data":{"text/plain":{"content":"array([0., 0., 0., 0., 0., 0., 0., 1., 0., 0.], dtype=float32)","content_type":"text/plain"}}},"children":[],"key":"s0cR9S6eYY"}],"key":"nQ1WXVS3fP"}],"key":"IUQlNysRXK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_pred.shape","key":"TaHsCWz77d"},{"type":"outputs","id":"1CoBZ8itHvW7vFT6AvmQi","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":56,"metadata":{},"data":{"text/plain":{"content":"(10000, 10)","content_type":"text/plain"}}},"children":[],"key":"tpwMGAWw9V"}],"key":"ajCTqiAG9w"}],"key":"FCIxAUhE4W"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_test.shape","key":"MkeFISwxY1"},{"type":"outputs","id":"4QZTjexo82o6LS5AtJ6e8","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":57,"metadata":{},"data":{"text/plain":{"content":"(10000, 10)","content_type":"text/plain"}}},"children":[],"key":"E2d9Jb7WBc"}],"key":"jK0OTe0pjN"}],"key":"cz7OfZxxdY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Convert one-hot encoded arrays to label indices\ny_pred_labels = np.argmax(y_pred, axis=1)\ny_test_labels = np.argmax(y_test, axis=1)","key":"n7ObUgbY9I"},{"type":"outputs","id":"-doU35XSqAiDrqr7vkgY9","children":[],"key":"beXZt8V7YA"}],"key":"ctCT59dRvR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_pred_labels[0:15]","key":"JnDIydRd87"},{"type":"outputs","id":"ZxKG5vFTRcou8yTPK4hA5","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":59,"metadata":{},"data":{"text/plain":{"content":"array([7, 2, 1, 0, 4, 1, 4, 9, 5, 9, 0, 6, 9, 0, 1], dtype=int64)","content_type":"text/plain"}}},"children":[],"key":"pG07pKSCNx"}],"key":"HZVUUh7ug1"}],"key":"ohBTkJ1y8Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"y_test_labels[0:15]","key":"tbrOhVoJOm"},{"type":"outputs","id":"agA0t_XX6qoCDCPxCHnFf","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":60,"metadata":{},"data":{"text/plain":{"content":"array([7, 2, 1, 0, 4, 1, 4, 9, 5, 9, 0, 6, 9, 0, 1], dtype=int64)","content_type":"text/plain"}}},"children":[],"key":"gXjG9RPduh"}],"key":"mOigKY6jxx"}],"key":"PPvodByqif"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Making the Confusion Matrix\ncm = confusion_matrix(y_test_labels, y_pred_labels)\nprint('Print the Confusion Matrix:')\nprint(cm)","key":"IZj14a4hpZ"},{"type":"outputs","id":"1WXWeSIXlk2s_8KKRkNLP","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Print the Confusion Matrix:\n[[ 977    0    0    0    0    0    1    1    1    0]\n [   8 1127    0    0    0    0    0    0    0    0]\n [  30    2  998    0    1    0    0    1    0    0]\n [  25    0    0  985    0    0    0    0    0    0]\n [  30    0    0    0  951    0    0    0    0    1]\n [  23    0    0    1    0  867    1    0    0    0]\n [  34    1    0    0    1    3  919    0    0    0]\n [  31    0    1    0    0    0    0  996    0    0]\n [  56    0    2    1    0    0    0    2  911    2]\n [  41    2    0    0    1    0    0    0    0  965]]\n"},"children":[],"key":"TpPaWmepaG"}],"key":"En6C5tXSM3"}],"key":"EpqG1TPcN0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(classification_report(y_test_labels, y_pred_labels))","key":"tSIClOsmev"},{"type":"outputs","id":"LDVOazqEE6MaZOkzRfDHw","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"              precision    recall  f1-score   support\n\n           0       0.78      1.00      0.87       980\n           1       1.00      0.99      0.99      1135\n           2       1.00      0.97      0.98      1032\n           3       1.00      0.98      0.99      1010\n           4       1.00      0.97      0.98       982\n           5       1.00      0.97      0.98       892\n           6       1.00      0.96      0.98       958\n           7       1.00      0.97      0.98      1028\n           8       1.00      0.94      0.97       974\n           9       1.00      0.96      0.98      1009\n\n    accuracy                           0.97     10000\n   macro avg       0.98      0.97      0.97     10000\nweighted avg       0.98      0.97      0.97     10000\n\n"},"children":[],"key":"IFiyvYcKoo"}],"key":"NiW4Dey9Zs"}],"key":"d1ci2ctWze"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"disp = ConfusionMatrixDisplay(confusion_matrix=cm, display_labels=np.arange(10))\ndisp.plot()\nplt.savefig('confusion_matrix_baseline.png')\nplt.show()","key":"nk90cqBcBt"},{"type":"outputs","id":"rru5TnHFyihh1SOZhah4D","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fd43804ac8b6851f52b02e2fd04b6cf6","path":"/fd43804ac8b6851f52b02e2fd04b6cf6.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"bRzpZwAvVY"}],"key":"wvQa0MYSeZ"}],"key":"Y8L3ZX1DN7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot The Accuracy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gPLMTf7odc"}],"identifier":"plot-the-accuracy","label":"Plot The Accuracy","html_id":"plot-the-accuracy","implicit":true,"key":"Xen6XuprJ3"}],"key":"YS9jP323pk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print('Plot the accuracy')\n# Keras 2.2.4 recognizes 'acc' and 2.3.1 recognizes 'accuracy'\n# use the command python -c 'import keras; print(keras.__version__)' on MAC or Linux to check Keras' version\nplt.plot(model_history.history['accuracy'], label='Training Accuracy')\n#plt.plot(model_history.history['val_accuracy'], label='Validation Accuracy')\nplt.title('5x5 Kernel Model Accuracy')\nplt.ylabel('Accuracy')\nplt.xlabel('Epoch')\nplt.yticks(np.arange(0.9, 1.2, step=0.01))\nplt.xticks(np.arange(0, 14, step=1))\nplt.ylim(0.9, 1)\nplt.xlim(0, 12)\nplt.grid()\nplt.legend(loc='lower right')\nplt.savefig('task2_model_accuracy.png')\nplt.show()","key":"krqW8xZ3JM"},{"type":"outputs","id":"9xqJb-bQR3vy_5a2ee2lY","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Plot the accuracy\n"},"children":[],"key":"jeIrERHX1H"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6bf65c0e421032d74a4445f892d110fe","path":"/6bf65c0e421032d74a4445f892d110fe.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"AqT4lz9x1S"}],"key":"iVAHwbqY3S"}],"key":"p3lunuulh7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the Loss","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"njrZfNUF90"}],"identifier":"plot-the-loss","label":"Plot the Loss","html_id":"plot-the-loss","implicit":true,"key":"al8KhGpLvO"}],"key":"FRS4VM0Aen"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print('Plot the loss')\nplt.plot(model_history.history['loss'], label='Training Loss')\n#plt.plot(model_history.history['val_loss'], label='Validation Loss')\nplt.title('5x5 Kernel Model Loss')\nplt.ylabel('Loss')\nplt.xlabel('Epoch')\nplt.yticks(np.arange(0, 0.40, step=0.025))\nplt.xticks(np.arange(0, 14, step=1))\nplt.ylim(0, 0.35)\nplt.xlim(0, 12)\nplt.grid()\nplt.legend(loc='upper right')\nplt.savefig('task2_model_loss.png')\nplt.show()","key":"DB5JT5xtY8"},{"type":"outputs","id":"CZTll84sklCn1mOo___gX","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Plot the loss\n"},"children":[],"key":"Bw0AcQm2O1"},{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c291a9c8546889c28e64337088e46501","path":"/c291a9c8546889c28e64337088e46501.png"},"text/plain":{"content":"<Figure size 640x480 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"A0yb8xKdQB"}],"key":"r56FAfu454"}],"key":"QOQhLplxo9"}],"key":"uDVheOmEdq"},"references":{"cite":{"order":[],"data":{}}}}