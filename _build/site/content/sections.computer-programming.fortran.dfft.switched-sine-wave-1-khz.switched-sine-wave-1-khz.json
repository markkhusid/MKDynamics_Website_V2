{"version":3,"kind":"Notebook","sha256":"46259cf6c7ca29b8a8e4ab3f7b25eb88d4ee9e70319c5831c4e409c6c2d3b29a","slug":"sections.computer-programming.fortran.dfft.switched-sine-wave-1-khz.switched-sine-wave-1-khz","location":"/Sections/Computer_Programming/Fortran/DFFT/Switched_Sine_Wave_1_kHz/switched_sine_wave_1_kHz.ipynb","dependencies":[],"frontmatter":{"title":"Switched 1 kHz Sine Wave","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Mark Khusid","given":"Mark","family":"Khusid"},"name":"Mark Khusid","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/markkhusid/MKDynamics_Website_V2","numbering":{"title":{"offset":4}},"source_url":"https://github.com/markkhusid/MKDynamics_Website_V2/blob/master/Sections/Computer_Programming/Fortran/DFFT/Switched_Sine_Wave_1_kHz/switched_sine_wave_1_kHz.ipynb","edit_url":"https://github.com/markkhusid/MKDynamics_Website_V2/edit/master/Sections/Computer_Programming/Fortran/DFFT/Switched_Sine_Wave_1_kHz/switched_sine_wave_1_kHz.ipynb","exports":[{"format":"ipynb","filename":"switched_sine_wave_1_kHz.ipynb","url":"/switched_sine_wave_1-f21c7f11a126f464e845439695243f10.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this example, we will a switched sine wave at a frequency of 1 kHz and a duty cycle of 50%. We will then plot the resulting signal in the time domain and in the frequency domain.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dOkMWiDysc"}],"key":"NF08LZ7Mlc"}],"key":"WLTh7HB5Ps"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Import Required Libraries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"s4SWLUOY5B"}],"identifier":"import-required-libraries","label":"Import Required Libraries","html_id":"import-required-libraries","implicit":true,"key":"HNjyL4x5rd"}],"key":"zdXCCdSoo6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%matplotlib inline\nimport matplotlib\nimport numpy as np\nfrom scipy.signal import square\nimport wave, math\n\nfrom matplotlib import pyplot as plt","key":"vUFM7X1exf"},{"type":"outputs","id":"2Jy9ncIJnD1-quA8Zfso5","children":[],"key":"ESlogV9Wu8"}],"key":"HdTu37ZEVX"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Define the Parameters such as the Sampling Frequency, the Duration of the Signal, and the Frequencies of the Sine Waves","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rPw4h4nxiD"}],"identifier":"define-the-parameters-such-as-the-sampling-frequency-the-duration-of-the-signal-and-the-frequencies-of-the-sine-waves","label":"Define the Parameters such as the Sampling Frequency, the Duration of the Signal, and the Frequencies of the Sine Waves","html_id":"define-the-parameters-such-as-the-sampling-frequency-the-duration-of-the-signal-and-the-frequencies-of-the-sine-waves","implicit":true,"key":"PLmazpjHDG"}],"key":"oWI0NHdsLl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Variables\nsRate = 100e3 # sample rate in Hertz (10 MHz)\nfreq1 = 1e3 # frequency of first sine wave (1 MHz)\nfreq2 = 500 # frequency of square wave (1 MHz)\namplitude1 = 1 # amplitude of first wave\namplitude2 = 1 # amplitude of second wave\nnumPeriods = 10 # number of periods of the waves\nnumSamples = sRate * numPeriods # total number of samples","key":"AWXE08pbOj"},{"type":"outputs","id":"FXeCAT5GYGBR4b6TAKFEK","children":[],"key":"U1y2Ndyv2R"}],"key":"smIRUPPOrr"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create Plotting Helper Function","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n67wKTGTLY"}],"identifier":"create-plotting-helper-function","label":"Create Plotting Helper Function","html_id":"create-plotting-helper-function","implicit":true,"key":"fQCdRtdh5y"}],"key":"SDpr6NCQm7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Graphing helper function\ndef setup_graph(title='', x_label='', y_label='', fig_size=None):\n    fig = plt.figure()\n    if fig_size != None:\n        fig.set_size_inches(fig_size[0], fig_size[1])\n    ax = fig.add_subplot(111)\n    ax.set_title(title)\n    ax.set_xlabel(x_label)\n    ax.set_ylabel(y_label)","key":"D2LSdNH1Qg"},{"type":"outputs","id":"FnSfk5NXJohzeWVEdIJVq","children":[],"key":"cbknGp9fVE"}],"key":"L0MEF4y47L"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generate the X-Axis for the Time Domain Signal","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kNNDPFGr0b"}],"identifier":"generate-the-x-axis-for-the-time-domain-signal","label":"Generate the X-Axis for the Time Domain Signal","html_id":"generate-the-x-axis-for-the-time-domain-signal","implicit":true,"key":"i0sNdsza6U"}],"key":"ZcPOtJrycR"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The X-axis for the time domain signal will be generated using the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iT6R4kKbSx"},{"type":"inlineCode","value":"numpy","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ruzegmxff4"},{"type":"text","value":" library.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EjIbvomTyD"}],"key":"otknXJaxJq"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To generate the X-axis for the time domain signal, we will use the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"G8JhSDDI4d"},{"type":"inlineCode","value":"numpy.linspace","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QQn9YyaVeJ"},{"type":"text","value":" function. This function generates an array of evenly spaced numbers over a specified interval.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"cyhDn4V3GP"}],"key":"dGMen583e8"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The function takes three arguments: ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NJowKg6u2y"},{"type":"inlineCode","value":"start","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JMJJZvnfB9"},{"type":"text","value":", ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wlEzkxXey4"},{"type":"inlineCode","value":"stop","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CTtyX4sCQZ"},{"type":"text","value":", and ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"iCyAeePH6K"},{"type":"inlineCode","value":"num","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"M9w3EPU0cC"},{"type":"text","value":". The ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"yYv39CPK2d"},{"type":"inlineCode","value":"start","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xWgYMHmfcP"},{"type":"text","value":" argument specifies the starting value of the sequence, the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"QdeoBNldUA"},{"type":"inlineCode","value":"stop","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"NdYKMB2g6L"},{"type":"text","value":" argument specifies the end value of the sequence, and the ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"fBp59hhvnV"},{"type":"inlineCode","value":"num","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"JKGkPjNmmY"},{"type":"text","value":" argument specifies the number of samples to generate.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"lmlv6y2kDQ"}],"key":"ODbecaGb3F"}],"key":"Pm4QoSyNob"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Create the x axis from 0 to numPeriods, divided into numSamples samples.\nx = np.linspace(0, int(numPeriods), int(numSamples))","key":"B1hZ9kWSqx"},{"type":"outputs","id":"AtTUQRaFccCvPyJXrd3Aq","children":[],"key":"i7j1Uk2Bsw"}],"key":"qy2J1Ikvo6"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Print out the length of x to make sure it is numSamples long.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hCtGXUw9ut"}],"key":"qDEHyvtU4F"}],"key":"h3imNDlv1Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"len(x)","key":"NsxzrFP88Q"},{"type":"outputs","id":"CVHSeRRhHV51p6cHzgxVr","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/plain":{"content":"1000000","content_type":"text/plain"}}},"children":[],"key":"TuXZLPxTds"}],"key":"qeKJCEUdsY"}],"key":"i1HGanQgbb"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generate the Sine Wave","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O3LDup0UDZ"}],"identifier":"generate-the-sine-wave","label":"Generate the Sine Wave","html_id":"generate-the-sine-wave","implicit":true,"key":"C21jmOwzsN"}],"key":"k5J4sRCAwM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"f1 = amplitude1*np.sin(freq1*2*np.pi*x)","key":"MuMvXKNEoE"},{"type":"outputs","id":"KWd4-HvI7QG83FkB0K-Le","children":[],"key":"CXNaQIIHyc"}],"key":"HohwUmVwDm"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generate the Square Wave that is Half the Frequency of the Sine Wave","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A1laJdh1Wd"}],"identifier":"generate-the-square-wave-that-is-half-the-frequency-of-the-sine-wave","label":"Generate the Square Wave that is Half the Frequency of the Sine Wave","html_id":"generate-the-square-wave-that-is-half-the-frequency-of-the-sine-wave","implicit":true,"key":"YvGmR1Th10"}],"key":"ZpO1gg59Ie"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Generate the square wave with the same number of samples as the sine wave\n# and an amplitude of 1 by providing an amplitude of 0.5 and then adding 0.5 \n# to the result.\nf2 = 0.5*amplitude2*square(freq2*2*np.pi*x)+0.5*amplitude2","key":"lByEiSIytW"},{"type":"outputs","id":"-c5IDKxzsZV9KMxTc6hWH","children":[],"key":"aFHWygXyBo"}],"key":"eAGHtZMMqK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Multiply the Sine Wave by the Square Wave","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tOEaMRFRvQ"}],"identifier":"multiply-the-sine-wave-by-the-square-wave","label":"Multiply the Sine Wave by the Square Wave","html_id":"multiply-the-sine-wave-by-the-square-wave","implicit":true,"key":"EqZTgmP0gl"}],"key":"F65Pms1d9p"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fcomb = f1 * f2","key":"JffF98mp5n"},{"type":"outputs","id":"FgZkyoU_303-bBsGntzWT","children":[],"key":"iWa9Sh4BuS"}],"key":"WZUOD1Rffk"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Check the length of the combined signal to make sure it is numSamples long.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HYHpSgtW0n"}],"key":"i1ufokL6r8"}],"key":"NmfgYT5Y4G"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"len(fcomb)","key":"eC5dKQECHm"},{"type":"outputs","id":"Sg2pkVunVd9gznfol-ZRf","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"1000000","content_type":"text/plain"}}},"children":[],"key":"wobR5OR3fz"}],"key":"CSPRuxmJQf"}],"key":"WQthO9kgvb"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the Time Domain Signals","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"E5kv9AlGkK"}],"identifier":"plot-the-time-domain-signals","label":"Plot the Time Domain Signals","html_id":"plot-the-time-domain-signals","implicit":true,"key":"TCrFZ6yVcU"}],"key":"fb8pDITblj"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"fig = plt.figure()\nfig.set_size_inches(12,6)\nplt.subplots_adjust(hspace=1)\nt_final = 0.01 # seconds\n\nplt.subplot(311)\nplt.plot(x, f1)\nplt.title('Sine wave {0:d} Hz'.format(int(freq1)))\nplt.xlabel('Time [sec]')\nplt.ylabel('Amplitude [arbitrary]')\nplt.xlim(0, t_final)\nplt.ylim(np.floor(min(f1)), np.ceil(max(f1)))\n\nplt.subplot(312)\nplt.plot(x, f2)\nplt.title('Square wave {0:d} Hz'.format(int(freq2)))\nplt.xlabel('Time [sec]')\nplt.ylabel('Amplitude [arbitrary]')\nplt.xlim(0, t_final)\nplt.ylim(2*np.floor(min(f2)), 2*np.ceil(max(f2)))\n\nplt.subplot(313)\nplt.plot(x, fcomb)\nplt.title('Sine wave {0:d} Hz x Square wave {1:d} Hz'.format(int(freq1), int(freq2)))\nplt.xlabel('Time [sec]')\nplt.ylabel('Amplitude [arbitrary]')\nplt.xlim(0, t_final)\nplt.ylim(np.floor(min(fcomb)), np.ceil(max(fcomb)))\nplt.show()","key":"hjSsDg7VAT"},{"type":"outputs","id":"ju9IXpDIeAmzF7o37O8Zy","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a738d980c2082e8e62049553d4275f66","path":"/a738d980c2082e8e62049553d4275f66.png"},"text/plain":{"content":"<Figure size 1200x600 with 3 Axes>","content_type":"text/plain"}}},"children":[],"key":"iW3YGLml1f"}],"key":"jRrXzv1RWf"}],"key":"rpdsy6uJxw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fft_output = np.fft.rfft(f1)\nmagnitude = [np.sqrt(i.real**2+i.imag**2)/len(fft_output) for i in fft_output]\nfrequencies = [(i*1.0/numSamples)*sRate for i in range(int(numSamples)//2+1)]","key":"tlk394iRZC"},{"type":"outputs","id":"gsz2J6nBi3y5rCoqoSWm0","children":[],"key":"Q2MKytP1cF"}],"key":"AWgrw0WS0N"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"setup_graph(x_label='frequency [Hz]', y_label='amplitude [arbitrary]', \n            title='Sine Wave Frequency Domain', fig_size=(12,6))\nplt.xlim(0, 4000)\nplt.plot(frequencies, magnitude, 'r')\nplt.show()\n","key":"IhPWz9blyj"},{"type":"outputs","id":"lJcBTiVdbISPspioTN2jb","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"eb64fdc5f30d380e8c9d74b70f7752aa","path":"/eb64fdc5f30d380e8c9d74b70f7752aa.png"},"text/plain":{"content":"<Figure size 1200x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"nTyPixbSUy"}],"key":"AsNliK54JE"}],"key":"yEub4f8ArS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fft_output = np.fft.rfft(f2)\nmagnitude = [np.sqrt(i.real**2+i.imag**2)/len(fft_output) for i in fft_output]\nfrequencies = [(i*1.0/numSamples)*sRate for i in range(int(numSamples)//2+1)]","key":"mN0kLjlLHy"},{"type":"outputs","id":"3h-s6poFUE5Wp2yn9ygN0","children":[],"key":"gw2FuMi8OV"}],"key":"RfJCbMez9F"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"setup_graph(x_label='frequency [Hz]', y_label='amplitude [arbitrary]', \n            title='Square Wave Frequency Domain', fig_size=(12,6))\nplt.xlim(-100, 8000)\nplt.ylim(0, 1)\nplt.plot(frequencies, magnitude, 'r')\nplt.show()\n","key":"eZrO814jHR"},{"type":"outputs","id":"Gx46AQGD3Id_yp-SnI1U7","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9de1cfbd2b61884a4558b490407add55","path":"/9de1cfbd2b61884a4558b490407add55.png"},"text/plain":{"content":"<Figure size 1200x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"L1iPXWVtct"}],"key":"cDfO1lLKo2"}],"key":"BM8pb2DzTA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fft_output = np.fft.rfft(fcomb)\nmagnitude = [np.sqrt(i.real**2+i.imag**2)/len(fft_output) for i in fft_output]\nfrequencies = [(i*1.0/numSamples)*sRate for i in range(int(numSamples)//2+1)]","key":"pmhJFOW6wx"},{"type":"outputs","id":"NObByXcQHbXsHrT6zbZJn","children":[],"key":"OLUobaNeUf"}],"key":"ZSQChsRz8E"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"setup_graph(x_label='frequency [Hz]', y_label='amplitude [arbitrary]', \n            title='Sine Wave x Square Wave Frequency Domain', fig_size=(12,6))\nplt.xlim(0, 8000)\nplt.plot(frequencies, magnitude, 'r')\nplt.show()\n","key":"lmsXMLmK2e"},{"type":"outputs","id":"TvDnLBnjE6yuoisySVjp4","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"3d01b7bc51200af9dd12fa59f9e59749","path":"/3d01b7bc51200af9dd12fa59f9e59749.png"},"text/plain":{"content":"<Figure size 1200x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"FeqjFZ4WOQ"}],"key":"xUmVM5quoq"}],"key":"k8IkAGZCGO"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"len(fcomb)","key":"GMtQnkGjhy"},{"type":"outputs","id":"DLpJbrexaiQm6ne0pCATC","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/plain":{"content":"1000000","content_type":"text/plain"}}},"children":[],"key":"r9yqxBmkyP"}],"key":"uSzNAobIip"}],"key":"RQSQvY0r1F"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"len(magnitude)","key":"WGfb4Pfnvd"},{"type":"outputs","id":"3IioXRQ0Ym02Xd1H9_Ud5","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/plain":{"content":"500001","content_type":"text/plain"}}},"children":[],"key":"qUjBTG8hAc"}],"key":"sFA6wrpQFL"}],"key":"Yo4E33YSjr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"len(frequencies)","key":"ifBPWGSs3C"},{"type":"outputs","id":"F10XjhrWaveA85PIR6oIt","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"500001","content_type":"text/plain"}}},"children":[],"key":"PzhqdEzvyt"}],"key":"mSksxxgPHC"}],"key":"MvFQQ7QS8a"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Generate Output Files","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CDvz7tmTor"}],"identifier":"generate-output-files","label":"Generate Output Files","html_id":"generate-output-files","implicit":true,"key":"gJawuHVy0X"}],"key":"is1sYBN9Dt"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Save the magnitude and the frequencies to files.  These files will be processed through the DFFT Fortran program.  The output of the program will be compared to the magnitude and frequencies generated by the Python program.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CcHwURCMLR"}],"key":"X1QG77tEoJ"}],"key":"qfLjTVK88o"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print ('Opening data files...')\ndataFile = open('sw_sine_1kHz.dat', 'wt')  # To be run through Fortran code. Has amplitudes only.\ntd_dataFile = open('sw_sine_1kHz_time_domain.dat', 'wt')  # Has time domain amplitude and time data\nfd_dataFile = open('sw_sine_1kHz_freq_domain.dat', 'wt')  # Has freq domain amplitude and corrected FFT frequencies (bins)\n\nprint ('Writing data files...')\nnp.savetxt(dataFile, fcomb, fmt='%10.10f', delimiter=' ', newline='\\n')\nnp.savetxt(td_dataFile, np.column_stack([fcomb, x]), fmt='%10.10f', newline='\\n')\nnp.savetxt(fd_dataFile, np.column_stack([magnitude, frequencies]), fmt='%10.10f', newline='\\n')","key":"jdifi4BNsh"},{"type":"outputs","id":"8FpgTwDDqY4NHyvCxhTOh","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Opening data files...\nWriting data files...\n"},"children":[],"key":"LeHpIbLUs2"}],"key":"Kq2XATVaZ0"}],"key":"XsYMNBr5jh"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Execute DFFT Fortran Program","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vqxZ986xoj"}],"identifier":"execute-dfft-fortran-program","label":"Execute DFFT Fortran Program","html_id":"execute-dfft-fortran-program","implicit":true,"key":"QNEiHJPbYD"}],"key":"FNEz7B6rra"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The DFFT Fortran program will be executed on the data file that contains the time domain data of the combined signal.  The program will output the magnitude and phase of the Fourier transform of the signal into two separate files: DFFT_mag_file.dat and DFFT_phase_file.dat.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"P4ZbmIjQ2H"}],"key":"VK3NgNInLy"}],"key":"DIYQZlbfcL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nexec_status = os.system(\"./dfft sw_sine_1kHz.dat DFFT_mag_file.dat DFFT_phase_file.dat 100000 10 > log.txt\")","key":"y1FAN771yr"},{"type":"outputs","id":"mx1PK52q0bWAlvZO3T2P7","children":[],"key":"WMQYuyVCMj"}],"key":"cv1KfetaxS"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot the DFFT Program Output","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YE8qzEKdn2"}],"identifier":"plot-the-dfft-program-output","label":"Plot the DFFT Program Output","html_id":"plot-the-dfft-program-output","implicit":true,"key":"yR3bZmtI3Z"}],"key":"lQ2GYawjf7"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"DFFT_mag_raw_data = np.loadtxt('DFFT_mag_file.dat')\nDFFT_phase_raw_data = np.loadtxt('DFFT_phase_file.dat')","key":"dtE8KdKXvu"},{"type":"outputs","id":"1wnI5fZ_ssRLT9pozz9DN","children":[],"key":"HiXMcVusu4"}],"key":"z51YsULkoa"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Get the frequency bins\nDFFT_freq_bins = [row[1] for row in DFFT_mag_raw_data]","key":"uCzK8v7LDp"},{"type":"outputs","id":"eCoLq_OqLezLImJCV7n9d","children":[],"key":"ONQqIkqeB6"}],"key":"MY49emeT9q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Get the magnitude data\nDFFT_mag_data = [row[0] for row in DFFT_mag_raw_data]","key":"csEbhHu21i"},{"type":"outputs","id":"sUSgigGBKFvrlHAuIw_Zs","children":[],"key":"iPzbg8RAdt"}],"key":"lxzVo7kXsd"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Plot the magnitude data\nsetup_graph(x_label='frequency [Hz]', y_label='amplitude [arbitrary]', \n            title='Frequency Domain', fig_size=(12,6))\nplt.plot(DFFT_freq_bins, DFFT_mag_data, 'r', label = 'DFFT Program Output')\nplt.plot(frequencies, magnitude, linestyle='--', color='blue', alpha=0.5, label = 'Python FFT Output')\nplt.legend()\nplt.xlim(0, sRate/numPeriods)\nplt.ylim(0, max(DFFT_mag_data)+0.1)\nplt.xticks(np.arange(0, sRate/numPeriods, step=1000))\nplt.show()","key":"SSvUnRz9tK"},{"type":"outputs","id":"oUtUkmv9ENtSi0iGxCqPn","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c558913a749b52beeb2b0763dc11788a","path":"/c558913a749b52beeb2b0763dc11788a.png"},"text/plain":{"content":"<Figure size 1200x600 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"vp9cgA9Ebh"}],"key":"QLC5xJrsQ1"}],"key":"cgC9EbGkAC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Discussion","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F1258umdVO"}],"identifier":"discussion","label":"Discussion","html_id":"discussion","implicit":true,"key":"Co3YZNd83W"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"When we compare the Python program output to the DFFT program output, we see that the magnitude and phase of the Fourier transform of the signal are almost the same.  The slight differences are due to the leakage of some of the energy of the signal into the neighboring frequency bins.  This is a common problem when using the Fourier transform to analyze signals.  The leakage can be reduced by using a window function to taper the signal before taking the Fourier transform.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"cE2dGdTZ7k"}],"key":"dQa7chQS1J"}],"key":"ObjuUxE3VB"}],"key":"zkJF1WJR0l"},"references":{"cite":{"order":[],"data":{}}}}