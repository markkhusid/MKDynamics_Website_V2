{"version":3,"kind":"Notebook","sha256":"a53535535fe7fcd8e36adc89897c86eef3e2c94a169d2e170c5cc46b4e21a051","slug":"sections.computer-programming.fortran.csv-fortran.csv-fortran-write-csv","location":"/Sections/Computer_Programming/Fortran/CSV_Fortran/csv_fortran_write_csv.ipynb","dependencies":[],"frontmatter":{"title":"Section: Write CSV Files","content_includes_title":true,"kernelspec":{"name":"py311_env","display_name":"Python 3.11","language":"python"},"authors":[{"nameParsed":{"literal":"Mark Khusid","given":"Mark","family":"Khusid"},"name":"Mark Khusid","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/markkhusid/MKDynamics_Website_V2","numbering":{"title":{"offset":4}},"source_url":"https://github.com/markkhusid/MKDynamics_Website_V2/blob/master/Sections/Computer_Programming/Fortran/CSV_Fortran/csv_fortran_write_csv.ipynb","edit_url":"https://github.com/markkhusid/MKDynamics_Website_V2/edit/master/Sections/Computer_Programming/Fortran/CSV_Fortran/csv_fortran_write_csv.ipynb","exports":[{"format":"ipynb","filename":"csv_fortran_write_csv.ipynb","url":"/csv_fortran_write_cs-981c8175b6541b05a71feabe29db2685.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"code","lang":"","value":"---\njupytext:\n  formats: md:myst\n  text_representation:\n    extension: .md\n    format_name: myst\nkernelspec:\n  display_name: Python 3\n  language: python\n  name: python3\n---","key":"swYTlWvv3O"}],"key":"UhKKWq9nXC"},{"type":"block","kind":"notebook-content","data":{"vscode":{"languageId":"raw"}},"children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Section: Write CSV Files","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TtZ1fK1IpX"}],"identifier":"section-write-csv-files","label":"Section: Write CSV Files","html_id":"section-write-csv-files","implicit":true,"key":"mz2Wohvljn"}],"key":"tA8WZFLgVR"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this section, we will write CSV files in Fortran using the CSV_Fortran Module.  The CSV_Fortran Module is a Fortran module that provides a simple interface for reading and writing CSV files.  The module is available at ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cdDnL7ZGfC"},{"type":"link","url":"https://github.com/jacobwilliams/csv-fortran","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"https://​github​.com​/jacobwilliams​/csv​-fortran","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ioiB28fI7D"}],"urlSource":"https://github.com/jacobwilliams/csv-fortran","error":true,"key":"qV9he0Y3Jq"},{"type":"text","value":".  Documentation for the module is available at ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"szp13H2vzR"},{"type":"link","url":"https://jacobwilliams.github.io/csv-fortran/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"https://​jacobwilliams​.github​.io​/csv​-fortran/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xlZP9d7cwY"}],"urlSource":"https://jacobwilliams.github.io/csv-fortran/","key":"D9BqnvnVnd"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JhC2A6V1bk"}],"key":"nYBxEVBMNi"}],"key":"q6mHaOhFA9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example Programs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bcNwQ3ODJb"}],"identifier":"example-programs","label":"Example Programs","html_id":"example-programs","implicit":true,"key":"O83jCzSUaC"}],"key":"zSex6V8MAa"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the documentation for the CSV_Fortran Module, there are several example programs that demonstrate how to read and write CSV files.  We will use the example programs to demonstrate how to write CSV files in Fortran.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"B8ieYvmo8m"}],"key":"sE8AH95mfC"}],"key":"pgTmcpyxmB"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Writing a CSV File","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"q6BNxCtCCQ"}],"identifier":"writing-a-csv-file","label":"Writing a CSV File","html_id":"writing-a-csv-file","implicit":true,"key":"mSLmRLo9Bf"}],"key":"adrUoouSaK"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The following example program writes a CSV file named ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c5mXfwjpjb"},{"type":"inlineCode","value":"test.csv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bBvywaGloO"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tR21Hi9GEg"}],"key":"Uh9R27z742"}],"key":"rt4uRDeij2"},{"type":"block","kind":"notebook-content","children":[{"type":"include","file":"Fortran_Code/Section_CSV_Fortran_Write_CSV/app/section_csv_fortran_write_csv.f90","literal":true,"children":[{"type":"code","value":"program csv_write_test\n\n  use csv_module\n    use iso_fortran_env, only: wp => real64\n\n    implicit none\n\n    type(csv_file) :: f\n    logical :: status_ok\n\n    ! set optional inputs:\n    call f%initialize(verbose = .true.)\n\n    ! open the file\n    call f%open('test.csv',n_cols=4,status_ok=status_ok)\n\n    ! add header\n    call f%add(['x','y','z','t'])\n    call f%next_row()\n\n    ! add some data:\n    call f%add([1.0_wp,2.0_wp,3.0_wp],real_fmt='(F5.3)')\n    call f%add(.true.)\n    call f%next_row()\n    call f%add([4.0_wp,5.0_wp,6.0_wp],real_fmt='(F5.3)')\n    call f%add(.false.)\n    call f%next_row()\n\n    ! finished\n    call f%close(status_ok)\n  \nend program csv_write_test\n","lang":"fortran","filename":"section_csv_fortran_write_csv.f90","key":"n0MGa6G3aM"}],"key":"jiJRw3j4Gf"}],"key":"WM7EUkQIaE"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The program writes a CSV file named ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vI16CHw4ob"},{"type":"inlineCode","value":"test.csv","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OUg7a8BNlA"},{"type":"text","value":" with the following contents:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nVQ0hkPnzQ"}],"key":"OpzGC6ZSop"},{"type":"code","lang":"bash","value":"x,y,z,t\n1.000,2.000,3.000,T\n4.000,5.000,6.000,F","position":{"start":{"line":3,"column":1},"end":{"line":7,"column":1}},"key":"JK2kv7piDW"}],"key":"F5s3sjcc6T"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Building the Example Program using FPM (Fortran Package Manager)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HhXbLHCFXO"}],"identifier":"building-the-example-program-using-fpm-fortran-package-manager","label":"Building the Example Program using FPM (Fortran Package Manager)","html_id":"building-the-example-program-using-fpm-fortran-package-manager","implicit":true,"key":"JV4q3mdZ5W"}],"key":"qvIbWWYjf1"},{"type":"block","kind":"notebook-content","data":{"vscode":{"languageId":"raw"}},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"TOML File","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"el99U0Lzi6"}],"identifier":"toml-file","label":"TOML File","html_id":"toml-file","implicit":true,"key":"TXdcXonfLk"}],"key":"KBcoYu9Twj"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The above program was compiled using the Fortran Package Manager (FPM).  The following is the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WGCOhWdEwb"},{"type":"inlineCode","value":"fpm.toml","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rxUAJT3re3"},{"type":"text","value":" file used to build the program:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hHBlDPuk9o"}],"key":"gvDmto0nqc"}],"key":"HCZu5zznfT"},{"type":"block","kind":"notebook-content","children":[{"type":"include","file":"Fortran_Code/Section_CSV_Fortran_Write_CSV/fpm.toml","literal":true,"children":[{"type":"code","value":"name = \"Section_CSV_Fortran_Write_CSV\"\n\n[build]\nauto-executables = true\nauto-tests = true\nauto-examples = true\n\n[install]\nlibrary = false\n\n[dependencies]\ncsv-fortran = { git=\"https://github.com/jacobwilliams/csv-fortran.git\" }\n\n[[executable]]\nname=\"Section_CSV_Fortran_Write_CSV\"\nsource-dir=\"app\"\nmain=\"section_csv_fortran_write_csv.f90\"\n\n\n","lang":"toml","filename":"fpm.toml","key":"LMN0be3w1N"}],"key":"UN5RGo3UHb"}],"key":"sb20BxpvIa"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Build the Program","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Uqk0mybRTS"}],"identifier":"build-the-program","label":"Build the Program","html_id":"build-the-program","implicit":true,"key":"DDx676rqMq"}],"key":"Gl5qHpdznZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\nroot_dir = \"\"\nroot_dir = os.getcwd()","key":"u8e5wYEszW"},{"type":"outputs","id":"Odicd8v8pblMrq2V4JooK","children":[],"key":"F1zEKbhHZb"}],"key":"UAG5B0iwOQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"code_dir = root_dir + \"/\" + \"Fortran_Code/Section_CSV_Fortran_Write_CSV\"","key":"HTqyNl9En1"},{"type":"outputs","id":"Tdz5KCkrT5YmG0J3Xrswz","children":[],"key":"xWQR9ezOmt"}],"key":"hfBF4hGHsv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"os.chdir(code_dir)","key":"DtkZZO6I8H"},{"type":"outputs","id":"yFm9Zm7_jNr2A2SZ7dflg","children":[],"key":"qYKdC18bhf"}],"key":"bBBAvKTUav"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"build_status = os.system(\"fpm build 2>/dev/null\")","key":"LDtNEK8NHH"},{"type":"outputs","id":"uRpUrG60pYu37R-Yd1zKR","children":[],"key":"BW9ABUswFc"}],"key":"QI8iviZoJ7"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Run the Program","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Zjnn3Ikfd3"}],"identifier":"run-the-program","label":"Run the Program","html_id":"run-the-program","implicit":true,"key":"GiYkumdWWe"}],"key":"AQsDJDXygQ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The program is run and the output is saved into a file named 'data.dat","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"KbieK8l3Fz"}],"key":"vLjHigathe"}],"key":"w9FdJDrvuA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"exec_status = \\\n    os.system(\"fpm run 2>/dev/null\")","key":"mOj2jo3FT6"},{"type":"outputs","id":"_41Mq4VAgBD5VbyV7MG4v","children":[],"key":"l4iLtmXOyy"}],"key":"do48tcGbs1"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Examine the Output File","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O0g6sGLStR"}],"identifier":"examine-the-output-file","label":"Examine the Output File","html_id":"examine-the-output-file","implicit":true,"key":"bRIFsHBtAc"}],"key":"qfWCli2QPy"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"!cat test.csv","key":"bRnpM8clFR"},{"type":"outputs","id":"AZNc0FsK_WrY8CLAGHrXq","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"\"x\",\"y\",\"z\",\"t\"\n1.000,2.000,3.000,T\n4.000,5.000,6.000,F\n"},"children":[],"key":"yjZ3NjBcOy"}],"key":"hFLnMgDyUh"}],"key":"wbem9M6cPo"}],"key":"xWE3vS2KG8"},"references":{"cite":{"order":[],"data":{}}}}