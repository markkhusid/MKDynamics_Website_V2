{"version":3,"kind":"Notebook","sha256":"3c67d251e6b4992fc92a31ee40691bb20563802edc4eef907b1e296985c8b60d","slug":"sections.computer-programming.fortran.modern-fortran.tsunami-simulator","location":"/Sections/Computer_Programming/Fortran/Modern_Fortran/Tsunami_Simulator.ipynb","dependencies":[],"frontmatter":{"title":"Tsunami Simulator","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Mark Khusid","given":"Mark","family":"Khusid"},"name":"Mark Khusid","id":"contributors-myst-generated-uid-0"}],"github":"https://github.com/markkhusid/MKDynamics_Website_V2","numbering":{"title":{"offset":4}},"source_url":"https://github.com/markkhusid/MKDynamics_Website_V2/blob/master/Sections/Computer_Programming/Fortran/Modern_Fortran/Tsunami_Simulator.ipynb","edit_url":"https://github.com/markkhusid/MKDynamics_Website_V2/edit/master/Sections/Computer_Programming/Fortran/Modern_Fortran/Tsunami_Simulator.ipynb","exports":[{"format":"ipynb","filename":"Tsunami_Simulator.ipynb","url":"/Tsunami_Simulator-5dea9ecbbd011cf052066e1a5da40d0d.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The following program simulates a tsunami water wave. ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"vza3JoJuIb"},{"type":"break","key":"iNuB12FRNc"},{"type":"text","value":"\nAdapted from: “","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"rmO2TXtPPb"},{"type":"link","url":"https://www.manning.com/books/modern-fortran","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Modern Fortran: Building Efficient Parallel Applications","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"PJT2N474XJ"}],"urlSource":"https://www.manning.com/books/modern-fortran","key":"pZUHtWSRsA"},{"type":"text","value":"” by Milan Curcic (Manning)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"daZIl10SFR"}],"key":"x79ToC6YEZ"}],"key":"Oezrb9uWpS"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The tsunami water wave height and speed will be calculated using the advection equation.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jvsDVLH5OO"}],"key":"bZjGH6TIEh"}],"key":"riHlV0pKk0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"From ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t26r4zGdHh"},{"type":"link","url":"https://en.wikipedia.org/wiki/Advection","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"wikipedia","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eibLq5drTi"}],"urlSource":"https://en.wikipedia.org/wiki/Advection","data":{"page":"Advection","wiki":"https://en.wikipedia.org/","lang":"en"},"internal":false,"protocol":"wiki","key":"GW7feVBcM8"},{"type":"text","value":":","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"MRs33nlA5P"}],"key":"DMqRfNdD21"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"zLK1XfiQyi"}],"key":"I9HtOPXIc3"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In the field of physics, engineering, and earth sciences, advection is the transport of a substance or quantity by bulk motion of a fluid.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YLKc7H3nZi"}],"key":"WeLpwMvHin"}],"key":"PjXKYmifxH"}],"key":"kMq9hTl3Xd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The Advection Equation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EG4CUSI2Bp"}],"identifier":"the-advection-equation","label":"The Advection Equation","html_id":"the-advection-equation","implicit":true,"key":"TuCUtOQoOF"}],"key":"v85PyVudBC"},{"type":"block","kind":"notebook-content","children":[{"type":"math","value":"\\Large \\frac{\\delta u}{\\delta t} + c\\frac{\\delta u}{\\delta x} = 0","position":{"start":{"line":1,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mstyle mathsize=\"1.44em\"><mfrac><mrow><mi>δ</mi><mi>u</mi></mrow><mrow><mi>δ</mi><mi>t</mi></mrow></mfrac><mo>+</mo><mi>c</mi><mfrac><mrow><mi>δ</mi><mi>u</mi></mrow><mrow><mi>δ</mi><mi>x</mi></mrow></mfrac><mo>=</mo><mn>0</mn></mstyle></mrow><annotation encoding=\"application/x-tex\">\\Large \\frac{\\delta u}{\\delta t} + c\\frac{\\delta u}{\\delta x} = 0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.9627em;vertical-align:-0.9878em;\"></span><span class=\"mord sizing reset-size6 size8\"><span class=\"mopen nulldelimiter sizing reset-size8 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.754em;\"><span class=\"pstrut\" style=\"height:3.44em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">t</span></span></span><span style=\"top:-3.67em;\"><span class=\"pstrut\" style=\"height:3.44em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-4.117em;\"><span class=\"pstrut\" style=\"height:3.44em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">u</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size8 size6\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin sizing reset-size6 size8\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.9627em;vertical-align:-0.9878em;\"></span><span class=\"mord mathnormal sizing reset-size6 size8\">c</span><span class=\"mord sizing reset-size6 size8\"><span class=\"mopen nulldelimiter sizing reset-size8 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.754em;\"><span class=\"pstrut\" style=\"height:3.44em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-3.67em;\"><span class=\"pstrut\" style=\"height:3.44em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-4.117em;\"><span class=\"pstrut\" style=\"height:3.44em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03785em;\">δ</span><span class=\"mord mathnormal\">u</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size8 size6\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel sizing reset-size6 size8\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.928em;\"></span><span class=\"mord sizing reset-size6 size8\">0</span></span></span></span></span>","enumerator":"1","key":"Nighp2rl5f"}],"key":"fol55zfK5z"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Program to Predict the Linear Advection of an Object, with Periodic Boundary Conditions","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TAAUosFMkY"}],"identifier":"program-to-predict-the-linear-advection-of-an-object-with-periodic-boundary-conditions","label":"Program to Predict the Linear Advection of an Object, with Periodic Boundary Conditions","html_id":"program-to-predict-the-linear-advection-of-an-object-with-periodic-boundary-conditions","implicit":true,"key":"JSxJoMRNj1"}],"visibility":"show","key":"y6RDEGqoy2"},{"type":"block","kind":"notebook-content","children":[{"type":"include","file":"Fortran_Code/Tsunami_Simulator/app/tsunami_simulator.f90","literal":true,"children":[{"type":"code","value":"program tsunami\n\n    implicit none\n    integer :: i, n\n    \n    integer, parameter :: grid_size = 100\n    integer, parameter :: num_time_steps = 100\n\n    real, parameter :: dt = 1 ! time step [s]\n    real, parameter :: dx = 1 ! grid spacing [m]\n    real, parameter :: c  = 1 ! phase speed [m/s]\n\n    real :: h(grid_size), dh(grid_size)\n    \n    integer, parameter :: icenter = 25\n    real, parameter    :: decay = 0.02\n    \n    logical :: file_exists\n    \n    open(9, file = 'tsunami_simulator_data.txt')\n    \n    if ( grid_size <= 0 ) stop 'grid_size must be > 0'\n    if ( dt <= 0 ) stop 'time step dt must be > 0'\n    if ( dx <= 0 ) stop 'grid spacing dx must be > 0'\n    if ( c <= 0 )  stop 'background flow speed c must be > 0'\n    \n    do concurrent (i = 1:grid_size)\n        h(i) = exp(-decay * (i - icenter)**2)\n    end do\n    \n    !print *, 0, h\n    write (9, *) 0, h\n    close(9)\n    \n    time_loop: do n=1,num_time_steps    \n        \n        dh(1) = h(1) - h(grid_size)\n        \n        do concurrent (i = 2:grid_size)\n            dh(i) = h(i) - h(i-1)       \n        end do\n        \n        do concurrent (i = 1:grid_size)\n            h(i)=h(i)-c*dh(i) / dx * dt\n        end do\n        \n        !print *, n, h\n        inquire(file = 'tsunami_simulator_data.txt', exist = file_exists)\n        if (file_exists) then\n            open(9, file = 'tsunami_simulator_data.txt', status = 'old', position = 'append', action = 'write')\n        else\n            open(9, file = 'tsunami_simulator_data.txt', status = \"new\", action = 'write')\n        end if\n        \n        write (9, *) n, h\n\n    end do time_loop\n\n    close (9)\n    \nend program tsunami\n","lang":"fortran","filename":"tsunami_simulator.f90","key":"cP379TrS5r"}],"key":"vZyCVynN43"}],"key":"OuOKqYKAKH"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Program Explanation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iSC37kkEna"}],"identifier":"program-explanation","label":"Program Explanation","html_id":"program-explanation","implicit":true,"key":"M0frMUJf5B"}],"key":"GtMsPuaI0V"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The Fortran program ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DlZ53zYi6C"},{"type":"inlineCode","value":"tsunami","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JVKXhsSISj"},{"type":"text","value":" simulates the propagation of a wave in a one-dimensional grid using a basic numerical scheme akin to the finite difference method. The purpose of the program is to approximate how a disturbance, initialized in the middle of the domain, evolves over time given the specified parameters.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"imBnhCJWch"}],"key":"Niie5VbmOX"},{"type":"heading","depth":3,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Key Elements of the Program","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Gm3q28l4G1"}],"identifier":"key-elements-of-the-program","label":"Key Elements of the Program","html_id":"key-elements-of-the-program","implicit":true,"key":"HxGL3RZE1o"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Variable Declarations and Constants","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"wYrVNf2uLv"}],"key":"dYUJ9qrxRh"},{"type":"text","value":":","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BDAaiutxKI"}],"key":"UeB4jpCACF"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":6,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"grid_size","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Uv7xDPgo8T"},{"type":"text","value":": The number of grid points in the simulation domain.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"YSIHOT7E1X"}],"key":"lOplHD5jZx"}],"key":"JKwkuHBVz6"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"num_time_steps","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"IdfPqpdA3y"},{"type":"text","value":": The number of time steps for which the simulation will run.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"GdK9BuWMqC"}],"key":"hgAAsPWa19"}],"key":"iYrwPz7f27"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"dt","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"PdBArgKyvS"},{"type":"text","value":": Time step in seconds.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"XNFWsL7H4d"}],"key":"ohBmag8iHv"}],"key":"ejbbhhbgCN"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"dx","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"aawSFsddDm"},{"type":"text","value":": Spatial grid spacing in meters.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"TTPLkUZpNM"}],"key":"mkHtpZvJMK"}],"key":"UKFFQZYnEp"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"c","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Rl1WGsgNNX"},{"type":"text","value":": Phase speed of the wave in meters per second.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"c1cenXljHP"}],"key":"BkOwKae3ir"}],"key":"nmJoWHxgvg"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"h","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"u8Dlica6II"},{"type":"text","value":": Height of the wave at each grid point.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"vAW66wgQ4m"}],"key":"t14pEiJH1P"}],"key":"yJQDJ78CPf"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"dh","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"LRtqaH48bv"},{"type":"text","value":": Temporal change in height at each grid point between consecutive steps.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"xO8fcsTjhE"}],"key":"e3C6KucKrn"}],"key":"PtHKSYU70h"}],"key":"wT7qbZzfQz"}],"key":"bFckFamNjg"},{"type":"listItem","spread":true,"position":{"start":{"line":14,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Initialization","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"OwugAeEyrq"}],"key":"VtRaqxPJvY"},{"type":"text","value":":","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ayxcRy4cJe"}],"key":"wLVirBOYhW"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"An initial wave profile is set using a Gaussian-like exponential decay formula centered at ","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"LCA2ldcTTl"},{"type":"inlineCode","value":"icenter","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"KYtSd6voxG"},{"type":"text","value":", influencing how sharply the wave amplitude decreases away from the center.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"C1uvmP3f5a"}],"key":"avpeOwYMQP"}],"key":"xS6UpzoLCq"}],"key":"lzbcqlkvt6"}],"key":"I1WVII6vpP"},{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"strong","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"File Handling","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"Th7bTJkXRC"}],"key":"dizpTCgyMX"},{"type":"text","value":":","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"R4hYy4wbda"}],"key":"KVonQ0BDEQ"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The program opens a file named ‘tsunami_simulator_data.txt’ for output and checks for its existence before each write operation to handle potential errors or file state changes during execution.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"pgWtXnAZMk"}],"key":"eOUJ4z4prh"}],"key":"uGXUEyAL6S"}],"key":"L5nhemBWwk"}],"key":"R4AMFl2YbD"},{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"strong","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Numerical Scheme","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"QFta2nbxSS"}],"key":"weE0VYwS4T"},{"type":"text","value":":","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"mO3xyENzmn"}],"key":"BPNdgrC4uT"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":21,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The simulation uses a simple difference scheme to approximate the temporal evolution of the wave:","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"dy57FMbZnU"}],"key":"em3p2pk4LU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":22,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Boundary Condition","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"DPC9Be957B"}],"key":"yIlKpPhURy"},{"type":"text","value":": A cyclic boundary condition is assumed (","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"T6tymCkVAm"},{"type":"inlineCode","value":"dh(1) = h(1) - h(grid_size)","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"QE0OuL3jVI"},{"type":"text","value":"), which allows the wave to wrap around the domain, simulating an infinite or periodic space.","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"ro3Fv7b648"}],"key":"VybISyVYNK"}],"key":"PHKPbjpiM2"},{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Interior Points","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"k7tce6mrTa"}],"key":"riIUqxjwEm"},{"type":"text","value":": The change in height (","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"XKX7FZfePc"},{"type":"inlineCode","value":"dh","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"AzomfEorUr"},{"type":"text","value":") at each internal grid point is computed based on the difference with its immediate left neighbor.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"qyZxyoprfQ"}],"key":"HQj5d9vBpP"}],"key":"F5IPZSCWX2"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"paragraph","children":[{"type":"strong","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Update Step","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"fHIaCL0aBd"}],"key":"CzTFy6jk54"},{"type":"text","value":": The wave height at each grid point is updated using the computed differences, scaled by the wave speed, grid spacing, and time step.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"Uc6HrTMIiW"}],"key":"XlV3QrsKyR"}],"key":"VztJdqZCsk"}],"key":"YwGBGqDhoL"}],"key":"zq5rnXwhO8"}],"key":"q4zmpi5yB8"}],"key":"MnwhhXHVDW"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"strong","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Looping Structure","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"xLb2CX3Og5"}],"key":"gPYF9RA2d5"},{"type":"text","value":":","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"iPra28oBJQ"}],"key":"dKQN2CGA8y"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":27,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The main loop (","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"lAu7TlB9Hz"},{"type":"inlineCode","value":"time_loop","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"BgdBdDFH94"},{"type":"text","value":") iterates over the number of time steps, updating the wave’s profile at each step and writing the results to the output file.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"EIxjNb5br0"}],"key":"gJ3Qncme5Q"}],"key":"WlJzj8np9h"},{"type":"listItem","spread":true,"position":{"start":{"line":28,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"An ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"jkLOISQxK9"},{"type":"inlineCode","value":"inquire","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"yir5cVepP5"},{"type":"text","value":" statement checks if the output file still exists before attempting to append new data, which helps in managing output data integrity.","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"SHzBPyqYkw"}],"key":"b6um8ifOj8"}],"key":"aQmLHG5r2w"}],"key":"kVf0I3JS3z"}],"key":"Rt9jPUSZuc"},{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"strong","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Output","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"yV9SPgZ72g"}],"key":"w4WYAtxGnX"},{"type":"text","value":":","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"jgXtBILREq"}],"key":"VDgfIMFJ1w"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":31,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"For each time step, the wave heights across the grid are written to the file. This output can be used for further analysis or visualization of the wave’s propagation.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"SfSJLNcbjL"}],"key":"Z8xY2dbe1R"}],"key":"zmY00A7IZo"}],"key":"DsoR6e8SxN"}],"key":"qzLTDj6iEF"}],"key":"OPcwsV7vIU"},{"type":"heading","depth":3,"position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"Program Execution Details","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"yFYu6FLTpf"}],"identifier":"program-execution-details","label":"Program Execution Details","html_id":"program-execution-details","implicit":true,"key":"SJJCmVjAtD"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":35,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":35,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"strong","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"Initialization of ","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"tjypTG9U0g"},{"type":"inlineCode","value":"h","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"hDIgNpZEyo"}],"key":"Xka4tRpLbK"},{"type":"text","value":":","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"yy0qgdIQPq"}],"key":"VPHVlP2izr"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":36,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":36,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The wave height at each grid point is initialized to create a localized disturbance. The exponential decay formula makes the initial wave amplitude highest at the center and decreases moving away from the center.","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"VBt9l6AK9B"}],"key":"HkITqUL8C4"}],"key":"EJvp3RUKj8"}],"key":"vgdKDpOILN"}],"key":"JMCFrts8oQ"},{"type":"listItem","spread":true,"position":{"start":{"line":38,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"strong","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"text","value":"Time Evolution","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"c93KQAmfAP"}],"key":"ac7eYEoFJM"},{"type":"text","value":":","position":{"start":{"line":38,"column":1},"end":{"line":38,"column":1}},"key":"DURyRv50cr"}],"key":"blZXjekQ0P"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":39,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":39,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"At each time step, the program computes the spatial gradient of the wave heights, then adjusts the heights based on this gradient, effectively simulating the wave propagation.","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"iqtm9HVoE4"}],"key":"ts5F8Flo33"}],"key":"nb11iY0tBC"}],"key":"ADtLrxfaBi"}],"key":"oVFIGsL48w"},{"type":"listItem","spread":true,"position":{"start":{"line":41,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"strong","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"children":[{"type":"text","value":"File Operations","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"E9ZeIHizdu"}],"key":"XhskP2p4Gd"},{"type":"text","value":":","position":{"start":{"line":41,"column":1},"end":{"line":41,"column":1}},"key":"xV1yKFbNrr"}],"key":"EZMubk2q0q"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":42,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":42,"column":1},"end":{"line":43,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Before writing to the file, the program ensures it’s in the correct state (open and ready for appending), handling the possibility that the file might not be available or already open from previous operations.","position":{"start":{"line":42,"column":1},"end":{"line":42,"column":1}},"key":"ihpjiU3o6G"}],"key":"h49adN1Rns"}],"key":"tdguuQtEFc"}],"key":"odWrrHr8hZ"}],"key":"Ps7znvvEK9"}],"key":"BGavH4Z587"},{"type":"heading","depth":3,"position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Practical Applications","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"by2ms5stkz"}],"identifier":"practical-applications","label":"Practical Applications","html_id":"practical-applications","implicit":true,"key":"PzyCos4p6k"},{"type":"paragraph","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"children":[{"type":"text","value":"This program is a simplistic representation useful for educational purposes in teaching numerical methods for solving partial differential equations, specifically hyperbolic equations like the wave equation. It can also serve as a basic model in physical sciences and engineering for understanding wave dynamics in a controlled setting.","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"yOiPxIcIAf"}],"key":"Xr2g5Fv8EF"}],"key":"IgJzv2BUKL"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Program Compilation and Execution","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"A11m3aIsJv"}],"identifier":"program-compilation-and-execution","label":"Program Compilation and Execution","html_id":"program-compilation-and-execution","implicit":true,"key":"iLJs1vLvr1"}],"key":"o5tlz6wsxs"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The above program is compiled and run using Fortran Package Manager (fpm):","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"X76a0SetoH"}],"key":"ZuYs4cQ8tf"}],"key":"IpDimnlyP7"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-05-05T21:48:32.438956Z","iopub.status.busy":"2024-05-05T21:48:32.438774Z","iopub.status.idle":"2024-05-05T21:48:32.453821Z","shell.execute_reply":"2024-05-05T21:48:32.442236Z","shell.execute_reply.started":"2024-05-05T21:48:32.438940Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"import os\nroot_dir = os.getcwd()","key":"oNMIDR2vjx"},{"type":"outputs","id":"p22BnobKQwqzMNCsFNKZl","children":[],"key":"pLAqcylL6P"}],"key":"iswGjyq0OT"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-05-05T21:48:32.467233Z","iopub.status.busy":"2024-05-05T21:48:32.463626Z","iopub.status.idle":"2024-05-05T21:48:32.527202Z","shell.execute_reply":"2024-05-05T21:48:32.526797Z","shell.execute_reply.started":"2024-05-05T21:48:32.467207Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"code_dir = root_dir + \"/\" + \"Fortran_Code/Tsunami_Simulator\"","key":"xL9e5kXk5a"},{"type":"outputs","id":"DVolaIwJOn1qUwnooN_7B","children":[],"key":"uzzcOCybt6"}],"key":"zzeJ5dJljd"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-05-05T21:48:32.530121Z","iopub.status.busy":"2024-05-05T21:48:32.529894Z","iopub.status.idle":"2024-05-05T21:48:32.560243Z","shell.execute_reply":"2024-05-05T21:48:32.559180Z","shell.execute_reply.started":"2024-05-05T21:48:32.530103Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"os.chdir(code_dir)","key":"wGO3SIbaqI"},{"type":"outputs","id":"rT2yY2GvKNMTalJdZzRdd","children":[],"key":"krKjfevBbG"}],"key":"VFWNKW4uNJ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-05-05T21:48:32.562206Z","iopub.status.busy":"2024-05-05T21:48:32.561873Z","iopub.status.idle":"2024-05-05T21:48:32.648565Z","shell.execute_reply":"2024-05-05T21:48:32.647422Z","shell.execute_reply.started":"2024-05-05T21:48:32.562182Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"build_status = os.system(\"fpm build 2>/dev/null\")","key":"tGe2JewrSx"},{"type":"outputs","id":"BFQUJQ2DXSiFHi6jmAvSY","children":[],"key":"ev1WMCEyxD"}],"key":"RWUT7NQnqS"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-05-05T21:48:32.649546Z","iopub.status.busy":"2024-05-05T21:48:32.649309Z","iopub.status.idle":"2024-05-05T21:48:32.710489Z","shell.execute_reply":"2024-05-05T21:48:32.702105Z","shell.execute_reply.started":"2024-05-05T21:48:32.649529Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"exec_status = os.system(\"fpm run 2>/dev/null\")","key":"lPKSgw4Nyj"},{"type":"outputs","id":"vTq-IDFw8puNio9mSiGjs","children":[],"key":"HhxqVBjXHm"}],"key":"d1UkegxCWm"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The above Fortran code writes the calculations to a file called ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q31jBjTHam"},{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"tsunami_simulator_data.txt","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xCpk4IQ136"}],"key":"Gdou4wFgQz"}],"key":"vXwVaZVPYw"}],"key":"UXGWHFph5Q"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2024-05-05T21:48:32.751435Z","iopub.status.busy":"2024-05-05T21:48:32.718440Z","iopub.status.idle":"2024-05-05T21:48:33.212300Z","shell.execute_reply":"2024-05-05T21:48:33.208550Z","shell.execute_reply.started":"2024-05-05T21:48:32.751391Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd\noutput_filename = 'tsunami_simulator_data.txt'\ndata_file = code_dir + \"/\" + output_filename\ntable = pd.read_fwf(data_file, header=None)\ntable","key":"kLv8ONJihO"},{"type":"outputs","id":"8GVVTG2qGXwTjGet7QHNo","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n      <th>1</th>\n      <th>2</th>\n      <th>3</th>\n      <th>4</th>\n      <th>5</th>\n      <th>6</th>\n      <th>7</th>\n      <th>8</th>\n      <th>9</th>\n      <th>...</th>\n      <th>91</th>\n      <th>92</th>\n      <th>93</th>\n      <th>94</th>\n      <th>95</th>\n      <th>96</th>\n      <th>97</th>\n      <th>98</th>\n      <th>99</th>\n      <th>100</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>9.929509e-06</td>\n      <td>0.000025</td>\n      <td>0.000063</td>\n      <td>0.000148</td>\n      <td>0.000335</td>\n      <td>0.000732</td>\n      <td>0.001534</td>\n      <td>0.003089</td>\n      <td>0.005976</td>\n      <td>...</td>\n      <td>1.459711e-38</td>\n      <td>1.021038e-39</td>\n      <td>6.862018e-41</td>\n      <td>4.430906e-42</td>\n      <td>2.746545e-43</td>\n      <td>1.681558e-44</td>\n      <td>1.401298e-45</td>\n      <td>0.000000e+00</td>\n      <td>0.000000e+00</td>\n      <td>0.000000e+00</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1</td>\n      <td>0.000000e+00</td>\n      <td>0.000010</td>\n      <td>0.000025</td>\n      <td>0.000063</td>\n      <td>0.000148</td>\n      <td>0.000335</td>\n      <td>0.000732</td>\n      <td>0.001534</td>\n      <td>0.003089</td>\n      <td>...</td>\n      <td>2.005009e-37</td>\n      <td>1.459711e-38</td>\n      <td>1.021038e-39</td>\n      <td>6.862018e-41</td>\n      <td>4.430906e-42</td>\n      <td>2.746545e-43</td>\n      <td>1.681558e-44</td>\n      <td>1.401298e-45</td>\n      <td>0.000000e+00</td>\n      <td>0.000000e+00</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2</td>\n      <td>0.000000e+00</td>\n      <td>0.000000</td>\n      <td>0.000010</td>\n      <td>0.000025</td>\n      <td>0.000063</td>\n      <td>0.000148</td>\n      <td>0.000335</td>\n      <td>0.000732</td>\n      <td>0.001534</td>\n      <td>...</td>\n      <td>2.646043e-36</td>\n      <td>2.005009e-37</td>\n      <td>1.459711e-38</td>\n      <td>1.021038e-39</td>\n      <td>6.862018e-41</td>\n      <td>4.430906e-42</td>\n      <td>2.746545e-43</td>\n      <td>1.681558e-44</td>\n      <td>1.401298e-45</td>\n      <td>0.000000e+00</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>3</td>\n      <td>0.000000e+00</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000010</td>\n      <td>0.000025</td>\n      <td>0.000063</td>\n      <td>0.000148</td>\n      <td>0.000335</td>\n      <td>0.000732</td>\n      <td>...</td>\n      <td>3.355098e-35</td>\n      <td>2.646043e-36</td>\n      <td>2.005009e-37</td>\n      <td>1.459711e-38</td>\n      <td>1.021038e-39</td>\n      <td>6.862018e-41</td>\n      <td>4.430906e-42</td>\n      <td>2.746545e-43</td>\n      <td>1.681558e-44</td>\n      <td>1.401298e-45</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>4</td>\n      <td>1.401298e-45</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000000</td>\n      <td>0.000010</td>\n      <td>0.000025</td>\n      <td>0.000063</td>\n      <td>0.000148</td>\n      <td>0.000335</td>\n      <td>...</td>\n      <td>4.087346e-34</td>\n      <td>3.355098e-35</td>\n      <td>2.646043e-36</td>\n      <td>2.005009e-37</td>\n      <td>1.459711e-38</td>\n      <td>1.021038e-39</td>\n      <td>6.862018e-41</td>\n      <td>4.430906e-42</td>\n      <td>2.746545e-43</td>\n      <td>1.681558e-44</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>96</th>\n      <td>96</td>\n      <td>3.354626e-04</td>\n      <td>0.000732</td>\n      <td>0.001534</td>\n      <td>0.003089</td>\n      <td>0.005976</td>\n      <td>0.011109</td>\n      <td>0.019841</td>\n      <td>0.034047</td>\n      <td>0.056135</td>\n      <td>...</td>\n      <td>2.746545e-43</td>\n      <td>1.681558e-44</td>\n      <td>1.401298e-45</td>\n      <td>0.000000e+00</td>\n      <td>0.000000e+00</td>\n      <td>0.000000e+00</td>\n      <td>9.929508e-06</td>\n      <td>2.541935e-05</td>\n      <td>6.252155e-05</td>\n      <td>1.477484e-04</td>\n    </tr>\n    <tr>\n      <th>97</th>\n      <td>97</td>\n      <td>1.477484e-04</td>\n      <td>0.000335</td>\n      <td>0.000732</td>\n      <td>0.001534</td>\n      <td>0.003089</td>\n      <td>0.005976</td>\n      <td>0.011109</td>\n      <td>0.019841</td>\n      <td>0.034047</td>\n      <td>...</td>\n      <td>4.430906e-42</td>\n      <td>2.746545e-43</td>\n      <td>1.681558e-44</td>\n      <td>1.401298e-45</td>\n      <td>0.000000e+00</td>\n      <td>0.000000e+00</td>\n      <td>0.000000e+00</td>\n      <td>9.929508e-06</td>\n      <td>2.541935e-05</td>\n      <td>6.252155e-05</td>\n    </tr>\n    <tr>\n      <th>98</th>\n      <td>98</td>\n      <td>6.252155e-05</td>\n      <td>0.000148</td>\n      <td>0.000335</td>\n      <td>0.000732</td>\n      <td>0.001534</td>\n      <td>0.003089</td>\n      <td>0.005976</td>\n      <td>0.011109</td>\n      <td>0.019841</td>\n      <td>...</td>\n      <td>6.862018e-41</td>\n      <td>4.430906e-42</td>\n      <td>2.746545e-43</td>\n      <td>1.681558e-44</td>\n      <td>1.401298e-45</td>\n      <td>0.000000e+00</td>\n      <td>0.000000e+00</td>\n      <td>0.000000e+00</td>\n      <td>9.929508e-06</td>\n      <td>2.541935e-05</td>\n    </tr>\n    <tr>\n      <th>99</th>\n      <td>99</td>\n      <td>2.541935e-05</td>\n      <td>0.000063</td>\n      <td>0.000148</td>\n      <td>0.000335</td>\n      <td>0.000732</td>\n      <td>0.001534</td>\n      <td>0.003089</td>\n      <td>0.005976</td>\n      <td>0.011109</td>\n      <td>...</td>\n      <td>1.021038e-39</td>\n      <td>6.862018e-41</td>\n      <td>4.430906e-42</td>\n      <td>2.746545e-43</td>\n      <td>1.681558e-44</td>\n      <td>1.401298e-45</td>\n      <td>0.000000e+00</td>\n      <td>0.000000e+00</td>\n      <td>0.000000e+00</td>\n      <td>9.929508e-06</td>\n    </tr>\n    <tr>\n      <th>100</th>\n      <td>0</td>\n      <td>9.929508e-06</td>\n      <td>0.000025</td>\n      <td>0.000063</td>\n      <td>0.000148</td>\n      <td>0.000335</td>\n      <td>0.000732</td>\n      <td>0.001534</td>\n      <td>0.003089</td>\n      <td>0.005976</td>\n      <td>...</td>\n      <td>1.459711e-38</td>\n      <td>1.021038e-39</td>\n      <td>6.862018e-41</td>\n      <td>4.430906e-42</td>\n      <td>2.746545e-43</td>\n      <td>1.681558e-44</td>\n      <td>1.401298e-45</td>\n      <td>0.000000e+00</td>\n      <td>0.000000e+00</td>\n      <td>0.000000e+00</td>\n    </tr>\n  </tbody>\n</table>\n<p>101 rows × 101 columns</p>\n</div>","content_type":"text/html"},"text/plain":{"content":"     0             1         2         3         4         5         6    \\\n0      0  9.929509e-06  0.000025  0.000063  0.000148  0.000335  0.000732   \n1      1  0.000000e+00  0.000010  0.000025  0.000063  0.000148  0.000335   \n2      2  0.000000e+00  0.000000  0.000010  0.000025  0.000063  0.000148   \n3      3  0.000000e+00  0.000000  0.000000  0.000010  0.000025  0.000063   \n4      4  1.401298e-45  0.000000  0.000000  0.000000  0.000010  0.000025   \n..   ...           ...       ...       ...       ...       ...       ...   \n96    96  3.354626e-04  0.000732  0.001534  0.003089  0.005976  0.011109   \n97    97  1.477484e-04  0.000335  0.000732  0.001534  0.003089  0.005976   \n98    98  6.252155e-05  0.000148  0.000335  0.000732  0.001534  0.003089   \n99    99  2.541935e-05  0.000063  0.000148  0.000335  0.000732  0.001534   \n100    0  9.929508e-06  0.000025  0.000063  0.000148  0.000335  0.000732   \n\n          7         8         9    ...           91            92   \\\n0    0.001534  0.003089  0.005976  ...  1.459711e-38  1.021038e-39   \n1    0.000732  0.001534  0.003089  ...  2.005009e-37  1.459711e-38   \n2    0.000335  0.000732  0.001534  ...  2.646043e-36  2.005009e-37   \n3    0.000148  0.000335  0.000732  ...  3.355098e-35  2.646043e-36   \n4    0.000063  0.000148  0.000335  ...  4.087346e-34  3.355098e-35   \n..        ...       ...       ...  ...           ...           ...   \n96   0.019841  0.034047  0.056135  ...  2.746545e-43  1.681558e-44   \n97   0.011109  0.019841  0.034047  ...  4.430906e-42  2.746545e-43   \n98   0.005976  0.011109  0.019841  ...  6.862018e-41  4.430906e-42   \n99   0.003089  0.005976  0.011109  ...  1.021038e-39  6.862018e-41   \n100  0.001534  0.003089  0.005976  ...  1.459711e-38  1.021038e-39   \n\n              93            94            95            96            97   \\\n0    6.862018e-41  4.430906e-42  2.746545e-43  1.681558e-44  1.401298e-45   \n1    1.021038e-39  6.862018e-41  4.430906e-42  2.746545e-43  1.681558e-44   \n2    1.459711e-38  1.021038e-39  6.862018e-41  4.430906e-42  2.746545e-43   \n3    2.005009e-37  1.459711e-38  1.021038e-39  6.862018e-41  4.430906e-42   \n4    2.646043e-36  2.005009e-37  1.459711e-38  1.021038e-39  6.862018e-41   \n..            ...           ...           ...           ...           ...   \n96   1.401298e-45  0.000000e+00  0.000000e+00  0.000000e+00  9.929508e-06   \n97   1.681558e-44  1.401298e-45  0.000000e+00  0.000000e+00  0.000000e+00   \n98   2.746545e-43  1.681558e-44  1.401298e-45  0.000000e+00  0.000000e+00   \n99   4.430906e-42  2.746545e-43  1.681558e-44  1.401298e-45  0.000000e+00   \n100  6.862018e-41  4.430906e-42  2.746545e-43  1.681558e-44  1.401298e-45   \n\n              98            99            100  \n0    0.000000e+00  0.000000e+00  0.000000e+00  \n1    1.401298e-45  0.000000e+00  0.000000e+00  \n2    1.681558e-44  1.401298e-45  0.000000e+00  \n3    2.746545e-43  1.681558e-44  1.401298e-45  \n4    4.430906e-42  2.746545e-43  1.681558e-44  \n..            ...           ...           ...  \n96   2.541935e-05  6.252155e-05  1.477484e-04  \n97   9.929508e-06  2.541935e-05  6.252155e-05  \n98   0.000000e+00  9.929508e-06  2.541935e-05  \n99   0.000000e+00  0.000000e+00  9.929508e-06  \n100  0.000000e+00  0.000000e+00  0.000000e+00  \n\n[101 rows x 101 columns]","content_type":"text/plain"}}},"children":[],"key":"fUp7bM7HLF"}],"key":"TUv1yLi8hC"}],"key":"IPT0l5Li4Y"}],"key":"Ig1xReCZo7"},"references":{"cite":{"order":[],"data":{}}}}